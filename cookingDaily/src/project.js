require=function a(s,c,r){function l(t,e){if(!c[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=c[t]={exports:{}};s[t][0].call(o.exports,function(e){return l(s[t][1][e]||e)},o,o.exports,a,s,c,r)}return c[t].exports}for(var h="function"==typeof require&&require,e=0;e<r.length;e++)l(r[e]);return l}({AdHelper:[function(o,e,t){"use strict";cc._RF.push(e,"b177fHRLNdPJbL4EN8oTbsS","AdHelper");var a=["586245508649672_597485694192320"],s=0,c=null,r=!1,l=!1,h=["586245508649672_597485454192344"],d=0,u=null,p=!1,g=!1,f={},i=0,m=0,y={loadAsync:function(t,n){if(l||FBInstant.getSupportedAPIs().indexOf("getInterstitialAdAsync")<0)n&&n();else{var e=function(){l=!1,c&&(r=!0,t&&t(),y.logEvent("iad_load",{type:"suc"}))},i=function(e){l=r=!1,y.logEvent("iad_load",{type:"fail"}),"ADS_NO_FILL"!=e.code&&"ADS_FREQUENT_LOAD"!=e.code&&"NETWORK_FAILURE"!=e.code||(f[a[s]]=c),c=null,++s<a.length?(l=!0,setTimeout(function(){l=!1,y.loadAsync(t,n)},5e3)):(l=!(s=0),setTimeout(function(){l=!1},9e4),n&&n(e)),y.logEvent("aderrornew",{code:e.code})},o=a[s];y.logEvent("iad_load",{type:"begin"}),l=!0,c=f[o],f[o]=null,c?c.loadAsync().then(e,i):FBInstant.getInterstitialAdAsync(o).then(function(e){return(c=e).loadAsync()},function(e){l=!1,n&&n(e),y.logEvent("aderrornew",{code:e.code})}).then(e,i)}},isInterstitialLoad:function(){return!window.FBInstant||!o("User").get().isAdRemoved()&&(r||y.loadAsync(),c&&r)},showInterstitialAd:function(e,t,n){var i=o("PageMgr");i.showAdAnimationIn(function(){y.showInterstitialAd_(function(){i.showAdAnimationOut(function(){e&&e()})},function(){i.showAdAnimationOut(function(){e&&e()})},n)})},showInterstitialAd_:function(e,t,n){if(I=0,console.log("showInterstitialAd"),!window.FBInstant)return console.log("当前环境木有广告"),void e();if(o("User").get().isAdRemoved())return!1;c&&r?(o("User").get().addAdShowCount(),c.showAsync().then(function(){r=!1,s=0,c=null,y.loadAsync(),e()},function(){t&&t(),r=!1,s=0,c=null,y.loadAsync()}),y.logEvent("iad_show"),i++,y.logEvent("iad_show_count",{count:i})):t&&t("unknown error")},debugMsg:function(e){}},v=0;y.isSupporteVideo=function(){return!FBInstant||FBInstant&&0<=FBInstant.getSupportedAPIs().indexOf("getRewardedVideoAsync")},y.getVideoLoadedCount=function(){return v},y.loadVideoAsync=function(e,t){if(g||FBInstant.getSupportedAPIs().indexOf("getRewardedVideoAsync")<0)return t&&t(),void y.debugMsg("isVideoLoading true");console.log("loadVideoAsync");var n=function(){g=!1,u&&(p=!0,e&&e(),y.logEvent("rad_load",{type:"suc"}),v++)},i=function(e){g=p=!1,"ADS_NO_FILL"!=e.code&&"ADS_FREQUENT_LOAD"!=e.code&&"NETWORK_FAILURE"!=e.code&&"UNKNOWN"!=e.code||(f[h[d]]=u),u=null,y.logEvent("rad_load",{type:"fail"}),++d<h.length?(g=!0,setTimeout(function(){g=!1,y.loadVideoAsync()},5e3)):(g=!(d=0),setTimeout(function(){g=!1},9e4),t&&t(e)),y.debugMsg(e.code),y.logEvent("aderrornew",{code:e.code})},o=h[d];y.logEvent("rad_load",{type:"begin"}),g=!0,u=f[o],f[o]=null,u?u.loadAsync().then(n,i):FBInstant.getRewardedVideoAsync(o).then(function(e){return(u=e).loadAsync()},function(e){g=!1,t&&t(e),y.debugMsg(e.code),y.logEvent("aderrornew",{code:e.code})}).then(n,i)},y.isVideoLoad=function(){return!window.FBInstant||(p||y.loadVideoAsync(),p)},y.showVideoAd=function(e,t,n,i){if(I=0,!window.FBInstant)return console.log("当前环境木有广告"),void t();try{if(p&&u)return o("User").get().addAdShowCount(),u.showAsync().then(function(){t(),p=!1,d=0,u=null,y.loadVideoAsync()},function(e){n&&n(e.message),p=!1,d=0,u=null,y.loadVideoAsync(),y.logEvent("aderrornew",{code:e.code})}),y.logEvent("rad_show",{from:e}),m++,void y.logEvent("rad_show_count",{count:m});n&&n("fail")}catch(e){n(e)}},y.logEvent=function(e,t,n){t=t||{},FBInstant?FBInstant.logEvent(e,n||1,t||{}):console.log(e,t)};var I=1;y.autoShowAd=function(e){e=e||function(){},3<=++I&&y.isInterstitialLoad()?(y.logEvent("autoShowAd"),this.showInterstitialAd(e,e)):e()},e.exports=y,cc._RF.pop()},{PageMgr:"PageMgr",User:"User"}],AnimalUtil:[function(e,t,n){"use strict";cc._RF.push(t,"f3c9d3fV6hE3avj/OjdJlqB","AnimalUtil"),cc.Class({extends:cc.Component,properties:{},getPowerIconAnimal:function(e){var n=this;new cc.Sprite;cc.loader.loadRes("ui_shop/guang.png",function(e,t){e||(n.guang.spriteFrame=new cc.SpriteFrame(t))})}}),cc._RF.pop()},{}],AnimationData:[function(e,t,n){"use strict";cc._RF.push(t,"55f24g75pVFupBCLKMNEufI","AnimationData");var i=[{index:1,beginRotation:0,actions:[[3,360,0,0,1,1]]},{index:2,beginRotation:0,actions:[[4,480,0,0,1,1]]},{index:3,beginRotation:0,actions:[[3,480,0,0,1,1]]},{index:4,beginRotation:0,actions:[[5,630,0,0,1,1],[5,-540,0,0,1,1]]},{index:5,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:6,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:7,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:8,beginRotation:0,actions:[[5,540,.5,0,.5,1]]},{index:9,beginRotation:0,actions:[[4,450,.5,0,.5,1]]},{index:10,beginRotation:0,actions:[[8,540,.5,-.92,.5,1.92]]},{index:11,beginRotation:0,actions:[[7,540,.5,-.92,.5,1.92]]},{index:12,beginRotation:0,actions:[[6,540,.5,-.92,.5,1.92]]},{index:13,beginRotation:45,actions:[[5,750,.5,-.92,.5,1.92]]},{index:14,beginRotation:45,actions:[[7,810,.5,-.92,.5,1.92],[7,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92]]},{index:15,beginRotation:0,actions:[[3,480,0,0,1,1]]},{index:16,beginRotation:0,actions:[[4,480,0,0,1,1]]},{index:17,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:18,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:19,beginRotation:45,actions:[[7,810,.5,-.92,.5,1.92],[7,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92]]},{index:20,beginRotation:45,actions:[[5,630,0,0,1,1]]},{index:21,beginRotation:0,actions:[[3,120,.7,-.56,.42,1.81],[3,330,.7,-.56,.42,1.81]]},{index:22,beginRotation:0,actions:[[5,420,.1,.75,.48,.98]]},{index:23,beginRotation:0,actions:[[5,270,.1,.75,.48,.98]]},{index:24,beginRotation:0,actions:[[5,480,0,.42,.46,.99],[5,-360,0,.42,.46,.99]]},{index:25,beginRotation:0,actions:[[4,120,.5,-.62,.43,1.55],[4,360,.5,.5,.5,.5]]},{index:26,beginRotation:0,actions:[[5,450,.5,-.62,.43,1.55]]},{index:27,beginRotation:0,actions:[[3,360,.5,-.62,.43,1.55],[4,420,.5,.5,.5,.5]]},{index:28,beginRotation:0,actions:[[4,450,.5,-.62,.43,1.55]]},{index:29,beginRotation:45,actions:[[5,450,.5,-.62,.43,1.55]]},{index:30,beginRotation:0,actions:[[3,432,.04,1.01,.55,1.34]]},{index:31,beginRotation:0,actions:[[.5,-80,.5,0,.5,1],[1,160,.5,0,.5,1],[.9,-145,.5,0,.5,1],[.9,130,.5,0,.5,1],[.8,-115,.5,0,.5,1],[.8,100,.5,0,.5,1],[.7,-85,.5,0,.5,1],[.7,70,.5,0,.5,1],[.6,-55,.5,0,.5,1],[.6,40,.5,0,.5,1],[.6,-20,.5,0,.5,1]]},{index:32,beginRotation:0,actions:[[3,360,0,0,1,1]]},{index:33,beginRotation:0,actions:[[4,480,0,0,1,1]]},{index:34,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:35,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:36,beginRotation:0,actions:[[5,630,0,0,1,1],[5,-540,0,0,1,1]]},{index:37,beginRotation:0,actions:[[1,30,1,0,0,1],[2,-60,1,0,0,1],[1,420,0,0,1,1]]},{index:38,beginRotation:0,actions:[[2,360,0,0,1,1],[4,360,0,0,1,1],[4,360,0,0,1,1]]},{index:39,beginRotation:0,actions:[[6,450,.47,-.65,.42,1.75]]},{index:40,beginRotation:0,actions:[[6,450,.5,.5,.53,.88]]},{index:41,beginRotation:0,actions:[[6.5,450,.47,-.65,.42,1.75]]},{index:42,beginRotation:0,actions:[[6,450,.5,.5,.53,.88]]},{index:43,beginRotation:0,actions:[[5,630,0,0,1,1],[5,-540,0,0,1,1]]},{index:44,beginRotation:0,actions:[[6,450,.47,-.65,.42,1.75]]},{index:45,beginRotation:0,actions:[[1.5,30,1,0,0,1],[2.5,-60,1,0,0,1],[1.5,420,0,0,1,1]]},{index:46,beginRotation:0,actions:[[1.5,360,0,0,1,1],[3.5,360,0,0,1,1],[3.5,360,0,0,1,1]]},{index:47,beginRotation:0,actions:[[4,420,.46,.74,.33,.61]]},{index:48,beginRotation:0,actions:[[6,450,.74,-.7,.16,1.68]]},{index:49,beginRotation:0,actions:[[6,450,.74,-.7,.16,1.68]]},{index:50,beginRotation:0,actions:[[3,450,.5,0,.5,1]]},{index:51,beginRotation:0,actions:[[3,400,.5,0,.5,1]]},{index:52,beginRotation:0,actions:[[2.5,-432,.7,0,.61,.99]]},{index:53,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:54,beginRotation:0,actions:[[6,450,.5,.5,.53,.88]]},{index:55,beginRotation:0,actions:[[7,540,.5,-.92,.5,1.92]]},{index:56,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:57,beginRotation:0,actions:[[2.5,480,0,0,1,1]]},{index:58,beginRotation:0,actions:[[3.5,480,0,0,1,1]]},{index:59,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:60,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:61,beginRotation:45,actions:[[6,750,.5,-.92,.5,1.92]]}];t.exports={getData:function(e){return i[e-1]}},cc._RF.pop()},{}],AppleShopDialog:[function(e,t,n){"use strict";cc._RF.push(t,"958dbsYmd5A45eeE88FG97D","AppleShopDialog");var i=e("PageMgr"),o=e("User"),a=e("AdHelper");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label},onEnable:function(){this.price1.string=o.get().getPrice("apple_package","$1.99"),this.price2.string=o.get().getPrice("apple_car_half","$4.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){a.logEvent("pay_shop_click",{itemId:"apple_package"}),o.get().purchase("apple_package",function(){o.get().addDiamon(2500),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(2500),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_package"})},function(){})},onBuyItem2:function(){a.logEvent("pay_shop_click",{itemId:"apple_car_half"}),o.get().purchase("apple_car_half",function(){o.get().addDiamon(25e3),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(25e3),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_car_half"})},function(){})},onClose:function(){i.hideDialog("AppleShopDialog"),this.data&&this.data.closeCb&&this.data.closeCb()}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],BestShareDialog:[function(e,t,n){"use strict";cc._RF.push(t,"33b14SPe/VCVrnUmcBoGf8O","BestShareDialog");var i=e("PageMgr"),o=e("AdHelper"),a=e("Utils");cc.Class({extends:cc.Component,properties:{playerImg3:cc.Sprite,playerImg4:cc.Sprite,playerScore1:cc.Label,playerScore2:cc.Label,shareDialogNode:cc.Node,closeNode:cc.Node,bestShareImgNode:cc.Node},start:function(){},onEnable:function(){var e=this;o.logEvent("best_share_show"),this.shareDialogNode.width=cc.winSize.width,this.shareDialogNode.height=cc.winSize.height,this.shareDialogNode.scale=0,this.closeNode.active=!1,this.shareDialogNode.runAction(cc.sequence(cc.scaleTo(.3,1).easing(cc.easeBackOut()),cc.delayTime(2),cc.callFunc(function(){e.closeNode.active=!0,e.closeNode.opacity=0,e.closeNode.runAction(cc.fadeIn(1))})))},updateUI:function(e){this.data=e,this.playerScore1.string=e.knifeCount,this.playerScore2.string=e.knifeCount,e.playerTexture&&(this.playerImg3.spriteFrame=new cc.SpriteFrame(e.playerTexture),this.playerImg4.spriteFrame=new cc.SpriteFrame(e.playerTexture))},onShare:function(){o.logEvent("best_share_click"),this.bestShareImgNode.active=!0;a.captureScreen(this.bestShareImgNode,537,300,function(e){FBInstant&&(o.logEvent("share_game",{from:"result_share"}),FBInstant.shareAsync({intent:"SHARE",image:e,text:this.isBest?FBInstant.player.getName()+" set a new personal best in Cooking Daily":"Can you beat my score in Cooking Daily ?",data:{myReplayData:"data",from:"result_share"}}).then(function(){console.log("share success")}).catch(function(e){console.log("err",e)}))}.bind(this)),this.bestShareImgNode.active=!1},onClose:function(){i.hideDialog("BestShareDialog"),this.data.onClose()}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",Utils:"Utils"}],BonusAnim:[function(e,t,n){"use strict";cc._RF.push(t,"09c78o15OJJoL3uCde/ngxn","BonusAnim");var i=e("SoundMgr");cc.Class({extends:cc.Component,properties:{topLabel:cc.Label,bottomLabel:cc.Label,iconSp:sp.Skeleton,iconsSp:[sp.SkeletonData]},onLoad:function(){this.configs=[["SECOND","CHANCE",i.PWR_UP_SECOND_CHANCE],["EXTRA","CONTINUE"],["EXTRA","APPLES"],["",""],["",""],["DOUBLE","XP"],["THREE","CHANCE"]]},setType:function(e){var t=e-1;this.iconSp.skeletonData=this.iconsSp[t],this.iconSp.setAnimation(0,"animation"),this.topLabel.string=this.configs[t][0],this.bottomLabel.string=this.configs[t][1],3==this.configs[t].length&&i.play(this.configs[t][2])}}),cc._RF.pop()},{SoundMgr:"SoundMgr"}],Breath:[function(e,t,n){"use strict";cc._RF.push(t,"f1a8aw8ioNH/J24zxz/tS3e","Breath"),cc.Class({extends:cc.Component,properties:{},onEnable:function(){this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.5,1.1),cc.scaleTo(.5,1)).repeatForever())}}),cc._RF.pop()},{}],BtnBreath:[function(e,t,n){"use strict";cc._RF.push(t,"c2378+plHdO/bOT+tFKPGO6","BtnBreath"),cc.Class({extends:cc.Component,properties:{},onEnable:function(){this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.scaleTo(.3,1.5),cc.scaleTo(.2,1)).repeatForever())}}),cc._RF.pop()},{}],ButtonSync:[function(e,t,n){"use strict";cc._RF.push(t,"6c48bSRMtJGA6ETq/AFESSd","ButtonSync"),cc.Class({extends:cc.Component,properties:{btn:cc.Button,sp:cc.Sprite},start:function(){},update:function(e){this.sp._sgNode.setState(this.btn.interactable?0:1)}}),cc._RF.pop()},{}],1:[function(e,t,n){var i,o,a=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function r(t){if(i===setTimeout)return setTimeout(t,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}(function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}})();var l,h=[],d=!1,u=-1;function p(){d&&l&&(d=!1,l.length?h=l.concat(h):u=-1,h.length&&g())}function g(){if(!d){var e=r(p);d=!0;for(var t=h.length;t;){for(l=h,h=[];++u<t;)l&&l[u].run();u=-1,t=h.length}l=null,d=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new f(e,t)),1!==h.length||d||r(g)},f.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],ChristmasSaleDialog:[function(e,t,n){"use strict";cc._RF.push(t,"66b67u2ir9NIJ21EZmsR/DZ","ChristmasSaleDialog");var i=e("PageMgr"),o=e("User"),a=e("AdHelper"),s=e("Utils");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label,price3:cc.Label,timerLabel:cc.Label},onEnable:function(){this.price1.string=o.get().getPrice("apple_box","$2.99"),this.price2.string=o.get().getPrice("apple_60000","$28.99"),this.price3.string=o.get().getPrice("apple_180000_half","$49.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){a.logEvent("pay_shop_click",{itemId:"apple_box"}),o.get().purchase("apple_box",function(){o.get().addDiamon(7500),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(7500),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})},onBuyItem2:function(){a.logEvent("pay_shop_click",{itemId:"apple_60000"}),o.get().purchase("apple_60000",function(){o.get().addDiamon(18e4),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(18e4),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})},onBuyItem3:function(){a.logEvent("pay_shop_click",{itemId:"apple_180000_half"}),o.get().purchase("apple_180000_half",function(){o.get().addDiamon(6e5),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_180000_half"})},function(){})},onClose:function(){i.hideDialog("ChristmasSaleDialog"),this.data&&this.data.closeCb&&this.data.closeCb()},update:function(){0<o.get().getChristmasLeftTime()&&(this.timerLabel.string=s.formatTimeHMS(o.get().getChristmasLeftTime()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],ContinuePage:[function(e,t,n){"use strict";cc._RF.push(t,"878e4gMd1pE0qZpqw1RsCpW","ContinuePage");var o=e("PageMgr"),a=e("SoundMgr"),h=e("AdHelper"),d=e("User"),i=e("Utils");cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeCountLabel:cc.Label,stageLabel:cc.Label,continueBreath:cc.Animation,diamonCount:cc.Label,videoBtn:cc.Button,adNode:cc.Node,coinNode:cc.Node,skipNode:cc.Node,adIconNode:cc.Node,continueLabelNode:cc.Node,knifeGroup:cc.Node,knifes:[]},onLoad:function(){this.appleCount=200},start:function(){},setKnifes:function(e,t,n){for(var i=0;i<e;i++){if(i>=this.knifes.length){var o=cc.instantiate(this.knifeIconTemplate);this.knifes.push(o),this.knifeGroup.addChild(o)}this.knifes[i].x=40*(i-e/2+.5),this.knifes[i].y=0,this.knifes[i].active||(this.knifes[i].active=!0),this.knifes[i].getComponent("KnifeIcon").setSelect(i<t)}for(this.knifeGroup.scale=40==n?1:.5*cc.winSize.width/640;i<this.knifes.length;i++)this.knifes[i].active=!1},updateUI:function(e){this.data=e,this.from=e.from,this.onContinueCb=e.onContinue,this.onNoContinueCb=e.onNoContinue;var t=e.curKnifeAmount,n=e.curStage,i=e.isBoss,o=e.name,a=e.continueCount,s=e.allcount||1,c=e.leftcount||1,r=e.gap||40;this.knifeCountLabel.string=t,this.diamonCount.string=d.get().getDiamonCount();this.curStage=n;if(i)this.stageLabel.string=o,this.stageLabel.node.color=this.stageLabel.node.color;else{this.stageLabel.node.color=cc.Color.WHITE;this.stageLabel.string="STAGE "+n}this.setKnifes(s,c,r);this.node.getComponent(cc.Animation);this.isFreeContinue=1==a&&d.get().isFreeContinue(),this.isAdContinue=!this.isFreeContinue,this.videoBtn.interactable=h.isVideoLoad();var l="none";this.coinNode.active=!this.isFreeContinue,this.skipNode.active=!this.isFreeContinue,this.adNode.y=this.isFreeContinue?-250:-162,this.isFreeContinue?(this.adIconNode.active=!1,this.videoBtn.interactable=!0,this.continueLabelNode.x=0,l="buyad_free"):(this.adIconNode.active=!0,this.continueLabelNode.x=32,l=1==a?"ad_first":"ad_second","gamespin"==this.from?l="games_spin":"game_halloween"==this.from&&(l="halloween_"+l)),this.state=l,h.logEvent("continue_show",{state:this.state})},onEnable:function(){h.isVideoLoad()&&this.continueBreath.play("continueBtn");var e=this.node.getComponent(cc.Animation);e.setCurrentTime(0),e.play("continue");var t=this;e.off("finished"),e.on("finished",function(){e.off("finished"),setTimeout(function(){t.onThanksButton()},200)}),this.audioId=a.play(a.CONITINUE_TIMER)},onAdButton:function(t){var n=this;if(this.isFriendInvite)this.onInviteFriend();else{a.stop(a.CONITINUE_TIMER),t.currentTarget.getComponent(cc.Button).interactable=!1;var e=this.node.getComponent(cc.Animation);e.pause();var i=function(e){t.currentTarget.getComponent(cc.Button).interactable=!0,o.hideDialog(o.CONTINUE),e&&(e=-e),n.onContinueCb(-e)};if(h.logEvent("continue_adclick",{state:this.state}),!this.isFreeContinue)return this.isAppleContinue?(d.get().decDiamon(200),void i(200)):void h.showVideoAd("continue_"+this.state,i,function(){e&&e.resume()});i()}},onInviteFriend:function(){var e=this;if(!FBInstant)return o.hideDialog(o.CONTINUE),void this.onContinueCb();o.showLoading();var n=this.node.getComponent(cc.Animation);n.pause(),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){FBInstant.context.getPlayersAsync().then(function(e){var t="";e.map(function(e){e.getID()!=FBInstant.player.getID()&&(t=e.getName())}),i.getShareImg(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:"hey，"+t+"，"+FBInstant.player.getName()+"  is waiting for you！",image:e,data:{from:"continue_invite"},strategy:"IMMEDIATE",notification:"PUSH"})})}),a.stop(a.CONITINUE_TIMER),d.get().decInviteContinueCount(),o.hideDialog(o.CONTINUE),e.onContinueCb(),o.hideLoading(),h.logEvent("continue_invite_finish",{state:e.state})}).catch(function(e){if("SAME_CONTEXT"==e.code){var t=o.getPage(o.INVITETINVALID);t.getChildByName("timer").getComponent(cc.Label).string="LATER",o.showDialog(o.INVITETINVALID,!0),t.once("close",function(){n&&n.resume()})}else n&&n.resume();o.hideLoading()}),h.logEvent("continue_invite_click",{state:this.state})},onThanksButton:function(){o.hideDialog(o.CONTINUE),h.logEvent("continue_nothank_click",{state:this.state}),a.stop(a.CONITINUE_TIMER),this.onNoContinueCb()},onAppleContinue:function(e){var t=this;a.stop(a.CONITINUE_TIMER);var n,i="enough";d.get().getDiamonCount()>=this.appleCount?(d.get().decDiamon(this.appleCount),n=this.appleCount,o.hideDialog(o.CONTINUE),e.currentTarget.getComponent(cc.Button).interactable=!0,n&&(n=-n),t.onContinueCb(n)):(this.diamonCount.node.runAction(cc.sequence(cc.scaleTo(.3,2),cc.delayTime(1),cc.scaleTo(.3,1))),i="not_enough",this.continueBreath.play(),o.showTip("Not enough coins."),setTimeout(function(){o.hideTip()},3e3)),h.logEvent("continue_apple_click",{isok:i,state:this.state})}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils"}],EventUtil:[function(e,t,n){"use strict";cc._RF.push(t,"c251av5S5hKzK/VV27L//lJ","EventUtil"),cc.Class({extends:cc.Component,emitEvent:function(e,t){this.node.emit(t)}}),cc._RF.pop()},{}],FBShare:[function(e,t,n){"use strict";cc._RF.push(t,"1ab80lNf/dO1q5hJ1lxn6sR","FBShare");e("User");cc.Class({extends:cc.Component,properties:{},onShare:function(e){FBInstant&&FBInstant.shareAsync({intent:"SHARE",image:"",text:"This game is very funny!",data:{myReplayData:"data"}}).then(function(){})},onRequet:function(){FBInstant.shareAsync({intent:"REQUEST",image:"",text:"X is asking for your help!",data:{myReplayData:"data"}}).then(function(){})},onInvite:function(){FBInstant.shareAsync({intent:"INVITE",image:"",text:"play with me!",data:{myReplayData:"data"}}).then(function(){})},onChallenge:function(){FBInstant.shareAsync({intent:"CHALLENGE",image:"",text:"come on to play with me!",data:{myReplayData:"data"}}).then(function(){})},start:function(){},logEvent:function(e,t){FBInstant&&FBInstant.logEvent(t,1,{})}}),window.shareImg="",cc._RF.pop()},{User:"User"}],GameConfig:[function(e,t,n){"use strict";cc._RF.push(t,"326e1SwBLRIXqKlhmB5FJFc","GameConfig"),window.GameVersion="2.14",window.DEV=!1,window.FUNCTION_VERSION=1,window.GAME_ID=11,window.appId="586245508649672",window.FB_APPID="586245508649672",window.lastScore=Math.floor(50*Math.random()),window.GameName="CookingDaily";try{window.FBInstant&&!window.DEV&&(console.log=function(){})}catch(e){}cc._RF.pop()},{}],GameDuel:[function(e,t,n){"use strict";cc._RF.push(t,"fce86pVEVdFQ7GsjC4C9L9r","GameDuel");var v=e("User"),I=e("PrizeData"),A=(e("LevelData"),e("PKLevelData")),T=e("TargetData"),S=e("AnimationData"),C=e("KnifeData"),k=e("SoundMgr"),b=e("PageMgr"),w=e("AdHelper"),f=e("Utils"),_=e("NetAPI");e("enginefix"),cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bonusAnim:cc.Prefab,pkTop:cc.Node,myNameLabel:cc.Label,opponentNameLabel:cc.Label,roundLabel:cc.Label,mySprite:cc.Sprite,opponentSprite:cc.Sprite,myKnifeGroup:cc.Node,opponentKnifeGroup:cc.Node,stakeSprite:cc.Sprite,defaltHeadFrame:cc.SpriteFrame,yoff:-500,stopY:-180,speed:100},init:function(){var n=this;this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=v.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!v.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.preBossData=null,this.preBossTexture=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.friendIndex=0,this.gotoUnlockLevel=15,this.myknifes=this.myknifes||[],this.opponentknifes=this.opponentknifes||[],this.knifesInPkTargets=this.knifesInPkTargets||[],this.roundKnifeData=[],!this.myPhotoTexure&&FBInstant&&FBInstant.player.getPhoto()&&cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e||(n.myPhotoTexure=t)}),this.otherPlayer=null,this.playWithMsg=null,this.playerCount=0},setKnifeTempLate:function(e){e instanceof cc.SpriteFrame?this.knifeTemplate.getComponent(cc.Sprite).spriteFrame=e:this.knifeTemplate=e,this.knifeTemplate.scale=1,this.knifeTemplate.rotation=0,this.setupKnifesPool()},showCostTip:function(e){this.costTipNode.active=!0,this.costTipNode.stopAllActions(),this.costTipNode.scale=0,this.costTipNode.y=-203,this.costTipNode.opacity=255,this.costTipNode.getChildByName("label").getComponent(cc.Label).string=e,this.costTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50))))},onEnable:function(){var o=this;if(this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),window.FBInstant){this.targetAnim.node.scale=0,this.roundLabel.node.opacity=0;var t=this.pkTop.getComponent(cc.Animation);this.roundLabel.string="ROUND "+this.pkInfo.round,this.pkInfo.fightId?(t.once("finished",function(){if(o.isInPlayback=!0,1==o.pkInfo.round)o.playPKStage(o.simDatas,function(){b.showTurn("It is your turn!"),o.beginPKStage()});else{o.roundLabel.string="ROUND "+(o.pkInfo.round-1);for(var e=[4,3,2,1][o.pkInfo.round-2],t=[],n=[],i=0;i<o.simDatas.length;i++)i<e?t.push(o.simDatas[i]):n.push(o.simDatas[i]);o.playPKStage(t,function(){o.playRoundChange(o.pkInfo.round),o.playPKStage(n,function(){b.showTurn("It is your turn!"),o.beginPKStage()})})}}),t.play("pkstart")):(this.pkTop.y=647,b.getPageAsync(b.TURNTABLE).then(function(e){e.getComponent("TurntableDialog").setFinishCallback(function(e){b.hideDialog(b.TURNTABLE),o.pkInfo.stake=e,o.addPkPlayersDisplay(),o.pkTop.y=347,t.once("finished",function(){o.beginPKStage()}),t.play("pkstart")}),b.showDialog(b.TURNTABLE)}))}},preparePkAsync:function(e){var a=this;this.isPkMod=!1,this.removeKnifes(!0),this.removeApples(!0),this.pkInfo=e,this.leftRound=this.pkInfo.fightId&&this.pkInfo.round<=3?2:1,this.isPkMod=!0,this.knifeTextures={},this.init(),this.addPkPlayersDisplay();var n=[],t=this.pkInfo.myDatas||[],i=this.pkInfo.opponentDatas||[],s=["1",v.get().getCurKnife()];t.forEach(function(e){var t=e>>16;s.indexOf(t)<0&&s.push(t),n.push({id:t,rotation:65535&e})}),i.forEach(function(e){var t=e>>16;s.indexOf(t)<0&&s.push(t),n.push({id:t,rotation:65535&e})}),this.knifesInPkTargets=n;var o=A.getData(1),c=o.target,r=T.getData(c),l=o.animation;this.pkInfo.round;cc.loader.loadRes("target/target_1",function(e,t){e||(a.targetSprite.spriteFrame=new cc.SpriteFrame(t))});this.curActionsData=S.getData(l),this.curTargetData=r,this.sounds={hitTarget:k.HIT,hitBlock:k.KNIFE_HIT,hitApple:k.APPLE_HIT};var h=null!=this.pkInfo.randomIndex?this.pkInfo.randomIndex:Math.floor(Math.random()*o.knifes.length),d=o.knifes[h],u=o.diamons[h];this.pkInfo.randomIndex=h;for(var p=0;p<d.length;p++){var g=this.defaultKnifePool.get();g.rotation=d[p],this.addKnifeToTarget(g),this.knifesInPkTargets.unshift({id:"1",rotation:d[p]})}if(!this.pkInfo.fightId)for(var f=0;f<u.length;f++){var m=this.applePool.get();m.rotation=u[f],this.addAppleToTarget(m)}var y=function(){for(var e=a.knifesInPkTargets,t=[4,7,5,3],n=a.pkInfo.round<=t.length?t[a.pkInfo.round-1]:1,i=0;i<e.length-n;i++){var o=a.defaultKnifePool.get();o.rotation=e[i].rotation,a.addKnifeToTarget(o,e[i].id)}for(a.simDatas=[];i<e.length;i++)a.simDatas.push(e[i])};return new Promise(function(i,e){var o=0;if(0==s.length)return y(),void i();for(var t=function(n){var e=C.getData(s[n]);e&&e.img&&cc.loader.loadRes("knife/"+e.img,function(e,t){e?console.log("error",e):(a.knifeTextures[s[n]]=t,s[n]==v.get().getCurKnife()&&a.setKnifeTempLate(new cc.SpriteFrame(t)),++o>=s.length&&(y(),i()))})},n=0;n<s.length;n++)t(n)})},addPkPlayersDisplay:function(){var n=this;this.myNameLabel.string=FBInstant.player.getName();var e=FBInstant.player.getPhoto();this.myPhotoTexure?this.mySprite.spriteFrame=new cc.SpriteFrame(this.myPhotoTexure):e&&cc.loader.load(e,function(e,t){e||(n.mySprite.spriteFrame=new cc.SpriteFrame(t))}),this.opponentNameLabel.string=this.pkInfo.nickname,this.opponentSprite.spriteFrame=this.defaltHeadFrame,this.pkInfo.photo&&cc.loader.load(this.pkInfo.photo,function(e,t){e||(n.opponentSprite.spriteFrame=new cc.SpriteFrame(t))});var t=I.getData(this.pkInfo.stake);t&&t.img&&cc.loader.loadRes("stakes/"+t.img,function(e,t){e||(n.stakeSprite.spriteFrame=new cc.SpriteFrame(t))})},playPKStage:function(n,i){var o=this;this.resetKnifes(n.length),this.resetUpLeftKnifes(n.length),this.resetUpRightKnifes(n.length),this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){for(var e=function(e){var t=o.defaultKnifePool.get();t.rotation=n[e].rotation,setTimeout(function(){o.addKnifeToTarget(t,n[e].id,!0),k.play(o.sounds.hitTarget),o.consumeOneKnife(),e==n.length-1&&i()},500*e)},t=0;t<n.length;t++)e(t)})))},playRoundChange:function(e){var t=this;this.roundLabel.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,0),cc.fadeOut()),cc.callFunc(function(){t.roundLabel.string="ROUND "+e,t.roundLabel.node.scale=4}),cc.spawn(cc.scaleTo(.1,1),cc.fadeIn())))},beginPKStage:function(e){this.isInPlayback=!1;var t=[4,3,2,1],n=A.getData(1),i=n.target,o=T.getData(i),a=(n.animation,this.pkInfo.round),s=a<=t.length?t[a-1]:1;if(this.curActionsData=S.getData(n.animation),this.curTargetData=o,this.resetKnifes(s),this.pkInfo.fightId&&!e||(this.resetUpLeftKnifes(s),this.resetUpRightKnifes(s)),e)return this.isStageBegin=!0,this.showKnifeIn(),void this.playRoundChange(this.pkInfo.round);this.beginStageActions()},onPkRoundEnd:function(e){var n=this;if(this.leftRound--,!e&&0<this.leftRound)return this.pkInfo.round++,void this.beginPKStage(!0);for(var t=[],i=v.get().getCurKnife(),o=0;o<this.roundKnifeData.length;o++)this.roundKnifeData[o]=this.roundKnifeData[o]%360,this.roundKnifeData[o]<0&&(this.roundKnifeData[o]+=360),t.push(i<<16|Math.round(this.roundKnifeData[o])),this.knifesInPkTargets.push({id:i,rotation:Math.round(this.roundKnifeData[o])});this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),b.showTip("Sending score...",null,-200);var a=null,s="",c="",r=!1,l=this.myNameLabel.string,h=this.opponentNameLabel.string,d=[4,3,2,1],u=I.getData(this.pkInfo.stake).emoji,p=-1,g=!1,f=this.pkInfo.round;if(this.pkInfo.fightId&&!e){var m=f<=d.length?d[f-1]:1;4==f&&this.pkInfo.promoterPlayerId!=this.pkInfo.opponentPlayerId?(a=_.FightOverAsync(this.pkInfo.fightId,0,t,f),s="Draw! Great game! Will "+h+" want a duel?",c="START NEW MATCH",r=g=!0):(a=_.FightRoundAsync(this.pkInfo.fightId,this.isUsingContinue,t,f),s="Round "+f+" starts with "+l+" casting "+m+" knives first and then "+h+".",c="PLAY")}else e?(p=this.pkInfo.opponentDatas.length+this.pkInfo.myDatas.length+t.length,a=_.FightOverAsync(this.pkInfo.fightId,this.pkInfo.opponentPlayerId,t,f),s=l+"  lost aginst "+h+"! "+l+" is obliged to buy "+u+" for "+h+".",c="START NEW MATCH",r=!0):(a=_.FightWithFriendAsync(this.pkInfo.opponentFacebookId,this.pkInfo.contextId,this.pkInfo.stake,t,this.isUsingContinue,this.pkInfo.randomIndex),s=l+" challenges "+h+" to a duel and the prize is "+u+".Round 1 starts and then "+h+".",c="ACCEPT PK");var y="";a.then(function(e){return y=e.sign,n.getScreenImageAsync(p,g,t)}).then(function(e){var t=function(){b.showTip("Score sent!",null,-200,!0),w.logEvent("pkmessage_send"),setTimeout(function(){if(b.hideTip(),r){var e=n.pkTop.getChildByName("mask");e.active=!0;var t=g?n.pkTop.getChildByName("draw"):n.pkTop.getChildByName("lose");t.active=!0,t.scale=4,t.opacity=0,t.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,1),cc.fadeIn(.1)),cc.delayTime(2),cc.callFunc(function(){t.active=!1,e.active=!1,b.showPage(b.PKPAGE)},n)))}else b.showTurn("It's your friend's turn !"),setTimeout(function(){b.showPage(b.PKPAGE)},3e3)},1e3)};FBInstant.updateAsync({action:"CUSTOM",cta:c,template:"pk_turn",text:s,image:e,data:{isPk:!0,sign:y,fightId:n.pkInfo.fightId,isNewMatch:r,from:"pk"},strategy:"IMMEDIATE",notification:"PUSH"}).then(t,t),n.isPkMod=!1,n.pkInfo=null}).catch(function(e){console.log(e),b.hideTip(),b.showPage(b.PKPAGE)})},getScreenImageAsync:function(e,t,n,i){var o=this.myNameLabel.string,a=this.opponentNameLabel.string,s=this.pkInfo.round,c=[4,3,2,1],r=!this.pkInfo.fightId||this.pkInfo.promoterPlayerId!=this.pkInfo.opponentPlayerId,l=this.mySprite.spriteFrame.getTexture(),h=this.opponentSprite.spriteFrame.getTexture(),d=1<s?c[s-2]:5,u=n.length%d,p=r?0:c[s-1],g={myName:r?o:a,opponentName:r?a:o,myTexture:r?l:h,opponentTexture:r?h:l,round:this.pkInfo.round,stakeTexture:this.stakeSprite.spriteFrame.getTexture(),knifes:this.knifesInPkTargets,knifeTextures:this.knifeTextures,loseIndex:e,isDraw:t,isMyTurn:!r,isMyWin:i||!r,leftCount:r?u:p,rightCount:r?p:u};return new Promise(function(e,t){f.getImageAsync("PKScreen",g).then(e).catch(t)})},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++){(n=new cc.Node).isDefaultKnife=!0,this.defaultKnifePool.put(n);var t=n.addComponent(cc.Sprite);t.spriteFrame=this.defaultKnifeIcon,t.trim=!1,t.sizeMode=cc.Sprite.SizeMode.RAW}for(e=0;e<30;e++){(n=new cc.Node).scale=.53,n.width=136,n.height=162,this.applePool.put(n),(n=n.addComponent(cc.Sprite)).spriteFrame=this.appleIcon}for(e=0;e<10;e++){var n;(n=new cc.Node).scale=.6,n.width=72,n.height=86,this.goldApplePool.put(n),(n=n.addComponent(cc.Sprite)).spriteFrame=this.goldAppleIcon}},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){var e=this;0==this.leftAmount&&(this.isStageBegin=!1,w.logEvent("pk_round_finish",{curStage:this.curStage}),setTimeout(function(){e.onPkRoundEnd()},1e3))},removeKnifes:function(e){if(!this.isPkMod)for(var t,n,i,o,a,s=this.targetBack.children,c=this,r=.3,l=s.length-1;0<=l;l--){var h=s[l];e?d(h):(t=h,void 0,n=2*Math.random()+3,i=cc.moveBy(r,-t.x*n,-t.y*n),o=cc.rotateBy(r,380*Math.random()-180),a=cc.sequence(cc.delayTime(r-.05),cc.fadeOut(.05)),t.runAction(cc.sequence(cc.spawn(i,o,a),cc.callFunc(d.bind(null,t)))))}function d(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?c.defaultKnifePool.put(e):c.knifePool.put(e),e.opacity=255}},removeApples:function(){if(!this.isPkMod)for(var e,t=this.targetUp.children,n=this,i=t.length-1;0<=i;i--){var o=t[i];(e=o).isGold?n.goldApplePool.put(e):n.applePool.put(e)}},removeSpecial:function(){this.specialBack.removeAllChildren(),this.specailUp.removeAllChildren()},resetUpLeftKnifes:function(e){for(var t=0;t<e;t++){if(t>=this.myknifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.myknifes.push(n),this.myKnifeGroup.addChild(n)}this.myknifes[t].x=30*t,this.myknifes[t].y=0,this.myknifes[t].active||(this.myknifes[t].active=!0),this.myknifes[t].getComponent("KnifeIcon").setSelect(!0),this.myknifes[t].runAction(cc.hide()),this.myknifes[t].runAction(cc.sequence(cc.delayTime(.1*t),cc.show()))}for(;t<this.myknifes.length;t++)this.myknifes[t].active=!1},resetUpRightKnifes:function(e){for(var t=0;t<e;t++){if(t>=this.opponentknifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.opponentknifes.push(n),this.opponentKnifeGroup.addChild(n)}this.opponentknifes[t].x=-30*t,this.opponentknifes[t].y=0,this.opponentknifes[t].active||(this.opponentknifes[t].active=!0);var i=this.pkInfo.promoterPlayerId!=this.pkInfo.opponentPlayerId||!this.pkInfo.fightId,o=i&&(1==this.pkInfo.round||3==this.pkInfo.round)||!i&&(2==this.pkInfo.round||4==this.pkInfo.round||5==this.pkInfo.round);this.opponentknifes[t].getComponent("KnifeIcon").setSelect(this.isInPlayback||o),this.opponentknifes[t].runAction(cc.hide()),this.opponentknifes[t].runAction(cc.sequence(cc.delayTime(.1*t),cc.show()))}for(;t<this.opponentknifes.length;t++)this.opponentknifes[t].active=!1},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1),this.isPkMod&&(this.isInPlayback?this.opponentknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1):this.myknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)))},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){v.get().addOneDiamon(e)},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),k.play(k.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.showKnifeIn()},getActions:function(e){for(var t=[],n=2<3*Math.random(),i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s=null;return s=1<t.length?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e,t,n){var i=e.rotation,o=i*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-i,e.x=this.targetBack.x+160*Math.cos(o),e.y=this.targetBack.y+160*Math.sin(o),t&&(e.preFrame=e.getComponent(cc.Sprite).spriteFrame,e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.knifeTextures[t])),n){var a=e.x,s=e.y;e.x=this.targetBack.x+500*Math.cos(o),e.y=this.targetBack.y+500*Math.sin(o),e.runAction(cc.moveTo(.05,a,s))}},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+198*Math.cos(n),e.y=this.targetUp.y+198*Math.sin(n)},showResult:function(){var e=this;b.hideDialog(b.CONTINUE),setTimeout(function(){e.onPkRoundEnd(!0)},0)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++){if((d=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(d*Math.PI/180),o=-Math.abs(Math.cos(d*Math.PI/180));u&&(i=-i);var a=Math.max(.1,d/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*d*20),c=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*c*10,o*=c;var r=cc.moveBy(a,i,o),l=this,h=cc.spawn(r,s);this.curMoveKnife.runAction(cc.sequence(h,cc.callFunc(function(){l.knifePool.put(l.curMoveKnife),l.curMoveKnife=null,setTimeout(function(){l.onGameOver()},200)}))),this.playDieEffect(d,u),k.play(this.sounds.hitBlock);break}}e=this.targetUp.children;t=15;for(n=0;n<e.length;n++){var d,u;if((d=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d)break}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var t=this,e=1==this.continueCount&&100*Math.random()<v.get().getChance_extra(),n=this.freeBonusCount<1&&100*Math.random()<v.get().getChance_second();n=!1;var i=C.getData(v.get().getCurKnife()).rate||0;this.freeBonusCount<1&&Math.random();if(!1,this.freeBonusCount++,this.isPkMod&&!this.pkInfo.fightId&&(n=!0),n)this.continueGame(!0);else if((e||0==this.continueCount&&(5<=this.curStage||this.isPkMod))&&w.isVideoLoad()||0==this.continueCount&&!this.isPkMod&&5<=this.curStage){this.continueCount++,b.getPage(b.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.roundLabel.string,continueCount:this.continueCount,isBoss:!0,allcount:this.allAmount,leftcount:this.leftAmount,onContinue:function(e){e&&t.showCostTip(e),t.continueGame()},onNoContinue:function(){t.showResult()},from:"gamemain"}),b.showDialog(b.CONTINUE),this.isPkMod&&w.logEvent("pk_continue_show")}else this.showResult(),w.logEvent("game_end",{curStage:this.curStage,leftAmount:this.leftAmount,targetId:this.curTargetData?this.curTargetData.index:1});(e||0==this.continueCount&&5<this.curStage)&&!w.isVideoLoad()&&cc.sys.isMobile&&w.logEvent("continue_noads")},continueGame:function(e){this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn(),!e&&this.isPkMod&&w.logEvent("pk_continue_click")},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(e){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,k.play(this.sounds.hitTarget),this.roundKnifeData.push(this.curMoveKnife.rotation),this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife);var t=cc.instantiate(this.parNode);t.y=-131,this.node.getChildByName("effectGroup").addChild(t),t.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd()}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",KnifeData:"KnifeData",LevelData:"LevelData",NetAPI:"NetAPI",PKLevelData:"PKLevelData",PageMgr:"PageMgr",PrizeData:"PrizeData",SoundMgr:"SoundMgr",TargetData:"TargetData",User:"User",Utils:"Utils",enginefix:"enginefix"}],GameHalloween:[function(e,t,n){"use strict";cc._RF.push(t,"5594ay5lTZN1rrU6TXeubwU","GameHalloween");var y=e("User"),v=e("HalloweenLevelData"),I=e("TargetData"),A=e("AnimationData"),f=e("KnifeData"),T=e("SoundMgr"),s=e("PageMgr"),c=e("AdHelper"),i=e("Utils");e("enginefix");var o=[50,100,150,200];cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,stageLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,bossDefentedAnim:cc.Prefab,bonusAnim:cc.Prefab,bossEye1:cc.Node,bossEye2:cc.Node,bossLight:cc.Node,lastBossLight:cc.Node,cameraBtn:cc.Node,screenNode:cc.Node,costTipNode:cc.Node,yoff:0,stopY:0,speed:0},init:function(){var n=this;this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=y.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!y.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.preBossData=null,this.preBossTexture=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,!this.myPhotoTexure&&FBInstant&&FBInstant.player.getPhoto()&&cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e||(n.myPhotoTexure=t)}),this.otherPlayer=null,this.playWithMsg=null,this.playerCount=0,FBInstant&&FBInstant.context.getPlayersAsync().then(function(e){for(var t in n.playerCount=e.length,e)if(e[t].getID()!=FBInstant.player.getID()){n.otherPlayer=e[t],s.showPK("Playing with "+e[t].getName());break}2<n.playerCount&&y.get().addGroupId(FBInstant.context.getID())})},onUpdateData:function(e){this.setKnifeTempLate(e.knifeNode)},setKnifeTempLate:function(e){e instanceof cc.SpriteFrame?this.knifeTemplate.getComponent(cc.Sprite).spriteFrame=e:this.knifeTemplate=e,this.knifeTemplate.scale=1,this.knifeTemplate.rotation=0,this.setupKnifesPool()},setPlayerGroupVisible:function(e,t){this.playerPhoto.node.parent.parent.active=e,this.playerPhoto.node.parent.parent.zIndex=t?-1:1},addPlayerPhoto:function(a){var s=this;cc.loader.loadRes("target/"+this.curTargetData.avator+"_mask",function(e,t){if(e)console.log("load =====error ",e);else{var n,i=s.playerPhoto.node.parent;if(i.getComponent(cc.Mask).spriteFrame=new cc.SpriteFrame(t),i.parent.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),i.width=t.width,i.height=t.height,a||"boss_s4"==s.curTargetData.avator||(i.width-=20,i.height-=20),window.FBInstant){c.logEvent("specialboss_show_"+s.curTargetData.avator);var o=s.otherPlayer&&s.otherPlayer.getPhoto()||FBInstant.player.getPhoto();n=o,cc.loader.load(n,function(e,t){e?console.log(e):s.isBossStage()&&(s.setPlayerGroupVisible(!0,a),s.playerPhoto.spriteFrame=new cc.SpriteFrame(t),s.playerPhoto.node.width=i.width,s.playerPhoto.node.height=i.height)})}else cc.loader.loadRes("test",function(e,t){e?console.log("load =====error ",e):(s.setPlayerGroupVisible(!0,a),s.playerPhoto.spriteFrame=new cc.SpriteFrame(t),s.playerPhoto.node.width=i.width,s.playerPhoto.node.height=i.height)})}})},showCostTip:function(e){this.costTipNode.active=!0,this.costTipNode.stopAllActions(),this.costTipNode.scale=0,this.costTipNode.y=-203,this.costTipNode.opacity=255,this.costTipNode.getChildByName("label").getComponent(cc.Label).string=e,this.costTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50))))},onCameraClick:function(){this.cameraBtn.active=!1,T.play(T.CAMERA),this.whiteMask.node.active=!1;var e=this.targetAnim.node.rotation;this.targetAnim.node.rotation=0;var t=cc.director.getRunningScene(),n=cc.winSize.height;"boss_s4"==this.curTargetData.avator&&this.ballLaba&&(this.ballLaba.scale=1,this.targetBack.active=!1),i.captureScreen(t,cc.winSize.width,n,function(e,t){this.shareBase64Img=e,this.screenNode.parent.active=!0;var n=(this.screenNode.width-50)/cc.winSize.width,i=this.screenNode.parent.getChildByName("share"),o=this.screenNode.parent.getChildByName("chahao");i.scale=0,o.scale=0,t.runAction(cc.sequence(cc.scaleTo(.3,n,n*t.scaleY),cc.targetedAction(i,cc.scaleTo(.2,1)),cc.targetedAction(o,cc.scaleTo(.2,1)))),this.screenNode._sgNode.addChild(t),this.screenNode.rtt=t,this.screenNode.height=50+(this.screenNode.width-50)*cc.winSize.height/cc.winSize.width}.bind(this),function(){this.targetAnim.node.rotation=e,t.scale=1,t.runAction(cc.flipY(!1)),t.y=0,t.x=0,this.targetBack.active=!0,this.ballLaba&&(this.ballLaba.removeFromParent(),this.ballLaba=null)}.bind(this),300)},onShare:function(){if(FBInstant){c.logEvent("specialboss_shareclick_"+this.curTargetData.avator);var e="boss_s1"==this.curTargetData.avator?"I caught a ninja turtle,do you want it? ":"Who inserted the knife? is it you? 💖💖💖💖";"boss_s4"==this.curTargetData.avator&&(e="Decisive world cup ! ⚽️⚽️⚽️"),c.logEvent("share_game",{from:"boss"}),FBInstant.shareAsync({intent:"SHARE",image:this.shareBase64Img,text:e,data:{myReplayData:"data",from:"boss"}}).then(function(){c.logEvent("specialboss_share_send_"+this.curTargetData.avator),this.showBossDefeated()}.bind(this)).catch(this.showBossDefeated.bind(this))}else this.showBossDefeated();this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onShareClose:function(){this.showBossDefeated(),this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onEnable:function(){this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),this.gotoStage(this.curStage),this.showKnifeIn()},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++){(t=new cc.Node).isDefaultKnife=!0,this.defaultKnifePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.defaultKnifeIcon}for(e=0;e<30;e++){(t=new cc.Node).scale=.53,t.width=136,t.height=162,this.applePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.appleIcon}for(e=0;e<10;e++){var t;(t=new cc.Node).scale=.6,t.width=72,t.height=86,this.goldApplePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.goldAppleIcon}},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){if(0==this.leftAmount)if(this.isStageBegin=!1,c.logEvent("halloween_level_finish",{curStage:this.curStage}),this.isBossStage()){this.curTargetData.hasPlayerImg?(this.cameraBtn.active=!0,this.cameraBtn.stopAllActions(),this.cameraBtn.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.2),cc.scaleTo(.5,1))))):this.showBossDefeated()}else this.showStagePass(!0)},isBossStage:function(){return this.curStage%5==0},showBossDefeated:function(){var e=this;if(this.setPlayerGroupVisible(!1),y.get().markBossDefented(this.curTargetData.index),y.get().isKnifeUnlock(this.curTargetData.drop))Math.random()<.5?this.showStagePass(!0):this.showStagePass(!1,function(){s.showDialogAsync("SweetCollectDialog",{count:o[Math.floor(e.curStage/5)-1],name:e.curTargetData.name,onClose:function(){e.gotoNextStage()}})});else{var t=s.getPage(s.SHOWKNIFE).getComponent("ShowKnifeDialog");t.setKnifeInfo(this.curTargetData,this.preKnifeTexture,!1),this.preKnifeTexture=null;var n=this;this.showStagePass(!1,function(){s.showDialog(s.SHOWKNIFE)}),t.registerOnClose(function(e,t){e&&n.setKnifeTempLate(t),n.gotoNextStage()})}},showStagePass:function(u,p){var g=this;this.targetAnim.node.stopAllActions(),this.targetAction=null,this.targetSprite.node.scale=0,this.removeKnifes(),this.removeApples(),this.removeSpecial();var f=this;if(this.isBossStage()){var e=cc.instantiate(this.parBrokenNode);this.node.getChildByName("effectGroup").addChild(e);f=this;setTimeout(function(){var e=y.get(),n=cc.instantiate(f.bossDefentedAnim);f.node.getChildByName("upEffectGroup").addChild(n);var t=n.getComponent(cc.Animation),i=n.getChildByName("bossgroup").getChildByName("progressBar");i.getChildByName("info").getComponent(cc.Label).string="Level "+e.getPlayer_lv();var o=i.getComponent(cc.ProgressBar),a=!1;o.progress=e.getPlayer_exp()/e.getMaxExp();var s=e.addExp(f.isDoubleXp?2*f.curTargetData.exp:f.curTargetData.exp),c=e.getPlayer_exp()/e.getMaxExp(),r=!1;!y.get().isMaxLevel()&&c<o.progress&&(c=1,r=!0);var l=(i.getChildByName("backbar").getComponent(cc.Sprite).fillRange=c)-o.progress;f.isDoubleXp&&(c=o.progress+l/2);var h=n.getChildByName("upgrageGroup");function d(e){i.color=e,n.getChildByName("zi").color=e;var t=n.getChildByName("bossgroup");t.getChildByName("bossdunbg").color=e,t.getChildByName("bossxiaodao1").color=e,t.getChildByName("bossxiaodao").color=e,t.getChildByName("bossdun").color=e,t.getChildByName("bosszui").color=e,t.getChildByName("progressBar").color=e,n.getChildByName("guang").color=e}if(o.schedule(function(){if(a)if(o.progress<c)o.progress+=.02;else{if(a=!1,r){t.pause();var e=y.get().getChanceTyType(s)+["% FOR SECOND CHANCE","% FOR EXTRA CONTINUE","% MORE APPLES IN FREE GIFT ","% FOR GOLDEN APPLE","APPLES FOR VIDEO","% FOR DOUBLE XP"][s-1];h.getChildByName("info").getComponent(cc.Label).string=e,h.getChildByName("icon").getComponent("PowerIcon").setIcon(s),h.active=!0,h.scale=.8,h.runAction(cc.scaleTo(.3,1))}f.isDoubleXp&&setTimeout(function(){a=!0,c+=l/2,f.isDoubleXp=!1},300)}},0),t.beginProgress=function(){a=!0},0<g.curTargetData.bossLv){d(cc.color().fromHEX(["#fce352","#a750f5"][g.curTargetData.bossLv-1]))}else d(cc.color().fromHEX("#ffffff"));n.on("clickOk",function(){h.active=!1,t.resume()}),t.on("finished",function(){t.off("finished"),n.removeFromParent(),u?f.gotoNextStage():p&&p()}),T.play(T.BOSS_DEFENTED)},500);var t=e.getComponent(cc.ParticleSystem);t.resetSystem(),this.curTargetData.color&&(t.startColor=t.startColor.fromHEX(this.curTargetData.color),t.endColor=t.endColor.fromHEX(this.curTargetData.color))}else{for(var n=cc.instantiate(f.targetBrokenAnim),i=1;i<=3;i++){n.getChildByName("kuai"+i).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.targetSprite.spriteFrame.getTexture())}f.node.getChildByName("upEffectGroup").addChild(n);var o=n.getComponent(cc.Animation);o.play("broken"),o.on("finished",function(){o.off("finished"),n.removeFromParent(),u?f.gotoNextStage():p&&p()})}},removeKnifes:function(e){if(!this.isPkMod)for(var t,n,i,o,a,s=this.targetBack.children,c=this,r=.3,l=s.length-1;0<=l;l--){var h=s[l];e?d(h):(t=h,void 0,n=2*Math.random()+3,i=cc.moveBy(r,-t.x*n,-t.y*n),o=cc.rotateBy(r,380*Math.random()-180),a=cc.sequence(cc.delayTime(r-.05),cc.fadeOut(.05)),t.runAction(cc.sequence(cc.spawn(i,o,a),cc.callFunc(d.bind(null,t)))))}function d(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?c.defaultKnifePool.put(e):c.knifePool.put(e),e.opacity=255}},removeApples:function(){if(!this.isPkMod)for(var e,t=this.targetUp.children,n=this,i=t.length-1;0<=i;i--){var o=t[i];(e=o).isGold?n.goldApplePool.put(e):n.applePool.put(e)}},removeSpecial:function(){this.specialBack.removeAllChildren(),this.bossEye1.active=!1,this.bossEye2.active=!1,this.bossLight.active=!1,this.lastBossLight.active=!1},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1),this.isPkMod&&(this.isInPlayback?this.opponentknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1):this.myknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)))},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){y.get().addOneDiamon(e),this.diamonCountLabel.string=y.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),T.play(T.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoNextStage:function(){this.curStage++,20<this.curStage?s.showDialogAsync("HalloweenEndDialog"):this.gotoStage(this.curStage)},preLoadBoss:function(e){for(var t=v.getData(e),n=t.targetInfo,i=t.rareInfo,o=null,a=0;a<n.length;a++)if(!y.get().isBossDefented(n[a].target)){o=n[a];break}if(i&&!o)for(var s=0;s<i.length;s++)if(!y.get().isBossDefented(i[s].target)){o=i[s];break}var c=null;if(o)c=o;else{var r=8<=y.get().getMaxStage()?.9:.5,l=i&&0<i.length&&Math.random()>r?i:n;c=l[Math.floor(Math.random()*l.length)]}var h=t.test;null!=h&&(c=t.test<n.length?n[h]:i[h-n.length]);var d=(this.preBossData=c).target||1,u=I.getData(d),p=this;if(u.avator&&cc.loader.loadRes("target/"+u.avator,function(e,t){p.preBossTexture=t}),u.hitTarget&&T.preLoad(T[u.hitTarget]),u.drop){var g=f.getData(u.drop);cc.loader.loadRes("knife/"+g.img,function(e,t){e?console.log("error",e):p.preKnifeTexture=t})}},gotoStage:function(e){this.curStage=e,this.curStage%5==1?this.preLoadBoss(this.curStage+4):this.setPlayerGroupVisible(!1);var t=v.getData(this.curStage),n=t.targetInfo,i=t.rareInfo,o=8<=y.get().getMaxStage()?.9:.5,a=i&&Math.random()>o?i:n,s=a[Math.floor(Math.random()*a.length)],c=t.test;null!=c?s=t.test<n.length?n[c]:i[c-n.length]:this.isBossStage()&&(this.preBossData||this.preLoadBoss(this.curStage),s=this.preBossData);var r=s.target;r||(r=1);var l=I.getData(r),h=t.diamons?t.diamons:s.diamons,d=t.gold?t.gold:s.gold,u=s.knifes,p=(s.animation,s.count);if(this.curActionsData=A.getData(s.animation),1==r){l={index:r,avator:"target_111"}}this.resetKnifes(p);for(var g=0;g<u.length;g++){(f=this.defaultKnifePool.get()).rotation=u[g],this.addKnifeToTarget(f)}for(g=0;h&&g<h.length;g++){(f=this.applePool.get()).rotation=h[g],f.isGold=!1,this.addAppleToTarget(f)}for(g=0;d&&g<d.length;g++){var f;(f=this.goldApplePool.get()).rotation=d[g],f.isGold=!0,this.addAppleToTarget(f)}if(this.sounds={hitTarget:T.HIT,hitBlock:T.KNIFE_HIT,hitApple:T.APPLE_HIT},l.hasPlayerImg=!1,this.curTargetData!=l){this.sounds.hitTarget=T[l.hitTarget]||this.sounds.hitTarget,this.curTargetData=l;var m=this;this.isBossStage()&&m.preBossTexture?(m.targetSprite.spriteFrame=new cc.SpriteFrame(m.preBossTexture),m.whiteMask.spriteFrame=new cc.SpriteFrame(m.preBossTexture),m.targetSprite.node.width=m.preBossTexture.width,m.targetSprite.node.height=m.preBossTexture.height,m.preBossTexture=null):cc.loader.loadRes("target/"+l.avator,function(e,t){m.targetSprite.spriteFrame=new cc.SpriteFrame(t),m.whiteMask.spriteFrame=new cc.SpriteFrame(t),m.targetSprite.node.width=t.width,m.targetSprite.node.height=t.height})}this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.curStage%5==0?this.setupStageBoss():this.beginStageActions()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.updateUI(),this.showKnifeIn()},getActions:function(e){for(var t=[],n=2<3*Math.random(),i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s=null;return s=1<t.length?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e){this.knifeCountLabel.string=this.curKnifeAmount;var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetBack,e.rotation=270-t,e.x=this.targetBack.x+160*Math.cos(n),e.y=this.targetBack.y+160*Math.sin(n)},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+198*Math.cos(n),e.y=this.targetUp.y+198*Math.sin(n)},setupStageBoss:function(){var n=cc.instantiate(this.bossFightAnim),e=this;this.node.getChildByName("upEffectGroup").addChild(n);var t=n.getComponent(cc.Animation);function i(e){n.getChildByName("bossxiaodaoL").color=e,n.getChildByName("bossxiaodaoR").color=e,n.getChildByName("bossziti2").color=e,n.getChildByName("guang").color=e;var t=n.getChildByName("bossdun");t.getChildByName("bossdun").color=e,t.getChildByName("bosszui").color=e}if(0<this.curTargetData.bossLv){i(cc.color().fromHEX(["#fce352","#a750f5"][this.curTargetData.bossLv-1]))}else i(cc.color().fromHEX("#ffffff"));t.playSound=function(){T.play(T.BOSS_FIGHT)},t.on("finished",function(){t.off("finished"),n.removeFromParent(),e.isDoubleXp=100*Math.random()<y.get().getChance_doubleXp(),e.isDoubleXp?e.showBonus(function(){e.beginStageActions()},6):e.beginStageActions()}),this.curTargetData.hasPlayerImg&&this.addPlayerPhoto(this.curTargetData.isBack),"boss_80000"==this.curTargetData.avator&&(this.bossEye1.active=!0,this.bossEye2.active=!0,this.bossEye1.scale=.5,this.bossEye2.scaleX=-.5,this.bossEye2.scaleY=.5),"boss_80001"==this.curTargetData.avator&&(this.bossLight.active=!0,this.bossLight.opacity=0),"boss_80003"==this.curTargetData.avator&&(this.lastBossLight.active=!0,this.lastBossLight.opacity=0)},showResult:function(){s.showPageAsync("HalloweenResultDialog",{score:this.curKnifeAmount,stageNum:this.curStage,playerTexture:this.myPhotoTexure,playerCount:this.playerCount})},updateUI:function(){this.diamonCountLabel.string=y.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5));var e=this.curStage%5;if(0==e)this.stageLabel.string="BOSS: "+this.curTargetData.name,this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#ed524b"),this.pointsNode.active=!1,this.pkIcon.runAction(cc.moveTo(.5,0,this.pkIcon.y)),this.pkIcon.color=this.stageLabel.node.color;else{this.stageLabel.node.color=cc.Color.WHITE,this.pkIcon.color=cc.Color.WHITE;var t=this;this.pkIcon.runAction(cc.sequence(cc.moveTo(.5,70,this.pkIcon.y),cc.callFunc(function(){t.pointsNode.active=!0}))),this.stageLabel.string="Stage "+this.curStage}this.pointsNode.getComponent("PointControl").setCount(e)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++){if((d=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(d*Math.PI/180),o=-Math.abs(Math.cos(d*Math.PI/180));u&&(i=-i);var a=Math.max(.1,d/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*d*20),c=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*c*10,o*=c;var r=cc.moveBy(a,i,o),l=this,h=cc.spawn(r,s);this.curMoveKnife.runAction(cc.sequence(h,cc.callFunc(function(){l.knifePool.put(l.curMoveKnife),l.curMoveKnife=null,setTimeout(function(){l.onGameOver()},200)}))),this.playDieEffect(d,u),T.play(this.sounds.hitBlock);break}}e=this.targetUp.children;t=15;for(n=0;n<e.length;n++){var d,u;if((d=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){var p=e[n].isGold;this.addOneDiamon(p),p?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var g=p?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);g.x=30*Math.random()-15,g.y=-131,this.node.getChildByName("upEffectGroup").addChild(g),T.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var t=this,e=1==this.continueCount&&100*Math.random()<y.get().getChance_extra(),n=this.freeBonusCount<1&&100*Math.random()<y.get().getChance_second(),i=f.getData(y.get().getCurKnife()).rate||0,o=this.freeBonusCount<1&&100*Math.random()<i;if(this.freeBonusCount++,o){var a=this;this.showBonus(function(){a.continueGame(!0)},7)}else if(n){a=this;this.showBonus(function(){a.continueGame(!0)},1)}else if((e||0==this.continueCount&&(5<=this.curStage||this.isPkMod))&&c.isVideoLoad()||0==this.continueCount&&!this.isPkMod&&5<=this.curStage){this.continueCount++,s.getPage(s.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.curTargetData.name,continueCount:this.continueCount,isBoss:this.isBossStage(),onContinue:function(e){e&&t.showCostTip(e),t.continueGame()},onNoContinue:function(){t.showResult()},from:"game_halloween"}),s.showDialog(s.CONTINUE)}else this.setPlayerGroupVisible(!1),this.showResult(),this.isPkMod||c.autoShowAd(),c.logEvent("halloween_game_end",{curStage:this.curStage,leftAmount:this.leftAmount,targetId:this.curTargetData?this.curTargetData.index:1});(e||0==this.continueCount&&5<this.curStage)&&!c.isVideoLoad()&&cc.sys.isMobile&&c.logEvent("continue_noads")},continueGame:function(e){this.diamonCountLabel.string=y.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn()},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(e){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0!=this.leftAmount||this.isPkMod)T.play(this.sounds.hitTarget);else{var t=this.isBossStage()?T.HIT_LAST_SPECIAL:T.HIT_LAST;T.play(t)}this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife);var n=cc.instantiate(this.parNode);n.y=-131,this.node.getChildByName("effectGroup").addChild(n),n.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd(),this.bossEye1.active?(this.bossEye1.scale=1,this.bossEye1.stopAllActions(),this.bossEye1.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,.5))),this.bossEye2.scaleX=-1,this.bossEye2.scaleY=1,this.bossEye2.stopAllActions(),this.bossEye2.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,-.5,.5)))):this.bossLight.active?(this.bossLight.stopAllActions(),this.bossLight.runAction(cc.sequence(cc.fadeTo(.01,255),cc.delayTime(.5),cc.fadeTo(.3,0)))):this.lastBossLight.active&&(this.lastBossLight.stopAllActions(),this.lastBossLight.runAction(cc.sequence(cc.fadeTo(.01,255),cc.delayTime(.5),cc.fadeTo(.3,0))))}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",HalloweenLevelData:"HalloweenLevelData",KnifeData:"KnifeData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",TargetData:"TargetData",User:"User",Utils:"Utils",enginefix:"enginefix"}],GameMain:[function(e,t,n){"use strict";cc._RF.push(t,"6a6b8Fgt6BD7KiUjrymfHhJ","GameMain");var m=e("User"),y=e("LevelData"),v=e("TargetData"),I=e("AnimationData"),f=e("KnifeData"),A=e("SoundMgr"),c=e("PageMgr"),r=e("AdHelper"),s=e("Utils");e("TaskMgr");e("enginefix"),cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,stageLabel:cc.Label,leftKnifeLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,cameraBtn:cc.Node,screenNode:cc.Node,gotoGroup:cc.Node,costTipNode:cc.Node,playerdes:cc.Sprite,rankPlayerScore:cc.Label,iconPlayerS:cc.Sprite,iconTipLabel:cc.Label,vsTop:cc.Node,singleTop:cc.Node,myCountLabel:cc.Label,opponentCountLabel:cc.Label,mySprite:cc.Sprite,opponentSprite:cc.Sprite,defaltHeadFrame:cc.SpriteFrame,topGroup:cc.Node,yoff:-500,stopY:-180,speed:100},onLoad:function(){this.defaultKnifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple(),this.level5BossIndex=0},init:function(){this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.iconPlayerS.node.active=!1,this.iconTipLabel.node.active=!1,this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.preBossData=null,this.preBossTexture=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.friendIndex=0,this.gotoUnlockLevel=15},setKnifeTempLate:function(e){e instanceof cc.SpriteFrame?this.knifeTemplate.getComponent(cc.Sprite).spriteFrame=e:this.knifeTemplate=e,this.knifeTemplate.scale=1,this.knifeTemplate.rotation=0,this.setupKnifesPool()},setPlayerGroupVisible:function(e,t){this.playerPhoto.node.parent.parent.active=e,this.playerPhoto.node.parent.parent.zIndex=t?-1:1},addPlayerPhoto:function(a){var s=this;cc.loader.loadRes("target/"+this.curTargetData.avator+"_mask",function(e,t){if(e)console.log("load =====error ",e);else{var n,i=s.playerPhoto.node.parent;if(i.getComponent(cc.Mask).spriteFrame=new cc.SpriteFrame(t),i.parent.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),i.width=t.width,i.height=t.height,!a&&s.curTargetData.avator,window.FBInstant){r.logEvent("socialboss_show",{boss:s.curTargetData.avator});var o=s.otherPlayer&&s.otherPlayer.photo||FBInstant.player.getPhoto();n=o,cc.loader.load(n,function(e,t){if(e)console.log(e);else if(s.isBossStage()){s.setPlayerGroupVisible(!0,a),s.playerPhoto.spriteFrame=new cc.SpriteFrame(s.myPhotoTexure);var n=Math.max(i.width,i.height);s.playerPhoto.node.width=n,s.playerPhoto.node.height=n}})}else cc.loader.loadRes("test",function(e,t){if(e)console.log("load =====error ",e);else{s.setPlayerGroupVisible(!0,a),s.playerPhoto.spriteFrame=new cc.SpriteFrame(t);var n=Math.max(i.width,i.height);s.playerPhoto.node.width=n,s.playerPhoto.node.height=n}})}})},showGotoBtn:function(){var e=this,t=(m.get().isPayReady()||m.get().getDiamonCount(),r.isVideoLoad());var n=this.gotoGroup.getChildByName("adgotobtn"),i=this.gotoGroup.getChildByName("applegotobtn");n.active=t,i.active=!0,this.gotoGroup.x=t?0:90,this.isGotoShow=!0,r.logEvent("GotoLevelShow",{mod:this.gotoMod}),n.scale=1.2,i.scale=1.2,this.gotoGroup.active=!0,n.stopAllActions(),i.stopAllActions(),n.runAction(cc.sequence(cc.repeat(cc.sequence(cc.scaleTo(.5,1),cc.scaleTo(.5,1.2)),3),cc.scaleTo(.2,0))),i.runAction(cc.sequence(cc.repeat(cc.sequence(cc.scaleTo(.5,1),cc.scaleTo(.5,1.2)),3),cc.scaleTo(.2,0))),this.gotoGroup.runAction(cc.sequence(cc.delayTime(3.2),cc.callFunc(function(){e.gotoGroup.stopAllActions(),e.gotoGroup.active=!1,e.isGotoShow=!1,e.playWithMsg&&(c.showPK(e.playWithMsg),e.playWithMsg=null)})))},gotoLevel:function(e,t){this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.gotoGroup.active=!1,this.curStage=e-1,this.curKnifeAmount=t,this.gotoNextStage()},onAdGotoClick:function(){this.gotoMod=1,this.onGotoLevelClick()},onAppleGotoClick:function(){m.get().getDiamonCount()<200?(m.get().isPayReady()?(c.showDialogAsync("AppleShopDialog"),c.showTip("APPLE NOT ENOUGH",null,-200)):c.showDialogAsync("IosShopPage"),setTimeout(function(){c.hideTip()},2e3)):(this.showCostTip(-200),this.gotoMod=0,this.onGotoLevelClick())},showCostTip:function(e){this.costTipNode.active=!0,this.costTipNode.stopAllActions(),this.costTipNode.scale=0,this.costTipNode.y=-203,this.costTipNode.opacity=255,this.costTipNode.getChildByName("label").getComponent(cc.Label).string=e,this.costTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50))))},onGotoLevelClick:function(){var e=this;r.logEvent("GotoLevelClick",{mod:this.gotoMod}),this.isGotoShow=!1,this.playWithMsg&&(c.showPK(this.playWithMsg),this.playWithMsg=null);this.curStage;var t=function(){e.gotoLevel(11,102),e.stageLabel.node.runAction(cc.sequence(cc.scaleTo(.5,1.5),cc.scaleTo(.5,1)))};0==this.gotoMod?(m.get().decDiamon(200),t()):r.showVideoAd("gotolevel",t,function(){})},onCameraClick:function(){this.cameraBtn.active=!1,A.play(A.CAMERA),this.whiteMask.node.active=!1;var e=this.targetAnim.node.rotation;this.targetAnim.node.rotation=0;var t=cc.director.getRunningScene(),n=cc.winSize.height;"boss_s4"==this.curTargetData.avator&&this.ballLaba&&(this.ballLaba.scale=1,this.targetBack.active=!1),this.knifeGroup.active=!1,s.captureScreen(t,cc.winSize.width,n,function(e,t){this.shareBase64Img=e,this.screenNode.parent.active=!0;var n=(this.screenNode.width-50)/cc.winSize.width,i=this.screenNode.parent.getChildByName("share"),o=this.screenNode.parent.getChildByName("chahao"),a=this.screenNode.parent.getChildByName("white");i.scale=0,o.scale=0,t.y=-90,t.scaleX=n,t.scaleY=n*t.scaleY,this.screenNode._sgNode.addChild(t),this.screenNode.rtt=t,this.screenNode.height=50+(this.screenNode.width-50)*(cc.winSize.height-660)/cc.winSize.width,a.width=this.screenNode.width,a.height=this.screenNode.height,this.screenNode.height-=50,this.screenNode.scale=1.1,this.screenNode.runAction(cc.scaleTo(.3,1)),a.scale=1.1,a.runAction(cc.sequence(cc.scaleTo(.3,1),cc.targetedAction(i,cc.scaleTo(.2,1)),cc.delayTime(1),cc.targetedAction(o,cc.scaleTo(.2,1))))}.bind(this),function(){this.targetAnim.node.rotation=e,t.scale=1,t.runAction(cc.flipY(!1)),t.y=0,t.x=0,this.targetBack.active=!0,this.knifeGroup.active=!0,this.ballLaba&&(this.ballLaba.removeFromParent(),this.ballLaba=null)}.bind(this),200,460)},onShare:function(){if(FBInstant){var e="";"boss_s4"==this.curTargetData.avator?e="Decisive world cup ! ⚽️⚽️⚽️":"boss_s1"==this.curTargetData.avator?e="I caught a ninja turtle,do you want it? ":"boss_s2"==this.curTargetData.avator?e="Who inserted the knife? is it you? 💖💖💖💖 ":"boss_s10"==this.curTargetData.avator&&(e="My new record, coming soon! 🤣🤣🤣"),r.logEvent("socialboss_share",{boss:this.curTargetData.avator}),r.logEvent("share_game",{from:"boss"}),FBInstant.shareAsync({intent:"SHARE",image:this.shareBase64Img,text:e,data:{myReplayData:"data",from:"boss",boss:this.curTargetData.avator}}).then(function(){this.showBossDefeated()}.bind(this)).catch(this.showBossDefeated.bind(this))}else this.showBossDefeated();this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onShareClose:function(){this.showBossDefeated(),this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},showRankFriend:function(e){var s=this;this.curFriendData=e,this.rankPlayerScore.string="passed",e.photo&&cc.loader.load(e.photo,function(e,t){if(!e){s.playerdes.spriteFrame=new cc.SpriteFrame(t),s.playerdes.node.width=s.playerdes.node.height=75,s.playerdes.node.active=!0;var n=s.playerdes.node.parent;n.x=500,n.opacity=255,n.stopAllActions(),s.rankPlayerScore.node.active=!0,s.rankPlayerScore.node.opacity=255;var i=s.rankPlayerScore.node,o=i.getChildByName("daoL"),a=i.getChildByName("daoR");o.active=!1,a.active=!1,i.x=500,i.opacity=255,i.stopAllActions()}})},showFriendDefend:function(){var e=this.playerdes.node.parent;e.stopAllActions(),e.runAction(cc.moveTo(.3,230,e.y));var t=this.rankPlayerScore.node;t.stopAllActions(),t.runAction(cc.moveTo(.3,230,t.y)),setTimeout(function(){e.runAction(cc.fadeOut(.3)),t.runAction(cc.fadeOut(.3))},2e3)},checkAndShowFriend:function(){var n=this,i=this.iconPlayerS.node;if(this.tipsData&&0<this.tipsData.length&&this.tipsData[0].lv==this.curStage){var e=this.tipsData.shift();this.iconTipLabel.string=e.text;var o=this.iconTipLabel.node,a=this.iconPlayerS.node.parent;if(o.x=500,a.x=500,!e.photo)return;a.stopAllActions(),o.stopAllActions(),this.friendTimeoutHandle&&(clearTimeout(this.friendTimeoutHandle),this.friendTimeoutHandle=null),cc.loader.load(e.photo,function(e,t){e?console.log(e):(i.active=!0,o.active=!0,a.opacity=255,o.opacity=255,n.iconPlayerS.spriteFrame=new cc.SpriteFrame(t),n.iconPlayerS.node.width=n.iconPlayerS.node.height=75,a.runAction(cc.moveTo(.3,230,a.y)),o.runAction(cc.moveTo(.3,230,o.y)),n.friendTimeoutHandle=setTimeout(function(){a.runAction(cc.moveTo(.3,500,a.y)),o.runAction(cc.moveTo(.3,500,o.y)),clearTimeout(n.friendTimeoutHandle),n.friendTimeoutHandle=null},3e3))})}},showVSDefend:function(){var e=this.vsTop.getChildByName("right"),t=e.getChildByName("daoL").getComponent(cc.Sprite),n=e.getChildByName("daoR").getComponent(cc.Sprite);t.node.active=!0,n.node.active=!0,t.fillStart=1,n.fillStart=1;var i=0,o=setInterval(function(){++i<=10?t.fillStart=(10-i)/10:n.fillStart=(20-i)/10,20==i&&clearInterval(o)},30)},startGame:function(){this.setupInput(),this.gotoStage(this.curStage),this.showKnifeIn(),r.logEvent("start_game")},onEnable:function(){this.isVS?(this.startGame(),this.myCountLabel.node.active=!0,this.opponentCountLabel.node.active=!0):this.startGame()},setPlay:function(e){this.isWithFriend=e},preloadAsync:function(e){var s=this;if(this.isVS=e.isVS,this.opponentScore=e.score,this.battleId=e.battleId,this.rewardCount=e.rewardCount,this.setPlayerGroupVisible(!1),this.init(),this.singleTop.active=!0,this.vsTop.active=!1,this.myCountLabel.string=0,this.opponentCountLabel.string=this.opponentScore||"?",this.isVS){var t=this.vsTop.getChildByName("right"),n=t.getChildByName("daoL").getComponent(cc.Sprite),i=t.getChildByName("daoR").getComponent(cc.Sprite);n.node.active=!1,i.node.active=!1}this.playerdes.node.active=!1,this.rankPlayerScore.node.active=!1;n=this.rankPlayerScore.node.getChildByName("daoL"),i=this.rankPlayerScore.node.getChildByName("daoR");return n.active=!1,i.active=!1,this.requestRankFriends(),new Promise(function(e,t){var n=0,i=function(){3==++n&&s.scheduleOnce(e)};window.FBInstant?(!s.myPhotoTexure&&FBInstant&&FBInstant.player.getPhoto()?cc.loader.load(FBInstant.player.getPhoto(),function(e,t){i(),e||(s.myPhotoTexure=t,s.mySprite.spriteFrame=new cc.SpriteFrame(t))}):(i(),s.mySprite.spriteFrame=new cc.SpriteFrame(s.myPhotoTexure)),s.opponentSprite.spriteFrame=s.defaltHeadFrame):cc.loader.loadRes("test",function(e,t){i(),e||(s.myPhotoTexure=t,s.mySprite.spriteFrame=new cc.SpriteFrame(t))});var o=m.get().getCurKnife();if(s.curKnifeId==o)i();else{var a=f.getData(o);a&&a.img&&cc.loader.loadRes("knife/"+a.img,function(e,t){i(),e?console.log("error",e):(s.curKnifeId=o,s.knifeTemplate.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),s.setupKnifesPool())})}s.otherPlayer=null,s.playWithMsg=null,s.playerCount=0,FBInstant?m.get().getContextPlayers(function(e){for(var t in s.playerCount=e.length,2<s.playerCount&&m.get().addGroupId(FBInstant.context.getID()),e)if(e[t].playerId!=FBInstant.player.getID()){s.otherPlayer=e[t],s.isWithFriend&&(s.isGotoShow?s.playWithMsg="Playing with "+e[t].name:c.showPK("Playing with "+e[t].name),s.isWithFriend=!1);break}s.otherPlayer?cc.loader.load(s.otherPlayer.photo,function(e,t){i(),e?console.log(e):s.opponentSprite.spriteFrame=new cc.SpriteFrame(t)}):i()}):i()})},prepareTipsData:function(e){this.tipsData=[];for(var t=e.slice(),n=t.length,i=["Cool!","Great!","Nice!","Good!"],o=0;o<n/2;o++){var a=t.splice(s.randomInt(t.length),1)[0];this.tipsData.push({lv:5*o+s.randomInt(3)+2,text:i[s.randomInt(i.length)],photo:a.photo}),0<t.length&&(a=t.splice(s.randomInt(t.length),1)[0],this.tipsData.push({lv:5*(o+1),text:i[s.randomInt(i.length)],photo:a.photo}))}},requestRankFriends:function(){var n=this;if(this.friendsData&&0<this.friendsData.length)this.prepareTipsData(this.resultFriendsData);else{this.friendsData=[],this.resultFriendsData=[];var i=[];RankUtils.getWorldRankData(function(e){for(var t=e.length-1;0<=t;t--)e[t].playerId!=(FBInstant&&FBInstant.player.getID())&&n.resultFriendsData.push(e[t]),i.push(e[t].playerId);n.friendsData=e,n.prepareTipsData(n.resultFriendsData)},!0)}},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onTouchBegan,this)},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++){(n=new cc.Node).isDefaultKnife=!0,this.defaultKnifePool.put(n);var t=n.addComponent(cc.Sprite);t.spriteFrame=this.defaultKnifeIcon,t.trim=!1,t.sizeMode=cc.Sprite.SizeMode.RAW}for(e=0;e<30;e++){(n=new cc.Node).scale=.53,n.width=136,n.height=162,this.applePool.put(n),(n=n.addComponent(cc.Sprite)).spriteFrame=this.appleIcon}for(e=0;e<10;e++){var n;(n=new cc.Node).scale=.6,n.width=72,n.height=86,this.goldApplePool.put(n),(n=n.addComponent(cc.Sprite)).spriteFrame=this.goldAppleIcon}},setupKnifesPool:function(e){this.knifePool||(this.knifePool=new cc.NodePool),this.knifePool.clear(),this.removeKnifes(!0);for(var t=0;t<30;t++){var n=cc.instantiate(this.knifeTemplate);this.knifePool.put(n)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){if(0==this.leftAmount)if(A.play(A["STAGE_PASS_"+((this.curStage-1)%5+1)]),this.isStageBegin=!1,r.logEvent("level_finish",{curStage:this.curStage}),this.curStage==y.getLeveCount()&&r.logEvent("max_level_finish",{continueCount:this.continueCount}),this.isBossStage()){5==this.curStage&&(this.level5BossIndex+=1);this.showBossDefeated()}else this.showStagePass(!0)},isBossStage:function(){return this.curStage%5==0},showBossDefeated:function(){this.setPlayerGroupVisible(!1),m.get().markBossDefented(this.curTargetData.index);var e=m.get().isKnifeUnlock(this.curTargetData.drop);if(e)this.showStagePass(!0);else{(e=!1)&&m.get().unlockKnife(this.curTargetData.drop,0,!0);var t=c.getPage(c.SHOWKNIFE).getComponent("ShowKnifeDialog");t.setKnifeInfo(this.curTargetData,this.preKnifeTexture,e),this.preKnifeTexture=null;var n=t.node.getChildByName("diban"),i=this;i.showStagePass(!1,function(){n.stopAllActions(),n.scale=0,n.runAction(cc.scaleTo(.2,1)),c.showDialog(c.SHOWKNIFE)}),t.registerOnClose(function(e,t){e&&i.setKnifeTempLate(t),i.gotoNextStage()})}},showStagePass:function(e,t){this.targetAnim.node.stopAllActions(),this.targetAction=null,this.targetSprite.node.scale=0,this.leftKnifeLabel.node.scale=0,this.removeKnifes(),this.removeApples(),this.removeSpecial();var n=this;if(this.isBossStage()){var i=cc.instantiate(this.parBrokenNode);this.node.getChildByName("effectGroup").addChild(i);var o=i.getComponent(cc.ParticleSystem);o.startColor=o.startColor.fromHEX(this.curTargetData.color||"#000000"),o.endColor=o.startColor.fromHEX(this.curTargetData.color||"#000000"),o.resetSystem(),this.scheduleOnce(function(){o.node.removeFromParent(),e?n.gotoNextStage():t&&t()},.5)}else{for(var a=cc.instantiate(n.targetBrokenAnim),s=1;s<=3;s++){a.getChildByName("kuai"+s).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.targetSprite.spriteFrame.getTexture())}n.node.getChildByName("upEffectGroup").addChild(a);var c=a.getComponent(cc.Animation);c.play("broken"),c.on("finished",function(){c.off("finished"),a.removeFromParent(),e?n.gotoNextStage():t&&t()})}},removeKnifes:function(e){var t,n,i,o,a,s=this.targetBack.children,c=this,r=.3;function l(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?c.defaultKnifePool.put(e):c.knifePool.put(e),e.opacity=255}for(var h=s.length-1;0<=h;h--){var d=s[h];e?l(d):(t=d,void 0,n=2*Math.random()+3,i=cc.moveBy(r,-t.x*n,-t.y*n),o=cc.rotateBy(r,380*Math.random()-180),a=cc.sequence(cc.delayTime(r-.05),cc.fadeOut(.05)),t.runAction(cc.sequence(cc.spawn(i,o,a),cc.callFunc(l.bind(null,t)))))}},removeApples:function(){var e,t=this.targetUp.children,n=this;for(var i=t.length-1;0<=i;i--){var o=t[i];(e=o).isGold?n.goldApplePool.put(e):n.applePool.put(e)}},removeSpecial:function(){this.specialBack.removeAllChildren(),this.specailUp.removeAllChildren(),this.node.getChildByName("upEffectGroup").removeAllChildren()},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=40*(t-e/2+.5),this.knifes[t].y=0,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(this.knifeGroup.scale=(cc.winSize.width-150)/(40*e),1<this.knifeGroup.scale&&(this.knifeGroup.scale=1);t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:(this.leftKnifeLabel.string=this.leftAmount,this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1))},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++,this.leftKnifeLabel.string=this.leftAmount)},addOneDiamon:function(e){m.get().addOneDiamon(e),this.diamonCountLabel.string=m.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),A.play(A.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoNextStage:function(){for(this.curStage++,this.gotoStage(this.curStage),this.playerdes.node.active=!1;this.friendsData&&this.friendIndex<this.friendsData.length&&!(this.friendsData[this.friendIndex].score>this.curKnifeAmount+this.leftAmount);this.friendIndex++)if(this.friendsData[this.friendIndex].score>this.curKnifeAmount){this.showRankFriend(this.friendsData[this.friendIndex]),this.friendIndex++;break}},preLoadBoss:function(e){var t=y.getData(e),n=t.targetInfo,i=t.rareInfo,o=null;if(!o){for(var a=0;a<n.length;a++)if(!m.get().isBossDefented(n[a].target)){o=n[a];break}if(i&&!o)for(var s=0;s<i.length;s++)if(!m.get().isBossDefented(i[s].target)){o=i[s];break}}5==e&&(this.level5BossIndex>=n.length&&(this.level5BossIndex=0),o?this.level5BossIndex=0:o=n[this.level5BossIndex]);var c=null;if(o)c=o;else{var r=8<=m.get().getMaxStage()?.8:.5,l=i&&0<i.length&&Math.random()>r?i:n;c=l[Math.floor(Math.random()*l.length)]}var h=t.test;null!=h&&(c=t.test<n.length?n[h]:i[h-n.length]);var d=(this.preBossData=c).target||1,u=v.getData(d);u||console.log("target id not find===",e,c);var p=this;if(u.avator&&cc.loader.loadRes("target/"+u.avator,function(e,t){p.preBossTexture=t}),u.hitTarget&&A.preLoad(A[u.hitTarget]),u.drop){var g=f.getData(u.drop);g||(console.log(u),console.log("knife not find=="+u.drop)),cc.loader.loadRes("knife/"+g.img,function(e,t){e?console.log("error",e):p.preKnifeTexture=t})}"boss_80000"==u.avator?cc.loader.loadRes("target/boss_80000_eye"):"boss_s10"==u.avator?cc.loader.loadRes("target/boss_s10_pan"):"boss_s2"==u.avator?cc.loader.loadRes("target/boss_s2_top"):"boss_s5"==u.avator?cc.loader.loadRes("target/boss_s5_flag"):"boss_s7"==u.avator?cc.loader.loadRes("target/boss_s7_mask_2"):"boss_40003"==u.avator?cc.loader.loadRes("target/boss_40003_mask_2"):"boss_s13"==u.avator&&cc.loader.loadRes("target/boss_s13_pan")},gotoStage:function(e){this.curStage=e,this.curStage%5==1?this.preLoadBoss(this.curStage+4):this.setPlayerGroupVisible(!1);var t=y.getData(this.curStage),n=t.targetInfo,i=t.rareInfo,o=8<=m.get().getMaxStage()?.9:.5,a=i&&0<i.length&&Math.random()>o?i:n,s=a[Math.floor(Math.random()*a.length)],c=t.test;null!=c?s=t.test<n.length?n[c]:i[c-n.length]:this.isBossStage()&&(this.preBossData||this.preLoadBoss(this.curStage),s=this.preBossData);var r=s.target;r||(r=1);var l=v.getData(r),h=t.diamons?t.diamons:s.diamons,d=s.knifes,u=(s.animation,s.count);this.curActionsData=I.getData(s.animation),this.resetKnifes(u);for(var p=0;p<d.length;p++){(g=this.defaultKnifePool.get()).rotation=d[p],this.addKnifeToTarget(g)}for(p=0;h&&p<h.length;p++){if(100*Math.random()<15||null!=c||this.isBossStage()){var g;Math.random(),m.get().getChance_goldApple();!1,(g=this.applePool.get()).rotation=h[p],g.isGold=!1,this.addAppleToTarget(g)}}if(this.sounds={hitTarget:A.HIT,hitBlock:A.KNIFE_HIT,hitApple:A.APPLE_HIT},this.curTargetData!=l){this.curTargetData=l;var f=this;this.isBossStage()&&f.preBossTexture?(f.targetSprite.spriteFrame=new cc.SpriteFrame(f.preBossTexture),f.whiteMask.spriteFrame=new cc.SpriteFrame(f.preBossTexture),f.targetSprite.node.width=f.preBossTexture.width,f.targetSprite.node.height=f.preBossTexture.height,f.preBossTexture=null):cc.loader.loadRes("target/"+l.avator,function(e,t){f.targetSprite.spriteFrame=new cc.SpriteFrame(t),f.whiteMask.spriteFrame=new cc.SpriteFrame(t),f.targetSprite.node.width=t.width,f.targetSprite.node.height=t.height})}this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.targetSprite.node.parent.x=0,this.leftKnifeLabel.node.scale=0,this.curStage%5==0?(this.curTargetData.index=r,this.setupStageBoss(),this.stageLabel.node.runAction(cc.sequence(cc.scaleTo(.3,1.4),cc.scaleTo(.3,1)))):this.beginStageActions()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.leftKnifeLabel.node.runAction(cc.scaleTo(.3,1)),this.updateUI(),this.showKnifeIn(),this.checkAndShowFriend()},getActions:function(e){for(var t=[],n=2<3*Math.random(),i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s=null;return s=1<t.length?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e,t,n){this.knifeCountLabel.string=this.curKnifeAmount,this.myCountLabel.string=this.curKnifeAmount;var i=e.rotation,o=i*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-i,e.x=this.targetBack.x+160*Math.cos(o),e.y=this.targetBack.y+160*Math.sin(o),t&&(e.preFrame=e.getComponent(cc.Sprite).spriteFrame,e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.knifeTextures[t])),n){var a=e.x,s=e.y;e.x=this.targetBack.x+500*Math.cos(o),e.y=this.targetBack.y+500*Math.sin(o),e.runAction(cc.moveTo(.05,a,s))}},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+182*Math.cos(n),e.y=this.targetUp.y+182*Math.sin(n)},setupStageBoss:function(){var e=this,t=cc.instantiate(this.bossFightAnim),n=this,i=this.curTargetData.hasPlayerImg;this.node.getChildByName("upEffectGroup").addChild(t);var o=t.getChildByName("bossdun");o.getChildByName("guo").getChildByName("zi").active=i;var a=o.getChildByName("bossziti2");a.getComponent(cc.Sprite).enabled=!i,a.getChildByName("wenzi2").active=i;var s=t.getComponent(cc.Animation);s.playSound=function(){A.play(A.BOSS_FIGHT)};s.on("finished",function(){s.off("finished"),t.removeFromParent(),n.isDoubleXp=100*Math.random()<m.get().getChance_doubleXp(),n.isDoubleXp=!1,e.topGroup.active=!0,n.isDoubleXp?n.showBonus(function(){n.beginStageActions()},6):n.beginStageActions()}),this.topGroup.active=!1;var c=this.targetSprite.node.parent.getChildByName("playerGroup");c.x=0,c.y=0},checkAndShowBest:function(){this.curKnifeAmount>m.get().getMaxScore()&&this.curKnifeAmount;this.showResult()},showResult:function(){c.getPage(c.RESULT).getComponent("ResultDialog").updateData({knifeCount:this.curKnifeAmount,stageNum:this.curStage,diamonCount:m.get().getDiamonCount(),playerTexture:this.myPhotoTexure,knifeSpriteFrame:this.knifeTemplate.getComponent(cc.Sprite).spriteFrame,otherPlayerId:this.otherPlayer?this.otherPlayer.playerId:"",otherPlayerPhoto:this.otherPlayer?this.otherPlayer.photo:"",otherPlayerName:this.otherPlayer?this.otherPlayer.name:"",friendsData:this.resultFriendsData,playerCount:this.playerCount,opponentScore:this.opponentScore,battleId:this.battleId,rewardCount:this.rewardCount,isVS:this.isVS}),c.showPage(c.RESULT)},updateUI:function(){if(this.diamonCountLabel.string=m.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5)),0==this.curStage%5)this.stageLabel.string=this.curTargetData.name,this.curTargetData.hasPlayerImg?this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#6C48A7"):this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#ed524b");else{this.stageLabel.node.color=cc.Color.WHITE;this.stageLabel.string="STAGE "+this.curStage}},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++){if((d=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(d*Math.PI/180),o=-Math.abs(Math.cos(d*Math.PI/180));u&&(i=-i);var a=Math.max(.1,d/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*d*20),c=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*c*10,o*=c;var r=cc.moveBy(a,i,o),l=this,h=cc.spawn(r,s);this.curMoveKnife.runAction(cc.sequence(h,cc.callFunc(function(){l.knifePool.put(l.curMoveKnife),l.curMoveKnife=null,setTimeout(function(){l.onGameOver()},200)}))),this.playDieEffect(d,u),A.play(this.sounds.hitBlock);break}}e=this.targetUp.children;t=15;for(n=0;n<e.length;n++){var d,u;if((d=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){var p=e[n].isGold;this.addOneDiamon(p),p?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var g=p?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);g.x=30*Math.random()-15,g.y=-131,this.node.getChildByName("effectGroup").addChild(g),A.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var t=this,e=1==this.continueCount&&100*Math.random()<m.get().getChance_extra(),n=(this.freeBonusCount<1&&(Math.random(),m.get().getChance_second()),f.getData(m.get().getCurKnife()).rate||0);this.freeBonusCount<1&&Math.random();this.freeBonusCount++,(e||0==this.continueCount&&(5<=this.curStage||this.isPkMod))&&r.isVideoLoad()||0==this.continueCount&&!this.isPkMod&&5<=this.curStage?(this.continueCount++,c.getPage(c.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.curTargetData.name,continueCount:this.continueCount,isBoss:this.isBossStage(),allcount:this.allAmount,leftcount:this.leftAmount,onContinue:function(e){e&&t.showCostTip(e),t.continueGame()},onNoContinue:function(){t.checkAndShowBest()},from:"gamemain"}),c.showDialog(c.CONTINUE)):(this.setPlayerGroupVisible(!1),r.logEvent("end_game",{curStage:this.curStage,leftAmount:this.leftAmount,targetId:this.curTargetData?this.curTargetData.index:1}),this.checkAndShowBest())},continueGame:function(e){this.diamonCountLabel.string=m.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn()},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(e){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0!=this.leftAmount||this.isPkMod)A.play(this.sounds.hitTarget);else{var t=this.isBossStage()?A.HIT_LAST_SPECIAL:A.HIT_LAST;A.play(t)}this.isPkMod&&this.roundKnifeData.push(this.curMoveKnife.rotation),this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife),this.curFriendData&&this.curKnifeAmount==this.curFriendData.score&&this.showFriendDefend(),this.isVS&&0<this.opponentScore&&this.curKnifeAmount==this.opponentScore+1&&this.showVSDefend();var n=cc.instantiate(this.parNode);if(n.y=-131,this.node.getChildByName("effectGroup").addChild(n),n.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd(),this.curTargetData&&"boss_s1"==this.curTargetData.avator&&this.specialBack.children[0]){var i=this.specialBack.children[0];i.stopAllActions(),i.runAction(cc.sequence(cc.moveTo(.1,i.tx,i.ty),cc.moveTo(1,i.tx,i.ty+90)))}if(this.curTargetData&&"boss_80000"==this.curTargetData.avator&&this.specailUp.children[0]&&this.specailUp.children[1]){var o=this.specailUp.children[0],a=this.specailUp.children[1];o.scale=1,o.stopAllActions(),o.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,.5))),a.scaleX=-1,a.scaleY=1,a.stopAllActions(),a.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,-.5,.5)))}}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",KnifeData:"KnifeData",LevelData:"LevelData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",TargetData:"TargetData",TaskMgr:"TaskMgr",User:"User",Utils:"Utils",enginefix:"enginefix"}],GameSpin:[function(e,t,n){"use strict";cc._RF.push(t,"cf323YU88RGA4gI/m6qE7Oz","GameSpin");var l=e("User"),c=e("AnimationData"),o=e("KnifeData"),f=e("SoundMgr"),h=e("PageMgr"),i=e("AdHelper"),a=e("Utils");e("enginefix"),cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,stageLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,bossDefentedAnim:cc.Prefab,bonusAnim:cc.Prefab,appleCount:cc.Label,uiGroup:cc.Node,cameraBtn:cc.Node,screenNode:cc.Node,shareNode:cc.Node,coinNode:cc.Node,animMaskNode:cc.Node,miaobaoNode:cc.Node,tipLabel:cc.Label,headSprite:cc.Sprite,scoreLabel:cc.Label,yoff:0,stopY:0,speed:0},init:function(){this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.rewardAppleCount=0,this.appleCount.string=this.rewardAppleCount,this.bossName="TURNTABLE",this.levelData={count:25,knifes:[100,440,270,230,310],animation:1},this.shareNode.active=!1},preLoad:function(n){var i=this;if(this.curKnifeId!=l.get().getCurKnife()){this.curKnifeId=l.get().getCurKnife();var e=o.getData(this.curKnifeId);cc.loader.loadRes("knife/"+e.img,function(e,t){e?console.log("error",e):(i.knifeTemplate.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),i.knifeTemplate.scale=1,i.knifeTemplate.rotation=0,i.setupKnifesPool(),n())})}else n()},onCameraClick:function(){this.cameraBtn.active=!1,f.play(f.CAMERA),this.whiteMask.node.active=!1;var e=this.targetAnim.node.rotation;this.targetAnim.node.rotation=0;var t=cc.director.getRunningScene(),n=cc.winSize.height;"boss_s4"==this.curTargetData.avator&&this.ballLaba&&(this.ballLaba.scale=1,this.targetBack.active=!1),a.captureScreen(t,cc.winSize.width,n,function(e,t){this.shareBase64Img=e,this.screenNode.parent.active=!0;var n=(this.screenNode.width-50)/cc.winSize.width,i=this.screenNode.parent.getChildByName("share"),o=this.screenNode.parent.getChildByName("chahao");i.scale=0,o.scale=0,t.runAction(cc.sequence(cc.scaleTo(.3,n,n*t.scaleY),cc.targetedAction(i,cc.scaleTo(.2,1)),cc.targetedAction(o,cc.scaleTo(.2,1)))),this.screenNode._sgNode.addChild(t),this.screenNode.rtt=t,this.screenNode.height=50+(this.screenNode.width-50)*cc.winSize.height/cc.winSize.width}.bind(this),function(){this.targetAnim.node.rotation=e,t.scale=1,t.runAction(cc.flipY(!1)),t.y=0,t.x=0,this.targetBack.active=!0,this.ballLaba&&(this.ballLaba.removeFromParent(),this.ballLaba=null)}.bind(this),300)},onShare:function(){f.play(f.CAMERA),h.whiteScreenEffect(function(){cc.director.once(cc.Director.EVENT_AFTER_DRAW,function(){var e=cc.game.canvas.toDataURL("image/webp");i.logEvent("share_game",{from:"spin"}),FBInstant&&FBInstant.shareAsync({intent:"SHARE",image:e,text:"My new record, coming soon! 🤣🤣🤣",data:{from:"spin"}}).then(function(){})})})},onShareClose:function(){this.showResult()},onEnable:function(){var n=this;this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),this.gotoStage(this.curStage),this.showKnifeIn(),this.animMaskNode.active=!1,this.tipLabel.node.active=!1,i.logEvent("gameturntable_show");var e=null;window.FBInstant&&(e=FBInstant.player.getPhoto()),e&&cc.loader.load(e,function(e,t){e||(n.headSprite.spriteFrame=new cc.SpriteFrame(t))})},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){0==this.leftAmount&&(this.isStageBegin=!1,i.logEvent("turntable_finish"),this.showResult())},isBossStage:function(){return this.curStage%5==0},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++){var t=new cc.Node;t.isDefaultKnife=!0,this.defaultKnifePool.put(t);var n=t.addComponent(cc.Sprite);n.spriteFrame=this.defaultKnifeIcon,n.trim=!1,n.sizeMode=cc.Sprite.SizeMode.RAW}},removeKnifes:function(e){var t,n,i,o,a,s=this.targetBack.children,c=this,r=.3;function l(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?c.defaultKnifePool.put(e):c.knifePool.put(e),e.opacity=255}for(var h=s.length-1;0<=h;h--){var d=s[h];e?l(d):(t=d,void 0,n=2*Math.random()+3,i=cc.moveBy(r,-t.x*n,-t.y*n),o=cc.rotateBy(r,380*Math.random()-180),a=cc.sequence(cc.delayTime(r-.05),cc.fadeOut(.05)),t.runAction(cc.sequence(cc.spawn(i,o,a),cc.callFunc(l.bind(null,t)))))}},removeApples:function(){var e,t=this.targetUp.children,n=this;for(var i=t.length-1;0<=i;i--){var o=t[i];(e=o).isGold?n.goldApplePool.put(e):n.applePool.put(e)}},removeSpecial:function(){this.specialBack.removeAllChildren()},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=40*(t-e/2+.5),this.knifes[t].y=0,this.knifes[t],this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(this.knifeGroup.scale=.5*cc.winSize.width/640;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){l.get().addOneDiamon(e),this.diamonCountLabel.string=l.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),f.play(f.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoStage:function(e){this.curStage=e;var t=this.levelData,n=(t.diamons,t.knifes),i=t.animation,o=t.count;this.curActionsData=c.getData(i),this.resetKnifes(o);for(var a=0;a<n.length;a++){var s=this.defaultKnifePool.get();s.rotation=n[a],this.addKnifeToTarget(s)}this.sounds={hitTarget:f.HIT,hitBlock:f.KNIFE_HIT,hitApple:f.APPLE_HIT},this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.beginStageActions()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.updateUI(),this.showKnifeIn()},getActions:function(e){return Math.random()<.5?cc.repeatForever(cc.rotateBy(5,-360)):cc.repeatForever(cc.rotateBy(5,360))},addKnifeToTarget:function(e,t){this.knifeCountLabel.string=this.curKnifeAmount;var n=e.rotation,i=n*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-n,e.x=this.targetBack.x+160*Math.cos(i),e.y=this.targetBack.y+160*Math.sin(i),t){var o=n%360;o<0&&(o+=360);var a=new cc.Node;a.y=131;var s=a.addComponent(cc.Label);a.addComponent(cc.LabelOutline).color=cc.hexToColor("#604520"),a.getComponent(cc.LabelOutline).width=3,80<=o&&o<=100?(this.rewardAppleCount*=4,s.string="x4",f.play(f.STAGE_PASS_5),a.color=cc.hexToColor("#E73C2A")):235<=o&&o<=305?(this.rewardAppleCount*=2,s.string="x2",a.color=cc.hexToColor("#5A9158"),f.play(f["STAGE_PASS_"+(Math.floor(4*Math.random())+1)])):(this.rewardAppleCount+=1,s.string="+1",a.color=cc.hexToColor("#E58D39")),this.appleCount.string=this.rewardAppleCount,this.uiGroup.stopAllActions(),this.uiGroup.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1))),this.node.addChild(a),a.runAction(cc.moveBy(1,0,100)),a.runAction(cc.sequence(cc.delayTime(.7),cc.fadeOut(.3))),setTimeout(function(){a.removeFromParent()},1e3)}},showResult:function(){var e=this,t=this.rewardAppleCount,n=t,i=12*n;100<n&&(n=100,i=1200);var o=cc.v2(cc.winSize.width/2-50,cc.winSize.height/2-50),a=new cc.Node;this.miaobaoNode.addChild(a),this.animMaskNode.active=!0,setTimeout(function(){e.tipLabel.node.active=!0,e.tipLabel.string="+"+t},1e3);for(var s=0;s<n;s++){var c=cc.instantiate(this.coinNode);a.addChild(c),c.x=500*Math.random()-250,c.y=(Math.random()-.5)*i,c.scale=0;var r=cc.pDistance(c.position,o)/1e3;c.runAction(cc.sequence(cc.delayTime(.5*Math.random()),cc.scaleTo(1*Math.random(),1).easing(cc.easeElasticOut()),cc.moveTo(r,o),cc.removeSelf()))}setTimeout(function(){l.get().collectGift(t),e.diamonCountLabel.string=l.get().getDiamonCount(),setTimeout(function(){h.hideDialog(h.GAMESPIN),h.showPage(h.HOME),a.removeFromParent(),e.tipLabel.node.active=!1},300)},2e3)},updateUI:function(){this.diamonCountLabel.string=l.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5)),this.stageLabel.string=this.bossName},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++){if((d=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(d*Math.PI/180),o=-Math.abs(Math.cos(d*Math.PI/180));u&&(i=-i);var a=Math.max(.1,d/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*d*20),c=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*c*10,o*=c;var r=cc.moveBy(a,i,o),l=this,h=cc.spawn(r,s);this.curMoveKnife.runAction(cc.sequence(h,cc.callFunc(function(){l.knifePool.put(l.curMoveKnife),l.curMoveKnife=null,setTimeout(function(){l.onGameOver()},200)}))),this.playDieEffect(d,u),f.play(this.sounds.hitBlock);break}}e=this.targetUp.children;t=15;for(n=0;n<e.length;n++){var d,u;if((d=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){var p=e[n].isGold;this.addOneDiamon(p),p?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var g=p?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);g.x=30*Math.random()-15,g.y=-131,this.node.getChildByName("upEffectGroup").addChild(g),f.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var e=this;0==this.continueCount&&i.isVideoLoad()?(this.continueCount++,h.getPage(h.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.bossName,isBoss:!0,allcount:this.allAmount,leftcount:this.leftAmount,continueCount:this.continueCount,gap:25,onContinue:function(){e.continueGame()},onNoContinue:function(){e.showShare()},from:"gamespin"}),h.showDialog(h.CONTINUE,!0)):this.showShare()},showShare:function(){i.logEvent("gameturntable_share_show"),this.scoreLabel.string="+"+this.rewardAppleCount,this.shareNode.active=!0;var e=this.shareNode.getChildByName("share"),t=this.shareNode.getChildByName("chahao");e.scale=0,t.scale=0,e.runAction(cc.scaleTo(.1,1)),t.runAction(cc.sequence(cc.delayTime(1),cc.scaleTo(.1,1)))},continueGame:function(e){this.diamonCountLabel.string=l.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn()},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(e){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0==this.leftAmount){var t=this.isBossStage()?f.HIT_LAST_SPECIAL:f.HIT_LAST;f.play(t)}else f.play(this.sounds.hitTarget);this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife,!0);var n=cc.instantiate(this.parNode);n.y=-131,this.node.getChildByName("effectGroup").addChild(n),n.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd()}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",KnifeData:"KnifeData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils",enginefix:"enginefix"}],GiftCollectDialog:[function(e,t,n){"use strict";cc._RF.push(t,"ca4efFHpY5Lh5OXJG6eQXYn","GiftCollectDialog");var i=e("AdHelper"),o=e("PageMgr"),a=e("User");cc.Class({extends:cc.Component,properties:{giftLabel:cc.Label,giftX2Label:cc.Label,videoBtn:cc.Button,guang:cc.Node},onLoad:function(){this.guang.runAction(cc.repeatForever(cc.rotateBy(1,10)))},onEnable:function(){this.isWaitingAd=!1;var e=this.node.getChildByName("content");e.scale=.8,e.runAction(cc.scaleTo(.1,1)),i.logEvent("CollectPage_Show")},onDisable:function(){this.isWaitingAd=!1},setGiftCount:function(e){this.count=e,this.giftLabel.string="x"+e},onUpdateData:function(e){this.setGiftCount(e.count)},onCollect:function(){this.showGift(!1),this.onClose(),i.logEvent("Collect")},onCollectX2:function(){var e=this;i.logEvent("Collectx2"),i.isVideoLoad()?(this.onClose(),i.logEvent("CollectAd_show"),i.showVideoAd("collectx2",this.showGift.bind(this,!0),function(){})):(o.showLoading("",!0),this.isWaitingAd=!0,this.timeoutHandler=setTimeout(function(){e.timeoutHandler=null,e.isWaitingAd=!1,o.hideLoading(),o.showTip("NO ADS AVAILBLE",null,-200),e.onClose(),setTimeout(function(){o.hideTip()},3e3),e.showGift()},6e3))},showGift:function(e){var t=e?2:1;a.get().collectGift(this.count*t),i.logEvent("turntable_apple_count",{isDouble:e?"ad":"normal",count:this.count*t},this.count*t),o.getPage(o.GIFTPAGE).getComponent("GiftPage").setAppleCount(this.count,e),o.showDialog(o.GIFTPAGE)},onClose:function(){o.hideDialog("GiftCollectDialog"),o.hideDialog(o.GAMESPIN)},update:function(e){var t=this;this.videoBtn.interactable=i.isSupporteVideo(),this.isWaitingAd&&i.isVideoLoad()&&(this.isWaitingAd=!1,this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=null),i.showVideoAd("collectx2",this.showGift.bind(this,!0),function(){}),i.logEvent("CollectAd_show"),setTimeout(function(){o.hideLoading(),t.onClose()},2e3))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],GiftPage:[function(e,t,n){"use strict";cc._RF.push(t,"df2a4sMX8ZPt7yheTLliqJy","GiftPage");var i=e("PageMgr"),c=e("SoundMgr");cc.Class({extends:cc.Component,properties:{appleGroup:cc.Node,infoGroup:cc.Node,appleTemplate:cc.Node,sweetTemplate:cc.Node,appleAnim:cc.Prefab},setAppleCount:function(e,t,n,i,o){this.appleCount=e,this.isDouble=t,this.isThree=n,this.finishCb=i,this.isSweet=o,this.infoGroup.getChildByName("label").getComponent(cc.Label).string="+"+e},playEffect:function(e){e=e||function(){},c.play(c.APPLES_COINS),this.infoGroup.opacity=0,this.infoGroup.getChildByName("jinbi").active=!this.isSweet,this.infoGroup.getChildByName("sweeticon").active=this.isSweet,this.infoGroup.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.2))),this.node.opacity=0,this.node.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(2),cc.fadeOut(.2),cc.callFunc(e)));function t(e,t){}var n=this.isSweet?this.appleCount:this.appleCount/2,i=600;100<n&&(n=100),50<n&&(i=cc.winSize.height);for(var o=0;o<n;o++){var a=this.isSweet?this.sweetTemplate:this.appleTemplate,s=cc.instantiate(a);this.appleGroup.addChild(s),s.x=640*Math.random()-320,s.y=Math.random()*i-i/2,s.scale=2*Math.random(),s.opacity=255*Math.random(),this.isSweet?(s.rotation=360*Math.random(),s.runAction(cc.sequence(cc.spawn(cc.scaleTo(Math.random(),.8),cc.fadeIn(Math.random())),cc.moveBy(Math.random(),0,-cc.winSize.height),cc.removeSelf()))):s.runAction(cc.sequence(cc.spawn(cc.scaleTo(Math.random(),.8),cc.fadeIn(Math.random())),cc.removeSelf(),cc.callFunc(t.bind(null,s.x,s.y))))}},onEnable:function(){var e=this;this.playEffect(function(){e.isDouble||e.isThree?e.playEffect(function(){e.isThree?e.playEffect(function(){e.closePage()}):e.closePage()}):e.closePage()})},closePage:function(){i.hideDialog(i.GIFTPAGE),this.finishCb&&this.finishCb()}}),cc._RF.pop()},{PageMgr:"PageMgr",SoundMgr:"SoundMgr"}],HalloweenDialog:[function(e,t,n){"use strict";cc._RF.push(t,"afd7c0K9hxFlrz54LO3O8QO","HalloweenDialog");var a=e("AdHelper"),s=e("PageMgr"),c=e("User"),i=e("Utils");cc.Class({extends:cc.Component,properties:{timer:cc.Label,playBtn:cc.Button,dian:cc.Node,countLabel:cc.Label},onShare:function(){a.logEvent("halloween_share_click"),s.showLoading(),i.getImageAsync("HalloweenScreen",function(e){}).then(function(e){a.logEvent("share_game",{from:"halloween_share"}),FBInstant.shareAsync({intent:"SHARE",text:"Trick or Treat!",image:e,data:{from:"halloween_share"}}).then(function(){s.hideLoading(),a.logEvent("halloween_share_success")}).catch(function(){s.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),s.hideLoading()})},onUpdateData:function(e){this.data=e},onPlay:function(){var i=this;a.logEvent("halloween_play_click");var o=function(){s.hideLoading(),c.get().decHalloweenCount(),s.showPageAsync("GameHalloween",i.data)};FBInstant?(s.showLoading(),c.get().getConnectedPlayersAsync(function(e){var t=c.get().getRecommondId();if(t&&Math.random()>e.length/(e.length+2))a.logEvent("halloween_play_recommond_group"),FBInstant.context.switchAsync(t).then(function(){o(),a.logEvent("halloween_play_recommond_group_success")}).catch(function(){o()});else if(1<e.length&&Math.random()<e.length/(e.length+2)){a.logEvent("halloween_play_recommond_player");for(var n=e[Math.floor(Math.random()*e.length)];i.data.otherPlayerId==n.getID();)n=e[Math.floor(Math.random()*e.length)];FBInstant.context.createAsync(n.getID()).then(function(){o(),a.logEvent("halloween_play_recommond_player_success")}).catch(function(){o()})}else a.logEvent("halloween_play_choose_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){o(),a.logEvent("halloween_play_choose_success")},function(){o()})})):o()},onClose:function(){s.hideDialog("HalloweenDialog")},onEnable:function(){a.logEvent("halloween_show")},update:function(e){this.dian.active=0<c.get().getHalloweenCount(),this.countLabel.string=c.get().getHalloweenCount(),0<c.get().getHalloweenCount()?(this.playBtn.interactable=!0,this.timer.string=""):(this.playBtn.interactable=!1,this.timer.string=c.get().getHalloweenTime())}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],HalloweenEndDialog:[function(e,t,n){"use strict";cc._RF.push(t,"da039I/wTRCRb/ZxVUGYDc5","HalloweenEndDialog");var i=e("AdHelper"),o=e("PageMgr"),a=e("User"),s=e("Utils");cc.Class({extends:cc.Component,properties:{},onShare:function(){i.logEvent("halloween_share_click",{from:"end"}),o.showLoading(),s.getImageAsync("HalloweenScreen",function(e){}).then(function(e){i.logEvent("share_game",{from:"halloween_end_share"}),FBInstant.shareAsync({intent:"SHARE",text:"Trick or Treat!",image:e,data:{from:"halloween_end_share"}}).then(function(){o.hideLoading(),i.logEvent("halloween_share_success",{from:"end"})}).catch(function(){o.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),o.hideLoading()})},onEnable:function(){i.logEvent("halloween_end_show")},onOK:function(){i.logEvent("halloween_endok_click"),a.get().decHalloweenCount(),o.showPage(o.HOME)},onClose:function(){o.showPage(o.HOME)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],HalloweenLevelData:[function(e,t,n){"use strict";cc._RF.push(t,"5782fLpLkVI67D/kx8hQNFq","HalloweenLevelData");var i=[{index:1,diamons:[],test:0,targetInfo:[{count:7,knifes:[],animation:1}]},{index:2,diamons:[0,180],test:0,targetInfo:[{count:9,knifes:[],animation:1}]},{index:3,diamons:[350,15,170,195],test:0,targetInfo:[{count:10,knifes:[90],animation:2}]},{index:4,diamons:[0,25,335,180,205,155],test:0,targetInfo:[{count:8,knifes:[90,230,310],animation:2}]},{index:5,isBoss:0,targetInfo:[{count:12,knifes:[],animation:4,diamons:[0,25,50,75,100,125,150,175],target:36}]},{index:6,diamons:[0,180],targetInfo:[{count:9,knifes:[30,330,150,210],animation:5}]},{index:7,diamons:[350,15,170,195],targetInfo:[{count:11,knifes:[90],animation:6}]},{index:8,diamons:[0,25,335,180,205,155],targetInfo:[{count:8,knifes:[90,270],animation:9}]},{index:9,diamons:[0,25,335,180,205,155],targetInfo:[{count:12,knifes:[50,130,230,310],animation:10}]},{index:10,isBoss:1,targetInfo:[{count:10,knifes:[90,230,310],animation:14,diamons:[],gold:[0,25,335,180,205,155],target:37}]},{index:11,diamons:[45,135,225,315],targetInfo:[{count:13,knifes:[0,90,180],animation:15}]},{index:12,diamons:[20,45,135,160,225,315],targetInfo:[{count:13,knifes:[0,90,180],animation:15}]},{index:13,diamons:[0,25,335,180,205,155],targetInfo:[{count:10,knifes:[50,90,130,270,230,310],animation:17}]},{index:14,diamons:[45,135,225,315],targetInfo:[{count:10,knifes:[0,90,180,270],animation:17}]},{index:15,isBoss:1,targetInfo:[{count:9,knifes:[],animation:31,gold:[195,220,245,270,295,320,345],target:38}]},{index:16,diamons:[0,180],targetInfo:[{count:11,knifes:[30],animation:21}]},{index:17,diamons:[20,45,135,160,225,315],targetInfo:[{count:12,knifes:[0,90,180],animation:23}]},{index:18,diamons:[0,25,335,180,205,155],targetInfo:[{count:12,knifes:[50,90,130,270,230,310],animation:25}]},{index:19,diamons:[45,135,225,315],targetInfo:[{count:12,knifes:[0,90,180,270],animation:27}]},{index:20,isBoss:1,targetInfo:[{count:16,knifes:[355,5,85,95,175,185,265,275],animation:29,gold:[200,225,250,290,315,340],diamons:[40,140],target:39}]}],o=function(e){return i.length<=(e-=1)&&(e=i.length-10+(e-i.length)%i.length%10),i[e]};t.exports={getData:o,getLength:function(e){var t=o(e);return t.targetInfo.length+(t.rareInfo?t.rareInfo.length:0)}},cc._RF.pop()},{}],HalloweenPayDialog:[function(e,t,n){"use strict";cc._RF.push(t,"7ea94Gfx5pB0avqn5rcwt1E","HalloweenPayDialog");var i=e("User"),o=e("PageMgr"),a=e("AdHelper");cc.Class({extends:cc.Component,properties:{},onEnable:function(){a.logEvent("pay_sale_show")},onPayClicked:function(){var e="apple_car_half";a.logEvent("pay_sale_click",{itemId:e}),i.get().purchase(e,function(){i.get().addDiamon(25e3),o.getPage(o.GIFTPAGE).getComponent("GiftPage").setAppleCount(25e3),o.showDialog(o.GIFTPAGE,!0),a.logEvent("pay_sale_success",{itemId:e})},function(){})},onCloseClicked:function(){o.hideDialog("HalloweenPayDialog"),i.get().isGiftAvailable()&&o.showDialog(o.SPINDIALOG)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],HalloweenRankItem:[function(e,t,n){"use strict";cc._RF.push(t,"151ceSJZnVDJqEwDBvs1PPO","HalloweenRankItem");var i=e("AdHelper"),o=e("PageMgr"),a=e("User");cc.Class({extends:cc.Component,properties:{num1:cc.Node,num2:cc.Node,num3:cc.Node,playerRank:cc.Label,diban:cc.Node,playerSprite:cc.Sprite,playerName:cc.Label,playerScore:cc.Label,defaultPeople:cc.SpriteFrame,friendBtn:cc.Node},updateItem:function(e,n){this.colors=this.colors||["#ffd366","#7b9bb6","#c5753a"],this.itemId=e,this.data=n,this.reset(),this.friendBtn.active=n.isFriend&&n.playerId!=(FBInstant&&FBInstant.player.getID()),this.num1.active=1==n.rank,this.num2.active=2==n.rank,this.num3.active=3==n.rank,this.playerRank.node.active=3<n.rank,this.playerRank.string=n.rank,FBInstant&&n.playerId!=FBInstant.player.getID()?(this.diban.opacity=178.5,this.diban.color=cc.hexToColor("#000000")):(this.diban.opacity=204,this.diban.color=cc.hexToColor("#3be0cb")),n.rank<=3?this.playerScore.node.color=cc.hexToColor(this.colors[n.rank-1]):this.playerScore.node.color=cc.hexToColor("#ffffff");var i=this;n.photo&&cc.loader.load(n.photo,function(e,t){e||i.data!=n||(i.playerSprite.spriteFrame=new cc.SpriteFrame(t),i.playerSprite.node.width=i.playerSprite.node.height=70)}),this.playerName.string=n.nickName,this.playerScore.string=n.score},reset:function(){this.playerSprite.spriteFrame=this.defaultPeople,this.playerSprite.node.width=this.playerSprite.node.height=70},onPlay:function(){if(i.logEvent("halloween_rank_play"),a.get().getHalloweenCount()<=0)return o.showTip("AVAILABLE IN "+a.get().getHalloweenTime()),void setTimeout(function(){o.hideTip()},1e3);FBInstant&&(o.showLoading(),FBInstant.context.createAsync(this.data.playerId).then(function(){i.logEvent("halloween_rank_play_success"),a.get().decHalloweenCount(),o.showPageAsync("GameHalloween"),o.hideLoading()}))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],HalloweenResultDialog:[function(e,t,n){"use strict";cc._RF.push(t,"0e9a5U8gHlI7r4QgzVCby3e","HalloweenResultDialog");var a=e("AdHelper"),s=e("PageMgr"),c=e("User"),i=e("Utils"),o=e("SoundMgr"),r=e("ListView"),l="halloween_rank";cc.Class({extends:cc.Component,properties:{diamonLabel:cc.Label,scoreLabel:cc.Label,list:r,playBtn:cc.Button,timer:cc.Label,dian:cc.Node,countLabel:cc.Label,shareNode:cc.Node,playScore:cc.Label,playPhoto:cc.Sprite},start:function(){},sendMessageToFb:function(){var e=this,t=this.data,n=(FBInstant.getEntryPointData(),function(){s.showTip("Score sent!",null,-cc.winSize.height/2+30,!0),setTimeout(function(){s.hideTip()},1e3)});if(2<t.playerCount)c.get().updateGroupRank(t.score,n);else{setTimeout(function(){e.shareNode.active=!0,i.captureScreen(e.shareNode,960,500,function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"CHALLENGE",template:"play_turn",text:FBInstant.player.getName()+" has challenged you to a match of Cooking Daily!",image:e,data:{playerId:FBInstant.player.getID(),otherPlayerName:FBInstant.player.getName(),stageNum:t.stageNum,knifeCount:t.score,otherPlayerPhoto:FBInstant.player.getPhoto(),from:"challenge"},strategy:"IMMEDIATE",notification:"PUSH"}).then(n,n)}.bind(e)),e.shareNode.active=!1},0)}},onEnable:function(){var t=this;a.logEvent("halloween_result_show"),this.diamonLabel.string=c.get().getDiamonCount();var e=this.getComponent(cc.Animation);e.once("finished",function(){FBInstant&&"SOLO"!=FBInstant.context.getType()&&s.showTip("Sending score...",function(){this.sendMessageToFb()}.bind(this),-cc.winSize.height/2+30)}.bind(this)),e.play("halloweenResultIPageIn"),o.play(o.GAME_OVER),this.listData=this.listData||null,c.get().getRankDataList(l,100,0,function(e){null==t.listData&&t.list.setItemsData(e),t.listData=e},!0),this.listData&&this.list.setItemsData(this.listData)},onUpdateData:function(e){if(this.data=e,this.stageNum=e.stageNum,c.get().setRankScore(l,e.score),this.scoreLabel.string=e.score,this.playScore.string=e.score,this.playPhoto.spriteFrame=new cc.SpriteFrame(e.playerTexture),this.listData){var t=this.listData.find(function(e){return FBInstant&&FBInstant.player.getID()==e.playerId});if(t&&t.score<e.score){t.score=e.score,this.listData.sort(function(e,t){return e.score-t.score});for(var n=0;n<this.listData.length;n++)this.listData[n].rank=n+1}}},onRestart:function(){var i=this;if(a.logEvent("halloween_restart_click"),c.get().getHalloweenCount()<=0)return s.showTip("AVAILABLE IN "+c.get().getHalloweenTime()),void setTimeout(function(){s.hideTip()},1e3);var o=function(){s.hideLoading(),c.get().decHalloweenCount(),s.showPageAsync("GameHalloween")};FBInstant&&5<=this.stageNum?(s.showLoading(),c.get().getConnectedPlayersAsync(function(e){var t=c.get().getRecommondId();if(t&&Math.random()>e.length/(e.length+2))a.logEvent("halloween_restart_recommond_group"),FBInstant.context.switchAsync(t).then(function(){o(),a.logEvent("halloween_restart_recommond_group_success")}).catch(function(){o()});else if(1<e.length&&Math.random()<e.length/(e.length+2)){a.logEvent("halloween_restart_recommond_player");for(var n=e[Math.floor(Math.random()*e.length)];i.data.otherPlayerId==n.getID();)n=e[Math.floor(Math.random()*e.length)];FBInstant.context.createAsync(n.getID()).then(function(){o(),a.logEvent("halloween_restart_recommond_player_success")}).catch(function(){o()})}else a.logEvent("halloween_restart_choose_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){o(),a.logEvent("halloween_restart_choose_success")},function(){o()})})):o()},update:function(e){this.dian.active=0<c.get().getHalloweenCount(),this.countLabel.string=c.get().getHalloweenCount(),0<c.get().getHalloweenCount()?(this.playBtn.interactable=!0,this.timer.string=""):(this.playBtn.interactable=!1,this.timer.string=c.get().getHalloweenTime())}}),cc._RF.pop()},{AdHelper:"AdHelper",ListView:"ListView",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils"}],HomePage:[function(e,t,n){"use strict";cc._RF.push(t,"6d360vaEnlBS7g9q5raGxmJ","HomePage");var i=e("PageMgr"),r=e("SoundMgr"),o=e("AdHelper"),a=e("User"),s=e("KnifeData"),c=e("Utils");e("NetAPI");cc.Class({extends:cc.Component,properties:{diamonLabel:cc.Label,bestScore:cc.Label,soundOnNode:cc.Node,spriteKnife:cc.Sprite,soundOffNode:cc.Node,duelNode:cc.Node,playSingleNode:cc.Node,version:cc.Label,spinNode:cc.Node,logoNode:cc.Node,bottomNode:cc.Node,topNode:cc.Node,playNode:cc.Node,play2Node:cc.Node},onLoad:function(){this.isFirst=!0,this.counter=0,this.isRecommonded=!1,this.curKnifeId=0,this.version.string="Version "+window.VERSION},onEnable:function(){this.counter++,console.log("=====home");Date.now(),a.get().getLastLoginTime();var e="SOLO";FBInstant&&(e=FBInstant.context.getType()),console.log(0==a.get().getMaxScore(),"THREAD"==e,window.isInTournament),this.isFirst,this.play2Node.active=!0,this.playNode.active=!this.play2Node.active,console.log(this.play2Node.active),this.isFirst=!1;a.get().isPKOpen();this.isPkEntry=!1,this.playInAnim()},setOutState:function(){var e=this;this.logoNode.stopAllActions(),this.logoNode.x=-cc.winSize.width,this.bottomNode.stopAllActions();var t=this.logoNode.getChildByName("maozi");t.y=471,t.stopAllActions();for(var n=0;n<this.bottomNode.childrenCount;n++)this.bottomNode.children[n].stopAllActions(),this.bottomNode.children[n].scale=0;this.duelNode.opacity=0,this.scheduleOnce(function(){e.duelNode.opacity=255,e.duelNode.scale=0},.1)},playInAnim:function(){this.setOutState();var e=this.logoNode.getChildByName("maozi"),t=this.playNode.active?this.playNode:this.play2Node;t.scale=1;var n=this.bottomNode.getChildByName("score"),i=t.getChildByName("play"),o=t.getChildByName("duelBtn"),a=this.bottomNode.getChildByName("result_spinbtn"),s=this.bottomNode.getChildByName("knife"),c=this.bottomNode.getChildByName("shop");i.scale=0,o.scale=0;n.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(1,1).easing(cc.easeElasticOut(1)))),i.runAction(cc.sequence(cc.delayTime(.2+.1),cc.scaleTo(1,1).easing(cc.easeElasticOut(1)))),o.runAction(cc.sequence(cc.delayTime(.4),cc.scaleTo(1,1).easing(cc.easeElasticOut(1)))),a.runAction(cc.sequence(cc.delayTime(.5),cc.scaleTo(1,1).easing(cc.easeElasticOut(1)))),s.runAction(cc.sequence(cc.delayTime(.2+.4),cc.scaleTo(1,1).easing(cc.easeElasticOut(1)))),c.runAction(cc.sequence(cc.delayTime(.7),cc.scaleTo(1,1).easing(cc.easeElasticOut(1)),cc.callFunc(function(){r.play("ui/maozi"),e.runAction(cc.sequence(cc.moveTo(.1,cc.v2(e.x,71)),cc.scaleTo(.1,1.4,.6),cc.scaleTo(.15,.6,1.4),cc.scaleTo(.2,1.2,.8),cc.scaleTo(.25,.9,1.1),cc.scaleTo(.1,1,1)))}))),this.logoNode.runAction(cc.moveTo(1,cc.v2(0,this.logoNode.y)).easing(cc.easeElasticOut(1)))},onPlaySingle:function(){o.logEvent("home_play_click"),c.playGame()},onPlayVs:function(){o.logEvent("home_vs_click"),window.isInTournament?c.playGame():a.get().challengeFriends2(function(e){c.playGame(e)})},onTournamentClick:function(){o.logEvent("home_tournament_click"),i.showDialogAsync("TournamentDialog")},onSoundClick:function(){r.setSoundEnable(!r.isSoundEnable()),a.get().save()},onPayShopClick:function(){o.logEvent("home_pay_click",{payState:a.get().isPayReady()?"YES":"NO"}),a.get().isPayReady()?i.showDialogAsync(i.PAYSHOP):i.showDialogAsync("IosShopPage")},onGiftClick:function(){i.showDialogAsync(i.SPINDIALOG)},onSpinClick:function(){o.logEvent("spin_play_click");var e=function(){i.getPageAsync(i.GAMESPIN).then(function(e){i.showLoading(),e.getComponent(i.GAMESPIN).preLoad(function(){i.showDialog(i.GAMESPIN,!0),i.hideLoading()})}).catch(function(){})};a.get().isGiftAvailable()?e():o.isVideoLoad()?(o.logEvent("spin_adclick"),o.showVideoAd("spin",e,function(){})):(i.showTip("NO ADS AVAILBLE",null,-200),setTimeout(function(){i.hideTip()},3e3))},onHalloweenClick:function(){o.logEvent("halloween_click"),i.showDialogAsync("HalloweenDialog",{knifeNode:this.spriteKnife.node})},onHoroscopeClick:function(){o.logEvent("horoscope_click"),i.showDialogAsync("HoroscopePage")},onThanksgivingClick:function(){o.logEvent("thanksgiving_click"),i.showDialogAsync("ThanksSaleDialog")},onNewYearClick:function(){o.logEvent("newyear_click"),i.showDialogAsync("NewYearSaleDialog")},onChiristmasClick:function(){o.logEvent("newyear_click"),i.showDialogAsync("ChristmasSaleDialog")},onDuelClick:function(){var e=i.getPage(i.PKPAGE).getComponent("PKPage");o.logEvent("home_deul_click",{maxStage:a.get().getMaxStage()}),e.homeConnectServer(function(e){e?1==e.maintance&&i.showDialog(i.MAINTANCEDIALOG):(o.logEvent("deul_connect_success"),i.showPage(i.PKPAGE))})},update:function(e){if(this.diamonLabel.string=a.get().getDiamonCount(),this.bestScore.string=0==a.get().getMaxScore()?"":a.get().getMaxScore(),this.curKnifeId!=a.get().getCurKnife()){var n=this;this.curKnifeId=a.get().getCurKnife();var t=s.getData(this.curKnifeId);cc.loader.loadRes("shadows/"+t.img,function(e,t){e?console.log("error",e):n.spriteKnife.spriteFrame=new cc.SpriteFrame(t)})}}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",NetAPI:"NetAPI",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils"}],HoroscopeGame:[function(e,t,n){"use strict";cc._RF.push(t,"bba08L7OX5A06J6YV/H0Y9v","HoroscopeGame");var i=e("User"),c=e("AnimationData"),f=e("SoundMgr"),o=e("PageMgr"),a=e("AdHelper"),s=e("Utils");e("enginefix");var r=["If your financial projects run into problems, you might get discouraged. But don’t give up, fight for yourself. You will then see things move very quickly.","You tend not to master every situation. Fortunately, luck will allow you to sort out things by discussing them with someone willing to help you. ","With a good physical condition you can have all the tools you need to resolve a situation that is unsatisfying or neverending. You deserve better than that in life.","You will be in good spirits and you will have to keep it that way. Keep acting in a positive way. In certain circumstances, a positive attitude is necessary. ","Someone will surprise you once more. Somebody will make you an offer that you will be tempted to accept. You will be glad to hear it.","You have a lot to do, and fortunately you’re in good health. Someone will give you a helpful hand in your work. Answer with gratitude so you can count on more help in the future.","You will find a way to stir your boat in a sea of troubles. You will receive a subtle offer that might charm you. But you will know how to resist to these calls which will enable you to come out of this maze victoriously.","You are experiencing difficult relationships with some people. But you will be lucky enough to get out of such a bad time. You will have to remain the same if you want to keep such relationships intact.","You are absolutely right to want to make the necessary remarks that will earn you respect.  Your judicious observations will be noted.","You are showing signs of impatience, but try to control it! A major event will mess up your schedule, but you will be able to deliver on all your deadlines. ","Take this great opportunity that will present itself. You will enjoy it if you keep it for yourself. Your commitment and absence of bias will serve you right.","You will be in good spirits despite a delicate situation especially since another apparently delicate situation will get solved easily."],l=["Red","Orange","Yellow","Green","Blue","Purple","White","Black","Grey","Pink","Golden","Silver"];cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,stageLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,bossDefentedAnim:cc.Prefab,bonusAnim:cc.Prefab,shareDialog:cc.Node,screenNode:cc.Node,playerSprite:cc.Sprite,horoSprite:cc.Sprite,frames:[cc.SpriteFrame],horoDateLabel:cc.Label,luckyColorLabel:cc.Label,luckyNumLabel:cc.Label,loveStars:[cc.Node],dailyDes:cc.Label,shareBtnNode:cc.Node,closeBtnNode:cc.Node,luckyColorTitleNode:cc.Node,luckyNumTitleNode:cc.Node,loveTitleNode:cc.Node,yoff:-500,stopY:-180,speed:100},onLoad:function(){this.bossName="HOROSCOPE",this.levelData={count:12,knifes:[],animation:s.randomInt(6)+4}},init:function(){this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=i.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!i.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.horoIndexs=[]},onUpdateData:function(e){var n=this;this.selectIndex=e.index,FBInstant&&cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e||(n.playerSprite.spriteFrame=new cc.SpriteFrame(t))}),this.horoSprite.spriteFrame=this.frames[this.selectIndex],this.horoDateLabel.string=e.date,this.textIndex=s.randomInt(r.length),this.dailyDes.string=r[this.textIndex]},onShare:function(){if(FBInstant){a.logEvent("gamehoroscope_share",{color:this.luckyColorLabel.string,num:this.luckyNumLabel.string,star:this.starCount,textIndex:this.textIndex,selectIndex:this.selectIndex});o.showLoading(),s.captureScreen(this.screenNode,960,500,function(e){a.logEvent("share_game",{from:"gamehoroscope"}),FBInstant.shareAsync({intent:"SHARE",image:e,text:"What's your horoscope today?Try it!",data:{from:"gamehoroscope"}}).then(function(){a.logEvent("gamehoroscope_share_success"),o.hideLoading(),o.showPage(o.HOME)}).catch(function(){o.hideLoading(),o.showPage(o.HOME)})})}else o.showPage(o.HOME)},onShareClose:function(){o.showPage(o.HOME)},onEnable:function(){this.shareDialog.active=!1,this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),this.gotoStage(this.curStage),this.showKnifeIn(),a.logEvent("gamehoroscope_show")},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){0==this.leftAmount&&(this.isStageBegin=!1,a.logEvent("horoscope_finish"),this.showResult())},isBossStage:function(){return this.curStage%5==0},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++){var t=new cc.Node;t.isDefaultKnife=!0,this.defaultKnifePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.defaultKnifeIcon}},removeKnifes:function(e){var t,n,i,o,a,s=this.targetBack.children,c=this,r=.3;function l(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?c.defaultKnifePool.put(e):c.knifePool.put(e),e.opacity=255}for(var h=s.length-1;0<=h;h--){var d=s[h];e?l(d):(t=d,void 0,n=2*Math.random()+3,i=cc.moveBy(r,-t.x*n,-t.y*n),o=cc.rotateBy(r,380*Math.random()-180),a=cc.sequence(cc.delayTime(r-.05),cc.fadeOut(.05)),t.runAction(cc.sequence(cc.spawn(i,o,a),cc.callFunc(l.bind(null,t)))))}},removeApples:function(){var e,t=this.targetUp.children,n=this;for(var i=t.length-1;0<=i;i--){var o=t[i];(e=o).isGold?n.goldApplePool.put(e):n.applePool.put(e)}},removeSpecial:function(){this.specialBack.removeAllChildren()},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){i.get().addOneDiamon(e),this.diamonCountLabel.string=i.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),f.play(f.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoStage:function(e){this.curStage=e;var t=this.levelData,n=(t.diamons,t.knifes),i=t.animation,o=t.count;this.curActionsData=c.getData(i),this.resetKnifes(o);for(var a=0;a<n.length;a++){var s;(s=this.defaultKnifePool.get()).rotation=n[a],this.addKnifeToTarget(s)}(s=new cc.Node).scale=.6,s.width=72,s.height=86,s.addComponent(cc.Sprite).spriteFrame=this.goldAppleIcon,s.rotation=30*this.selectIndex-180+15,s.isGold=!0,this.addAppleToTarget(s),this.sounds={hitTarget:f.HIT,hitBlock:f.KNIFE_HIT,hitApple:f.APPLE_HIT},this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.beginStageActions()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.updateUI(),this.showKnifeIn()},getActions:function(e){for(var t=[],n=2<3*Math.random(),i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s=null;return s=1<t.length?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e,t){this.knifeCountLabel.string=this.curKnifeAmount;var n=e.rotation,i=n*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-n,e.x=this.targetBack.x+160*Math.cos(i),e.y=this.targetBack.y+160*Math.sin(i),t){var o=n%360;o<0&&(o+=360);var a=Math.ceil(o/30)-6;a<0&&(a+=12),0==a&&(a=12),this.horoIndexs.push(a)}},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+198*Math.cos(n),e.y=this.targetUp.y+198*Math.sin(n)},showResult:function(){var e=this;this.shareDialog.active=!0,this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.luckyColorLabel.string=s.randomSelectOne(l),this.luckyNumLabel.string=s.randomInt(13);var t=2;this.isUsingContinue&&(t+=1),0==this.leftAmount&&(t+=s.randomInt(2)+1);for(var n=0;n<this.loveStars.length;n++)this.loveStars[n].active=n<t,this.loveStars[n].opacity=0;this.starCount=t,this.shareDialog.opacity=0,this.luckyColorLabel.node.opacity=0,this.luckyNumLabel.node.opacity=0,this.dailyDes.node.opacity=0,this.luckyColorTitleNode.opacity=0,this.luckyNumTitleNode.opacity=0,this.loveTitleNode.opacity=0,this.shareBtnNode.opacity=0,this.closeBtnNode.opacity=0,this.shareBtnNode.active=!1,this.closeBtnNode.active=!1,this.shareDialog.runAction(cc.sequence(cc.fadeIn(.3),cc.delayTime(.3),cc.spawn(cc.targetedAction(this.luckyColorTitleNode,cc.fadeIn(.2)),cc.targetedAction(this.luckyColorLabel.node,cc.fadeIn(.2))),cc.delayTime(.3),cc.spawn(cc.targetedAction(this.luckyNumTitleNode,cc.fadeIn(.2)),cc.targetedAction(this.luckyNumLabel.node,cc.fadeIn(.2))),cc.delayTime(.3),cc.targetedAction(this.loveTitleNode,cc.fadeIn(.1)),cc.targetedAction(this.loveStars[0],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[1],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[2],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[3],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[4],cc.fadeIn(.1)),cc.delayTime(.3),cc.targetedAction(this.dailyDes.node,cc.fadeIn(.2)),cc.callFunc(function(){e.shareBtnNode.active=!0,e.closeBtnNode.active=!0}),cc.targetedAction(this.shareBtnNode,cc.fadeIn(.2)),cc.delayTime(2),cc.targetedAction(this.closeBtnNode,cc.fadeIn(.2)))),a.logEvent("gamehoroscope_result_show",{color:this.luckyColorLabel.string,num:this.luckyNumLabel.string,star:this.starCount,textIndex:this.textIndex,selectIndex:this.selectIndex}),i.get().markShowHoroscope()},updateUI:function(){this.diamonCountLabel.string=i.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5)),this.stageLabel.string="BOSS: "+this.bossName,this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#ed524b"),this.pointsNode.active=!1,this.pkIcon.runAction(cc.moveTo(.5,0,this.pkIcon.y)),this.pkIcon.color=this.stageLabel.node.color,this.pointsNode.getComponent("PointControl").setCount(4)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++){if((d=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(d*Math.PI/180),o=-Math.abs(Math.cos(d*Math.PI/180));u&&(i=-i);var a=Math.max(.1,d/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*d*20),c=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*c*10,o*=c;var r=cc.moveBy(a,i,o),l=this,h=cc.spawn(r,s);this.curMoveKnife.runAction(cc.sequence(h,cc.callFunc(function(){l.knifePool.put(l.curMoveKnife),l.curMoveKnife=null,setTimeout(function(){l.onGameOver()},200)}))),this.playDieEffect(d,u),f.play(this.sounds.hitBlock);break}}e=this.targetUp.children;t=15;for(n=0;n<e.length;n++){var d,u;if((d=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(d+=360),d=(u=270<d)?360-d:d,Math.abs(d)<t&&this.curMoveKnife.y>this.stopY-180+3*d){var p=e[n].isGold;this.addOneDiamon(p),p?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var g=p?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);g.x=30*Math.random()-15,g.y=-131,this.node.getChildByName("upEffectGroup").addChild(g),f.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var e=this;0==this.continueCount&&a.isVideoLoad()?(this.continueCount++,o.getPage(o.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.bossName,isBoss:!0,continueCount:this.continueCount,onContinue:function(){e.continueGame()},onNoContinue:function(){e.showResult()},from:"gamehoroscope"}),o.showDialog(o.CONTINUE,!0)):this.showResult()},continueGame:function(e){this.diamonCountLabel.string=i.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn()},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(e){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0==this.leftAmount){var t=this.isBossStage()?f.HIT_LAST_SPECIAL:f.HIT_LAST;f.play(t)}else f.play(this.sounds.hitTarget);this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife,!0);var n=cc.instantiate(this.parNode);n.y=-131,this.node.getChildByName("effectGroup").addChild(n),n.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd()}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils",enginefix:"enginefix"}],HoroscopeItem:[function(e,t,n){"use strict";cc._RF.push(t,"6d9d9yLUehEMr4rxmZmm9W4","HoroscopeItem"),cc.Class({extends:cc.Component,properties:{iconSprite:cc.Sprite,nameLabel:cc.Label,dateLabel:cc.Label,frames:[cc.SpriteFrame]},updateItem:function(e){this.data=e,this.nameLabel.string=e.name,this.dateLabel.string=e.date,this.iconSprite.spriteFrame=this.frames[e.index]},onClick:function(){this.data.onSelect(this.data)}}),cc._RF.pop()},{}],HoroscopePage:[function(e,t,n){"use strict";cc._RF.push(t,"df2df1LRrBJZbEZzJ7Zwm5E","HoroscopePage");var i=e("AdHelper"),o=e("PageMgr");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},onLoad:function(){for(var e=[["Aries","3/21-4/20"],["Taurus","4/21-5/20"],["Gemini","5/21-6/21"],["Cancer","6/22-7/22"],["Leo","7/23-8/22"],["Virgo","8/23-9/22"],["Libra","9/23-10/22"],["Scorpio","10/23-11/21"],["Sagittarious","11/22-12/21"],["Capricorn","12/22-1/19"],["Aquarius","1/20-2/18"],["Pisces","2/19-3/20"]],t=0;t<4;t++)for(var n=0;n<3;n++){var i=cc.instantiate(this.itemPrefab);this.node.addChild(i),i.getComponent("HoroscopeItem").updateItem({index:3*t+n,name:e[3*t+n][0],date:e[3*t+n][1],onSelect:this.onSelect.bind(this)}),i.x=170*(n-1),i.y=220-210*t}},onEnable:function(){i.logEvent("horoscope_show")},onSelect:function(e){i.logEvent("horoscope_select",{index:e.index}),o.showPageAsync("HoroscopeGame",e)},onClose:function(e){i.logEvent("horoscope_close"),o.showPage(o.HOME)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr"}],ImageNumber:[function(e,t,n){"use strict";cc._RF.push(t,"5d28fZUFg5B6Z7nUyg7dil9","ImageNumber"),cc.Class({extends:cc.Component,properties:{numFrames:[cc.SpriteFrame]},setNum:function(e){this.num=e;this.node.children;var t=[];do{var n=e%10,i=Math.floor(e/10);e=i,t.unshift(n)}while(0!=i);for(var o=0;o<t.length;o++){var a=this.node.children[o];if(!a){var s=new cc.Node;this.node.addChild(s),s.addComponent(cc.Sprite),(a=s).childrenCount}a.active=!0,a.getComponent(cc.Sprite).spriteFrame=this.numFrames[t[o]]}for(;o<this.node.childrenCount;o++)this.node.children[o].active=!1},getNum:function(){return this.num}}),cc._RF.pop()},{}],InviteDialog:[function(e,t,n){"use strict";cc._RF.push(t,"c4193BsDbRCL6CE+UuBTrq7","InviteDialog");var i=e("PageMgr"),o=e("Utils");cc.Class({extends:cc.Component,properties:{labelCount:cc.Label,editbox:cc.EditBox,personal:cc.Button},onEnable:function(){this.editbox.string="",this.personal.interactable=0<this.editbox.string.length,this.editbox.placeholder="Come on,play with me!!!",this.labelCount.string="0/"+this.editbox.maxLength},onClose:function(){i.showDialog(i.INVITETIP)},onEditChange:function(){this.labelCount.string=this.editbox.string.length+"/"+this.editbox.maxLength,this.personal.interactable=0<this.editbox.string.length},onPersonalize:function(){var t=this;if(!FBInstant)return t.node.emit("invite_finish_double"),void i.hideDialog(i.INVITE);i.showLoading(),o.getShareImg(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:this.editbox.string,image:e,data:{},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){t.node.emit("invite_finish_double"),i.hideDialog(i.INVITE),i.hideLoading()}).catch(function(e){console.log("updateAsync err",e),i.hideLoading()})}.bind(this))},onProfile:function(){var t=this;if(!FBInstant)return t.node.emit("invite_finish"),void i.hideDialog(i.INVITE);i.showLoading(),o.getShareImg(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:this.editbox.placeholder,image:e,data:{},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){t.node.emit("invite_finish"),i.hideDialog(i.INVITE),i.hideLoading()}).catch(function(e){console.log("updateAsync err",e),i.hideLoading()})}.bind(this))}}),cc._RF.pop()},{PageMgr:"PageMgr",Utils:"Utils"}],InviteKnifePage:[function(e,t,n){"use strict";cc._RF.push(t,"78e8d952TRLzLnFPEIcCo/B","InviteKnifePage");var s=e("User"),i=e("Utils"),o=e("PageMgr"),a=e("AdHelper"),c=e("KnifeData"),r=e("NetHelper");cc.Class({extends:cc.Component,properties:{diamon:cc.Label,info:cc.Label,appleCost:cc.Label,inviteLabel:cc.Label,knifes:[cc.Sprite],knifeGroup:cc.Node,equipNode:cc.Node,bottomGroup:cc.Node,equip:cc.Node,tip:cc.Node,adBtn:cc.Node,inviteTipLabel:cc.Label},onLoad:function(){var i=this,t=[154,155,156,157];this.knifeDatas=[];for(var e=function(n){var e=c.getData(t[n]);i.knifeDatas.push(e),cc.loader.loadRes("knife/"+e.img,function(e,t){e?console.log("error",e):i.knifes[n].spriteFrame=new cc.SpriteFrame(t)}),s.get().isKnifeUnlock(t[n])&&(i.curIndex=n+1)},n=this.curIndex=0;n<t.length;n++)e(n);this.curIndex=Math.min(3,this.curIndex),this.updateUI(this.knifeDatas[this.curIndex])},start:function(){this.knifeGroup.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.knifeGroup.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.knifeGroup.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},onTouchStart:function(e){},onTouchMove:function(e){this.isMove=!0;var t=e.getDelta();this.knifeGroup.x+=t.x,0<this.knifeGroup.x&&(this.knifeGroup.x=0),this.knifeGroup.x<-600&&(this.knifeGroup.x=-600)},onTouchEnd:function(e){this.isMove=!1;var t=Math.abs(Math.round(this.knifeGroup.x/200));this.curIndex=t,this.updateUI(this.knifeDatas[this.curIndex])},onEnable:function(){this.diamon.string=s.get().getDiamonCount(),this.updateUI(this.curData)},updateUI:function(e){var t=this;this.curData=e,this.appleCost.string=this.curData.price,this.adBtn.active=!1;var n=this.adBtn.active?"FREE(":"INVITE(",i=this.curData.id,o=this.curData.friend_num;this.inviteLabel.string=n+s.get().getFriendsCount(i)+"/"+this.curData.friend_num+")";var a=FBInstant&&FBInstant.player.getID()||"123";this.inviteTipLabel.string="Refer "+o+" friends \nOnly new player login could you get it",r.getShareCount(a,"inviteknife_"+i,function(e){i==t.curData.id&&(e=parseInt(e),e+=s.get().getFriendsCount(i),t.inviteLabel.string=n+e+"/"+o+")",!s.get().isKnifeUnlock(t.curData.id)&&o<=e&&(s.get().unlockKnife(t.curData.id,0),t.showKnifeDialog(t.curData.id),t.equip.active=s.get().isKnifeUnlock(t.curData.id)&&t.curData.id==s.get().getCurKnife(),t.equipNode.active=s.get().isKnifeUnlock(t.curData.id)&&t.curData.id!=s.get().getCurKnife(),t.bottomGroup.active=!s.get().isKnifeUnlock(t.curData.id)))}),this.info.string=this.curData.rate+"% THREE CHANCE",this.equip.active=s.get().isKnifeUnlock(this.curData.id)&&this.curData.id==s.get().getCurKnife(),this.equipNode.active=s.get().isKnifeUnlock(this.curData.id)&&this.curData.id!=s.get().getCurKnife(),this.bottomGroup.active=!s.get().isKnifeUnlock(this.curData.id)},onKnifeClick:function(e,t){this.curIndex=t,this.updateUI(this.knifeDatas[this.curIndex])},onAppleBuyClick:function(){var e=this;a.logEvent("knife_buy_click"),s.get().getDiamonCount()>=this.curData.price?(s.get().unlockKnife(this.curData.id,this.curData.price),this.showKnifeDialog(this.curData.id),this.updateUI(this.curData)):(this.tip.active=!0,setTimeout(function(){e.tip.active=!1},4e3))},onInviteClick:function(){var n=this,e=function(){s.get().addFriendsCount(n.curData.id),s.get().getFriendsCount(n.curData.id)>=n.curData.friend_num&&(s.get().unlockKnife(n.curData.id,0),n.showKnifeDialog(n.curData.id)),n.updateUI(n.curData)};FBInstant?(a.logEvent("knife_invite_click",{type:this.adBtn.active?"ad":"invite"}),this.adBtn.active?a.showVideoAd("knife_invite",e,function(){}):(o.showLoading("",!0),TournamentMgr.stopContextTick(),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e?o.hideLoading():i.getImageAsync("InviteScreen",function(e){e.getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}).then(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"PLAY NOW",template:"invite_knife",text:"This 🎯 game is awesome! You should try it!😝",image:e,data:{from:"knife_invite",playerId:FBInstant.player.getID(),shareType:"inviteknife_"+n.curData.id},strategy:"IMMEDIATE",notification:"PUSH"}).then(function(){a.logEvent("knife_invite_finish"),o.hideLoading()}).catch(function(e){console.log("updateAsync err",e),o.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),o.hideLoading()})})}).catch(function(e){console.log("chooseAsync err",e),o.hideLoading()}))):e()},onEquipClick:function(){s.get().setCurKnife(this.curData.id),o.getPage(o.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(this.knifes[this.curIndex].node)),this.updateUI(this.curData),o.showPage(o.HOME)},showKnifeDialog:function(e){var n=this,t=o.getPage(o.SHOWINVITEKNIFE).getComponent("ShowInviteKnifeDialog");t.setKnifeInfo(e,this.info.string),t.registerOnClose(function(e,t){e&&(o.getPage(o.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(t)),n.updateUI(n.curData),o.showPage(o.HOME))}),o.showDialog(o.SHOWINVITEKNIFE)},update:function(e){for(var t=this.node.width/2,n=0;n<this.knifes.length;n++){var i=this.knifes[n].node.convertToWorldSpaceAR(cc.p(0,0));Math.abs(t-i.x)<150?this.knifes[n].node.scale=1.3-.5*Math.abs(t-i.x)*1/150:this.knifes[n].node.scale=.8}if(!this.isMove){var o=200*-this.curIndex;o!=this.knifeGroup.x&&(this.knifeGroup.x>o?(this.knifeGroup.x-=10,this.knifeGroup.x<=o&&(this.knifeGroup.x=o)):(this.knifeGroup.x+=10,this.knifeGroup.x>=o&&(this.knifeGroup.x=o)))}}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",NetHelper:"NetHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],InviteTipDialog:[function(e,t,n){"use strict";cc._RF.push(t,"c3fb61d1zVFTKETs+sAGh6t","InviteTipDialog");var i=e("PageMgr");cc.Class({extends:cc.Component,properties:{},onChooseFriend:function(){i.hideDialog(i.INVITETIP);var t=i.getPage(i.HOME).getComponent("HomePage");if(FBInstant){FBInstant.context.chooseAsync().then(function(){var e=FBInstant.context.getID();User.get().isFriendsInvited(e)?t.showInviteInvildDialog():t.showInviteDialog()}).catch(function(e){console.log("chooseAsync err",e)})}else t.showInviteDialog()},start:function(){}}),cc._RF.pop()},{PageMgr:"PageMgr"}],IosShopPage:[function(e,t,n){"use strict";cc._RF.push(t,"80764YU74VICIJfeCDse5yO","IosShopPage");var h=e("PageMgr"),d=e("AdHelper"),u=e("SlotData"),p=(e("SloteList"),e("SoundMgr")),g=e("User"),f=e("TaskMgr");cc.Class({extends:cc.Component,properties:{videoTime:cc.Label,spinTime:cc.Label,freeVideoBtn:cc.Button,videoBtn:cc.Button},onEnable:function(){d.logEvent("payios_show")},update:function(e){this.freeVideoBtn.interactable=d.isVideoLoad(),this.videoBtn.interactable=d.isVideoLoad(),this.videoBtn.interactable=d.isVideoLoad()&&g.get().isVideoAvailable(),g.get().isVideoAvailable()?this.videoTime.string="":this.videoTime.string=g.get().getVideoLeftTime()},showGetApples:function(e){g.get().addDiamon(e),h.getPage(h.GIFTPAGE).getComponent("GiftPage").setAppleCount(e),h.showDialog(h.GIFTPAGE,!0)},onVideoClicked:function(){var e=this;d.logEvent("payios_video_click"),d.showVideoAd("payios_ad",function(){e.showGetApples(200)},function(){})},onTimedVideoClicked:function(){var e=this;g.get().resetVideoTime(),d.logEvent("payios_timevideo_click"),d.showVideoAd("payios_ad_time",function(){e.showGetApples(400)},function(){})},onSpinSloto_start:function(){var o=this;f.onSpinSlot(),this.spinList1.node.opacity=255,p.play(p.SLOT_START);var e=Math.floor(Math.random()*u.length),t=u[e];d.logEvent("payios_spin_random",{randomIndex:e});var n=t.slice();.8<Math.random()&&(n[Math.floor(Math.random()*n.length)]=10);var i=Math.floor(Math.random()*n.length),a=n.splice(i,1)[0];n.splice(Math.floor(Math.random()*n.length),0,a);for(var s=[],c=0;c<n.length;c++)s.indexOf(n[c])<0?n[c]:s.push(n[c]);var r=2==s.length,l=1==s.length;this.spinBtn.interactable=!1,this.spinVideoIcon.active=!1,this.spinList1.node.opacity=255,this.spinSwitcher.play("resultslot"),this.spinSwitcher.once("finished",function(){o.spinList1.scorllToIndex(n[0],function(){p.play(p.SLOT_STOP)}),setTimeout(function(){o.spinList2.scorllToIndex(n[1],function(){p.play(p.SLOT_STOP)},1)},200),setTimeout(function(){o.spinList3.scorllToIndex(n[2],function(){p.play(p.SLOT_STOP),o.spinSwitcher.play("resultspinback"),r&&(p.play(p.SLOT_2),h.showTip("REWARD X2",null,-200),setTimeout(function(){h.hideTip()},3e3)),l&&(o.spinList1.showLightEffect(),o.spinList2.showLightEffect(),o.spinList3.showLightEffect(),p.play(p.SLOT_3),h.showTip("REWARD X3",null,-200),setTimeout(function(){h.hideTip()},3e3));setTimeout(function(){for(var e=0,t=-1,n=0;n<3;n++){var i=o["spinList"+(n+1)].getCurrentData();if("knife"==i.type)t=i.id;else e+=i.count*("apple"==i.type?2:4)}l?g.get().addDiamon(3*e):r?g.get().addDiamon(2*e):g.get().addDiamon(e),h.getPage(h.GIFTPAGE).getComponent("GiftPage").setAppleCount(e,r,l,function(){0<t&&o.showKnifeGet(0,t)}),h.showDialog(h.GIFTPAGE,!0),o.spinBtn.interactable=!0},800)},2)},400)})},onSpinClicked:function(){var e=this;d.logEvent("payios_spin_click"),g.get().resetSpinTime();d.showVideoAd("payios_ad_spin",function(){e.onSpinSloto_start()},function(){})},showKnifeGet:function(e,t,n){var i=h.getPage(h.SHOWINVITEKNIFE).getComponent("ShowInviteKnifeDialog");i.setKnifeInfo(t,""),i.registerOnClose(function(e,t){e&&h.getPage(h.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(t));n&&n()}),h.showDialog(h.SHOWINVITEKNIFE,!0)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",SlotData:"SlotData",SloteList:"SloteList",SoundMgr:"SoundMgr",TaskMgr:"TaskMgr",User:"User"}],JumpGame:[function(e,t,n){"use strict";cc._RF.push(t,"a9a31SfLmVMMr+moglg9hCF","JumpGame");var i=e("AdHelper");cc.Class({extends:cc.Component,properties:{img:cc.Sprite},onLoad:function(){this.data=null,this.gamesId=["2656341144652244","749528802210263","857045494748306"],this.curIndex=Math.floor(Math.random()*this.gamesId.length),this.serverDatas=null,this.allWeight=0},start:function(){this.node.on("click",this.onSwitchGame.bind(this))},onEnable:function(){this.img.spriteFrame=null,this.getComponent(cc.Button).interactable=!1,cc.sys.os!=cc.sys.OS_IOS?this.serverRecommond():this.node.active=!1},randomOneGame:function(e){if(0!=e.length){for(var t=Math.floor(Math.random()*this.allWeight),n=0,i=null,o=0;o<e.length;o++)if(t<=(n+=e[o].weight)){i=e[o];break}console.log("randomOneGame",i),this.setAdData(i)}},serverRecommond:function(){var t=this;null==this.serverDatas?this.getRecommondGames(function(e){console.log(e),e.data.ads&&0<e.data.ads.length&&(t.serverDatas=e.data.ads,t.allWeight=0,t.serverDatas.forEach(function(e){t.allWeight+=e.weight}),t.randomOneGame(t.serverDatas))}):this.randomOneGame(this.serverDatas)},getRecommondGames:function(t){var e="Other";e=cc.sys.os==cc.sys.OS_IOS?"IOS":cc.sys.os==cc.sys.OS_ANDROID?"ANDROID":cc.sys.isMobile?"MOBILE_WEB":"WEB";var n="001",i="name";window.FBInstant&&(n=FBInstant.player.getID(),i=FBInstant.player.getName());var o=new XMLHttpRequest;o.open("POST","https://api.conchgame.com/fbapi/v1/getRecommendGames"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4==o.readyState){console.log(o.responseText);try{var e=JSON.parse(o.responseText);t(e)}catch(e){}}};var a="playerId="+n+"&nickname="+i+"&appId="+window.appId+"&locale="+navigator.language+"&deviceOS="+e+"&timezoneOffset="+(new Date).getTimezoneOffset();o.send(a)},localRecommond:function(){console.log("this.curIndex",this.curIndex,this.gamesId);var e=this.gamesId[this.curIndex];this.setAdData({breathType:3,appId:e,appName:e}),this.curIndex++,this.curIndex>=this.gamesId.length&&(this.curIndex=0)},setAdData:function(e){var n=this;switch(this.data=e,this.img.spriteFrame=null,e.icon?cc.loader.load(e.icon,function(e,t){e?console.log(e):(n.img.spriteFrame=new cc.SpriteFrame(t),n.getComponent(cc.Button).interactable=!0)}):cc.loader.loadRes("gameicons/"+e.appId,function(e,t){e?console.log(e):(n.img.spriteFrame=new cc.SpriteFrame(t),n.getComponent(cc.Button).interactable=!0)}),this.node.stopAllActions(),e.breathType){case 1:this.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.7,1.1),cc.scaleTo(.7,1))));break;case 2:this.node.runAction(cc.repeatForever(cc.sequence(cc.rotateBy(.5,5),cc.rotateBy(.5,-5))))}},onSwitchGame:function(){var e=this;console.log("onSwitchGame",this.data),i.logEvent("switch_game_click"),window.FBInstant&&FBInstant.switchGameAsync(this.data.appId,{from:window.GameName,switchGameInfo:{appId:window.appId,appName:window.GameName},type:window.GameName}).then(function(){i.logEvent("switch_game_success",{game:e.data.appName,appId:e.data.appId})}).catch(function(e){console.log(e)})}}),cc._RF.pop()},{AdHelper:"AdHelper"}],KnifeData:[function(e,t,n){"use strict";cc._RF.push(t,"b7664SQMuZDR5surAOhYW0Z","KnifeData");var i={1:{img:"knife_0",boss_id:0,price:0,ad_num:0,friend_num:0},2:{img:"knife_1",boss_id:0,price:200,ad_num:0,friend_num:0},3:{img:"knife_2",boss_id:0,price:200,ad_num:0,friend_num:0},4:{img:"knife_3",boss_id:0,price:200,ad_num:0,friend_num:0},5:{img:"knife_4",boss_id:0,price:200,ad_num:0,friend_num:0},6:{img:"knife_5",boss_id:0,price:200,ad_num:0,friend_num:0},7:{img:"knife_6",boss_id:0,price:200,ad_num:0,friend_num:0},8:{img:"knife_7",boss_id:0,price:200,ad_num:0,friend_num:0},9:{img:"knife_8",boss_id:0,price:200,ad_num:0,friend_num:0},10:{img:"knife_9",boss_id:0,price:200,ad_num:0,friend_num:0},11:{img:"knife_10",boss_id:0,price:200,ad_num:0,friend_num:0},12:{img:"knife_11",boss_id:0,price:200,ad_num:0,friend_num:0},13:{img:"knife_12",boss_id:0,price:200,ad_num:0,friend_num:0},14:{img:"knife_13",boss_id:0,price:200,ad_num:0,friend_num:0},15:{img:"knife_14",boss_id:0,price:200,ad_num:0,friend_num:0},16:{img:"knife_15",boss_id:0,price:200,ad_num:0},17:{img:"knife_16",boss_id:0,price:200,ad_num:0},18:{img:"knife_17",boss_id:0,price:200,ad_num:0},19:{img:"knife_18",boss_id:0,price:200,ad_num:0},20:{img:"knife_19",boss_id:0,price:200,ad_num:0},21:{img:"knife_20",boss_id:0,price:200,ad_num:0},22:{img:"knife_21",boss_id:0,price:200,ad_num:0},23:{img:"knife_22",boss_id:0,price:200,ad_num:0},24:{img:"knife_23",boss_id:0,price:200,ad_num:0},25:{img:"knife_24",boss_id:0,price:200,ad_num:0},26:{img:"knife_25",boss_id:0,price:200,ad_num:0},100:{img:"knife_10000",boss_id:1e4,price:0,ad_num:0},101:{img:"knife_10001",boss_id:10001,price:0,ad_num:0},102:{img:"knife_10002",boss_id:10002,price:0,ad_num:0},103:{img:"knife_10003",boss_id:10003,price:0,ad_num:0},200:{img:"knife_20000",boss_id:2e4,price:0,ad_num:0},201:{img:"knife_20001",boss_id:20001,price:0,ad_num:0},202:{img:"knife_20002",boss_id:20002,price:0,ad_num:0},203:{img:"knife_20003",boss_id:20003,price:0,ad_num:0},300:{img:"knife_30000",boss_id:3e4,price:0,ad_num:0},301:{img:"knife_30001",boss_id:30001,price:0,ad_num:0},302:{img:"knife_30002",boss_id:30002,price:0,ad_num:0},303:{img:"knife_30003",boss_id:30003,price:0,ad_num:0},400:{img:"knife_40000",boss_id:4e4,price:0,ad_num:0},401:{img:"knife_40001",boss_id:40001,price:0,ad_num:0},402:{img:"knife_40002",boss_id:40002,price:0,ad_num:0},500:{img:"knife_50000",boss_id:5e4,price:0,ad_num:0},501:{img:"knife_50001",boss_id:50001,price:0,ad_num:0},502:{img:"knife_50002",boss_id:50002,price:0,ad_num:0},600:{img:"knife_60000",boss_id:6e4,price:0,ad_num:0},601:{img:"knife_60001",boss_id:60001,price:0,ad_num:0},700:{img:"knife_70000",boss_id:7e4,price:0,ad_num:0},701:{img:"knife_70001",boss_id:70001,price:0,ad_num:0},1001:{img:"knife_10000001",boss_id:10000001,price:0,ad_num:0},1002:{img:"knife_10000002",boss_id:10000002,price:0,ad_num:0},1003:{img:"knife_10000003",boss_id:10000003,price:0,ad_num:0},1004:{img:"knife_10000004",boss_id:10000004,price:0,ad_num:0},1005:{img:"knife_10000005",boss_id:10000005,price:0,ad_num:0}};t.exports={getData:function(e){var t=i[e];return t?t.id=e:(t=i[1]).id=1,t},getAllData:function(){return i}},cc._RF.pop()},{}],KnifeIcon:[function(e,t,n){"use strict";cc._RF.push(t,"f6592BiNgFNaJsiYM/iHmyo","KnifeIcon"),cc.Class({extends:cc.Component,properties:{knife:{default:null,type:cc.Node,serializable:!0}},setSelect:function(e){this.knife.active=e}}),cc._RF.pop()},{}],LevelData:[function(e,t,n){"use strict";cc._RF.push(t,"eba9alkANFG152AdNjg6FHl","LevelData");var i=[{index:1,diamons:[90,180],targetInfo:[{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1}]},{index:2,diamons:[0,60,300],targetInfo:[{count:7,knifes:[],animation:1},{count:7,knifes:[],animation:1},{count:7,knifes:[],animation:1},{count:7,knifes:[],animation:1},{count:7,knifes:[330],animation:1},{count:7,knifes:[30],animation:1}]},{index:3,diamons:[60,90,270,300],targetInfo:[{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,180],animation:2},{count:7,knifes:[0],animation:3},{count:7,knifes:[0],animation:3},{count:7,knifes:[180],animation:3},{count:7,knifes:[180],animation:3}]},{index:4,diamons:[60,270,300],targetInfo:[{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[30,0,330],animation:3},{count:7,knifes:[0,170],animation:3},{count:7,knifes:[0,180],animation:3}]},{index:5,isBoss:1,targetInfo:[{count:12,knifes:[],animation:4,diamons:[0,72,144,216,288],target:1e4},{count:10,knifes:[],animation:4,diamons:[],target:10000001},{count:10,knifes:[],animation:4,diamons:[0,30,60,90,120,150,180],target:10001},{count:10,knifes:[],animation:4,diamons:[],target:10002},{count:10,knifes:[],animation:4,diamons:[],target:10000005},{count:10,knifes:[],animation:4,diamons:[],target:10000003},{count:10,knifes:[],animation:4,diamons:[],target:10000002}],rareInfo:[]},{index:6,diamons:[0,180],targetInfo:[{count:9,knifes:[30,330,150,210],animation:5}]},{index:7,diamons:[90,270],targetInfo:[{count:11,knifes:[0],animation:6},{count:11,knifes:[0,180],animation:7}]},{index:8,diamons:[90,270],targetInfo:[{count:8,knifes:[0,120,240],animation:9},{count:8,knifes:[0,120,240],animation:9},{count:9,knifes:[0,180],animation:8},{count:9,knifes:[0,180],animation:8}]},{index:9,diamons:[90,270],targetInfo:[{count:12,knifes:[0],animation:10},{count:12,knifes:[0],animation:11},{count:12,knifes:[0],animation:12},{count:12,knifes:[0,180],animation:10},{count:12,knifes:[0,180],animation:11},{count:12,knifes:[0,180],animation:12},{count:9,knifes:[0,120,240],animation:10},{count:9,knifes:[0,120,240],animation:11},{count:9,knifes:[0,120,240],animation:12}]},{index:10,isBoss:1,targetInfo:[{count:12,knifes:[0,180],animation:13,diamons:[],target:2e4},{count:12,knifes:[],animation:4,diamons:[],target:10000003},{count:10,knifes:[0,120,240],animation:14,diamons:[60,180,300],target:20001},{count:12,knifes:[],animation:14,diamons:[0,90,180,270],target:20003},{count:12,knifes:[],animation:4,diamons:[],target:10000004},{count:12,knifes:[],animation:14,diamons:[0,90,180,270],target:20002}],rareInfo:[]},{index:11,diamons:[45,135,225],targetInfo:[{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,180],animation:16},{count:13,knifes:[0,180],animation:16}]},{index:12,diamons:[45,135,225],targetInfo:[{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,180],animation:16},{count:13,knifes:[0,180],animation:16}]},{index:13,diamons:[60,90,270,300],targetInfo:[{count:12,knifes:[0,120,240],animation:17},{count:12,knifes:[0,180],animation:18}]},{index:14,diamons:[45,135,225,315],targetInfo:[{count:10,knifes:[0,120,240],animation:17},{count:10,knifes:[0,120,240],animation:18},{count:10,knifes:[0,90,180,270],animation:17},{count:10,knifes:[0,90,180,270],animation:18}]},{index:15,isBoss:1,targetInfo:[{count:9,knifes:[45,117,189,261,333],animation:19,diamons:[81,153,225,297,369],target:3e4},{count:8,knifes:[0,30,150,180,210,330],animation:20,diamons:[55,80,105,130,230,255,280,305],target:30001},{count:12,knifes:[0,180],animation:19,diamons:[90,270],target:30002},{count:12,knifes:[0,180],animation:19,diamons:[90,270],target:30003}]},{index:16,diamons:[0,180],targetInfo:[{count:11,knifes:[30],animation:21},{count:11,knifes:[330,30,150,210],animation:22}]},{index:17,diamons:[45,135,270],targetInfo:[{count:12,knifes:[0,90,180],animation:23},{count:10,knifes:[0,120,240],animation:24}]},{index:18,diamons:[45,135,270],targetInfo:[{count:12,knifes:[0,90,180],animation:25},{count:12,knifes:[0,180],animation:26}]},{index:19,diamons:[60,270,300],targetInfo:[{count:12,knifes:[0,180],animation:27},{count:11,knifes:[330,30,150,210],animation:28}]},{index:20,isBoss:1,targetInfo:[{count:12,knifes:[355,5,85,95,175,185,265,275],animation:29,diamons:[],target:4e4},{count:12,knifes:[],animation:30,diamons:[0,72,144,216,288],target:40001},{count:10,knifes:[],animation:31,diamons:[],target:40002}]},{index:21,diamons:[45,135],targetInfo:[{count:11,knifes:[0,90,180],animation:32},{count:11,knifes:[0,180],animation:33}]},{index:22,diamons:[60,300],targetInfo:[{count:16,knifes:[],animation:32},{count:13,knifes:[],animation:33},{count:13,knifes:[0,90,180],animation:32},{count:13,knifes:[0,180],animation:33}]},{index:23,diamons:[90,270],targetInfo:[{count:13,knifes:[0,180],animation:34},{count:13,knifes:[0,180],animation:35}]},{index:24,diamons:[0,90,180,270],targetInfo:[{count:16,knifes:[],animation:36}]},{index:25,isBoss:1,targetInfo:[{count:9,knifes:[0,90,180,270],animation:37,diamons:[45,135,225,315],target:5e4},{count:20,knifes:[],animation:38,diamons:[0,45,90,135,180,225,270,315],target:50001},{count:18,knifes:[],animation:14,diamons:[0,90,180,270],target:50002}],rareInfo:[]},{index:26,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,180],animation:39},{count:16,knifes:[0,90,180],animation:40}]},{index:27,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,90,180],animation:41},{count:17,knifes:[0,180],animation:42}]},{index:28,diamons:[45,135,225,315],targetInfo:[{count:13,knifes:[0,90,180],animation:43}]},{index:29,diamons:[45,135,225,315],targetInfo:[{count:15,knifes:[0,90,180],animation:44}]},{index:30,diamons:[0,90,180,270],isBoss:1,targetInfo:[{count:18,knifes:[],animation:45,target:6e4}]},{index:31,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,180],animation:47}]},{index:32,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,90,180],animation:48}]},{index:33,diamons:[45,135,225,315],targetInfo:[{count:13,knifes:[30,150,210,330],animation:49}]},{index:34,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0],animation:50}]},{index:35,diamons:[0,90,180,270],isBoss:1,targetInfo:[{count:14,knifes:[30,60,120,150,210,240,300,330],animation:51,target:7e4}]},{index:36,diamons:[45,225,315],test:0,targetInfo:[{count:14,knifes:[0,180],animation:52}]},{index:37,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[30,150,210,330],animation:53}]},{index:38,diamons:[45,135,225,315],targetInfo:[{count:16,knifes:[0,90,180,270],animation:54}]},{index:39,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0],animation:55}]},{index:40,diamons:[30,60,90,150,180,210,270,300,330],isBoss:1,targetInfo:[{count:18,knifes:[0,120,240],animation:56,target:60001}]},{index:41,diamons:[45,225,315],targetInfo:[{count:14,knifes:[0,180],animation:57}]},{index:42,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[30,150,210,330],animation:58}]},{index:43,diamons:[45,135,225,315],targetInfo:[{count:16,knifes:[0,90,180,270],animation:59}]},{index:44,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0],animation:60}]},{index:45,diamons:[30,60,90,150,180,210,270,300,330],isBoss:1,targetInfo:[{count:15,knifes:[0,120,240],animation:61,target:70001}]}],o=function(e){return i.length<=(e-=1)&&(e=i.length-10+(e-i.length)%i.length%10),i[e]};t.exports={getData:o,getLength:function(e){var t=o(e);return t.targetInfo.length+(t.rareInfo?t.rareInfo.length:0)},getLeveCount:function(){return i.length}},cc._RF.pop()},{}],ListItem:[function(e,t,n){"use strict";cc._RF.push(t,"b6237p+1IxD2rSevt+73Nq8","ListItem"),cc.Class({extends:cc.Component,updateItem:function(e,t){}}),cc._RF.pop()},{}],ListView:[function(e,t,n){"use strict";cc._RF.push(t,"3cc05tSy9xLNpEQZY+8R+Js","ListView"),cc.Class({extends:cc.ScrollView,properties:{itemPrefab:cc.Prefab,spacing:0},onLoad:function(){this.lastIndex=0,this.listData=[],this.items=[],this.updateTimer=0,this.lastContentPosY=0,this.itemName=this.itemPrefab.name,this.itemHeight=this.itemPrefab.data.height<=0?100:this.itemPrefab.data.height,this.bufferZone=this.node.height/2*1.2,this.spawnCount=Math.floor(2*this.bufferZone*1.2/this.itemHeight),this.content||(this.content=new cc.Node,this.node.addChild(this.content)),this.content.y=this.node.height/2,this.onItemClickCB=null;for(var e=0;e<this.spawnCount;e++){var t=cc.instantiate(this.itemPrefab);this.content.addChild(t),t.y=-(e+.5)*(this.itemHeight+this.spacing),t.active=!1,this.items.push(t),t.on("click",this._onItemClick.bind(this))}},onItemClick:function(e){this.onItemClickCB=e},_onItemClick:function(e){this.onItemClickCB&&this.onItemClickCB(e.currentTarget.getComponent(this.itemName))},initItems:function(){if(this.items){for(var e=0;e<this.items.length;e++){var t=this.items[e].getComponent(this.itemName);this.items[e].y=-(e+.5)*(this.itemHeight+this.spacing),e<this.listData.length?(t.updateItem(e,this.listData[e]),this.items[e].active=!0):this.items[e].active=!1}this.content.height=this.listData.length*(this.itemHeight+this.spacing)+this.spacing}},removeAllItems:function(){for(var e=0;e<this.items.length;e++)this.items[e].active=!1;this.content.stopAllActions(),this.content.y=0,this.lastContentPosY=0},getItem:function(e){this.items;for(var t=0;t<this.items.length;t++){var n=this.items[t].getComponent(this.itemName);if(n.itemId==e)return n}},setItemsData:function(e){this.listData=e,this.lastContentPosY=0,this.content.y=this.node.height/2,this.initItems()},addItemsData:function(e){this.listData.push.apply(this.listData,e),this.lastIndex+=e.length,this.content.height=this.listData.length*(this.itemHeight+this.spacing)+this.spacing},requestMoreData:function(){},getPositionInView:function(e){var t=e.parent.convertToWorldSpaceAR(e.position);return this.node.convertToNodeSpaceAR(t)},update:function(e){if(cc.ScrollView.prototype.update.call(this,e),this.updateTimer+=e,!(Math.abs(this.lastContentPosY-this.content.y)<this.itemHeight)){this.updateTimer=0;for(var t=this.items,n=this.bufferZone,i=this.content.y<this.lastContentPosY,o=(this.itemHeight+this.spacing)*t.length,a=0;a<t.length;++a){var s=this.getPositionInView(t[a]);if(i){if(s.y<-n&&t[a].y+o<0){t[a].setPositionY(t[a].y+o);var c=t[a].getComponent(this.itemName),r=c.itemId-t.length;0<=r&&r<this.listData.length&&c.updateItem(r,this.listData[r])}}else if(s.y>n&&t[a].y-o>-this.content.height){t[a].setPositionY(t[a].y-o);var l=t[a].getComponent(this.itemName),h=l.itemId+t.length;l.updateItem(h,this.listData[h]),h>this.listData.length-10&&this.requestMoreData()}}this.lastContentPosY=this.content.y}}}),cc._RF.pop()},{}],Loading:[function(e,t,n){"use strict";cc._RF.push(t,"84b63sEjhdFB5sRVRwz6smv","Loading");var i=e("User");cc.Class({extends:cc.Component,properties:{},start:function(){window.FBInstant||this.loadGameScene()},loadGameScene:function(){cc.director.preloadScene("newGame",function(){cc.director.loadScene("newGame")}),i.get().subscribeBot(function(){i.get().createShortcut(function(){})})}}),cc._RF.pop()},{User:"User"}],NetAPI:[function(e,t,n){"use strict";cc._RF.push(t,"9a20eZDwJ1D0KenUTbp3P32","NetAPI");var c=e("NetMgr"),r=e("NetConfig"),i={},o=[];i.getFBSignAsync=function(){return new Promise(function(e,t){o.push({resolve:e,reject:t}),1<o.length||FBInstant.player.getSignedPlayerInfoAsync(JSON.stringify({nickname:FBInstant.player.getName()})).then(function(t){o.forEach(function(e){e.resolve(t)}),o=[]}).catch(function(t){o.forEach(function(e){e.reject(t)}),o=[]})})},i.getPkCountAsync=function(c,e){return new Promise(function(e,t){var n="last_knife_"+c,i=r.wssServer.replace("wss","https").replace("/knife/","/knife_count/"),o=r.serverId,a=new XMLHttpRequest,s=i+"?game_id="+r.game_id+"&platform=instant&game="+r.gameName+"&channel=0&account="+n+"&sign=&serverId="+o;a.open("GET",s),a.onreadystatechange=function(){4==a.readyState&&(200==a.status?e(Number(a.responseText)):(t("request error code : "+a.status),console.log(a.status,a.responseText)))},a.send()})},i.isConnected=function(){return c.isConnected},i.disConnect=function(){return c.disConnect()},i.loginAsync=function(e,t,n,i){return c.loginAsync(e,t,n,i)},i.loadPlayerAsync=function(e){var t={serverSign:e};return c.sendAsync("LoadPlayer",t)},i.FightWithFriendAsync=function(e,t,n,i,o,a){var s={facebookId:e,contextId:t,stake:n,datas:i,anotherChance:o,cdata:""+a};return c.sendAsync("FightWithFriend",s)},i.FightRoundAsync=function(e,t,n,i){var o={fightId:e,useAnotherChance:t,datas:n,round:i};return c.sendAsync("FightRound",o)},i.FightOverAsync=function(e,t,n,i){n={fightId:e,winId:t,datas:n,round:i};return c.sendAsync("FightOver",n)},i.BattleLogAsync=function(){return c.sendAsync("BattleLog",{})},t.exports=i,cc._RF.pop()},{NetConfig:"NetConfig",NetMgr:"NetMgr"}],NetConfig:[function(e,t,n){"use strict";cc._RF.push(t,"e3bae6wAw5BvZcm17R6en68","NetConfig"),t.exports={httpsDomain:"https://cj-api.capjoy.com",wssServer:"wss://game-knife-01.capjoy.com/game/knife/1",serverId:"21101",game_id:11,gameName:"knife",version:0,isDev:DEV},cc._RF.pop()},{}],NetHelper:[function(e,t,n){"use strict";cc._RF.push(t,"96ee1kQtttJwYzaRXOkBUQo","NetHelper");var i={},a=window.GAME_ID;i.postToServer=function(e,t,n){n=n||function(){};var i=new XMLHttpRequest,o="https://fb-api.capjoy.com/"+e;i.open("POST",o),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState){console.log(i.responseText);try{n(JSON.parse(i.responseText))}catch(e){n(i.responseText)}}};var a="";if(t)for(var s=Object.keys(t),c=0;c<s.length;c++)0<c&&(a+="&"),a+=s[c]+"="+t[s[c]];i.send(a),console.log("post ",o),console.log("params ",a)},i.getRanksInfo=function(e,t,n){var i={game_id:a,playerId:e,type:["Instant_games_rankInfo_all","Instant_games_rankInfo_week"],players:t};this.postToServer2("fbapi/v0/get_rankInfo_"+a,i,n)},i.updateRanks=function(e,t,n,i){var o={game_id:a,playerId:e,type:t,rankInfo:JSON.stringify(n)};console.log("Sssss  updateRanksvvupdateRanksupdateRanks"),console.log(o),this.postToServer2("fbapi/v0/update_rankInfo_"+a,o,i)},i.postToServer2=function(e,t,n){n=n||function(){};var i=new XMLHttpRequest,o="https://api.conchgame.com/"+e;i.open("POST",o),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState){console.log(i.responseText);try{n(JSON.parse(i.responseText))}catch(e){n(i.responseText)}}};var a="";if(t)for(var s=Object.keys(t),c=0;c<s.length;c++){0<c&&(a+="&");var r=t[s[c]];if(Array.isArray(r))for(var l=0;l<r.length;l++)0<l&&(a+="&"),a+=s[c]+"="+r[l];else a+=s[c]+"="+r}i.send(a),console.log("post ",o),console.log("params ",a)},i.sendAd=function(e,t,n){this.postToServer2("fbapi/v0/ads/report/"+e+"/"+n+"/"+t,{v:"1.0"})},i.sendShare=function(e,t,n){if(e!=t){var i={playerId:e,sharePlayerId:t,type:n};this.postToServer("api/game/v0/shareUpdate_"+a,i)}};var o=!(i.getShareCount=function(e,t,n){var i={playerId:e,type:t};this.postToServer("api/game/v0/shareGet_"+a,i,function(e){0==e.error?n(e.data.count):n(0)})}),s=!1;i.getFuntionOpen=function(e,t,n){if(s)n(o);else{var i={locale:cc.sys.language,nickname:e,timezoneOffset:(new Date).getTimezoneOffset(),playerId:t,appId:window.appId};this.postToServer("fbapi/v0/testCase_"+a,i,function(e){0==e.error?(o=1==parseInt(e.data),n(o)):n(!1),s=!0})}},t.exports=i,cc._RF.pop()},{}],NetMgr:[function(e,t,n){"use strict";cc._RF.push(t,"44249YSvNJLKKD1UqNoLtsq","NetMgr"),e("ProtoGenerated");var s=e("AdHelper"),i=e("NetConfig"),p=e("crc16"),g={},c=i.httpsDomain,r=i.game_id,l=i.serverId,h=i.wssServer,d=i.gameName,u=i.version,f=i.isDev,m="",y="",v="",I=null,a="wss",A="",T=443,S=null,o={},C={},k=null,b=0,w=0;g.getAccountAsync=function(o,a){return new Promise(function(t,n){if(""==y){o,a;var i=new XMLHttpRequest,e=c+"/instant?game_id="+r+"&platform=instant&game="+d+"&playerId="+o+"&signature="+a;i.open("GET",e),console.log(e),i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status){var e=JSON.parse(i.responseText);m=e.sign,y=e.account,v=e.nickname,0==e.error?t(e):n(e),console.log("getAccount Http",i.responseText,i.status,e)}else n("requesnt error code : "+i.status),console.log(i.status,i.responseText)},i.send()}else t({account:y,sign:m,nickname:v})})},g.getServerListAsync=function(o,a,s,e){return new Promise(function(t,n){if(I)t(I);else{var i=new XMLHttpRequest,e=c+"/serverlist?game_id="+o+"&platform=instant&game="+a+"&channel=0&account="+s+"&isdev="+(DEV?"1":"0");i.open("GET",e),i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status){var e=JSON.parse(i.responseText);0==(I=e).error?e.notice&&e.notice.maintance&&1==e.notice.maintance.maintance?n(e.notice.maintance):t(e):n(e),console.log("getServerListAsync",e)}else n("request error code : "+i.status)},i.send()}})},g.connectAsync=function(e){return new Promise(function(t,n){g.connect(e,null,null,function(e){e?n(e):t()})})},g.loginAsync=function(i,e,o,a){return new Promise(function(t,n){console.log(h),g.connectAsync(h).then(function(){return s.logEvent("net_Version"),g.sendAsync("Version",{})}).then(function(e){if(s.logEvent("net_Login"),e.version==u){var t={account:"last_knife_"+i,serverId:l,signature:m,ssl:!0,facebookId:i,name:o,headUrl:a};return g.sendAsync("Login",t)}throw Error("version not equal")}).then(function(e){_(),t()}).catch(function(e){console.log(e),n(e)})})},g.getTime=function(){return w},g.clearCache=function(){};var _=function(){P(),k=setInterval(function(){g.send("Ping",{upTime:w},function(e){w=e.time})},3e5)},P=function(){k&&(clearInterval(k),k=null)},N=function(e){var t=String.fromCharCode.apply(null,e);return decodeURIComponent(escape(t))};g.isConnected=function(){return!(!S||S.readyState!=WebSocket.OPEN)},g.disConnect=function(){g.close(),g.clearCache(),o={},C={}},g.connect=function(e,t,n,i){A=e||A,T=t||T,a=n||a,g.close();var o=A.startsWith("ws")?A+":"+T:a+"://"+A+":"+T;(S=new WebSocket(o)).binaryType="arraybuffer",S.onopen=function(e){console.log("WebSocket was opened."),i&&i(null),S.onopen=function(){}},S.onmessage=function(e){console.log("response text msg: "+e.data),function(e){var t=new DataView(e),n=t.getUint32(0),i=new DataView(e,4,n-4),o=t.getUint32(n),a=p(new Uint8Array(e),4,n);(a^=65535&i.getUint32(0))!=o&&console.error("crc doesn't consistent: "+a+":"+o);for(var s=i.getUint32(4),c=i.getUint16(8),r=new Uint8Array(c),l=0;l<r.length;l++)r[l]=~i.getUint8(10+l);var h=N(r),d=new Uint8Array(i.buffer,14+c,n-(14+c)),u=g.decodePb(h,d);f&&"Ping"!=h&&console.log("receiveMgs<<<<<<<<",h,u),C[s]&&"function"==typeof C[s]&&(C[s](u),C[s]=null),g.emit(h,u)}(e.data)},S.onerror=function(e){console.log("Send Text fired an error",e),i&&i(e)},S.onclose=function(e){g.clearCache(),g.emit("onclose"),s.logEvent("net_close",{code:e.code,reason:e.reason,wasClean:e.wasClean}),console.log("WebSocket instance closed.")}},g.sendAsync=function(o,a){return new Promise(function(t,e){var n=-1,i=setTimeout(function(){clearTimeout(i),i=null,C[n]=null,e("timeout")},3e4);n=g.send(o,a,function(e){null!=i&&(clearTimeout(i),i=null,t(e))},e)})},g.send=function(e,t,n,i){if(g.isConnected()){C[++b]=n;var o=function(e){for(var t=(e=unescape(encodeURIComponent(e))).split(""),n=[],i=0;i<t.length;i++)n.push(t[i].charCodeAt(0));return new Uint8Array(n)}(e),a=g.encodePb(e,t),s=14+o.length+a.length+4,c=new ArrayBuffer(s),r=new DataView(c),l=0;r.setUint32(l,0),l+=4,r.setUint32(l,b),l+=4,r.setUint32(l,0),l+=4,r.setUint16(l,o.length),l+=2;for(var h=0;h<o.length;h++)r.setUint8(l,~o[h]),l++;for(var d=0;d<a.length;d++)r.setUint8(l,a[d]),l++;r.setUint32(0,l);var u=p(new Uint8Array(c),4,s-4);return u^=65535&b,r.setUint32(l,u),S.send(c),f&&"Ping"!=e&&console.log("sendMgs>>>>>>>",e,t),b}i&&i("socket not connected")},g.emit=function(e,t){o[e]&&o[e].forEach(function(e){e(t)})},g.on=function(e,t){o[e]||(o[e]=[]);var n=o[e].indexOf(t);return 0<=n?(console.warn(e+" push already register for funtion ",t),e+"&"+n):(o[e].push(t),e+"&"+(o[e].length-1))},g.off=function(e,t){if(o[e])if(t){var n=o[e].indexOf(t);0<=n&&o[e].splice(n,1)}else o[e]=[]},g.removeAllPush=function(){o=[]},g.removePush=function(e){var t=e.split("&");2==t.length?o[t[0]]&&t[1]<o[t[0]].length&&o[t[0]].splice(t[1],1):console.log(e+" noticeid is not illgal")},g.close=function(){S&&(S.close(),S=null)},g.decodePb=function(e,t){return protobuf.de(e+".Down",t)},g.encodePb=function(e,t){return protobuf.en(e+".Up",t)},t.exports=g,cc._RF.pop()},{AdHelper:"AdHelper",NetConfig:"NetConfig",ProtoGenerated:"ProtoGenerated",crc16:"crc16"}],NewYearSaleDialog:[function(e,t,n){"use strict";cc._RF.push(t,"818821XJdlAlqUSk9PeCkjF","NewYearSaleDialog");var i=e("PageMgr"),o=e("User"),a=e("AdHelper"),s=e("Utils");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label,price3:cc.Label,timerLabel:cc.Label},onEnable:function(){this.price1.string=o.get().getPrice("apple_box","$2.99"),this.price2.string=o.get().getPrice("apple_60000","$28.99"),this.price3.string=o.get().getPrice("apple_180000_half","$49.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){a.logEvent("pay_shop_click",{itemId:"apple_box"}),o.get().purchase("apple_box",function(){o.get().addDiamon(7500),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(7500),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})},onBuyItem2:function(){a.logEvent("pay_shop_click",{itemId:"apple_60000"}),o.get().purchase("apple_60000",function(){o.get().addDiamon(18e4),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(18e4),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})},onBuyItem3:function(){a.logEvent("pay_shop_click",{itemId:"apple_180000_half"}),o.get().purchase("apple_180000_half",function(){o.get().addDiamon(6e5),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_180000_half"})},function(){})},onClose:function(){i.hideDialog("NewYearSaleDialog"),this.data&&this.data.closeCb&&this.data.closeCb()},update:function(){0<o.get().getNewYearLeftTime()&&(this.timerLabel.string=s.formatTimeHMS(o.get().getNewYearLeftTime()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],NoticeDialog:[function(e,t,n){"use strict";cc._RF.push(t,"6bd3b5sKWtBSqbXzeVxxl36","NoticeDialog"),cc.Class({extends:cc.Component,properties:{headSp:cc.Sprite},start:function(e){var n=this;console.log("data"),window.FBInstant&&cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e||(n.headSp.spriteFrame=new cc.SpriteFrame(t))})}}),cc._RF.pop()},{}],PKItem:[function(e,t,n){"use strict";cc._RF.push(t,"2f42doFZcdPuICxyGVdLA/N","PKItem");var i=e("ListItem"),o=(e("Utils"),e("PageMgr")),a=e("PrizeData"),s=e("AdHelper"),c={};cc.Class({extends:i,properties:{itemGroup:cc.Node,title:cc.Label,playNode:cc.Node,nudgeNode:cc.Node,playName:cc.Label,playSprite:cc.Sprite,defaultPeople:cc.SpriteFrame,gift:cc.Sprite,timeLabel:cc.Label},ctor:function(){this.labelTexts=["Your Turn:","Friends' Turn:","Suggested friends:"],this.labelColors=["#98EA54","#FEF24C","#32CFEA"]},updateItem:function(e,n){var i=this;if(this.itemId=e,6!=(this.data=n).type)if(this.node.scale=1,this.title.node.active=n.type<3,this.itemGroup.active=3<=n.type,n.type<3)this.title.string=this.labelTexts[n.type],this.title.node.color=cc.hexToColor(this.labelColors[n.type]);else{if(this.playSprite.spriteFrame=this.defaultPeople,n.photo&&cc.loader.load(n.photo,function(e,t){e||i.data!=n||(i.playSprite.spriteFrame=new cc.SpriteFrame(t))}),this.playNode.active=3==n.type||5==n.type,this.nudgeNode.active=4==n.type&&3600<Math.floor(Date.now()/1e3)-this.data.lastActTime&&!c[this.data.fightId]&&""!=this.data.contextId,this.playName.string=n.nickname,this.gift.node.active=3==n.type||4==n.type,this.timeLabel.string="",this.data.leftTime<43200&&4==n.type){var t=Math.floor(this.data.leftTime/3600)+"H:"+Math.floor(this.data.leftTime/60%60)+"M";this.timeLabel.string=t}var o=a.getData(this.data.stake);o&&o.img&&cc.loader.loadRes("stakes/"+o.img,function(e,t){e||(i.gift.spriteFrame=new cc.SpriteFrame(t))})}else this.node.scale=0},onPlayClick:function(){if(FBInstant){s.logEvent("pkitem_play"),o.showLoading();var e=this.data,t=function(){e.contextId=FBInstant.context.getID(),e.round=e.round||1,o.hideLoading(),o.getPage(o.PKPAGE).getComponent("PKPage").entryPKGame(e)};FBInstant.context.createAsync(this.data.opponentFacebookId).then(t).catch(function(e){console.log(e),"SAME_CONTEXT"!=e.code?o.hideLoading():t()})}},onNudgeClick:function(){var n=this;if(FBInstant){s.logEvent("pkitem_nudge"),o.showLoading();var i=this.data;o.getPageAsync("GameDuel").then(function(e){var t=e.getComponent("GameDuel");FBInstant.context.switchAsync(i.contextId).then(function(){return t.preparePkAsync(i)},function(e){if("SAME_CONTEXT"==e.code)return t.preparePkAsync(i);throw new Error("switchAsync fail")}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(){t.getScreenImageAsync(-1,!1,[]).then(function(e){var t=function(){o.hideLoading(),c[i.fightId]=!0,n.nudgeNode.active=!1,o.showTip("Message sent!"),setTimeout(function(){o.hideTip()},2e3)};FBInstant.updateAsync({action:"CUSTOM",cta:"PLAY NOW",template:"pk_turn",text:FBInstant.player.getName()+" is waiting for you!It's your turn!",image:e,data:{isPk:!0,fightId:i.fightId,from:"pk"},strategy:"IMMEDIATE",notification:"PUSH"}).then(t,t)}).catch(function(e){console.log(e),o.hideLoading(),o.hideTip()})})}).catch(function(e){console.log(e),o.hideLoading(),o.hideTip()})})}}}),cc._RF.pop()},{AdHelper:"AdHelper",ListItem:"ListItem",PageMgr:"PageMgr",PrizeData:"PrizeData",Utils:"Utils"}],PKLevelData:[function(e,t,n){"use strict";cc._RF.push(t,"64936zCsRZNK4uQD+3MUBr5","PKLevelData");var i=[{index:1,animation:1,target:1,knifes:[[0,180],[30,330],[0,90]],diamons:[[90,270],[0,180],[180,270]]}];t.exports={getData:function(e){return i[e-1]}},cc._RF.pop()},{}],PKPage:[function(e,t,n){"use strict";cc._RF.push(t,"5c2c8ZBKRBJzrnF63EcdkKo","PKPage");var p=e("AdHelper"),g=e("PageMgr"),i=e("ListView"),a=e("PushAPI"),f=e("NetAPI"),m=e("User");cc.Class({extends:cc.Component,properties:{listView:i,connectTip:cc.Node,pkrecordDialog:cc.Node,ruleDialog:cc.Node,historyList:i,redMark:cc.Node},onLoad:function(){},onEnable:function(){this.pkrecordDialog.active=!1,this.getComponent(cc.Animation).play("pkpageopen"),this.listView.node.stopAllActions(),this.listView.node.y=-cc.winSize.height,this.listView.node.runAction(cc.moveTo(.1,this.listView.node.x,-142))},onReconnect:function(){g.showLoading(),this.connectServer()},onReconnectClose:function(){g.showPage(g.HOME)},homeConnectServer:function(e){this.isConnected?e():(this.isConnected=!0,this.node.active=!0,this.isConnected=!1,this.connectServer(null,null,null,e),this.node.active=!1)},connectServer:function(t,s,c,r){var l=this;if(console.log("sign, fightId, isNewMatch",t,s,c,this.isConnecting),!this.isConnecting){this.connectTip.active=!1,this.isConnecting=!0,this.playerId=0,this.myTurnData=[],this.friendsTurnData=[],this.suggestedData=[],this.friendsPlayer={},this.friendsInMatch={},this.lastBlockedFacebookId=null;var h=function(e){var t={contextId:e.contextId,fightId:e.fightId,leftTime:e.leftTime,lastActTime:e.lastActTime,myDatas:e.myDatas,opponentDatas:e.opponentDatas,opponentFacebookId:e.opponentFacebookId,round:e.round,stake:e.stake,anotherChance:e.anotherChance,turnPlayerId:e.turnPlayerId,opponentPlayerId:e.opponentPlayerId,promoterPlayerId:e.promoterPlayerId,photo:null,nickname:"opponent",randomIndex:parseInt(e.cdata)},n=l.friendsPlayer[e.opponentFacebookId];n&&(t.photo=n.getPhoto(),t.nickname=n.getName(),l.friendsInMatch[e.opponentFacebookId]=!0,e.turnPlayerId==l.playerId?l.myTurnData.push(t):l.friendsTurnData.push(t))},d=function(e){for(var t in l.myTurnData)if(l.myTurnData[t].fightId==e)return l.lastBlockedFacebookId=l.myTurnData[t].opponentFacebookId,l.myTurnData.splice(t,1)[0];for(var n in l.friendsTurnData)if(l.friendsTurnData[n].fightId==e){var i=l.friendsTurnData.splice(n,1)[0];return o(i.opponentFacebookId),i}},o=function(e){var t=!1;for(var n in l.myTurnData)l.myTurnData[n].opponentFacebookId==e&&(t=!0);for(var i in l.friendsTurnData)l.friendsTurnData[i].opponentFacebookId==e&&(t=!0);l.friendsInMatch[e]=t};this.updateFacebookId=o;var u=function(){for(var e in l.suggestedData=[],l.friendsPlayer)l.friendsInMatch[e]||l.suggestedData.push({opponentFacebookId:l.friendsPlayer[e].getID(),photo:l.friendsPlayer[e].getPhoto(),nickname:l.friendsPlayer[e].getName()})};a.removeAllNotice(),a.SocketCloseNotice(function(e){console.log("SocketCloseNotice"),l.isConnected=!1,l.connectTip.active=!0}),a.TextNotice(function(e){}),a.UpdateBattleNotice(function(e){e.items.forEach(function(e){d(e.fightId),h(e)}),u(),l.updateList()}),a.DeleteBattleNotice(function(e){e.ids.forEach(function(e){d(e)}),u(),l.updateList()}),a.BattleTimeoutNotice(function(e){}),a.NewBattleLogNotice(function(e){l.redMark.active=0<e.count}),g.showLoading("Connecting Server"),f.loginAsync(FBInstant.player.getID(),"",FBInstant.player.getName(),FBInstant.player.getPhoto()).then(function(){return p.logEvent("deul_loginAsync"),console.log("login success"),new Promise(function(e,t){m.get().getConnectedPlayersAsync(e,t)})}).then(function(e){return e.forEach(function(e){l.friendsPlayer[e.getID()]=e}),p.logEvent("pk_friend_count",{count:e.length}),f.loadPlayerAsync(t)}).then(function(e){l.isConnecting=!1,l.isConnected=!0,p.logEvent("net_loadPlayer"),l.playerId=e.playerId,l.fightId=e.fightId||s;var t=e.datas;l.redMark.active=0<e.newBattlelog,l.timeoutOverDatas=e.timeoutOverDatas;for(var n=l.friendsTurnData.length-1;0<=n;n--){var i=l.friendsTurnData[n];d(i.fightId),h(i)}if(t.forEach(function(e){h(e)}),u(),l.updateList(),c)l.createNewMatchAsync().then(g.hideLoading,function(){g.showPage(g.PKPAGE),g.hideLoading()});else{if(l.fightId){for(var o in g.hideLoading(),l.myTurnData)if(l.myTurnData[o].fightId==l.fightId)return void l.entryPKGame(l.myTurnData[o]);for(var a in l.friendsTurnData)if(l.friendsTurnData[a].fightId==l.fightId)return g.showPage(g.PKPAGE),void g.showDialog(g.TIPDIALOG)}else g.hideLoading();r&&r()}}).catch(function(e){p.logEvent("deul_error",{code:e.code}),console.log(e),g.hideLoading(),l.isConnecting=!1,l.isConnected=!1,l.connectTip.active=!0,r&&r(e)})}},updateList:function(){var t=[];0<this.myTurnData.length&&t.push({type:0}),this.myTurnData.forEach(function(e){e.type=3,t.push(e)}),0<this.friendsTurnData.length&&t.push({type:1}),this.friendsTurnData.forEach(function(e){e.type=4,t.push(e)}),0<this.suggestedData.length&&t.push({type:2}),this.suggestedData.forEach(function(e){e.type=5,t.push(e)});for(var e=t.length;e<11;e++)t.push({type:6});this.listView.setItemsData(t)},onNewGame:function(){var e=this;FBInstant&&(g.showLoading(),p.logEvent("new_game_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"],minSize:2,maxSize:2}).then(function(){return p.logEvent("new_game_choose_success"),e.createNewMatchAsync()}).then(g.hideLoading).catch(g.hideLoading))},entryPKGame:function(t){console.log("entryPKGame",t),g.showLoading(),g.getPageAsync("GameDuel").then(function(e){e.getComponent("GameDuel").preparePkAsync(t).then(function(){g.hideLoading(),g.showPage("GameDuel")}).catch(function(e){g.hideLoading(),console.log(e)})}),this.lastBlockedFacebookId&&t.opponentFacebookId!=this.lastBlockedFacebookId&&(this.updateFacebookId(this.lastBlockedFacebookId),this.lastBlockedFacebookId=null)},createNewMatchAsync:function(){var l=this;return new Promise(function(c,r){FBInstant.context.getPlayersAsync().then(function(e){var t,n="OPPONENT",i="",o=null,a=FBInstant.context.getID();for(var s in e)if(e[s].getID()!=FBInstant.player.getID()){n=e[s].getName(),i=e[s].getID(),o=e[s].getPhoto();break}l.friendsInMatch[i]?(g.showTip("A match is already in progress!"),setTimeout(function(){g.hideTip()},3e3),r()):(t={contextId:a,opponentFacebookId:i,nickname:n,photo:o,stake:1,round:1,datas:[]},l.entryPKGame(t),c(),p.logEvent("pk_choose_opponent",{isNew:""==i}))}).catch(function(e){console.log(e),r()})})},onClose:function(){g.showPage(g.HOME),f.disConnect(),this.isConnected=!1},onHistory:function(){var o=this;p.logEvent("history_show"),this.pkrecordDialog.active=!0,this.pkrecordDialog.active=!1,this.redMark.active=!1,g.showLoading(),f.BattleLogAsync().then(function(e){for(var t=[],n=e.datas.length-1;0<=n;n--){var i=o.friendsPlayer[e.datas[n].opponentFacebookId];t.push({stake:e.datas[n].stake,photo:i?i.getPhoto():null,nickname:i?i.getName():null,timestamp:e.datas[n].overTime,winId:e.datas[n].winId,opponentPlayerId:e.datas[n].opponentPlayerId,promoterPlayerId:e.datas[n].promoterPlayerId,myPlayerId:o.playerId,myDatas:e.datas[n].myDatas,opponentDatas:e.datas[n].opponentDatas,round:e.datas[n].round})}o.historyList.setItemsData(t),o.pkrecordDialog.active=!0,g.hideLoading()})},onHistoryClose:function(){this.pkrecordDialog.active=!1},onRuleOpen:function(){p.logEvent("rule_show"),this.ruleDialog.active=!0},onRuleClose:function(){this.ruleDialog.active=!1}}),cc._RF.pop()},{AdHelper:"AdHelper",ListView:"ListView",NetAPI:"NetAPI",PageMgr:"PageMgr",PushAPI:"PushAPI",User:"User"}],PKRecordItem:[function(e,t,n){"use strict";cc._RF.push(t,"cf33cg6HqZApZ69chlY6eLl","PKRecordItem");var i=e("ListItem"),v=e("PageMgr"),I=e("PrizeData"),A=e("AdHelper");cc.Class({extends:i,properties:{playName:cc.Label,resultLabel:cc.Label,playSprite:cc.Sprite,defaultPeople:cc.SpriteFrame,gift:cc.Sprite,time:cc.Label},ctor:function(){this.labelTexts=["Your Turn:","Friends' Turn:","Suggested friends:"],this.labelColors=["#9af737","#fcf300","#06cdeb"]},updateItem:function(e,n){var i=this;this.itemId=e,this.data=n,this.playSprite.spriteFrame=this.defaultPeople,n.photo&&cc.loader.load(n.photo,function(e,t){e||i.data!=n||(i.playSprite.spriteFrame=new cc.SpriteFrame(t))});var t=I.getData(this.data.stake);t&&t.img&&cc.loader.loadRes("stakes/"+t.img,function(e,t){e||(i.gift.spriteFrame=new cc.SpriteFrame(t))}),this.resultLabel.string="DRAW",this.resultLabel.node.color=cc.hexToColor("#4ba4ff"),this.data.winId==this.data.opponentPlayerId&&(this.resultLabel.string="LOSE",this.resultLabel.node.color=cc.hexToColor("#c8c8c8")),this.data.winId==this.data.myPlayerId&&(this.resultLabel.string="WIN",this.resultLabel.node.color=cc.hexToColor("#ffe400"));var o=new Date(1e3*this.data.timestamp);this.time.string=o.getMonth()+1+"/"+o.getDate()+" "+o.getHours()+":"+o.getMinutes()},onPlayClick:function(){if(FBInstant){v.showLoading();var e=this.data,t=function(){e.contextId=FBInstant.context.getID(),e.round=e.round||1,v.getPage(v.PKPAGE).getComponent("PKPage").entryPKGame(e),v.hideLoading()};FBInstant.context.createAsync(this.data.opponentFacebookId).then(t).catch(function(e){console.log(e),"SAME_CONTEXT"!=e.code?v.hideLoading():t()})}},onShareClick:function(){var m=this;if(FBInstant){v.showLoading();var y=this.data;v.getPageAsync("GameDuel",!0).then(function(e){var t=e.getComponent("GameDuel"),n=0==y.winId,i=m.data.winId==m.data.myPlayerId,o=FBInstant.player.getName(),a=o,s=y.nickname,c=y.promoterPlayerId==y.myPlayerId,r=I.getData(y.stake),l=i?o:s,h=i?s:o,d=l;A.logEvent("history_share",{isLose:!n&&!i,isWin:i,isDraw:n}),c?a="I":(s=a,a=y.nickname,s="me"),h==o&&(h="I"),l==o&&(l="I",d="me");var u=a+" challenges "+s+" to a duel and the prize is "+r.emoji+".",p=h+" misses the target and thus  "+l+" win."+h+" is obliged to buy "+r.emoji+" for "+d+".",g=" [🤣,🤣,🤣]  Do you want to join this game?",f=u+p+"[😭,😭,😭]  Can you beat him for me ?";i?f=u+p+g:n&&(f=u+"The result is a draw. Great game !"+g),t.preparePkAsync(y).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(){t.getScreenImageAsync(n?-1:y.myDatas.length+y.opponentDatas.length,n,[],i).then(function(e){A.logEvent("share_game",{from:"pk_recored_share"}),FBInstant.shareAsync({intent:"SHARE",text:f,image:e,data:{isPk:!0,from:"pk_recored_share"}}),v.hideLoading()}).catch(function(e){console.log(e),v.hideLoading()})})})})}}}),cc._RF.pop()},{AdHelper:"AdHelper",ListItem:"ListItem",PageMgr:"PageMgr",PrizeData:"PrizeData"}],PKScreen:[function(e,t,n){"use strict";cc._RF.push(t,"80fe6goKdlLxbz/skZuRb7Z","PKScreen"),cc.Class({extends:cc.Component,properties:{pkTop:cc.Node,winTop:cc.Node,leftItem:cc.Node,rightItem:cc.Node,pkLeft:cc.Node,pkRight:cc.Node,winLeft:cc.Node,winRight:cc.Node,target:cc.Node,targetFront:cc.Node,scoreLable:cc.Label,dao1:cc.Node,dao2:cc.Node,dao3:cc.Node,dao4:cc.Node,dao5:cc.Node,dao6:cc.Node,dao7:cc.Node,dao8:cc.Node},onLoad:function(){this.leftDao=[this.dao1,this.dao2,this.dao3,this.dao4],this.rightDao=[this.dao8,this.dao7,this.dao6,this.dao5],this.center=this.pkTop.getChildByName("center"),this.roundLabel=this.center.getChildByName("round").getComponent(cc.Label),this.prize=this.center.getChildByName("coka"),this.pkMe=this.pkLeft.getChildByName("myplayer"),this.pkOpp=this.pkLeft.getChildByName("opponentplayer");var t=this;this.node.on("pre_capture",function(e){t.setInfo(e.detail)})},start:function(){},setDao:function(e,t,n){for(var i=0;i<n.length;i++){var o=n[i].getComponent("RoundDao");i<e?t?o.setMode("white"):o.setMode("black"):o.setMode("none")}},setInfo:function(e){this.infoData=e;var t=this.infoData;if(0<=e.loseIndex||e.isDraw){this.winTop.active=!0,this.pkTop.active=!1;var n=this.winLeft.getChildByName("nv"),i=this.winRight.getChildByName("nv"),o=this.winLeft.getChildByName("prize_2"),a=this.winRight.getChildByName("prize_2"),s=this.winLeft.getChildByName("myplayer"),c=this.winRight.getChildByName("opponentplayer"),r=this.winLeft.getChildByName("myName").getComponent(cc.Label),l=this.winRight.getChildByName("opponentName").getComponent(cc.Label);r.string=t.myName,l.string=t.opponentName;var h=this.pkLeft.getChildByName("headlight"),d=this.pkRight.getChildByName("headlight");t.isDraw?(this.scoreLable.string="DRAW",n.active=!0,i.active=!0,o.active=a.active=!0):t.isMyWin?(n.active=!0,i.active=!1,o.active=!0,a.active=!1,h.active=!0,d.active=!1,this.scoreLable.string=t.myName+" WIN!"):(n.active=!1,i.active=!0,o.active=!1,a.active=!0,h.active=!0,d.active=!1,this.scoreLable.string=t.opponentName+" WIN!");var u=s.getChildByName("jiazaitouxiang").getComponent(cc.Sprite),p=c.getChildByName("jiazaitouxiang").getComponent(cc.Sprite);u.spriteFrame=new cc.SpriteFrame(t.myTexture),p.spriteFrame=new cc.SpriteFrame(t.opponentTexture),o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.stakeTexture),a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.stakeTexture),this.target.x=this.targetFront.x=482,this.target.y=this.targetFront.y=237}else{this.winTop.active=!1,this.pkTop.active=!0;var g=this.pkLeft.getChildByName("myName").getComponent(cc.Label),f=this.pkRight.getChildByName("opponentName").getComponent(cc.Label),m=this.pkLeft.getChildByName("headlight"),y=this.pkRight.getChildByName("headlight"),v=this.pkLeft.getChildByName("myplayer"),I=this.pkRight.getChildByName("opponentplayer"),A=v.getChildByName("singleColor"),T=I.getChildByName("singleColor");this.roundLabel.string="ROUND"+t.round,g.string=t.myName,f.string=t.opponentName,t.isMyTurn?(m.active=!0,y.active=!1,A.active=!1,T.active=!0):(m.active=!1,y.active=!0,A.active=!0,T.active=!1);var S=[0,4,3,2,1];t.isMyTurn?(this.setDao(S[t.round],!0,this.leftDao),this.setDao(S[t.round],!1,this.rightDao)):(this.setDao(S[t.round],!1,this.leftDao),this.setDao(S[t.round],!0,this.rightDao));var C=v.getChildByName("jiazaitouxiang").getComponent(cc.Sprite),k=I.getChildByName("jiazaitouxiang").getComponent(cc.Sprite);C.spriteFrame=new cc.SpriteFrame(t.myTexture),k.spriteFrame=new cc.SpriteFrame(t.opponentTexture),this.prize.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.stakeTexture),this.target.x=this.targetFront.x=482,this.target.y=this.targetFront.y=177}var b=this.leftItem.getComponent("RoundItem"),w=this.rightItem.getComponent("RoundItem");b.setHead(new cc.SpriteFrame(t.myTexture)),w.setHead(new cc.SpriteFrame(t.opponentTexture));this.getRoundNum(t.round);0<=t.loseIndex||t.isDraw?t.isDraw?(b.setData(t.round,!1,t.loseIndex),w.setData(t.round,!1,t.loseIndex)):(this.checkCount(t),console.log(" ==== >>checkCount : ",t.leftCount,t.rightCount),t.isMyWin?(b.setData(t.leftCount,!1,t.leftCount),w.setData(t.rightCount,!0,t.rightCount)):(b.setData(t.leftCount,!0,t.leftCount),w.setData(t.rightCount,!1,t.rightCount))):t.isMyTurn?(b.setData(t.round,!0,t.loseIndex),w.setData(t.round,!1,t.loseIndex)):(b.setData(t.round,!1,t.loseIndex),w.setData(t.round,!0,t.loseIndex)),this.target.removeAllChildren();for(var _=0;_<t.knifes.length;_++){var P=t.knifes[_],N=new cc.Node;N.addComponent(cc.Sprite),N.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.knifeTextures[P.id]),N.rotation=P.rotation,this.addKnifeToTarget(N)}},getRoundNum:function(e){return[0,4,7,9][e-1]},addKnifeToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.target,e.rotation=270-t,e.x=0+160*Math.cos(n),e.y=0+160*Math.sin(n)},checkCount:function(e){var t=[4,4,3,3,2,2,1,1],n=[1,2,2,1,1,2,2,1],i=0,o=0;if(e.loseIndex<0)return e.leftCount=0,void(e.rightCount=0);for(var a=e.loseIndex+1,s=0;s<t.length;s++){if(!(0<a-t[s]))return void(1==n[s]?(e.leftCount=a+i-1,e.rightCount=o-1):(e.leftCount=i-1,e.rightCount=a+o-1));a-=t[s],1==n[s]?i+=t[s]:o+=t[s]}}}),cc._RF.pop()},{}],PageMgr:[function(e,t,n){"use strict";cc._RF.push(t,"9d47ek3KiZFCpcwMGuMTbyZ","PageMgr");var i=e("AdHelper"),c=function(){},r={};c.HOME="HOME",c.GAMEMAIN="GAMEMAIN",c.GAMESPIN="GameSpin",c.SETTING="SettingDialog",c.SHOP="ShopDialog",c.PAYSHOP="ShopPage",c.RANK="RankPage",c.RESULT="RESULT",c.POWERUP="PowerUpPage",c.GIFTPAGE="GIFTPAGE",c.INVITE="INVITE",c.INVITETIP="INVITETIP",c.INVITETINVALID="INVITETINVALID",c.NOTICEDIALOG="NoticeDialog",c.PKPAGE="PKPAGE",c.TIPDIALOG="TIPDIALOG",c.MAINTANCEDIALOG="MAINTANCEDIALOG",c.SHOWKNIFE="SHOWKNIFE",c.SHOWINVITEKNIFE="SHOWINVITEKNIFE",c.CONTINUE="CONTINUE",c.TURNTABLE="TurntableDialog",c.POWERINFODIALOG="PowerInfoDialog",c.SPINDIALOG="SpinDialog",c.BESTSHARE="BestShareDialog",c.VSRESULT="VsResultDialog";var o=null,a=null,s=1;c.register=function(e,t){r[e]=t},c.getPage=function(e){return r[e]},c.showPage=function(e){console.log("showPage==",e),o&&o.active&&(o.active=!1,o=null),a&&a.active&&(a.active=!1,a=null),r[e]&&!r[e].active&&(s++,r[e].zIndex=s,r[e].active=!0,i.logEvent("page_show",{name:e})),r[e]?o=r[e]:console.log("page not find ==",e)},c.hidePage=function(e){r[e]&&r[e].active&&(r[e].active=!1,o==r[e]&&(o=null))},c.showDialog=function(e,t){console.log("showDialog==",e),t?r[e]&&!r[e].active&&(s++,r[e].zIndex=s,r[e].active=!0):(a&&a.active&&(a.active=!1,a=null),r[e]&&!r[e].active&&(s++,r[e].zIndex=s,r[e].active=!0,i.logEvent("page_show",{name:e})),r[e]&&(a=r[e]))},c.hideDialog=function(e){r[e]&&r[e].active&&(r[e].active=!1,r[e].emit("close"),a==r[e]&&(a=null))},c.hideAllDialog=function(){a&&a.active&&(a.active=!1,a=null)};var l=null;c.showLoading=function(e,t){c.hideLoading(),c.loading.getChildByName("tip").getComponent(cc.Label).string=e||"",c.loading.active=!0,t||(l=setTimeout(function(){c.hideLoading()},1e4))},c.hideLoading=function(){l&&(clearTimeout(l),l=null),c.loading.active=!1},c.showTip=function(e,t,n,i){t=t||function(){},c.tip.active=!0,c.tip.opacity=255,c.tip.y=n||55,c.tip.getChildByName("label").getComponent(cc.Label).string=e,i||(c.tip.scale=0,c.tip.stopAllActions(),c.tip.runAction(cc.sequence(cc.scaleTo(.3,1).easing(cc.easeBackOut()),cc.callFunc(t))))},c.showPK=function(e){c.tip.active=!0,c.tip.y=-200,c.tip.getChildByName("label").getComponent(cc.Label).string=e,c.tip.stopAllActions(),c.tip.opacity=0,c.tip.runAction(cc.sequence(cc.spawn(cc.fadeTo(.3,255),cc.moveBy(.3,0,100)),cc.delayTime(1),cc.spawn(cc.fadeTo(.3,0),cc.moveBy(.3,0,-100))))},c.showTurn=function(e,t){c.tip.active=!0,c.tip.y=-cc.winSize.height/2-35,c.tip.getChildByName("label").getComponent(cc.Label).string=e,t=t||function(){},c.tip.stopAllActions(),c.tip.opacity=0,c.tip.runAction(cc.sequence(cc.spawn(cc.fadeTo(.3,255),cc.moveBy(.3,0,100)),cc.delayTime(2),cc.spawn(cc.fadeTo(.3,0),cc.moveBy(.3,0,-100)),cc.callFunc(t)))},c.hideTip=function(){c.tip.active=!1};var h=null;c.showAdAnimationIn=function(e){(h=h||cc.find("Canvas/AdMask")).active=!0,h.setLocalZOrder(1001);var t=h.getChildByName("content");t.width=cc.winSize.width,t.height=cc.winSize.height,t.y=-cc.winSize.height,t.stopAllActions(),t.runAction(cc.sequence(cc.moveTo(.3,0,0),cc.delayTime(.8),cc.callFunc(function(){e()})))},c.showAdAnimationOut=function(e){var t=(h=h||cc.find("Canvas/AdMask")).getChildByName("content");t.width=cc.winSize.width,t.height=cc.winSize.height,t.stopAllActions(),t.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.3,0,-cc.winSize.height),cc.callFunc(function(){h.active=!1,e()})))},c.getPageAsync=function(s,t){return new Promise(function(i,o){if(r[s])i(r[s]);else{var e=c.showLoading,a=c.hideLoading;t&&(e=function(e){e&&e()},a=function(e){e&&e()}),e(),cc.loader.loadRes("pagePrefab/"+s,function(e,t){if(e)return a(),console.log("getPageAsync err",s),void o(e);var n=cc.instantiate(t);n.active=!1,cc.find("Canvas/pages").addChild(n),c.register(s,n),i(n),a()})}})},c.showPageAsync=function(n,i){return new Promise(function(t,e){c.getPageAsync(n).then(function(e){i&&e.getComponent(n)&&e.getComponent(n).onUpdateData&&e.getComponent(n).onUpdateData(i),c.showPage(n),t(e)}).catch(function(e){console.log(e)})})},c.showDialogAsync=function(n,i,o){return new Promise(function(t,e){c.getPageAsync(n).then(function(e){c.showDialog(n,o),i&&e.getComponent(n)&&e.getComponent(n).onUpdateData&&e.getComponent(n).onUpdateData(i),t(e)})})};var d=null;c.whiteScreenEffect=function(e){(d=d||cc.find("Canvas/whitescreen")).active=!0,d.opacity=0,d.stopAllActions(),d.runAction(cc.sequence(cc.fadeIn(.15),cc.fadeOut(.15),cc.callFunc(function(){e(),d.active=!1})))},t.exports=c,cc._RF.pop()},{AdHelper:"AdHelper"}],PageRegister:[function(e,t,n){"use strict";cc._RF.push(t,"e9b6d7esm9F9ajL5Fup2YB0","PageRegister"),e("GameConfig"),window.VERSION=GameVersion;var i={},s=(e("md5"),e("TaskMgr")),c=e("Utils"),r=e("NetHelper");window.part1="3415",window.sendReport=function(e){try{if(i[e.message])return;if(console.log(e),i[e.message]=!0,window.FBInstant){var t={game:"knife",version:window.VERSION,type:"code_error",msg:e.message+"\n"+e.stack,url:e.source,line:e.line,col:e.colno,error:e.stack},n=new XMLHttpRequest;n.open("POST","https://client-report.capjoy.com:1443/api/v1/logs/"),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(JSON.stringify(t)),console.log("sendReported")}}catch(e){}},window.addEventListener&&window.addEventListener("error",function(e){sendReport({message:e.message,source:e.filename,stack:e.error&&e.error.stack,line:e.lineno,colno:e.colno})});var l=e("PageMgr"),h=e("SoundMgr"),d=e("User"),u=e("AdHelper"),o=e("KnifeData");cc.Class({extends:cc.Component,properties:{game:cc.Prefab,home:cc.Prefab,result:cc.Prefab,showKnife:cc.Prefab,continue:cc.Prefab,gift:cc.Prefab,inviteKnife:cc.Prefab,inviteInvalid:cc.Prefab,pkfriend:cc.Prefab,tipDialog:cc.Prefab,loading:cc.Node,tip:cc.Node,loadingPage:cc.Node},onLoad:function(){window.part2="a003e21f95e",this.isFbStart=!1,this.loading.setLocalZOrder(1e3),l.loading=this.loading,l.tip=this.tip,window.FBInstant=window.FBInstant||!1,window.FBINIT=window.FBINIT||!1,this.preLoadSounds(),this.loadAllPages(),cc.director.setDisplayStats(!1),DEV&&this.showDebugConsole(),FBInstant||this.loadUserData()},showDebugConsole:function(){if(window.document&&cc.sys.isMobile){var e=document.createElement("script");e.async=!0,e.src="vconsole.min.js";e.addEventListener("load",function(){new VConsole},!1),document.body.appendChild(e)}},preLoadSounds:function(){window.part3="4673f549";for(var e=[h.CLICK,h.THROW,h.HIT,h.HIT_LAST,h.HIT_LAST_SPECIAL,h.BOSS_FIGHT,h.KNIFE_HIT,h.APPLE_HIT,h.CONITINUE_TIMER,h.GAME_OVER,h.STAGE_PASS_1,h.STAGE_PASS_2,h.STAGE_PASS_3,h.STAGE_PASS_4,h.STAGE_PASS_5],t=0;t<e.length;t++)h.preLoad(e[t],function(){0});cc.sys.os==cc.sys.OS_IOS&&h.preLoad("iosidle",function(e,t){e?cc.log(e):cc.audioEngine.play(t,!0,0)})},loadAllPages:function(){var e=0;this.register(l.HOME,this.home),e++,this.setProgress(e/21),this.register(l.GAMEMAIN,this.game),e++,this.setProgress(e/21),this.register(l.RESULT,this.result),e++,this.setProgress(e/21),this.register(l.SHOWKNIFE,this.showKnife),e++,this.setProgress(e/21),this.register(l.CONTINUE,this.continue),e++,this.setProgress(e/21),this.register(l.GIFTPAGE,this.gift),e++,this.setProgress(e/21),this.register(l.INVITETINVALID,this.inviteInvalid),e++,this.setProgress(e/21),this.register(l.PKPAGE,this.pkfriend),e++,this.setProgress(e/21),this.register(l.TIPDIALOG,this.tipDialog),e++,this.setProgress(e/21),this.register(l.SHOWINVITEKNIFE,this.inviteKnife),e++,this.setProgress(e/21)},loadUserData:function(){var e=d.get(),n=this;e.load(function(){n.setProgress(1);var e=d.get().getCurKnife(),t=o.getData(e);cc.loader.loadRes("shadows/"+t.img,function(e,t){if(e)return console.log("error",e),void n.preStartGame(function(){n.startGame()});l.getPage(l.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(new cc.SpriteFrame(t)),n.preStartGame(function(){n.startGame()})})})},preStartGame:function(e){h.preLoad("ui/maozi",function(){e()})},startGame:function(){var e=this;if(window.part4="86d63c7e2",FBInstant){FBInstant.onPause(function(){console.log("Pause event was triggered!")});var t=FBInstant.context.getID(),n=FBInstant.context.getType(),i=FBInstant.player.getName(),o=FBInstant.player.getID(),a=FBInstant.getEntryPointData();this.entryGame(),u.loadAsync(),u.loadVideoAsync(),this.setPush(),d.get().initPay(),d.get().sendFriendEvent();var s="facebook";if(a){s=a.from||a.type;var c=!1;0==d.get().getMaxStage()&&(c=!0,a.switchGameInfo&&r.sendAd(a.switchGameInfo.appId,o,window.appId),a.shareType&&r.sendShare(o,a.playerId,a.shareType)),a.boss&&u.logEvent("boss_entry",{boss:a.boss,type:n,isNewUser:c?"new":"old"})}u.logEvent("entry_game",{from:s,index:d.get().getVersion()}),FBInstant.getEntryPointAsync().then(function(e){u.logEvent(0==d.get().getMaxStage()?"NewEntry":"ActiveEntry",{ContextType:n,EntryPoint:e}),window.ContextType=n,window.EntryPoint=e,"THREAD"!=n||"feed"!=e&&"facebook_gaming_tab"!=e&&"in_game_menu"!=e&&"bookmark"!=e||d.get().getContextPlayers(function(e){console.log("getContextPlayers count",e.length),0==e.length||a&&a.switchGameInfo?window.isInTournament=!1:(window.isInTournament=!0,window.entryContextId=t,2==e.length&&TournamentMgr.onUserJoinTournament(t,e))})}),r.getFuntionOpen(i,o,function(){e.tickContextChange()})}else this.entryGame()},entryGame:function(){this.loadingPage.active=!1,RankUtils.preloadRankDatas(),TournamentMgr.reqTournamentIds(function(){}),d.get().subscribeBot(function(){d.get().createShortcut(function(){window.FBInstant&&!FBInstant.context.getID()&&0==d.get().getMaxStage()&&FBInstant.postSessionScore(1)})}),s.setTaskIndex(d.get().getTaskIndex()),h.preLoad(h.BACKGROUND,function(){h.playMusic(h.BACKGROUND,!0)});var e=FBInstant&&FBInstant.getEntryPointData();if(console.log("entryPointData",e),e&&e.isPk){var t=e.sign,n=e.fightId,i=e.isNewMatch;l.getPage(l.PKPAGE).getComponent("PKPage").connectServer(t,n,i),l.showPage(l.PKPAGE),l.getPage(l.HOME).getComponent("HomePage").isPkEntry=!0,l.showPage(l.HOME),d.get().markPKOpen(),u.logEvent("pkmessage_clicked")}else if(e&&"sendgift_share"==e.from){l.showPage(l.HOME);var o="cookinggift_"+e.id;if(!localStorage.getItem(o))localStorage.setItem(o,"true"),d.get().addDiamon(e.coin),l.getPage(l.GIFTPAGE).getComponent("GiftPage").setAppleCount(e.coin),l.showDialog(l.GIFTPAGE)}else if(FBInstant&&"THREAD"==FBInstant.context.getType())if(l.showPage(l.HOME),e){var a=e.knifeCount;"end"==e.vsType&&e.battleId||("start"==e.vsType&&e.playerId!=FBInstant.player.getID()?c.playGame({isVS:!0,score:a,rewardCount:e.rewardCount,battleId:e.battleId}):c.playGame({isVS:!0,score:0}))}else c.playGame({isVS:!0,score:0});else l.showPage(l.HOME),5<=d.get().getMaxStage()&&d.get().getConnectedPlayersAsync(function(e){if(d.get().isShowNotice()&&0<e.length)l.showDialogAsync("SendGiftDialog",{players:e});else{l.showDialogAsync(l.NOTICEDIALOG+c.randomSelectOne(["s12","s10","s13","s2","s6"]),{})}},function(e){console.log(e)})},tickContextChange:function(){var n=this;setInterval(function(){if(n.contextId!=FBInstant.context.getID()){n.contextId=FBInstant.context.getID();var e="contextural_rank."+n.contextId;d.get().resetSessionScore();var t=function(){console.log("updateAsync LEADERBOARD"),FBInstant.updateAsync({action:"LEADERBOARD",name:e})};console.log("tickContextChange",n.contextId),FBInstant.getLeaderboardAsync(e).then(function(e){return e.setScoreAsync(window.lastScore,"")}).then(function(){return[t()]}).catch(t)}},3e3)},setProgress:function(e){FBInstant&&FBINIT&&FBInstant.setLoadingProgress(80+20*e)},register:function(e,t){cc.director.getScene();var n=cc.instantiate(t);n.active=!1,this.node.addChild(n),l.register(e,n)},setPush:function(){var n={bg:"img_apple",t:"text_apple",da:{t:"Play Now",u:"game_play",pld:{type:"hours23_da"}},tm:82800,pms:{nk:FBInstant.player.getName()}},i={};if(i.nickname=FBInstant.player.getName(),FBInstant){var o={target:[],tpl:[{bg:FBInstant.player.getPhoto(),t:FBInstant.player.getName()+" has joined the game!",tm:0,bts:[{t:"Play Now",u:"game_play"}]}]};i.playerInfo={head:FBInstant.player.getPhoto(),score:d.get().getMaxScore()},0==d.get().getMaxStage()?(i.newFriend=o,d.get().getConnectedPlayersAsync(function(e){for(var t in e)if(e[t].getID()!=FBInstant.player.getID()&&o.target.push(e[t].getID()),15<t)break;e.length<2&&(n.bts=[{t:"Play Now",u:"game_play",pld:{type:"hours23"}}]),FBInstant.setSessionData(i)},function(e){console.log(e)})):d.get().getConnectedPlayersAsync(function(e){i.friends=d.get().getBotFriendsFilterd(e),e.length<2&&(n.bts=[{t:"Play Now",u:"game_play",pld:{type:"hours23"}}]),FBInstant.setSessionData(i)},function(e){FBInstant.setSessionData(i),console.log(e)})}},update:function(e){FBINIT&&!this.isFbStart&&(this.isFbStart=!0,this.loadUserData())}}),cc._RF.pop()},{AdHelper:"AdHelper",GameConfig:"GameConfig",KnifeData:"KnifeData",NetHelper:"NetHelper",PageMgr:"PageMgr",SoundMgr:"SoundMgr",TaskMgr:"TaskMgr",User:"User",Utils:"Utils",md5:"md5"}],"PageUtil.js":[function(e,t,n){"use strict";cc._RF.push(t,"5e5e4jEdgFGL6yg17x4BOJu","PageUtil.js");var i=e("PageMgr"),o=e("AdHelper"),a=e("Utils");cc.Class({extends:cc.Component,properties:{},openPage:function(e,t){i.showPage(t)},openPageAsync:function(e,t){i.showPageAsync(t)},closePage:function(e,t){i.hidePage(t)},openDialog:function(e,t){i.showDialog(t)},openDialogAsync:function(e,t){i.showDialogAsync(t)},closeDialog:function(e,t){i.hideDialog(t)},noticeShare:function(e,n){o.logEvent("notice_share_click",{name:n}),i.showLoading(),cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e?i.hideLoading():a.getImageAsync("NoticeScreen"+n,function(e){e.getChildByName("mask").getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),e.getChildByName("name").getComponent(cc.Label).string=FBInstant.player.getName()}).then(function(e){o.logEvent("share_game",{from:"notice_share"}),FBInstant.shareAsync({intent:"SHARE",text:"I am challenging this boss, 😓 Are you joining?",image:e,data:{from:"notice_share"}}).then(function(){i.hideLoading(),o.logEvent("notice_share_success",{name:n})}).catch(function(){i.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),i.hideLoading()})})}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",Utils:"Utils"}],PayShop:[function(e,t,n){"use strict";cc._RF.push(t,"b53e0lRnUFOyIY4HQOvqviJ","PayShop");var o=e("User"),i=e("PageMgr"),a=e("AdHelper");cc.Class({extends:cc.Component,properties:{adfreeBtn:cc.Button,removeAdBtn:cc.Button,bothRemove:cc.Button,removeAdPrice:cc.Label,removeContinuePrice:cc.Label,removeBoth:cc.Label,packageLabel:cc.Label,apple_boxLabel:cc.Label,appleCarLabel:cc.Label,packagesLabel:cc.Label,boxsLabel:cc.Label,appleCarsLabel:cc.Label,appleCarsPreLabel:cc.Label,appleCarPreLabel:cc.Label,appleBoxPreLabel:cc.Label,packagesPreLabel:cc.Label,boxsPreLabel:cc.Label},onLoad:function(){this.node.getChildByName("content").scale=cc.winSize.width/640},start:function(){},onEnable:function(){this.updateButtonState(),this.removeAdPrice.string=o.get().getPrice("remove_a_d","$1.99"),this.removeContinuePrice.string=o.get().getPrice("remove_a_continue","$1.99"),this.removeBoth.string=o.get().getPrice("remove_a_both","$2.99"),this.packageLabel.string=o.get().getPrice("apple_package","$1.99");var e=o.get().getPrice("apple_box","$4.99");this.appleBoxPreLabel.string=e.substring(0,1)+(e.substring(1)/.8).toFixed(2),this.apple_boxLabel.string=e;var t=o.get().getPrice("apple_car","$9.99");this.appleCarPreLabel.string=t.substring(0,1)+t.substring(1)/.5,this.appleCarLabel.string=t;var n=o.get().getPrice("apple_25000","$19.99");this.packagesPreLabel.string=n.substring(0,1)+(n.substring(1)/.2).toFixed(2),this.packagesLabel.string=n;var i=o.get().getPrice("apple_60000","$39.99");this.boxsPreLabel.string=i.substring(0,1)+(20*i.substring(1)).toFixed(2),this.boxsLabel.string=i,this.appleCarsPreLabel.string=o.get().getPrice("apple_180000","$99.99"),this.appleCarsLabel.string=o.get().getPrice("apple_180000_half","$49.99")},updateButtonState:function(){this.adfreeBtn.interactable=!o.get().isFreeContinue(),this.removeAdBtn.interactable=!o.get().isAdRemoved(),this.bothRemove.interactable=this.adfreeBtn.interactable&&this.removeAdBtn.interactable},showSuccess:function(){i.showTip("Pay Success"),setTimeout(function(){i.hideTip()},2e3)},onContinueFree:function(){var e=this;o.get().isPayReady()?(a.logEvent("pay_shop_click",{itemId:"remove_a_continue"}),o.get().purchase("remove_a_continue",function(){o.get().setFreeContinue(),e.updateButtonState(),e.showSuccess(),a.logEvent("pay_shop_success",{itemId:"remove_a_continue"})},function(){})):i.showDialog(i.PAYTIP,!0)},onRemoveAd:function(){var e=this;o.get().isPayReady()?(a.logEvent("pay_shop_click",{itemId:"remove_a_d"}),o.get().purchase("remove_a_d",function(){o.get().setRemoveAd(),e.updateButtonState(),e.showSuccess(),a.logEvent("pay_shop_success",{itemId:"remove_a_d"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBothFree:function(){var e=this;o.get().isPayReady()?(a.logEvent("pay_shop_click",{itemId:"remove_a_both"}),o.get().purchase("remove_a_both",function(){o.get().setBothFree(),e.updateButtonState(),e.showSuccess(),a.logEvent("pay_shop_success",{itemId:"remove_a_both"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuyPackage:function(){o.get().isPayReady()?(a.logEvent("pay_shop_click",{itemId:"apple_package"}),o.get().purchase("apple_package",function(){o.get().addDiamon(2e3),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(2e3),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_package"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuyBox:function(){o.get().isPayReady()?(a.logEvent("pay_shop_click",{itemId:"apple_box"}),o.get().purchase("apple_box",function(){o.get().addDiamon(6500),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(6500),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuyCar:function(){if(o.get().isPayReady()){var e="apple_car";a.logEvent("pay_shop_click",{itemId:e}),o.get().purchase(e,function(){o.get().addDiamon(2e4),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(2e4),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:e})},function(){})}else i.showDialog(i.PAYTIP,!0)},onBuy60000:function(){o.get().isPayReady()?(a.logEvent("pay_shop_click",{itemId:"apple_60000"}),o.get().purchase("apple_60000",function(){o.get().addDiamon(8e5),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(8e5),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuy25000:function(){if(o.get().isPayReady()){var e="apple_25000";a.logEvent("pay_shop_click",{itemId:e}),o.get().purchase(e,function(){o.get().addDiamon(1e5),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(1e5),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:e})},function(){})}else i.showDialog(i.PAYTIP,!0)},onBuy180000:function(){if(o.get().isPayReady()){var e="apple_180000_half";a.logEvent("pay_shop_click",{itemId:e}),o.get().purchase(e,function(){o.get().addDiamon(6e5),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:e})},function(){})}else i.showDialog(i.PAYTIP,!0)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],PlayerLvData:[function(e,t,n){"use strict";cc._RF.push(t,"470caVtTZlDRoNwh58uhDOV","PlayerLvData");var i=[100,150,200,250,300,350,400,450,500,600,700,800,900,1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200,2300,2400,2500,2600,2700,2800,2900,3e3,3100,3200,3300,3400,3500,3600,3700,3800,3900,4e3,4100,4200,4300,4400,4500,4600,4700,4800,5e3,5200,5400,5600,5800,6e3,6200,6400,6600,7e3];t.exports={getData:function(e){return i[e-1]},getMaxLv:function(){return i.length}},cc._RF.pop()},{}],PointControl:[function(e,t,n){"use strict";cc._RF.push(t,"6e2fayc6uFDuL21LaVE8EhO","PointControl");var i=e("PointIcon");cc.Class({extends:cc.Component,properties:{point1:{default:null,type:i,serializable:!0},point2:{default:null,type:i,serializable:!0},point3:{default:null,type:i,serializable:!0},point4:{default:null,type:i,serializable:!0}},start:function(){},setCount:function(e){for(var t=0;t<4;t++)this["point"+(t+1)].setSelect(t<e)}}),cc._RF.pop()},{PointIcon:"PointIcon"}],PointIcon:[function(e,t,n){"use strict";cc._RF.push(t,"882dan3hP9FJ477OvHF8zlb","PointIcon"),cc.Class({extends:cc.Component,properties:{pointNode:{default:null,type:cc.Node,serializable:!0}},setSelect:function(e){this.pointNode.active=e},start:function(){}}),cc._RF.pop()},{}],PowerIcon:[function(e,t,n){"use strict";cc._RF.push(t,"2b7fbK2kkhDNoILF8o9Jg4C","PowerIcon"),cc.Class({extends:cc.Component,properties:{icon1:{default:null,type:cc.Node},icon2:{default:null,type:cc.Node,serializable:!0},icon3:{default:null,type:cc.Node,serializable:!0},icon4:{default:null,type:cc.Node,serializable:!0},icon5:{default:null,type:cc.Node,serializable:!0},icon6:{default:null,type:cc.Node,serializable:!0}},setIcon:function(e){this.icon1.active=1==e,this.icon2.active=2==e,this.icon3.active=3==e,this.icon4.active=4==e,this.icon5.active=5==e,this.icon6.active=6==e}}),cc._RF.pop()},{}],PowerInfoDialog:[function(e,t,n){"use strict";cc._RF.push(t,"feff0xtgYpDHpv6yIT549Cx","PowerInfoDialog");var i=e("PowerIcon");cc.Class({extends:cc.Component,properties:{info_txt:cc.Label,info_name:cc.Label,icon:i},start:function(){},setInfo:function(e,t){console.log("-----\x3e : ",e,t);this.info_txt.string=t+["% SECOND CHANCE: A CHANCE TO CONTINUE WHEN YOU MISS A SHOT!","% EXTRA CONTINUE: A CHANCE TO CONTINUE AFTER WATCHING A VIDEO!","% EXTRA APPLES: GET EXTRA APPLES WHEN COLLECTING FREE GIFT!","% GOLDEN APPLE: A CHANCE TO FIND GOLDEN APPLES!","% MORE APPLES: GET MORE APPLES AFTER WATCHING A VIDEO!","% DOUBLE XP: A CHANCE TO GET DOUBLE XP WHEN PLAYING!"][e-1],this.icon.setIcon(e)},onUpdateData:function(e){this.setInfo(e.index,e.num)}}),cc._RF.pop()},{PowerIcon:"PowerIcon"}],PowerUpData:[function(e,t,n){"use strict";cc._RF.push(t,"e99a2e30zlNCpSumGUC/Jgp","PowerUpData");var i=[{lv:1,type:1,data:5},{lv:2,type:2,data:10},{lv:3,type:3,data:5},{lv:4,type:4,data:5},{lv:5,type:5,data:5},{lv:6,type:6,data:5},{lv:7,type:1,data:1},{lv:8,type:2,data:5},{lv:9,type:3,data:5},{lv:10,type:4,data:2},{lv:11,type:5,data:5},{lv:12,type:6,data:2},{lv:13,type:1,data:2},{lv:14,type:2,data:5},{lv:15,type:3,data:5},{lv:16,type:4,data:3},{lv:17,type:5,data:3},{lv:18,type:6,data:2},{lv:19,type:1,data:3},{lv:20,type:2,data:5},{lv:21,type:3,data:5},{lv:22,type:4,data:3},{lv:23,type:5,data:5},{lv:24,type:6,data:2},{lv:25,type:1,data:2},{lv:26,type:2,data:5},{lv:27,type:3,data:5},{lv:28,type:4,data:3},{lv:29,type:5,data:5},{lv:30,type:6,data:1},{lv:31,type:1,data:2},{lv:32,type:2,data:5},{lv:33,type:3,data:5},{lv:34,type:4,data:3},{lv:35,type:5,data:5},{lv:36,type:6,data:2},{lv:37,type:1,data:2},{lv:38,type:2,data:5},{lv:39,type:3,data:5},{lv:40,type:4,data:3},{lv:41,type:5,data:5},{lv:42,type:6,data:2},{lv:43,type:1,data:2},{lv:44,type:2,data:5},{lv:45,type:3,data:5},{lv:46,type:4,data:3},{lv:47,type:5,data:5},{lv:48,type:6,data:2},{lv:49,type:1,data:2},{lv:50,type:2,data:5},{lv:51,type:3,data:5},{lv:52,type:4,data:3},{lv:53,type:5,data:5},{lv:54,type:6,data:2},{lv:55,type:1,data:2},{lv:56,type:2,data:5},{lv:57,type:3,data:5},{lv:58,type:4,data:3},{lv:59,type:5,data:5},{lv:60,type:6,data:2}];t.exports={getData:function(e){return i[e-1]}},cc._RF.pop()},{}],PowerUpItem:[function(e,t,n){"use strict";cc._RF.push(t,"27a1a/u/BlD64cpFFpQAn7w","PowerUpItem");var i=e("PowerIcon"),o=e("PageMgr");e("User");cc.Class({extends:cc.Component,properties:{lock:cc.Node,label:cc.Label,icon:i,item_bg1:cc.Node,item_bg2:cc.Node,label2:cc.Label},start:function(){},setLock:function(e){this.lock.active=e},setIcon:function(e){this.index=e,this.icon.setIcon(e)},setLight:function(e){this.item_bg1.active=e,this.item_bg2.active=!e},setLable:function(e,t){this.num=t,this.label2.string="",this.label.string=e},openDialog:function(){console.log("this.index:",this.index),this.index<1||o.showDialogAsync(o.POWERINFODIALOG,{index:this.index,num:this.num},!0)}}),cc._RF.pop()},{PageMgr:"PageMgr",PowerIcon:"PowerIcon",User:"User"}],PowerUpPage:[function(e,t,n){"use strict";cc._RF.push(t,"1a0d3fv6q1MMIeRfC2y0IXd","PowerUpPage");var l=e("User"),h=e("PlayerLvData");cc.Class({extends:cc.Component,properties:{item:{default:null,type:cc.Prefab},bar:{default:null,type:cc.Node},level:{default:null,type:cc.Label}},start:function(){},onEnable:function(){var e=l.get().getPlayer_lv(),t=l.get().getPlayer_exp(),n=l.get().getChance_second(),i=l.get().getChance_extra(),o=l.get().getChance_giftApple(),a=l.get().getChance_goldApple(),s=l.get().getChance_videoApple(),c=l.get().getChance_doubleXp();this.bar.width=t/h.getData(e)*290,this.level.string="LEVEL "+e;this.node_second||(this.node_second=cc.instantiate(this.item),this.node.addChild(this.node_second),this.node_second.y=155);var r=this.node_second.getComponent("PowerUpItem");1<=e?(r.setLock(!1),r.setLable(n+"% FOR SECOND CHANCE",n),r.setIcon(1)):(r.setLock(!0),r.setLable("POWER-UP 1"),r.setIcon(-1)),r.setLight(!0),this.node_extra||(this.node_extra=cc.instantiate(this.item),this.node.addChild(this.node_extra),this.node_extra.y=this.node_second.y-110);r=this.node_extra.getComponent("PowerUpItem");2<e?(r.setLock(!1),r.setLable(i+"% FOR EXTRA CONTINUE",i),r.setIcon(2)):(r.setLock(!0),r.setLable("POWER-UP 2"),r.setIcon(-1)),r.setLight(!1),this.node_giftApple||(this.node_giftApple=cc.instantiate(this.item),this.node.addChild(this.node_giftApple),this.node_giftApple.y=this.node_extra.y-110);r=this.node_giftApple.getComponent("PowerUpItem");3<e?(r.setLock(!1),r.setLable(o+"% MORE APPLES IN FREE GIFT",o),r.setIcon(3)):(r.setLock(!0),r.setLable("POWER-UP 3"),r.setIcon(-1)),r.setLight(!0),this.node_goldApple||(this.node_goldApple=cc.instantiate(this.item),this.node.addChild(this.node_goldApple),this.node_goldApple.y=this.node_giftApple.y-110);r=this.node_goldApple.getComponent("PowerUpItem");4<e?(r.setLock(!1),r.setLable(a+"% FOR GOLDEN APPLE",a),r.setIcon(4)):(r.setLock(!0),r.setLable("POWER-UP 4"),r.setIcon(-1)),r.setLight(!1),this.node_videoApple||(this.node_videoApple=cc.instantiate(this.item),this.node.addChild(this.node_videoApple),this.node_videoApple.y=this.node_goldApple.y-110);r=this.node_videoApple.getComponent("PowerUpItem");5<e?(r.setLock(!1),r.setLable(s+"APPLES FOR VIDEO",s),r.setIcon(5)):(r.setLock(!0),r.setLable("POWER-UP 5"),r.setIcon(-1)),r.setLight(!0),this.node_doubleXp||(this.node_doubleXp=cc.instantiate(this.item),this.node.addChild(this.node_doubleXp),this.node_doubleXp.y=this.node_videoApple.y-110);r=this.node_doubleXp.getComponent("PowerUpItem");6<e?(r.setLock(!1),r.setLable(c+"% FOR DOUBLE XP",c),r.setIcon(6)):(r.setLock(!0),r.setLable("POWER-UP 6"),r.setIcon(-1)),r.setLight(!1)},onUpgrade:function(e){}}),cc._RF.pop()},{PlayerLvData:"PlayerLvData",User:"User"}],PrizeData:[function(e,t,n){"use strict";cc._RF.push(t,"694f7QqA6JASbxi1sASACPl","PrizeData");var i=[{id:0,img:"prize_1",emoji:"🥤"},{id:1,img:"prize_2",emoji:"🍺"},{id:2,img:"prize_3",emoji:"🍫"},{id:3,img:"prize_4",emoji:"🍗"},{id:4,img:"prize_5",emoji:"🍔"},{id:5,img:"prize_6",emoji:"🍭"}];t.exports={getData:function(e){return i[e]}},cc._RF.pop()},{}],ProtoGenerated:[function(e,t,n){"use strict";if(cc._RF.push(t,"66e7du2HsRMW7x4YQSpb2hV","ProtoGenerated"),window.protobuf){var i=protobuf.Root.fromJSON(JSON.parse('{"options": {"java_outer_classname": "PlayerNetMessage", "java_package": "game.ck.net.message"}, "nested": {"message": {"nested": {"BattleTimeoutNotice": {"fields": {}, "nested": {"Down": {"fields": {"timeoutOverDatas": {"type": "BattleOverInfo", "id": 1, "rule": "repeated"}}}}}, "FightOver": {"fields": {}, "nested": {"Down": {"fields": {}}, "Up": {"fields": {"winId": {"type": "int64", "id": 2}, "datas": {"type": "int32", "id": 3, "rule": "repeated"}, "fightId": {"type": "int64", "id": 1}, "round": {"type": "int32", "id": 4}}}}}, "BattleLog": {"fields": {}, "nested": {"Down": {"fields": {"datas": {"type": "BattleLogInfo", "id": 1, "rule": "repeated"}}}, "Up": {"fields": {}}}}, "BattleInfo": {"fields": {"promoterPlayerId": {"type": "int64", "id": 6}, "contextId": {"type": "string", "id": 4}, "fightId": {"type": "int64", "id": 1}, "stake": {"type": "int32", "id": 8}, "round": {"type": "int32", "id": 7}, "leftTime": {"type": "int32", "id": 3}, "opponentPlayerId": {"type": "int64", "id": 13}, "lastActTime": {"type": "int32", "id": 15}, "myDatas": {"type": "int32", "id": 10, "rule": "repeated"}, "cdata": {"type": "string", "id": 14}, "opponentDatas": {"type": "int32", "id": 11, "rule": "repeated"}, "anotherChance": {"type": "bool", "id": 9}, "createTime": {"type": "int32", "id": 2}, "opponentFacebookId": {"type": "string", "id": 5}, "turnPlayerId": {"type": "int64", "id": 12}}}, "UpdateBattleNotice": {"fields": {}, "nested": {"Down": {"fields": {"items": {"type": "BattleInfo", "id": 1, "rule": "repeated"}}}}}, "Ping": {"fields": {}, "nested": {"Down": {"fields": {"upTime": {"type": "int32", "id": 1}, "time": {"type": "int32", "id": 2}}}, "Up": {"fields": {"upTime": {"type": "int32", "id": 1}}}}}, "FightWithFriend": {"fields": {}, "nested": {"Down": {"fields": {"sign": {"type": "string", "id": 2}}}, "Up": {"fields": {"contextId": {"type": "string", "id": 2}, "stake": {"type": "int32", "id": 3}, "cdata": {"type": "string", "id": 6}, "facebookId": {"type": "string", "id": 1}, "anotherChance": {"type": "bool", "id": 5}, "datas": {"type": "int32", "id": 4, "rule": "repeated"}}}}}, "NewBattleLogNotice": {"fields": {}, "nested": {"Down": {"fields": {"count": {"type": "int32", "id": 1}}}}}, "LoadPlayer": {"fields": {}, "nested": {"Down": {"fields": {"playerId": {"type": "int64", "id": 1}, "newBattlelog": {"type": "int32", "id": 5}, "timeoutOverDatas": {"type": "BattleOverInfo", "id": 3, "rule": "repeated"}, "fightId": {"type": "int64", "id": 4}, "datas": {"type": "BattleInfo", "id": 2, "rule": "repeated"}}}, "Up": {"fields": {"serverSign": {"type": "string", "id": 1}}}}}, "BattleOverInfo": {"fields": {"contextId": {"type": "string", "id": 2}, "winId": {"type": "int64", "id": 4}, "opponentFacebookId": {"type": "string", "id": 3}, "fightId": {"type": "int64", "id": 1}}}, "Version": {"fields": {}, "nested": {"Down": {"fields": {"version": {"type": "int32", "id": 1}, "time": {"type": "int32", "id": 2}}}, "Up": {"fields": {"version": {"type": "int32", "id": 1}}}}}, "DeleteBattleNotice": {"fields": {}, "nested": {"Down": {"fields": {"ids": {"type": "int64", "id": 1, "rule": "repeated"}}}}}, "BattleLogInfo": {"fields": {"promoterPlayerId": {"type": "int64", "id": 3}, "winId": {"type": "int64", "id": 9}, "stake": {"type": "int32", "id": 5}, "overTime": {"type": "int64", "id": 1}, "myDatas": {"type": "int32", "id": 7, "rule": "repeated"}, "timeout": {"type": "bool", "id": 10}, "opponentDatas": {"type": "int32", "id": 8, "rule": "repeated"}, "round": {"type": "int32", "id": 6}, "opponentFacebookId": {"type": "string", "id": 2}, "opponentPlayerId": {"type": "int64", "id": 4}}}, "FightRound": {"fields": {}, "nested": {"Down": {"fields": {}}, "Up": {"fields": {"datas": {"type": "int32", "id": 3, "rule": "repeated"}, "useAnotherChance": {"type": "bool", "id": 2}, "fightId": {"type": "int64", "id": 1}, "round": {"type": "int32", "id": 4}}}}}, "Login": {"fields": {}, "nested": {"Down": {"fields": {}}, "Up": {"fields": {"account": {"type": "string", "id": 1}, "name": {"type": "string", "id": 6}, "ssl": {"type": "bool", "id": 4}, "signature": {"type": "string", "id": 3}, "facebookId": {"type": "string", "id": 5}, "serverId": {"type": "int32", "id": 2}, "headUrl": {"type": "string", "id": 7}}}}}, "TextNotice": {"fields": {}, "nested": {"Down": {"fields": {"msg": {"type": "string", "id": 1}}}}}}}}}'));protobuf.en=function(e,t){var n=i.lookup("message."+e);return n?n.encode(t).finish():null},protobuf.de=function(e,t){var n=i.lookup("message."+e);return n?n.decode(t):null}}else console.log("protobuf is not ready for use");cc._RF.pop()},{}],PushAPI:[function(e,t,n){"use strict";cc._RF.push(t,"95d17T/KNxGkI15ip3FP2UQ","PushAPI");var i=e("NetMgr"),o={removeNotice:function(e){i.removePush(e)},removeAllNotice:function(){i.removeAllPush()},SocketCloseNotice:function(e){return i.on("onclose",e)},TextNotice:function(e){return i.on("TextNotice",e)},UpdateBattleNotice:function(e){return i.on("UpdateBattleNotice",e)},DeleteBattleNotice:function(e){return i.on("DeleteBattleNotice",e)},BattleTimeoutNotice:function(e){return i.on("DeleteBattleNotice",e)},NewBattleLogNotice:function(e){return i.on("NewBattleLogNotice",e)}};t.exports=o,cc._RF.pop()},{NetMgr:"NetMgr"}],RankItem:[function(e,t,n){"use strict";cc._RF.push(t,"4be0ao3MSNKU7XWWLJg6LUI","RankItem");var c=e("KnifeData"),r=e("PageMgr"),l=e("AdHelper"),h=e("Utils");cc.Class({extends:cc.Component,properties:{num1:cc.Node,num2:cc.Node,num3:cc.Node,playerRank:cc.Label,diban:cc.Node,friendBtn:cc.Node,sharedBtn:cc.Node,playerSprite:cc.Sprite,playerName:cc.Label,playerScore:cc.Label,btnLabel:cc.Label,knifeSprite:cc.Sprite,knifeShadowSprite:cc.Sprite,defaultKnife:cc.SpriteFrame,defaultPeople:cc.SpriteFrame},onLoad:function(){},updateItem:function(e,n){this.colors=this.colors||["#ffd366","#7b9bb6","#c5753a"],this.itemId=e,(this.data=n).isFriend=!0,this.reset();var t="id1";window.FBInstant&&(t=FBInstant.player.getID());var i=n.isInvite,o=n.playerId==t;this.btnLabel.string=o?"SHARE":"PLAY",i&&(this.btnLabel.string="INVITE"),this.sharedBtn.active=o,this.friendBtn.active=!o,this.sharedBtn.off("click"),this.sharedBtn.on("click",function(){h.getShareImg(function(e){r.hideLoading(),l.logEvent("share_game",{from:"rank_share"}),FBInstant.shareAsync({intent:"SHARE",text:FBInstant.player.getName()+":Help!🎯🎯🎯🎯🎯🎯",image:e,data:{from:"rank_share"}}).then(function(){r.hideLoading()}).catch(function(){r.hideLoading()})})}),this.friendBtn.off("click"),this.friendBtn.on("click",function(){if(console.log(n.playerId),FBInstant){if(i)return r.showLoading(),l.logEvent("invite_choose_show"),void FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){h.playGame({isVS:!0}),r.hideLoading(),l.logEvent("invite_choose_success")},function(e){e&&"SAME_CONTEXT"==e.code&&h.playGame({isVS:!0}),r.hideLoading()});if(o)return void h.getShareImg(function(e){r.hideLoading(),l.logEvent("share_game",{from:"rank_share"}),FBInstant.shareAsync({intent:"SHARE",text:FBInstant.player.getName()+":Help!🎯🎯🎯🎯🎯🎯",image:e,data:{from:"rank_share"}}).then(function(){l.logEvent("rank_share_success"),r.hideLoading()}).catch(function(){r.hideLoading()})});r.showLoading(),TournamentMgr.stopContextTick(),FBInstant.context.createAsync(n.playerId).then(function(){h.playGame({isVS:!0,score:n.score}),window.isInTournament&&(l.logEvent("tournament_rankplay"),window.isInTournament=!1)}).catch(function(e){e&&"SAME_CONTEXT"==e.code?h.playGame({isVS:!0,score:n.score}):r.hideLoading()})}else r.showLoading(),h.playGame({isVS:!0,score:n.score})}),this.num1.active=1==n.rank,this.num2.active=2==n.rank,this.num3.active=3==n.rank,this.playerRank.node.active=3<n.rank,this.playerRank.string=n.rank;var a=this;if(n.photo&&cc.loader.load(n.photo,function(e,t){e||a.data!=n||(a.playerSprite.spriteFrame=new cc.SpriteFrame(t),a.playerSprite.node.width=a.playerSprite.node.height=70)}),n.costomData){var s=n.costomData;n.rank,a=this;s.knifeId&&c.getData(s.knifeId)&&cc.loader.loadRes("knife/"+c.getData(s.knifeId).img,function(e,t){e?console.log("error",e):(a.knifeSprite.spriteFrame=new cc.SpriteFrame(t),a.knifeShadowSprite.spriteFrame=new cc.SpriteFrame(t))})}this.playerName.string=n.name,n.isFriend,this.playerScore.string=n.score},reset:function(){this.playerSprite.spriteFrame=this.defaultPeople,this.knifeSprite.spriteFrame=this.defaultKnife,this.knifeShadowSprite.spriteFrame=this.defaultKnife}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",PageMgr:"PageMgr",Utils:"Utils"}],RankMgr:[function(t,e,n){"use strict";cc._RF.push(e,"6e54co9BjhN94bZM8bsXDO1","RankMgr");var i=t("NetHelper"),o=function(){function e(){}return e.sortRank=function(e){e.sort(function(e,t){return t.score-e.score});var t=1;e.forEach(function(e){e.rank=t,t++})},e.getPlayerId=function(){var e="id1";return window.FBInstant&&(e=FBInstant.player.getID()),e},e.getPlayerPhoto=function(){var e="id1";return window.FBInstant&&(e=FBInstant.player.getPhoto()),e},e.getPlayerName=function(){var e="id1";return window.FBInstant&&(e=FBInstant.player.getName()),e},e.getRankData=function(e,t){var n=localStorage.getItem("rank_"+window.FB_APPID);if(n&&(n=JSON.parse(n)),n&&(n.time>Date.now()-48e4||!window.FBInstant))return t(n.info||{}),void console.log("from local",n);i.getRanksInfo(this.getPlayerId(),e,function(e){localStorage.setItem("rank_"+window.FB_APPID,JSON.stringify({time:Date.now(),info:e.data})),t(e&&e.data||{})})},e.preloadRankDatas=function(){var a=this;t("User").get().getConnectedPlayersAsync(function(e){for(var t=[],n=0;n<e.length;n++)e[n].getPhoto()&&cc.loader.load(e[n].getPhoto()),t.push(e[n].getID()),a.globalRankData.push({playerId:e[n].getID(),name:e[n].getName(),photo:e[n].getPhoto(),score:0,isFriends:!0,rank:1,customData:{stageNum:0,knifeId:1}}),a.friendsRankData.push({playerId:e[n].getID(),name:e[n].getName(),photo:e[n].getPhoto(),score:0,isFriends:!0,rank:1,customData:{stageNum:0,knifeId:1}});t.push(a.getPlayerId()),a.globalRankData.push({playerId:a.getPlayerId(),photo:a.getPlayerPhoto(),name:a.getPlayerName(),rank:1,score:1,customData:{stageNum:0,knifeId:1},isFriends:!0}),a.friendsRankData.push({playerId:a.getPlayerId(),photo:a.getPlayerPhoto(),name:a.getPlayerName(),rank:1,score:0,customData:{stageNum:0,knifeId:1},isFriends:!0}),a.getRankData(t,function(e){var n=e.Instant_games_rankInfo_all||{},i=e.Instant_games_rankInfo_week||{},o=a.getPlayerId();a.globalRankData.forEach(function(e){if(n[e.playerId]){var t=JSON.parse(n[e.playerId]);e.score=t.score,e.customData=t.extradata,e.playerId==o&&(a.myWorldScore=e.score)}}),a.sortRank(a.globalRankData),a.friendsRankData.forEach(function(e){if(i[e.playerId]){var t=JSON.parse(i[e.playerId]);e.score=t.score,e.customData=t.extradata,e.playerId==o&&(a.myWeekScore=e.score)}}),a.sortRank(a.friendsRankData)})})},e.updateScore=function(e,t){var n=[];e>this.myWeekScore&&(n.push("Instant_games_rankInfo_week"),this.myWeekScore=e),e>this.myWorldScore&&(n.push("Instant_games_rankInfo_all"),this.myWorldScore=e),0!=n.length&&i.updateRanks(this.getPlayerId(),n,{score:e,extradata:t},function(){})},e.getWorldRankData=function(e){var t=this.getPlayerId(),n=this.globalRankData.find(function(e){return e.playerId===t});n?(n.score>=this.myWorldScore||(n.score=1,this.sortRank(this.globalRankData)),e(this.globalRankData)):e([])},e.getFriendsRankData=function(e){var t=this.getPlayerId(),n=this.friendsRankData.find(function(e){return e.playerId===t});n?(n.score>=this.myWeekScore||(n.score=this.myWeekScore,this.sortRank(this.friendsRankData)),e(this.friendsRankData)):e([])},e.globalRankData=[],e.friendsRankData=[],e.myWeekScore=0,e.myWorldScore=0,e}();window.RankUtils=o,cc._RF.pop()},{NetHelper:"NetHelper",User:"User"}],RankPage:[function(e,t,n){"use strict";cc._RF.push(t,"c9ccahVoZVI45CNbZq1F/C8","RankPage");var i=e("User"),o=(e("AdHelper"),e("PageMgr"),e("ListView"));e("Utils");cc.Class({extends:cc.Component,properties:{item:cc.Prefab,rankNode:cc.Node,listview:o,firstSprite:cc.Sprite,defaltFrame:cc.SpriteFrame},onLoad:function(){this.rankNode.scale=cc.winSize.width/640},onEnable:function(){this.friendRankName=i.get().getFriendRankName(),this.requestFriendsData(0)},requestFriendsData:function(e){var t=this;this.isFriendsRequest||(this.isFriendsRequest=!0,RankUtils.getFriendsRankData(function(e){t.listview.setItemsData(e),0<e.length?e[0].photo&&cc.loader.load(e[0].photo,function(e,t){e||(this.firstSprite.spriteFrame=new cc.SpriteFrame(t))}.bind(t)):t.firstSprite.spriteFrame=t.defaltFrame}))}}),cc._RF.pop()},{AdHelper:"AdHelper",ListView:"ListView",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],ResultDialog:[function(e,t,n){"use strict";var i;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cc._RF.push(t,"e44a5Yu64FJRaBxR0NYWQW7","ResultDialog");var a=e("AdHelper"),l=e("PageMgr"),s=e("SoundMgr"),h=e("Utils"),d=e("User"),c=(e("TaskMgr"),e("ListView")),r=e("ImageNumber");cc.Class((o(i={extends:cc.Component,properties:{imageNum:r,diamonLabel:cc.Label,bestNode:cc.Node,shareNode:cc.Node,shareResultNode:cc.Node,shareBtnNode:cc.Node,playerImg:cc.Sprite,playerImg2:cc.Sprite,otherPlayerImg:cc.Sprite,playerScore:cc.Label,playerResultScore1:cc.Label,playerResultScore2:cc.Label,playerName:cc.Label,getTipNode:cc.Node,touchMask:cc.Node,coinNode:cc.Node,rankNode:cc.Node,advideoBtn:cc.Button,spinBtn:cc.Button,slotoBtn:cc.Button,flyingApple:cc.Node,flyingGoldApple:cc.Node,miaoNode:cc.Node,tipNode:cc.Node,vsNode:cc.Node,touramentNode:cc.Node,rankList:c},onLoad:function(){this.rankNode.scale=cc.winSize.width/640,this.resultShowCounter=0},showSpinAnim:function(){var e=this.giftNode.getChildByName("result_spin");this.giftNode.stopAllActions(),e.stopAllActions(),this.giftNode.runAction(cc.sequence(cc.moveTo(.2,cc.winSize.width/2,this.giftNode.y),cc.callFunc(function(){e.runAction(cc.repeatForever(cc.rotateBy(1,20)))})))},onPayPage:function(){a.logEvent("pay_resultshop_click",{payState:d.get().isPayReady()?"YES":"NO"}),l.showDialogAsync(l.PAYSHOP)}},"onPayPage",function(){a.logEvent("shop_resultshop_click"),l.showDialogAsync(l.PAYSHOP)}),o(i,"onTournamentClick",function(){a.logEvent("result_tournament_click"),l.showDialogAsync("TournamentDialog")}),o(i,"onGiftClick",function(){a.logEvent("result_turntable_click"),this.giftNode.active=!1,l.getPageAsync(l.GAMESPIN).then(function(e){l.showLoading(),e.getComponent(l.GAMESPIN).preLoad(function(){l.showDialog(l.GAMESPIN,!0),l.hideLoading()})}).catch(function(){})}),o(i,"onRestart",function(){var e=function(e){a.autoShowAd(function(){h.playGame({isVS:e})})};FBInstant?window.isInTournament?e():d.get().challengeFriends2(e):e()}),o(i,"onTourament",function(){var e=function(e){a.autoShowAd(function(){h.playGame({isVS:e})})};FBInstant&&this.resultShowCounter%3==0?d.get().chooseFriend(e):e()}),o(i,"onShowAd",function(e){var t=this;e.currentTarget.active=!1;a.isVideoLoad()?a.showVideoAd("result_ad",function(){t.showGetGift()},function(){}):a.isInterstitialLoad(),a.logEvent("result_adclick",{isDouble:this.isDoubleApple,type:"reward"})}),o(i,"showGetGift",function(){var e=d.get().addAdDiamon(this.isDoubleApple);this.diamonLabel.string=d.get().getDiamonCount(),l.getPage(l.GIFTPAGE).getComponent("GiftPage").setAppleCount(e),l.showDialog(l.GIFTPAGE,!0)}),o(i,"onInvite",function(e){var n=this;e.currentTarget.active=!1;l.showLoading(),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e?l.hideLoading():h.getImageAsync("InviteScreen",function(e){e.getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}).then(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"PLAY NOW",template:"invite_result",text:"This 🎯 game is awesome! You should try it!😝",image:e,data:{from:"invite_result"},strategy:"IMMEDIATE",notification:"PUSH"}).then(function(){n.showGetGift(),a.logEvent("result_invite_finish"),l.hideLoading()}).catch(function(e){console.log("updateAsync err",e),l.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),l.hideLoading()})})}).catch(function(e){(console.log("chooseAsync err",e),l.hideLoading(),"SAME_CONTEXT"==e.code)&&(l.getPage(l.INVITETINVALID).getChildByName("timer").getComponent(cc.Label).string="LATER",l.showDialog(l.INVITETINVALID,!0))}),a.logEvent("result_inviteclick")}),o(i,"onShare",function(){a.logEvent("result_shareclick"),h.getShareImg(function(e){FBInstant&&(a.logEvent("share_game",{from:"result_share"}),FBInstant.shareAsync({intent:"SHARE",image:e,text:this.isBest?FBInstant.player.getName()+" set a new personal best in Cooking Daily":"Can you beat my score in Cooking Daily ?",data:{myReplayData:"data",from:"result_share"}}).then(function(){console.log("share success")}).catch(function(e){console.log("err",e)}))}.bind(this))}),o(i,"onCloseShare",function(){this.shareDialogNode.active=!1}),o(i,"onEnable",function(){var t=this,e=this.getComponent(cc.Animation);e.once("finished",function(){var e=t.data;FBInstant&&"SOLO"!=FBInstant.context.getType()&&e.isVS&&l.showTip("Sending score...",function(){this.sendMessageToFb()}.bind(t),-cc.winSize.height/2+30),d.get().subscribeBot()}),e.play("resultIPageIn"),s.play(s.GAME_OVER),a.logEvent("result_show",{isDouble:this.isDoubleApple});var n=a.isVideoLoad();this.advideoBtn.interactable=n,this.resultCounter=this.resultCounter||0,this.resultCounter++,this.spinBtn.node.active=!1,this.advideoBtn.node.active=!1,this.slotoBtn.node.active=!1,this.listData&&1<this.listData.length?this.updateRankLocal():this.requstRank()}),o(i,"sendMessageToFb",function(){var e=this,i=this.data;console.log(i);var o=537,a=300,s=(FBInstant.getEntryPointData(),function(){l.showTip("Score sent!",null,-cc.winSize.height/2+30,!0),setTimeout(function(){l.hideTip()},1e3)});if(2<i.playerCount)d.get().updateGroupRank(i.knifeCount,s);else if(i.opponentScore&&0<i.opponentScore){o*=this.shareResultNode.scale,a*=this.shareResultNode.scale;var t=FBInstant.player.getName()+" win",c=FBInstant.player.getID();i.opponentScore>i.knifeCount?(t=i.otherPlayerName+" win",c=i.otherPlayerId):i.opponentScore==i.knifeCount&&(t="Draw");var r=t;if(this.playerResultScore2.string=i.opponentScore,this.shareResultNode.getChildByName("myhat").active=i.opponentScore<i.knifeCount,this.shareResultNode.getChildByName("oherhat").active=i.opponentScore>i.knifeCount,""==i.otherPlayerPhoto)return void s();cc.loader.load(i.otherPlayerPhoto,function(e,t){var n=this;e||(this.otherPlayerImg.spriteFrame=new cc.SpriteFrame(t),setTimeout(function(){n.shareResultNode.active=!0,h.captureScreen(n.shareResultNode,o,a,function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Start New Match",template:"play_turn",text:r,image:e,data:{from:"challenge_result",vsType:"end",winId:c,battleId:i.battleId,rewardCount:i.rewardCount,playerId:i.otherPlayerId,playerName:i.otherPlayerName,playerPhoto:i.otherPlayerPhoto,score:i.knifeCount,otherScore:i.opponentScore,otherPlayerId:FBInstant.player.getID(),otherPlayerName:FBInstant.player.getName(),otherPlayerPhoto:FBInstant.player.getPhoto()},strategy:"IMMEDIATE",notification:"PUSH"}).then(s,s)}.bind(n)),n.shareResultNode.active=!1},0))}.bind(this))}else{var n=this.resultType||"challenge";this.resultType=null,setTimeout(function(){e.shareNode.active=!0,h.captureScreen(e.shareNode,o,a,function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"CHALLENGE",template:"play_turn",text:FBInstant.player.getName()+" has challenged you to a match of Cooking Daily !",image:e,data:{playerId:FBInstant.player.getID(),otherPlayerName:FBInstant.player.getName(),stageNum:i.stageNum,knifeCount:i.knifeCount,otherPlayerPhoto:FBInstant.player.getPhoto(),from:n,battleId:Date.now(),rewardCount:i.rewardCount,vsType:"start"},strategy:"IMMEDIATE",notification:"PUSH"}).then(s,s)}.bind(e)),e.shareNode.active=!1},0)}}),o(i,"updateData",function(e){this.data=e,window.lastScore=e.knifeCount,this.imageNum.setNum(e.knifeCount),this.diamonLabel.string=e.diamonCount,this.playerScore.string=e.knifeCount,this.playerResultScore1.string=e.knifeCount,e.playerTexture&&(this.playerImg.spriteFrame=new cc.SpriteFrame(e.playerTexture),this.playerImg2.spriteFrame=new cc.SpriteFrame(e.playerTexture)),this.isFirstPlay||(this.isFirstPlay=0==d.get().getMaxStage()),this.stageNum=e.stageNum;var t;console.log("result updateScoreAndStage");var n=d.get().isPassSessionScore(e.knifeCount);t=d.get().updateScoreAndStage(e.knifeCount,e.stageNum),this.bestNode.active=t,5<e.stageNum&&a.isInterstitialLoad()&&.3<=Math.random()&&!n&&a.showInterstitialAd(function(){},function(){}),this.shareBtnNode.stopAllActions(),this.shareBtnNode.scale=1,t&&this.shareBtnNode.runAction(cc.sequence(cc.scaleTo(.5,1.1),cc.scaleTo(.5,1)).repeatForever()),FBInstant&&!d.get().isShortCreated()&&FBInstant.canCreateShortcutAsync().then(function(e){e&&(a.logEvent("createShortcut"),FBInstant.createShortcutAsync().then(function(){d.get().markShortCreated(),a.logEvent("createShortcutSuccess")}).catch(function(){}))}),this.vsNode.active=!0,this.touramentNode.active=!1}),o(i,"updateRankLocal",function(e){if(e=e||this.data.knifeCount||0,this.listData){var t=this.listData.find(function(e){return FBInstant&&FBInstant.player.getID()==e.playerId});t&&t.score<e&&(t.score=e),this.listData.sort(function(e,t){return t.score-e.score});for(var n=0;n<this.listData.length;n++)this.listData[n].rank=n+1;this.rankList.setItemsData(this.listData)}}),o(i,"requstRank",function(){var t=this;RankUtils.getFriendsRankData(function(e){t.listData=e.concat(),t.updateRankLocal()})}),o(i,"onJumpGame",function(){a.logEvent("switch_game_click"),window.FBInstant&&FBInstant.switchGameAsync("435134576951080",{from:"lastknife"}).then(function(){a.logEvent("switch_game_success",{game:"ninjago"})}).catch(function(e){console.log(e)})}),o(i,"showGetTip",function(e,t,n){var i=this;this.touchMask.active=!0,d.get().addDiamon(e);var o=n.convertToWorldSpace(cc.p(0,0)),a=this.node.convertToNodeSpace(o);this.getTipNode.active=!0,this.getTipNode.stopAllActions(),this.getTipNode.scale=0,this.getTipNode.y=0,this.getTipNode.x=a.x-200,this.getTipNode.opacity=255,this.getTipNode.getChildByName("label").getComponent(cc.Label).string="+"+e,this.getTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50)),cc.callFunc(function(){i.touchMask.active=!1,t()})))}),o(i,"setType",function(e){this.resultType=e}),o(i,"addCoinNumWithAnim",function(e){for(var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=cc.v2(cc.winSize.width/2-50,cc.winSize.height/2-50),a=0;a<30;a++){var s=cc.instantiate(this.coinNode);this.miaoNode.addChild(s),s.x=200*Math.random()-100,s.y=200*Math.random()-100-250,s.scale=0,s.runAction(cc.sequence(cc.delayTime(.5*Math.random()),cc.scaleTo(.5+.5*Math.random(),1).easing(cc.easeElasticOut()),cc.moveTo(.5,o),cc.removeSelf()))}var c=this.tipNode.getComponent(cc.Label);c.string=i?"BIG WIN +"+e:"+"+e,c.node.opacity=255,setTimeout(function(){d.get().addDiamon(e),t.diamonLabel.node.runAction(cc.sequence(cc.scaleTo(1,1.5),cc.callFunc(function(){c.node.runAction(cc.fadeOut(.5)),t.diamonLabel.string=d.get().getDiamonCount()}),cc.scaleTo(1,1),cc.callFunc(function(){n&&n()})))},600)}),o(i,"onAdCoinBtn",function(){var e=this;a.isVideoLoad()?a.showVideoAd("result_adCoin",function(){e.addCoinNumWithAnim(200)},function(){}):(l.showTip("NO ADS AVAILBLE",null,-200),setTimeout(function(){l.hideTip()},3e3)),a.logEvent("result_adCoin_click")}),o(i,"showAppleGet",function(e,t,n,i){var o=this,a=t?this.flyingApple:this.flyingGoldApple;a.active=!0,a.x=90*(e-1),a.y=-273,a.runAction(cc.sequence(cc.moveTo(.5,cc.p(268,530)),cc.callFunc(function(){a.active=!1,d.get().addDiamon(n),o.diamonLabel.string=d.get().getDiamonCount(),o.diamonLabel.node.runAction(cc.sequence(cc.scaleTo(.2,2),cc.scaleTo(.2,1),cc.callFunc(i)))})))}),o(i,"showKnifeGet",function(n,i){var e=l.getPage(l.SHOWINVITEKNIFE).getComponent("ShowInviteKnifeDialog");e.setKnifeInfo(n,""),d.get().unlockKnife(n,0),e.registerOnClose(function(e,t){e&&(l.getPage(l.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(t)),d.get().setCurKnife(n));i&&i()}),l.showDialog(l.SHOWINVITEKNIFE)}),i)),cc._RF.pop()},{AdHelper:"AdHelper",ImageNumber:"ImageNumber",ListView:"ListView",PageMgr:"PageMgr",SoundMgr:"SoundMgr",TaskMgr:"TaskMgr",User:"User",Utils:"Utils"}],ResultItem:[function(e,t,n){"use strict";cc._RF.push(t,"f88abvVwEVCGKBPZmC8xnR+","ResultItem");var i=e("PageMgr"),o=e("AdHelper");cc.Class({extends:cc.Component,properties:{playerSprite:cc.Sprite,playerName:cc.Label,btnText:cc.Label,appleNode:cc.Node,goldAppleNode:cc.Node,defaltFrame:cc.SpriteFrame,gameIcon:cc.Node},start:function(){},updateItem:function(n){var i=this;this.data=n,this.playerSprite.spriteFrame=this.defaltFrame,n.isInvite?(this.playerName.string="",this.btnText.string="+",this.goldAppleNode.active=2==this.data.appleState,this.appleNode.active=1==this.data.appleState,this.appleNode.x=-20,this.btnText.node.x=20,0==this.data.appleState&&(this.btnText.string="INVITE",this.btnText.node.x=0)):(this.playerName.string=n.nickName,this.btnText.string="PLAY",n.photo&&cc.loader.load(n.photo,function(e,t){e||i.data!=n||(i.playerSprite.spriteFrame=new cc.SpriteFrame(t))}),this.goldAppleNode.active=2==n.appleState,this.appleNode.active=1==n.appleState,this.appleNode.x=-39,0==n.appleState?this.btnText.node.x=0:this.btnText.node.x=20),this.gameIcon.active=n.isJumpGame},onPlayClick:function(){var s=this;if(this.data.isJumpGame)return o.logEvent("switch_game_click"),void(window.FBInstant&&FBInstant.switchGameAsync("435134576951080",{from:"lastknife"}).then(function(){o.logEvent("switch_game_success",{game:"ninjago"})}).catch(function(e){console.log(e)}));var t=function(){var e=s.node,t=s.node.parent,n=0<s.data.appleState;if(s.data.appleState=0,s.updateItem(s.data),s.node.removeFromParent(),t.addChild(e),e.active=!1,n)for(var i=Math.floor(3*Math.random()),o=0;o<3;o++){var a=t.children[o].getComponent("ResultItem");0==a.data.appleState&&i==o&&(a.data.appleState=Math.random()<.9?1:2,a.updateItem(a.data))}};FBInstant?this.data.playerId?(i.showLoading(),o.logEvent("friend_play_click",{appleState:this.data.appleState}),TournamentMgr.stopContextTick(),FBInstant.context.createAsync(this.data.playerId).then(function(){i.hideLoading(),i.getPage(i.GAMEMAIN).getComponent("GameMain").setPlay(!0);var e=i.getPage(i.RESULT).getComponent("ResultDialog");e.setType("friend_play"),0<s.data.appleState?e.showGetTip(10*s.data.appleState,function(){i.showPage(i.GAMEMAIN),t()},s.node):(i.showPage(i.GAMEMAIN),t()),o.logEvent("friend_play_click_success",{appleState:s.data.appleState}),window.isInTournament=!1}).catch(function(e){"NETWORK_FAILURE"!=e.code&&"SAME_CONTEXT"!=e.code||(t(),i.getPage(i.RESULT).getComponent("ResultDialog").addFriendList());i.hideLoading()})):(i.showLoading(),o.logEvent("friend_choose_show",{appleState:this.data.appleState}),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){i.getPage(i.GAMEMAIN).getComponent("GameMain").setPlay(!0);var e=i.getPage(i.RESULT).getComponent("ResultDialog");e.setType("friend_choose"),0<s.data.appleState?e.showGetTip(10*s.data.appleState,function(){i.showPage(i.GAMEMAIN),t()},s.node):(i.showPage(i.GAMEMAIN),t()),i.hideLoading(),o.logEvent("friend_choose_success",{appleState:s.data.appleState})},function(e){i.hideLoading(),o.logEvent("friend_choose_fail",{code:e.code})})):(i.getPage(i.GAMEMAIN).getComponent("GameMain").setPlay(!1),0<this.data.appleState?i.getPage(i.RESULT).getComponent("ResultDialog").showGetTip(20*this.data.appleState,function(){i.showPage(i.GAMEMAIN),t()},this.node):(i.showPage(i.GAMEMAIN),t()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr"}],ResultRankItem:[function(e,t,n){"use strict";cc._RF.push(t,"c86adtGWP9NW5+rH79uByi8","ResultRankItem");var a=e("Utils"),s=e("AdHelper"),c=e("PageMgr");cc.Class({extends:cc.Component,properties:{num1:cc.Node,num2:cc.Node,num3:cc.Node,playerRank:cc.Label,diban:cc.Node,friendBtn:cc.Node,playerSprite:cc.Sprite,playerName:cc.Label,playerScore:cc.Label,defaultPeople:cc.SpriteFrame,btnText:cc.Label,rewardLabel:cc.Label},onLoad:function(){},updateItem:function(e,n){var i=this;this.colors=this.colors||["#ffd366","#7b9bb6","#c5753a"],this.itemId=e,this.data=n,this.reset(),this.friendBtn.active=n.isFriend,this.btnText.string="PLAY",this.rewardLabel.string=n.rewardCount,FBInstant&&FBInstant.player.getID()==n.playerId&&(this.btnText.string="SHARE"),n.isFriend&&(this.friendBtn.off("click"),this.friendBtn.on("click",function(){if(console.log(n.playerId),FBInstant)if(c.showLoading(),FBInstant&&FBInstant.player.getID()==n.playerId)a.getShareImg(function(e){c.hideLoading(),s.logEvent("share_game",{from:"rank_share"}),FBInstant.shareAsync({intent:"SHARE",text:FBInstant.player.getName()+":Help!🎯🎯🎯🎯🎯🎯",image:e,data:{from:"result_share"}}).then(function(){s.logEvent("result_share_success"),c.hideLoading()}).catch(function(){c.hideLoading()})});else{s.logEvent("friend_play_click");var t=function(){a.playGame({isVS:!0,score:0,rewardCount:i.data.rewardCount}),s.autoShowAd()};TournamentMgr.stopContextTick(),FBInstant.context.createAsync(n.playerId).then(function(){c.hideLoading(),t(),s.logEvent("friend_play_click_success")}).catch(function(e){c.hideLoading(),e&&"SAME_CONTEXT"==e.code&&t()})}else a.playGame({isVS:!0,score:0,rewardCount:i.data.rewardCount})})),this.num1.active=1==n.rank,this.num2.active=2==n.rank,this.num3.active=3==n.rank,this.playerRank.node.active=3<n.rank,this.playerRank.string=n.rank,this.diban.active=n.rank%2==1;var o=this;n.photo&&cc.loader.load(n.photo,function(e,t){e||o.data!=n||(o.playerSprite.spriteFrame=new cc.SpriteFrame(t),o.playerSprite.node.width=o.playerSprite.node.height=70)}),this.playerName.string=n.nickName,this.playerScore.string=n.score},reset:function(){this.playerSprite.spriteFrame=this.defaultPeople}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",Utils:"Utils"}],Rotate:[function(e,t,n){"use strict";cc._RF.push(t,"f1644HZk15Jv6LGEUXO1xE/","Rotate"),cc.Class({extends:cc.Component,properties:{},start:function(){},update:function(e){this.node.rotation+=1}}),cc._RF.pop()},{}],RoundDao:[function(e,t,n){"use strict";cc._RF.push(t,"049f4uT5rdI2a4YhUcjqAav","RoundDao"),cc.Class({extends:cc.Component,properties:{black:cc.Sprite,white:cc.Sprite,flag:cc.Sprite},onLoad:function(){this.mode="black"},start:function(){},setMode:function(e){this.mode=e,this.black.node.active="black"==this.mode,this.white.node.active="white"==this.mode,this.flag.node.active="flag"==this.mode,"flag"==this.mode&&(this.flag.node.active=!0,this.black.node.active=!0)}}),cc._RF.pop()},{}],RoundItem:[function(e,t,n){"use strict";cc._RF.push(t,"b7b23+Pgt1MHYHIkw8odI3b","RoundItem"),cc.Class({extends:cc.Component,properties:{play_head:cc.Sprite,dao1:cc.Node,dao2:cc.Node,dao3:cc.Node,dao4:cc.Node,dao5:cc.Node,dao6:cc.Node,dao7:cc.Node,dao8:cc.Node,dao9:cc.Node,dao10:cc.Node},onLoad:function(){this.daos=[this.dao1,this.dao2,this.dao3,this.dao4,this.dao5,this.dao6,this.dao7,this.dao8,this.dao9,this.dao10]},start:function(){},setLoseIndex:function(e){for(var t=0;t<this.daos.length;t++){var n=this.daos[t].getComponent("RoundDao");t<=e?n.setMode("black"):n.setMode("none")}},setTurn:function(e,t){e-=1;for(var n=[0,4,7,9],i=[4,7,9,10],o=[4,7,9,10],a=0;a<this.daos.length;a++){var s=this.daos[a].getComponent("RoundDao");a<o[e]?a<i[e]&&n[e]<=a&&t?s.setMode("white"):s.setMode("black"):s.setMode("none")}},setData:function(e,t,n){0<=n?(this.setLoseIndex(e),t&&this.daos[e].getComponent("RoundDao").setMode("flag")):this.setTurn(e,t)},setHead:function(e){this.play_head.spriteFrame=e}}),cc._RF.pop()},{}],SendGiftDialog:[function(e,t,n){"use strict";cc._RF.push(t,"4c296ubjLtG+IH5eviPg7hL","SendGiftDialog");var i=e("SendGiftItem"),a=e("Utils"),s=e("AdHelper"),c=e("PageMgr");cc.Class({extends:cc.Component,properties:{items:[i]},start:function(){},onSendClick:function(){for(var o=[],e=0;e<this.items.length;e++){this.data.players[e]&&this.items[e].isSelected&&o.push(this.items[e].texture)}console.log("onSendClick",o),a.getImageAsync("SendGfitScreen",function(e){var t=e.getChildByName("item1"),n=e.getChildByName("item2"),i=e.getChildByName("item3");o[0]?(t.active=!0,t.getChildByName("headimg").getChildByName("jiazaitouxiang").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o[0])):t.active=!1,o[1]?(n.active=!0,n.getChildByName("headimg").getChildByName("jiazaitouxiang").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o[1])):n.active=!1,o[2]?(i.getChildByName("headimg").getChildByName("jiazaitouxiang").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o[2]),i.active=!0):i.active=!1,e.getChildByName("name").getComponent(cc.Label).string=FBInstant.player.getName()+"'S GIFT"}).then(function(e){s.logEvent("share_game",{from:"sendgift_share"}),FBInstant.shareAsync({intent:"SHARE",text:"I am challenging this boss, 😓 Are you joining?",image:e,data:{from:"sendgift_share",coin:200,id:Date.now()}}).then(function(){c.hideLoading()}).catch(function(){c.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),c.hideLoading()})},onUpdateData:function(e){console.log(e),this.data=e;for(var t=0;t<6;t++){var n=e.players[t];n?(this.items[t].node.active=!0,this.items[t].setPlayerHead(n.getPhoto())):this.items[t].node.active=!1}}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",SendGiftItem:"SendGiftItem",Utils:"Utils"}],SendGiftItem:[function(e,t,n){"use strict";cc._RF.push(t,"6daaf3f1RRJHrmSyq2jhJ8s","SendGiftItem"),cc.Class({extends:cc.Component,properties:{headSp:cc.Sprite,checkNode:cc.Node},start:function(){this.isSelected=!0},onCheckClick:function(){this.isSelected=!this.isSelected,this.checkNode.active=this.isSelected},setPlayerHead:function(e){var n=this;cc.loader.load(e,function(e,t){e?console.log(e):(n.texture=t,n.headSp.spriteFrame=new cc.SpriteFrame(t))})}}),cc._RF.pop()},{}],SettingDialog:[function(e,t,n){"use strict";cc._RF.push(t,"f714cyvQbpAg6UK0nXQaIkc","SettingDialog");var i=e("SoundMgr"),o=e("PageMgr"),a=e("User");cc.Class({extends:cc.Component,properties:{sound_cx:{default:null,type:cc.Toggle},music_cx:{default:null,type:cc.Toggle}},start:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){e.count++,20==e.count&&(a.get().clearData(),o.showTip("数据清除，关闭重启"))})},onEnable:function(){this.count=0,this.music_cx.isChecked=i.isMusicEnable(),this.sound_cx.isChecked=i.isSoundEnable()},onSound:function(e){console.log("onSound"),i.setSoundEnable(e.target.parent.getComponent(cc.Toggle).isChecked)},onLeftHand:function(e){console.log("onMusic"),i.setMusicEnable(e.target.parent.getComponent(cc.Toggle).isChecked)}}),cc._RF.pop()},{PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User"}],ShopData:[function(e,t,n){"use strict";cc._RF.push(t,"320b0rQVZRAvJq2j27rCKOO","ShopData");var i=[{type:"apple",title:"GET FOR COINS",color:"#294d6d",data:[1,2,3,4,5,6,7,8,17,20,21,24,25]},{type:"apple",title:"GET FOR COINS",color:"#396884",data:[9,10,11,12,13,14,15,16,18,19,22,23,26]},{type:"boss",title:"BOSS KNIFES",color:"#E4462D",data:[100,101,102,103,200,201,202,203,300,301,302,303,400,401,402,500,501,502,600]},{type:"boss",title:"BOSS KNIFES",color:"#E4462D",data:[601,700,701,1001,1002,1003,1004,1005]}];t.exports={getData:function(e){return i[e-1]},getPageLength:function(){return i.length}},cc._RF.pop()},{}],ShopDialog:[function(e,t,n){"use strict";cc._RF.push(t,"f760fz/Aw9FLavqRTw3FKsM","ShopDialog");var f=e("User"),i=e("Utils"),a=e("AdHelper"),m=e("KnifeData"),l=e("TargetData"),y=e("ShopData"),v=e("PageMgr");cc.Class({extends:cc.Component,properties:{pageView:cc.PageView,diamonLabel:cc.Label,titleNode:cc.Node,titleLabel:cc.Label,bassInfo:cc.Node,itemPrefab:cc.Prefab,showKnife:cc.Sprite,costLabel:cc.Label,unlockBtn:cc.Node,videoBtn:cc.Node,sweetBtn:cc.Node,sweetLabel:cc.Label,candyCountLabel:cc.Label,videoLeft:cc.Label,videoInfo:cc.Node,videoKnifeLabel:cc.Label,inviteFriendNode:cc.Node,inviteLabel:cc.Label,halloweenTopBar:cc.Node},init:function(){this.curPageIndex=0,this.lastSelectItem=null,this.curKnifeData=0,this.isClickEnabled=!0,this.type="video"},onLoad:function(){this.init(),this.showKnife.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(1,1.2),cc.scaleTo(1,1))))},onEnable:function(){this.isShowAd=!1,this.curKnifePageIndex&&this.pageView.setCurrentPageIndex(this.curKnifePageIndex)},updateItem:function(n,i,o){var a=f.get().isKnifeUnlock(i.id),e=a?"knife/":"shadows/",s=this;cc.loader.loadRes(e+i.img,function(e,t){e?console.log("error",e):(n.getChildByName("knife").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),n.getChildByName("knife").scale=.5,o&&(s.showKnife.spriteFrame=new cc.SpriteFrame(t),s.onItemClick(-1,n,i)),n.emit("load_finish"),a&&(n.getChildByName("knife").color=cc.Color.WHITE))}),this.node.getChildByName("GuanLight").opacity=a?255:100},start:function(){var e=this,t=this.pageView.getPages(),n=f.get().getCurKnife(),i=0,o=-1;v.showLoading();for(var a=0;a<y.getPageLength();a++)for(var s=0;s<16;s++){var c=y.getData(a+1),r=c.data[s]||-1,l=m.getData(r);-1==r&&(l=null),c.color="#8A927C";var h=l&&l.id||"",d=this.getItemByData(l,n==h);n==h&&(o=a),d.on("load_finish",function(e){i++,e.off("load_finish"),16==i&&v.hideLoading()}.bind(null,d)),d.dataIndex=h;var u=f.get().isKnifeUnlock(h);h&&!u&&(d.getChildByName("knife").color=d.getChildByName("knife").color.fromHEX(c.color)),d.getChildByName("defaultknife").color=cc.hexToColor(c.color),l&&!u&&"video"==c.type&&f.get().getVideoWatchCount(l.id)>=l.ad_num&&(f.get().unlockKnife(h,0),u=!0),d.getChildByName("adbtn").active=!1,d.getChildByName("coinbtn").active=!1,d.on("click",this.onItemClick.bind(this,s,d,l)),-1==r&&(d.getChildByName("adbtn").active=!1,d.getChildByName("coinbtn").active=!1);var p=Math.floor(s/4),g=s%4;d.x=130*(g-2+.5),d.y=130*(2-p-.5),t[a].addChild(d),o<0&&(o=0,this.onItemClick(-1,d,l))}this.curKnifePageIndex=o,setTimeout(function(){e.pageView.setCurrentPageIndex(o)},0)},onItemClick:function(e,t,n){if(!n)return v.showTip("Coming soon"),void setTimeout(function(){v.hideTip()},1e3);if(this.isClickEnabled){this.curKnifeData=n;var i=f.get().isKnifeUnlock(n.id),o=n.price&&0<n.price,a=n.boss_id&&0<n.boss_id,s=n.ad_num&&0<n.ad_num;n.friend_num&&n.friend_num;if(this.sweetBtn.active=n.isHalloween&&!a,n.isHalloween&&(o=!1),this.unlockBtn.active=!i&&o,this.videoBtn.active=!i&&s,this.curKnifeData.friend_num&&(this.inviteLabel.string="INVITE("+f.get().getFriendsCount(this.curKnifeData.id)+"/"+this.curKnifeData.friend_num+")"),s&&(this.videoLeft.string=n.ad_num-f.get().getVideoWatchCount(n.id)),this.costLabel.string=n.price,this.sweetLabel.string=n.price,i)f.get().setCurKnife(n.id),v.getPage(v.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(t.getChildByName("knife"))),this.showKnife.node.color=cc.Color.WHITE,this.showKnife.getComponentInChildren(cc.Sprite).spriteFrame=null;if(this.node.getChildByName("GuanLight").opacity=i?255:100,t==this.lastSelectItem&&i&&0<=e)v.showPage(v.HOME);else{if(this.lastSelectItem&&(this.lastSelectItem.getChildByName("select").active=!1),t.getChildByName("select").active=!0,this.lastSelectItem=t,this.bassInfo.active=a){var c=l.getData(n.boss_id),r=this.bassInfo.getChildByName("bossLabel").getComponent(cc.Label);r.string=c.name;r.node.color=cc.hexToColor(["#e4462d","#fce352","#a750f5"][c.bossLv]),i?(r.node.color=cc.hexToColor("#ffffff"),this.bassInfo.getChildByName("xiaodao boss").color=cc.hexToColor("#219256"),this.bassInfo.getChildByName("label").color=cc.hexToColor("#219256")):(this.bassInfo.getChildByName("xiaodao boss").color=cc.hexToColor("#ffffff"),this.bassInfo.getChildByName("label").color=cc.hexToColor("#ffffff"))}this.showKnife.spriteFrame=t.getChildByName("knife").getComponent(cc.Sprite).spriteFrame,i||(this.showKnife.getComponentInChildren(cc.Sprite).spriteFrame=this.showKnife.spriteFrame),this.curKnifePageIndex=this.pageView.getCurrentPageIndex()}}},getItemByData:function(e,t){var n=cc.instantiate(this.itemPrefab);return e?(this.updateItem(n,e,t),n.getChildByName("select").active=t):(n.getChildByName("select").active=!1,n.getChildByName("defaultknife").active=!0),t&&(this.lastSelectItem&&(this.lastSelectItem.getChildByName("select").active=!1),this.lastSelectItem=n),n},onPageTurn:function(){this.curPageIndex=this.pageView.getCurrentPageIndex();var e=y.getData(this.curPageIndex+1),t=e.type;this.type=t,this.titleLabel.string=e.title},onInviteFriend:function(){var e=this,n=function(){f.get().addFriendsCount(e.curKnifeData.id),f.get().getFriendsCount(e.curKnifeData.id)>=e.curKnifeData.friend_num&&(f.get().unlockKnife(e.curKnifeData.id,0),e.updateItem(e.lastSelectItem,e.curKnifeData,!0),e.unlockBtn.active=!1,e.inviteFriendNode.active=!1),e.inviteLabel.string="INVITE("+f.get().getFriendsCount(e.curKnifeData.id)+"/"+e.curKnifeData.friend_num+")"};FBInstant?(v.showLoading("",!0),a.logEvent("shop_invite_click"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e?v.hideLoading():i.getImageAsync("InviteScreen",function(e){e.getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}).then(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"shop_invite_knife",text:"This 🎯 game is awesome! You should try it!😝",image:e,data:{from:"shop_invite"},strategy:"IMMEDIATE",notification:"PUSH"}).then(function(){n(),a.logEvent("shop_invite_finish"),v.hideLoading()}).catch(function(e){console.log("updateAsync err",e),v.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),v.hideLoading()})})}).catch(function(e){console.log("chooseAsync err",e),v.hideLoading()})):n()},onUnlock:function(e,t){f.get().getDiamonCount()>=this.curKnifeData.price?(f.get().unlockKnife(this.curKnifeData.id,this.curKnifeData.price),f.get().setCurKnife(this.curKnifeData.id),this.updateItem(this.lastSelectItem,this.curKnifeData,!0),this.unlockBtn.active=!1,this.lastSelectItem.getChildByName("coinbtn").active=!1):(v.showTip("Not enough coins",null,-200),setTimeout(function(){v.hideTip()},3e3))},onWatchVideo:function(n,i){var o=this;a.showVideoAd("shop",function(){var e=o.curKnifeData.id;if(f.get().addWatchVideoCount(e),f.get().getVideoWatchCount(e)==o.curKnifeData.ad_num)f.get().unlockKnife(o.curKnifeData.id,0,!1,!0),f.get().setCurKnife(o.curKnifeData.id),o.updateItem(o.lastSelectItem,o.curKnifeData,!0),o.lastSelectItem.getChildByName("adbtn").active=!1,o.videoBtn.active=!1;else{o.videoLeft.string=o.curKnifeData.ad_num-f.get().getVideoWatchCount(e);var t=cc.instantiate(o.node.getChildByName("tipNode"));t.active=!0,t.x=n,t.y=i-150,t.getComponent(cc.Label).string="-1",t.runAction(cc.spawn(cc.moveBy(1,0,50),cc.fadeOut(1))),o.node.addChild(t)}},function(){})},onSweetBuy:function(e){if(f.get().getSweetCount()>=this.curKnifeData.price)f.get().unlockHalloweenKnife(this.curKnifeData.id,this.curKnifeData.price),f.get().setCurKnife(this.curKnifeData.id),this.updateItem(this.lastSelectItem,this.curKnifeData,!0),this.sweetBtn.active=!1;else{var t=cc.instantiate(this.node.getChildByName("tipNode"));t.active=!0,t.x=e.currentTarget.x,t.y=e.currentTarget.y+50,t.width=300,t.getComponent(cc.Label).string="NOT ENOUGH CANDY",t.runAction(cc.spawn(cc.moveBy(1,0,50),cc.fadeOut(1))),this.node.addChild(t)}},update:function(e){this.diamonLabel.string=f.get().getDiamonCount(),this.candyCountLabel.string=f.get().getSweetCount(),this.videoKnifeLabel.string=f.get().getUnlockVideoCount()+"/32",this.isShowAd||(this.videoBtn.getComponent(cc.Button).interactable=a.isVideoLoad())}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",PageMgr:"PageMgr",ShopData:"ShopData",TargetData:"TargetData",User:"User",Utils:"Utils"}],ShowInviteKnifeDialog:[function(e,t,n){"use strict";cc._RF.push(t,"fda61zLXPFPHYLHmv/nUyOC","ShowInviteKnifeDialog");var o=e("KnifeData"),i=e("User");cc.Class({extends:cc.Component,properties:{info:cc.Label,knifeSprite:cc.Sprite},start:function(){},setKnifeInfo:function(e,t){this.knifeId=e;var n=this,i=o.getData(this.knifeId);this.info.string=t,cc.loader.loadRes("knife/"+i.img,function(e,t){e?console.log("error",e):n.knifeSprite.spriteFrame=new cc.SpriteFrame(t)})},equip:function(){i.get().setCurKnife(this.knifeId),this.onClosed(!0,this.knifeSprite.node)},registerOnClose:function(e){this.onClosed=e},onClose:function(){this.onClosed(!1)}}),cc._RF.pop()},{KnifeData:"KnifeData",User:"User"}],ShowKnifeDialog:[function(e,t,n){"use strict";cc._RF.push(t,"e60bbRJRAZAyb2i8Cl5rvtR","ShowKnifeDialog");var a=e("KnifeData"),i=e("User"),s=e("AdHelper"),o=e("PageMgr"),c=e("Utils");cc.Class({extends:cc.Component,properties:{bossName:cc.Label,knifeSprite:cc.Sprite,unlockNode:cc.Node,equipBtn:cc.Node,inviteBtn:cc.Node,adBtn:cc.Node},setKnifeInfo:function(e,t,n){this.knifeId=e.drop,this.bossName.string=e.name||"";var i=this,o=a.getData(this.knifeId);t?i.knifeSprite.spriteFrame=new cc.SpriteFrame(t):cc.loader.loadRes("knife/"+o.img,function(e,t){e?console.log("error",e):i.knifeSprite.spriteFrame=new cc.SpriteFrame(t)}),this.adBtn.getComponent(cc.Button).interactable=s.isVideoLoad(),this.adBtn.getComponent(cc.Button).interactable=!0,n||s.logEvent("knife_invite_show",{isAd:this.adBtn.active?1:0})},equip:function(){this.equipBtn.stopAllActions(),i.get().setCurKnife(this.knifeId),this.onClosed(!0,this.knifeSprite.spriteFrame)},equip_adinvite:function(){s.logEvent("unlock_invite_finish"),i.get().unlockKnife(this.knifeId,0,!0),this.equip(),o.hideDialog(o.SHOWKNIFE)},onBuyKnife:function(){i.get().unlockKnife(this.knifeId,50,!0),this.equip(),o.hideDialog(o.SHOWKNIFE)},onInvite_:function(){var e=this;s.logEvent("unlock_invite_click");var t=function(){e.equip_adinvite(),o.hideLoading()};if(window.FBInstant){var n=function(){FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(t).catch(function(e){(console.log("chooseAsync err",e),o.hideLoading(),"SAME_CONTEXT"==e.code)&&(o.getPage(o.INVITETINVALID).getChildByName("timer").getComponent(cc.Label).string="LATER",o.showDialog(o.INVITETINVALID,!0))})};o.showLoading(),c.getShareImg(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:"hey，"+FBInstant.player.getName()+"  is waiting for you！",image:e,data:{from:"continue_invite"},strategy:"IMMEDIATE",notification:"PUSH"}).then(n).catch(n)})}else t()},onAdClick:function(){var e=this;s.logEvent("unlock_ad_click");e.equip_adinvite()},registerOnClose:function(e){this.onClosed=e},onClose:function(){this.onClosed(!1)}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],SlotData:[function(e,t,n){"use strict";cc._RF.push(t,"6e742nfzClG56mrhPVvp8mK","SlotData");t.exports=[[0,2,4],[0,3,6],[1,3,3],[1,2,3],[1,2,2],[4,5,7],[0,2,4],[3,5,8],[0,0,4],[0,1,4],[3,3,5],[2,3,3],[1,2,4],[1,1,1],[1,1,1],[0,1,2],[7,7,7],[0,1,3],[5,6,8],[1,5,8],[1,2,3],[3,6,7],[0,1,1],[1,2,4],[5,5,5],[0,3,4],[0,2,4],[0,2,5],[1,1,3],[0,1,3],[1,4,6],[0,0,3],[0,0,0],[2,3,4],[8,8,8],[1,4,5],[0,0,2],[1,3,5],[2,2,2],[0,1,2],[4,6,8],[1,2,6],[0,1,4],[0,2,6],[2,4,6],[0,1,4],[1,5,7],[1,2,5],[0,1,3],[2,3,4],[2,5,7],[0,2,3],[3,3,6],[1,1,3],[1,3,3],[0,3,5],[1,2,4],[1,6,8],[0,6,7],[0,1,4],[3,4,6],[0,1,2],[1,4,5],[3,6,8],[3,3,3],[0,1,3],[6,6,6],[0,1,2],[0,3,6],[0,5,8],[1,2,4],[0,3,3],[1,2,5],[0,1,4],[0,1,2],[0,0,4],[1,2,3],[1,2,6],[2,2,3],[0,1,3],[4,6,7],[0,2,3],[2,6,7],[3,5,7],[3,3,3],[1,2,3],[3,4,5],[4,6,8],[1,2,4],[2,5,8],[0,0,1],[2,4,5],[2,2,2],[1,2,4],[0,1,2],[0,2,2],[0,1,3],[4,5,8],[0,1,5],[0,4,5],[0,2,3],[3,4,5],[0,2,4],[1,2,4],[5,6,7],[1,5,7],[0,0,2],[2,5,7],[9,9,9],[0,2,3],[4,5,7],[2,3,6],[0,2,6],[0,2,4],[0,2,2],[1,3,4],[0,1,6],[0,1,2],[1,4,6],[3,4,6],[0,2,4],[2,3,5],[0,1,3],[0,6,8],[0,1,2],[2,2,3],[1,5,8],[0,1,3],[1,2,3],[0,1,4],[0,2,5],[0,6,7],[0,1,3],[0,4,6],[3,3,6],[1,2,3],[3,5,7],[0,1,1],[0,2,3],[2,3,5],[0,1,5],[1,2,3],[0,4,5],[2,4,5],[0,2,3],[0,5,8],[0,0,1],[1,6,7],[0,5,7],[1,2,3],[1,1,2],[1,1,4],[0,2,4],[1,1,4],[1,2,2],[0,1,2],[0,4,6],[0,3,4],[0,1,4],[0,3,5],[3,6,7],[0,2,3],[3,3,5],[1,3,6],[0,2,3],[4,6,7],[3,5,8],[0,1,2],[2,6,8],[1,6,7],[0,1,4],[0,1,6],[1,6,8],[0,2,4],[1,3,6],[1,3,5],[0,2,3],[2,6,8],[0,3,3],[1,2,3],[4,5,8],[2,4,6],[1,2,4],[2,5,8],[3,6,8],[0,0,0],[0,0,3],[2,2,4],[1,2,4],[2,3,3],[0,5,7],[0,1,4],[1,3,4],[2,2,4],[0,1,2],[2,3,6],[1,1,2],[0,1,2],[2,6,7],[0,6,8]],cc._RF.pop()},{}],SloteList:[function(e,t,n){"use strict";cc._RF.push(t,"46cba9yw5JGj58ieXZ7sRBZ","SloteList");var s=[],a=e("KnifeData"),i=e("Utils"),c=e("User");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,lightNode:cc.Node},onLoad:function(){this.items=[],this.itemHeight=this.itemPrefab.data.height,this.moveSpeed=0,this.datas=[{type:"knife",id:1},{type:"apple",count:5},{type:"apple",count:5},{type:"apple",count:10},{type:"apple",count:10},{type:"apple",count:20},{type:"apple",count:20},{type:"apple",count:50},{type:"apple",count:50},{type:"apple",count:100},{type:"apple",count:100},{type:"apple",count:200},{type:"apple",count:500}],this.dir=-1;for(var e=0;e<3;e++){var t=cc.instantiate(this.itemPrefab);this.content.addChild(t),t.y=-e*this.itemHeight*this.dir,this.items.push(t.getComponent("SlotoItem")),this.items[e].updateData(this.datas[e],e)}if(0==s.length)for(var n=a.getAllData(),i=Object.keys(n),o=0;o<i.length;o++)0<n[i[o]].ad_num&&!c.get().isKnifeUnlock(i[o])&&s.push(i[o])},getItemCount:function(){return this.datas.length},onEnable:function(){this.isScrolling=!1,this.isIdleScrolling=!1,this.lightNode.active=!1},setKnife:function(e){this.datas[0].id=e,cc.loader.loadRes("knife/"+a.getData(e).img,cc.SpriteFrame,function(e,t){})},randomKnife:function(){return 0==s.length?-1:i.randomSelectOne(s)},setCurrentIndex:function(e){this.curIndex=e,this.content.y=this.itemHeight*e*this.dir;for(var t=0;t<this.items.length;t++){this.items[t].node.y=-(t+e)*this.itemHeight*this.dir;var n=(e+t)%this.datas.length;this.items[t].updateData(this.datas[n],n)}},getCurrentData:function(){return this.datas[this.curIndex]},showLightEffect:function(){this.lightNode.active=!0,this.lightNode.stopAllActions(),this.lightNode.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.2,255),cc.fadeTo(.2,0))))},idleScroll:function(e){this.isIdleScrolling=!0,this.moveSpeed=e||1,this.moveSpeed*=.5},scorllToIndex:function(e,t,n){(this.curIndex=e)==this.datas.length-1&&s.splice(s.indexOf(this.datas[e].id),1),this.moveSpeed=20,this.isScrolling=!0,this.isIdleScrolling=!1;var i=1;n&&(i+=n);var o=this.itemHeight*this.datas.length,a=Math.floor(this.content.y/o)*o;this.desY=a+this.dir*(i*this.datas.length*this.itemHeight+e*this.itemHeight),this.finishCb=t||function(){}},update:function(e){if(this.isIdleScrolling||this.isScrolling){if(this.content.y+=this.moveSpeed*this.dir,1==this.dir&&this.items[0].node.y+this.content.y>this.itemHeight||-1==this.dir&&this.items[0].node.y+this.content.y<-this.itemHeight){var t=this.items.shift(),n=this.items[this.items.length-1];t.node.y=n.node.y-this.itemHeight*this.dir;var i=(n.index+1)%this.datas.length;t.updateData(this.datas[i],i),this.items.push(t)}this.isScrolling&&Math.abs(this.content.y-this.desY)<30&&(this.isScrolling=!1,this.content.y=this.desY,this.finishCb())}}}),cc._RF.pop()},{KnifeData:"KnifeData",User:"User",Utils:"Utils"}],SlotoBtn:[function(e,t,n){"use strict";cc._RF.push(t,"22fd58062lJ26e5dfRH/hpX","SlotoBtn");var i=e("SloteList"),o=(e("SlotData"),e("AdHelper")),c=e("PageMgr"),r=e("SoundMgr");e("User");cc.Class({extends:cc.Component,properties:{spinBtn:cc.Button,spinVideoIcon:cc.Node,spinList1:i,spinList2:i,spinList3:i,spinSwitcher:cc.Animation,dengsNode:cc.Node},onLoad:function(){this.curIndex=0,this.curTime=0,this.isGo=!1,this.colors=[cc.color(255,0,0),cc.color(255,255,0),cc.color(255,0,244),cc.color(255,33,0),cc.color(255,33,0),cc.color(33,33,44),cc.color(223,33,33),cc.color(11,33,66),cc.color(255,33,0),cc.color(255,255,255)]},onEnable:function(){var e=this;this.spinBtn.interactable=!0,this.spinList1.node.active=!1,this.spinVideoIcon.active=!0,this.spinList1.setCurrentIndex(1),this.spinList2.setCurrentIndex(0),this.spinList3.setCurrentIndex(2);var t=this.spinList1.randomKnife();0<=t&&(this.spinList1.setKnife(t),this.spinList2.setKnife(t),this.spinList3.setKnife(t)),setTimeout(function(){e.spinList1.idleScroll()},10),setTimeout(function(){e.spinList2.idleScroll(2)},200),setTimeout(function(){e.spinList3.idleScroll()},400),this.reset()},onSpinSloto:function(){var e=this;this.reset();var t="free";o.isVideoLoad()?(t="video",o.showVideoAd("result_sloto",function(){e.onSpinSloto_start()},function(){})):(c.showTip("NO ADS AVAILBLE",null,-200),setTimeout(function(){c.hideTip()},3e3)),o.logEvent("result_sloto_click",{isFirst:this.isFirstPlay?"free":"ad",type:t})},onSpinSloto_start:function(){var a=this;this.spinList1.node.active=!0,r.play(r.SLOT_START);var s=Math.floor(Math.random()*this.spinList1.getItemCount());o.logEvent("result_slot_random",{randomIndex:s}),this.isFirstPlay&&(this.isFirstPlay=!1);var e=[s,s,s];this.spinBtn.interactable=!1,this.spinVideoIcon.active=!1,this.spinList1.node.opacity=255,this.spinSwitcher.play("resultslot"),this.spinSwitcher.once("finished",function(){a.spinList1.scorllToIndex(e[0],function(){r.play(r.SLOT_STOP)}),setTimeout(function(){a.spinList2.scorllToIndex(e[1],function(){r.play(r.SLOT_STOP)},1)},200),setTimeout(function(){a.spinList3.scorllToIndex(e[2],function(){r.play(r.SLOT_STOP),a.spinSwitcher.play("resultspinback"),a.spinList1.showLightEffect(),a.spinList2.showLightEffect(),a.spinList3.showLightEffect(),r.play(r.SLOT_3),a.showGetEffect(),setTimeout(function(){for(var e=0,t=-1,n=0;n<3;n++){var i=a["spinList"+(n+1)].getCurrentData();"knife"==i.type?t=i.id:e+=i.count}var o=c.getPage(c.RESULT).getComponent("ResultDialog");0==e?0<t&&o.showKnifeGet(t):o.addCoinNumWithAnim(e,function(){0<t&&o.showKnifeGet(t)},s==a.spinList1.getItemCount()-1),a.spinBtn.interactable=!0},800)},2)},400)})},reset:function(){this.isGo=!1,this.curIndex=0,this.curTime=0;for(var e=this.dengsNode.children,t=0;t<e.length;t++)e[t].color=cc.Color.WHITE,e[t].stopAllActions()},showGetEffect:function(){this.isGo=!0;for(var t=this.dengsNode.children,e=function(e){t[e].runAction(cc.sequence(cc.delayTime(e%2==0?0:.1),cc.callFunc(function(){t[e].color=cc.Color.WHITE}),cc.delayTime(.1),cc.callFunc(function(){t[e].color=cc.Color.RED}),cc.delayTime(e%2==1?0:.1)).repeatForever())},n=0;n<t.length;n++)e(n)},update:function(e){if(!this.isGo){this.curTime+=e,.1<this.curTime&&(this.curTime-=.1,this.curIndex++);var t=this.dengsNode.children,n=this.curIndex;this.curIndex=this.curIndex%t.length;var i=this.curIndex+this.colors.length;i>=t.length&&(i%=t.length);for(var o=0;o<t.length;o++)o>=this.curIndex&&o<this.curIndex+this.colors.length?t[o].color=this.colors[o-this.curIndex]:i<this.curIndex?o<i?t[o].color=this.colors[this.colors.length-i+o-1]:this.colors[o-n]?t[o].color=this.colors[o-n]:t[o].color=cc.Color.WHITE:t[o].color=cc.Color.WHITE}}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",SlotData:"SlotData",SloteList:"SloteList",SoundMgr:"SoundMgr",User:"User"}],SlotoItem:[function(e,t,n){"use strict";cc._RF.push(t,"5d435+0PXhNaLiuPW2ZekGD","SlotoItem");var i=e("KnifeData");cc.Class({extends:cc.Component,properties:{countLabel:cc.Label,appleNode:cc.Node,goldAppleNode:cc.Node,knifeSprite:cc.Sprite},updateData:function(e,t){var n=this;this.data!=e&&(this.index=t,this.data=e,this.appleNode.active="knife"!=e.type,this.knifeSprite.node.active="knife"==e.type,"knife"==e.type?(this.countLabel.node.active=!1,cc.loader.loadRes("knife/"+i.getData(e.id).img,cc.SpriteFrame,function(e,t){e?console.log("error",e):n.knifeSprite.spriteFrame=t})):(this.countLabel.node.active=!0,this.countLabel.string=e.count))}}),cc._RF.pop()},{KnifeData:"KnifeData"}],SoundMgr:[function(n,e,t){"use strict";cc._RF.push(e,"cb77baMvr5LEriYIauncdpl","SoundMgr");var i=function(){};i.CLICK="ui/ClickButton",i.APPLES_COINS="ui/GiftApples",i.CONITINUE_TIMER="ui/TimerContinue",i.GAME_OVER="ui/GameOver",i.PWR_UP_SECOND_CHANCE="ui/SecondChance",i.CAMERA="camera",i.THROW="ThrowKnife",i.HIT="hit/knifeHit",i.HIT_LAST="hit/wookBroken",i.HIT_LAST_SPECIAL="hit/wookBroken",i.BOSS_DEFENTED="hit/BossDefeated",i.BOSS_FIGHT="hit/FightBoss",i.KNIFE_HIT="hit/knifeHitKnife",i.APPLE_HIT="hit/KnifeHitApple",i.LEMON_HIT="bosshit/LemonHit",i.COMPASS_HIT="bosshit/CompassHit",i.GEAR_HIT="bosshit/GearHit",i.DONUT_HIT="bosshit/DonutHit",i.SHIRT_HIT="bosshit/ButtonHit",i.DIAMOND_HIT="bosshit/DiamonHit",i.WHEEL_HIT="bosshit/WheelHit",i.CHIP_HIT="bosshit/ButtonHit",i.CHEESE_HIT="bosshit/CheeseHit",i.SHIELD_HIT="bosshit/ShieldHit",i.AK47="bosshit/AK47",i.SLOT_START="ui/slot_spin_start",i.SLOT_STOP="ui/slot_stop",i.SLOT_2="ui/slot_multiplier_x2",i.SLOT_3="ui/slot_multiplier_x3",i.BACKGROUND="backgroud",i.STAGE_PASS_1="stagepass1",i.STAGE_PASS_2="stagepass2",i.STAGE_PASS_3="stagepass3",i.STAGE_PASS_4="stagepass4",i.STAGE_PASS_5="stagepass5";var o={};i.register=function(e,t){o[e]=t};var a={},s={},c={},r=1,l=1;i.init=function(e,t){r=t?1:0,l=e?1:0},i.setSoundEnable=function(e){for(var t in r=e?1:0,s)cc.audioEngine.setVolume(s[t],r);console.log("setSoundEnable",e,r),n("User").get().save()},i.setMusicEnable=function(e){for(var t in l=e?1:0,c)cc.audioEngine.setVolume(c[t],l);console.log("setMusicEnable",e,l),n("User").get().save()},i.isSoundEnable=function(){return 1==r},i.isMusicEnable=function(){return 1==l},i.playClick=function(){s[i.CLICK]=i.play(i.CLICK)},i.preLoad=function(n,i){a[n]||o[n]||(a[n]=!0,cc.loader.loadRes("sound/"+n,function(e,t){if(a[n]=!1,e)return cc.log(e),void(i&&i(e,t));o[n]=t,i&&i(e,t)}))},i.play=function(e,t,n){if(n=n||1,!a[e]&&0!=r)return o[e]?(s[e]=cc.audioEngine.play(o[e],t,n*r),s[e]):void i.preLoad(e)},i.playMusic=function(e,t,n){if(n=n||1,o[e])return c[e]=cc.audioEngine.play(o[e],t,n*l),c[e];i.preLoad(e)},i.stop=function(e){cc.audioEngine.stop(s[e])},e.exports=i,cc._RF.pop()},{User:"User"}],SoundUtil:[function(e,t,n){"use strict";cc._RF.push(t,"fa9d18MP39ET4DxIKnRmC8s","SoundUtil");var i=e("SoundMgr");cc.Class({extends:cc.Component,properties:{},playClick:function(){i.playClick()}}),cc._RF.pop()},{SoundMgr:"SoundMgr"}],SpinBtn:[function(e,t,n){"use strict";cc._RF.push(t,"3da72iAJRBMEJwh+wmMH9Um","SpinBtn");var i=e("PageMgr"),o=e("AdHelper"),a=e("User"),s=e("Rotate");cc.Class({extends:cc.Component,properties:{freeSpinNode:cc.Node,adSpinNode:cc.Node,spinTimeLabel:cc.Label,rotateCom:s},start:function(){},onSpinClick:function(){o.logEvent("spin_play_click");console.log("User.get().isGiftAvailable() : ",a.get().isGiftAvailable(),a.get().getGiftLeftTime()),a.get().isGiftAvailable()?i.getPageAsync(i.GAMESPIN).then(function(e){i.showLoading(),e.getComponent(i.GAMESPIN).preLoad(function(){i.showDialog(i.GAMESPIN,!0),i.hideLoading()})}).catch(function(){}):(i.showTip("Wait a moment.",null,-200),setTimeout(function(){i.hideTip()},1e3))},update:function(e){a.get().isGiftAvailable()?(this.freeSpinNode.active=!0,this.adSpinNode.active=!1,this.rotateCom.enabled=!0):(this.rotateCom.enabled=!1,this.freeSpinNode.active=!1,this.adSpinNode.active=!0,this.spinTimeLabel.string=a.get().getGiftLeftTime())}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",Rotate:"Rotate",User:"User"}],SpinDialog:[function(e,t,n){"use strict";cc._RF.push(t,"2b74532ZNJPSL+RflikyAT6","SpinDialog");var i=e("PageMgr"),o=e("User"),a=e("AdHelper");cc.Class({extends:cc.Component,properties:{giftTimeLabel:cc.Label,playBtn:cc.Button},start:function(){},onEnable:function(){a.logEvent("turntable_dialog_show");var e=this.node.getChildByName("content");e.scale=.8,e.runAction(cc.scaleTo(.1,1))},onPlay:function(){var t=this;a.logEvent("turntable_play_click"),i.getPageAsync(i.GAMESPIN).then(function(e){i.showLoading(),e.getComponent(i.GAMESPIN).preLoad(function(){t.onClose(),i.showDialog(i.GAMESPIN,!0),i.hideLoading()})}).catch(function(){})},onClose:function(){i.hideDialog(i.SPINDIALOG)},update:function(e){o.get().isGiftAvailable()?(this.giftTimeLabel.string="READY!",this.playBtn.interactable=!0):(this.giftTimeLabel.string=o.get().getGiftLeftTime(),this.playBtn.interactable=!1)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],SpinLottery:[function(e,t,n){"use strict";cc._RF.push(t,"738274u84JNpot1JEjYc4m1","SpinLottery"),cc.Class({extends:cc.Component,properties:{spinNode:{default:null,type:cc.Node},wheelNode:{default:null,type:cc.Node},maxSpeed:{default:10,type:cc.Float,max:15,min:2,tooltip:"最大速度转每秒"},duration:{default:2,type:cc.Float,max:5,min:1,tooltip:"减速前旋转时间"},acc:{default:10,type:cc.Float,max:10,min:1,tooltip:"加速度"},gearNum:{default:8,type:cc.Integer,tooltip:"齿轮个数"}},onEnable:function(){this.wheelState=0,this.curSpeed=0,this.spinTime=0,this.defaultAngle=360/this.gearNum/2,this.gearAngle=360/this.gearNum,this.wheelNode.rotation=this.defaultAngle,this.finalAngle=0,this.targetId=0,this.decAngle=1080,this.spinNodeSpeed=0,this.spinNodeRotationMax=-20,this.spinNodeMoveTm=0,this.lastSpinMoveTm=0},run:function(e,t){0===this.wheelState&&((null==e||e>=this.gearNum)&&(e=Math.floor(Math.random()*this.gearNum)),this.curDecAngle=this.decAngle,this.wheelState=1,this.curSpeed=0,this.spinTime=0,this.targetId=parseInt(e),this.finalAngle=(360-this.targetId*this.gearAngle+this.defaultAngle+(40*Math.random()-20))%360,this.cb=t)},update:function(e){(this.spinNode.rotation<0||this.spinNodeSpeed<0)&&(this.spinNodeMoveTm<=0?(this.spinNodeSpeed+=50*e,this.spinNodeMoveTm=0):this.spinNodeMoveTm-=e,this.spinNodeSpeed<-1&&(this.spinNodeSpeed=-1),this.spinNode.rotation+=this.spinNodeSpeed,0<this.spinNode.rotation&&(this.spinNode.rotation=0),this.spinNode.rotation<-40&&(this.spinNode.rotation=-40)),0!==this.wheelState&&(1==this.wheelState?(this.spinTime+=e,this.wheelNode.rotation-=this.curSpeed,this.wheelNode.rotation<0&&(this.wheelNode.rotation+=360),this.curSpeed<=this.maxSpeed?this.curSpeed+=this.acc*e:(this.curSpeed=this.maxSpeed,this.spinTime>=this.duration&&Math.abs(this.wheelNode.rotation-this.finalAngle)<=this.maxSpeed+1&&(this.wheelNode.rotation=this.finalAngle,this.maxSpeed=this.curSpeed,this.wheelState=2))):2==this.wheelState&&(this.curSpeed=this.maxSpeed*this.curDecAngle/this.decAngle,this.curSpeed<.2&&(this.curSpeed=.2),this.wheelNode.rotation-=this.curSpeed,this.wheelNode.rotation<0&&(this.wheelNode.rotation+=360),this.curDecAngle-=this.curSpeed,this.curDecAngle<=.001&&(this.wheelNode.rotation=this.finalAngle,this.curSpeed=0,this.wheelState=0,this.cb&&this.cb())),this.lastSpinMoveTm-=e,Math.floor(this.wheelNode.rotation/this.gearAngle)!=Math.floor((this.wheelNode.rotation+this.curSpeed)%360/this.gearAngle)?this.lastSpinMoveTm<=0?(this.lastSpinMoveTm=.2,this.spinNodeSpeed=-this.curSpeed,this.spinNodeMoveTm=.15,this.spinNodeMoveStatus=!1):this.spinNodeMoveStatus=!0:this.lastSpinMoveTm<=0&&this.spinNodeMoveStatus&&(this.lastSpinMoveTm=.2,this.spinNodeSpeed=-this.curSpeed,this.spinNodeMoveTm=.15,this.spinNodeMoveStatus=!1))}}),cc._RF.pop()},{}],SweetCollectDialog:[function(e,t,n){"use strict";cc._RF.push(t,"7c029AJDJJLmpNSUq+O0I8d","SweetCollectDialog");var i=e("AdHelper"),o=e("PageMgr"),a=e("User");cc.Class({extends:cc.Component,properties:{giftLabel:cc.Label,bossLabel:cc.Label,videoBtn:cc.Button,guang:cc.Node},onLoad:function(){this.guang.runAction(cc.repeatForever(cc.rotateBy(1,10)))},onEnable:function(){this.isWaitingAd=!1;var e=this.node.getChildByName("content");e.scale=.8,e.runAction(cc.scaleTo(.1,1)),i.logEvent("halloween_sweetbag_show")},onDisable:function(){this.isWaitingAd=!1},onUpdateData:function(e){this.onCloseCb=e.onClose,this.count=e.count,this.giftLabel.string=e.count,this.bossLabel.string=e.name},onCollect:function(){this.showGift(!1),i.logEvent("halloween_collect")},onCollectX2:function(){var e=this;i.logEvent("halloween_collectx2"),i.isVideoLoad()?(i.logEvent("halloween_collect_adshow"),i.showVideoAd(this.showGift.bind(this,!0),function(){})):(o.showLoading("",!0),this.isWaitingAd=!0,this.timeoutHandler=setTimeout(function(){e.timeoutHandler=null,e.isWaitingAd=!1,o.hideLoading(),o.showTip("NO ADS AVAILBLE",null,-200),setTimeout(function(){o.hideTip()},3e3),e.showGift()},6e3))},showGift:function(e){o.hideDialog("SweetCollectDialog");var t=e?2:1;a.get().addSweetCount(this.count*t),o.getPage(o.GIFTPAGE).getComponent("GiftPage").setAppleCount(this.count,e,!1,this.onCloseCb,!0),o.showDialog(o.GIFTPAGE)},onClose:function(){o.hideDialog("SweetCollectDialog"),this.onCloseCb()},update:function(e){var t=this;this.videoBtn.interactable=i.isSupporteVideo(),this.isWaitingAd&&i.isVideoLoad()&&(this.isWaitingAd=!1,this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=null),i.showVideoAd(this.showGift.bind(this,!0),function(){}),i.logEvent("halloween_collect_adshow"),setTimeout(function(){o.hideLoading(),t.onClose()},2e3))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],TargetData:[function(e,t,n){"use strict";cc._RF.push(t,"83a4aeXbDVKBZ5xo1HEyfSo","TargetData");var i={1:{avator:"target_1",color:"#D8832F"},1e4:{avator:"boss_10000",name:"BORNEOL",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:100,exp:10,color:"#f77d0c"},10001:{avator:"boss_10001",name:"COOKIES",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:101,exp:10,color:"#80a306"},10002:{avator:"boss_10002",name:"TOAST BREAD",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:102,exp:10,color:"#f83913"},10003:{avator:"boss_10003",name:"CAN",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:103,exp:10,color:"#f83913"},2e4:{avator:"boss_20000",name:"BEER",hitTarget:"COMPASS_HIT",bossLv:0,block:[],drop:200,exp:20,color:"#61b9d3"},20001:{avator:"boss_20001",name:"BIG MAC",hitTarget:"GEAR_HIT",bossLv:0,block:[],drop:201,exp:20,color:"#D91E6F"},20002:{avator:"boss_20002",name:"STEAK",hitTarget:"DONUT_HIT",bossLv:0,block:[],drop:202,exp:20,color:"#f83d7c"},20003:{avator:"boss_20003",name:"SUSHI",hitTarget:"DONUT_HIT",bossLv:0,block:[],drop:203,exp:20,color:"#f83d7c"},3e4:{avator:"boss_30000",name:"OREO",hitTarget:"SHIRT_HIT",bossLv:0,block:[],drop:300,exp:30,color:"#000000"},30001:{avator:"boss_30001",name:"CAKE",hitTarget:"DIAMOND_HIT",bossLv:0,block:[],drop:301,exp:30},30002:{avator:"boss_30002",name:"SEAFOOD PIZZA",hitTarget:"WHEEL_HIT",bossLv:0,block:[],drop:302,exp:30},30003:{avator:"boss_30003",name:"LOLLIPOP",hitTarget:"WHEEL_HIT",bossLv:0,block:[],drop:303,exp:30},4e4:{avator:"boss_40000",name:"ICE CUBE",HitTarget:"CHIP_HIT",bossLv:0,block:[],drop:400,color:"#606060",exp:40},40001:{avator:"boss_40001",name:"CHOCOLATE DONUT",HitTarget:"CHEESE_HIT",bossLv:0,block:[],drop:401,exp:40,color:"#EB6A50"},40002:{avator:"boss_40002",name:"SANDWICH",HitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:402,exp:40,color:"#2B2B2B"},5e4:{avator:"boss_50000",name:"APPLE PIE",HitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:500,exp:50},50001:{avator:"boss_50001",name:"STRAWBERRY DONUT",HitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:501,exp:50,color:"#E3E3E3"},50002:{avator:"boss_50002",name:"HAM PIZZA",HitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:502,exp:50,color:"#E3E3E3"},6e4:{avator:"boss_60000",name:"WAFFLES",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:600,exp:100,color:"#FC251C"},60001:{avator:"boss_60001",name:"MUSHROOM PIZZA",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:601,exp:100,color:"#F8B536"},7e4:{avator:"boss_70000",name:"SPAGHETTI",hitTarget:"SHIELD_HIT",bossLv:1,block:[],drop:700,exp:120},70001:{avator:"boss_70001",name:"TOMATO PIZZA",hitTarget:"SHIELD_HIT",bossLv:1,block:[],drop:701,exp:120},10000001:{index:35,avator:"boss_s10",hasPlayerImg:!0,name:"CD",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:1001,exp:30,color:"#1E1D1F"},10000002:{index:35,avator:"boss_s2",hasPlayerImg:!0,name:"LOVE",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:1002,exp:30,color:"#FD6E70"},10000003:{index:35,avator:"boss_s12",hasPlayerImg:!0,name:"TV",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:1003,exp:30,color:"#FED747"},10000004:{index:35,avator:"boss_s6",hasPlayerImg:!0,name:"SUNFLOWER",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:1004,exp:30,color:"#FAD034"},10000005:{index:35,avator:"boss_s13",hasPlayerImg:!0,isBack:!0,name:"KODAK",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:1005,exp:30,color:"#FAD034"}};t.exports={getData:function(e){var t=i[e];return t.index=e,t}},cc._RF.pop()},{}],TaskButton:[function(e,t,n){"use strict";cc._RF.push(t,"e79eff8J65CPKmmLQLkzdlU","TaskButton");var i=e("TaskMgr"),o=e("AdHelper"),a=e("PageMgr");cc.Class({extends:cc.Component,properties:{completeNode:cc.Node,newNode:cc.Node,inprogressNode:cc.Node,statusLabel:cc.Label},update:function(){this.completeNode.active=i.isTaskComplete(),this.inprogressNode.active=i.isTaskInprogress(),this.newNode.active=!(this.completeNode.active||this.inprogressNode.active),this.statusLabel.string="NEW\nTASK",i.isTaskComplete()&&(this.statusLabel.string="TASK\nDONE"),i.isTaskInprogress()&&(this.statusLabel.string="TASK\nDOING")},onLoad:function(){this.completeNode.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,2),cc.scaleTo(.3,1),cc.delayTime(.3))))},onTaskClick:function(){o.logEvent("result_task_click"),i.openTask(),a.showDialogAsync("TaskDialog")}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",TaskMgr:"TaskMgr"}],TaskData:[function(e,t,n){"use strict";cc._RF.push(t,"be6d1hL1I1FAJJUlg22gCqr","TaskData");var i=[{type:"finish_level",num:5,rewardCount:25,iconIndex:0,des:"COMPLETE STAGE 5."},{type:"finish_level",num:7,rewardCount:30,iconIndex:0,des:"COMPLETE STAGE 7."},{type:"collect_apple",num:20,rewardCount:50,iconIndex:4,des:"COLLECT 20 APPLES"},{type:"spin_slot",num:1,rewardCount:25,iconIndex:2,des:"PLAY ONE-ARM BANDIT 1 TIME."},{type:"challenge_friends",num:1,rewardCount:100,iconIndex:1,des:"CHALLENGE 1 FRIEND"},{type:"finish_level",num:10,rewardCount:50,iconIndex:0,des:"COMPLETE STAGE 10."},{type:"spin_slot",num:3,rewardCount:100,iconIndex:2,des:"PLAY ONE-ARM BANDIT 3 TIME."},{type:"challenge_friends",num:3,rewardCount:300,iconIndex:1,des:"CHALLENGE 3 FRIEND"},{type:"finish_level",num:15,rewardCount:200,iconIndex:0,des:"COMPLETE STAGE 15."},{type:"beat_boss",num:15,rewardCount:50,iconIndex:3,des:"DEFEAT BOSS : THE DIAMOND.IT APPEARS ON THE 25TH STAGE."},{type:"finish_level_nocontinue",num:10,rewardCount:100,iconIndex:0,des:"COMPLETE STAGE 10 WITHOUT 'CONTINUE'."},{type:"finish_level_nocontinue",num:20,rewardCount:300,iconIndex:0,des:"COMPLETE STAGE 20 WITHOUT 'CONTINUE'."},{type:"finish_level_nocontinue",num:30,rewardCount:500,iconIndex:0,des:"COMPLETE STAGE 30 WITHOUT 'CONTINUE'."}];t.exports={getData:function(e){return i[e]},getLength:function(e){return Object.keys(i).length}},cc._RF.pop()},{}],TaskDialog:[function(e,t,n){"use strict";cc._RF.push(t,"7b740oES/FP5KYPTZ7oP1Ax","TaskDialog");var i=e("TaskMgr"),o=e("User"),a=e("PageMgr"),s=e("AdHelper");cc.Class({extends:cc.Component,properties:{iconsFrame:[cc.SpriteFrame],taskIcon:cc.Sprite,desLabel:cc.Label,barLabel:cc.Label,rewardLabel:cc.Label,taskBar:cc.Sprite,collectBtn:cc.Button},updateUI:function(){var e=i.getCurrentTask();this.desLabel.string=e.des,this.rewardLabel.string=e.rewardCount,this.taskIcon.spriteFrame=this.iconsFrame[e.iconIndex],this.collectBtn.interactable=i.isTaskComplete();var t=e.num,n=o.get().getTaskCount();"beat_boss"!=e.type&&"finish_level"!=e.type&&"finish_level_nocontinue"!=e.type||(t=1,n=i.isTaskComplete()?1:0),this.barLabel.string=n+"/"+t,this.taskBar.fillRange=n/t},onEnable:function(){this.updateUI()},onCollectReward:function(){var e=i.getCurrentTask();s.logEvent("task_collect",{taskIndex:o.get().getTaskIndex()}),a.getPage(a.GIFTPAGE).getComponent("GiftPage").setAppleCount(e.rewardCount),a.showDialog(a.GIFTPAGE,!0),o.get().addDiamon(e.rewardCount),i.openNextTask(),this.updateUI()}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",TaskMgr:"TaskMgr",User:"User"}],TaskMgr:[function(e,t,n){"use strict";cc._RF.push(t,"ca20ejBppRADqzBZvAv9V7C","TaskMgr");var i=e("TaskData"),o=e("User"),a=e("AdHelper"),s={},c=null;s.setTaskIndex=function(e){c=i.getData(e)},s.getCurrentTask=function(){return c},s.getTotalTaskCount=function(){return i.getLength()},s.isTaskFinish=function(){return"beat_boss"==c.type&&0<o.get().getTaskCount()||o.get().getTaskCount()>=c.num},s.isTaskInprogress=function(){return"inprogress"==o.get().getTaskStatus()},s.isTaskComplete=function(){return"completed"==o.get().getTaskStatus()},s.openTask=function(){"unlocked"==o.get().getTaskStatus()&&o.get().setTaskStatus("inprogress")},s.openNextTask=function(){o.get().openNextTask(),o.get().getTaskIndex()<s.getTotalTaskCount()&&(s.setTaskIndex(o.get().getTaskIndex()),c&&"spin_slot"==c.type&&!a.isSupporteVideo()&&s.openNextTask())},s.isAllTaskCompleted=function(){return o.get().getTaskIndex()>=s.getTotalTaskCount()},s.onFinishStage=function(e,t){s.isTaskInprogress()&&("finish_level"==c.type&&o.get().getTaskCount()<e?(o.get().setTaskCount(e),e>=c.num&&o.get().setTaskStatus("completed"),console.log("onFinishStage",e,t)):"finish_level_nocontinue"==c.type&&0==t&&o.get().getTaskCount()<e&&(o.get().setTaskCount(e),e>=c.num&&o.get().setTaskStatus("completed")))},s.onCollectApple=function(e){s.isTaskInprogress()&&"collect_apple"==c.type&&(console.log("onCollectApple",e),o.get().setTaskCount(o.get().getTaskCount()+e),o.get().getTaskCount()>=c.num&&o.get().setTaskStatus("completed"))},s.onSpinSlot=function(){s.isTaskInprogress()&&"spin_slot"==c.type&&(console.log("onSpinSlot"),o.get().setTaskCount(o.get().getTaskCount()+1),o.get().getTaskCount()>=c.num&&o.get().setTaskStatus("completed"))},s.onChallengeFriend=function(){s.isTaskInprogress()&&"challenge_friends"==c.type&&(console.log("onChallengeFriend"),o.get().setTaskCount(o.get().getTaskCount()+1),o.get().getTaskCount()>=c.num&&o.get().setTaskStatus("completed"))},s.onBeatBoss=function(e){s.isTaskInprogress()&&"beat_boss"==c.type&&e==c.num&&(console.log("onBeatBoss",e),o.get().setTaskCount(1),o.get().setTaskStatus("completed"))},t.exports=s,cc._RF.pop()},{AdHelper:"AdHelper",TaskData:"TaskData",User:"User"}],ThanksSaleDialog:[function(e,t,n){"use strict";cc._RF.push(t,"480b5onYf5Al4Hahknsf8Gf","ThanksSaleDialog");var i=e("PageMgr"),o=e("User"),a=e("AdHelper"),s=e("Utils");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label,price3:cc.Label,timerLabel:cc.Label},onEnable:function(){this.price1.string=o.get().getPrice("apple_box","$2.99"),this.price2.string=o.get().getPrice("apple_60000","$28.99"),this.price3.string=o.get().getPrice("apple_180000_half","$49.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){a.logEvent("pay_shop_click",{itemId:"apple_box"}),o.get().purchase("apple_box",function(){o.get().addDiamon(7500),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(7500),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})},onBuyItem2:function(){a.logEvent("pay_shop_click",{itemId:"apple_60000"}),o.get().purchase("apple_60000",function(){o.get().addDiamon(18e4),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(18e4),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})},onBuyItem3:function(){a.logEvent("pay_shop_click",{itemId:"apple_180000_half"}),o.get().purchase("apple_180000_half",function(){o.get().addDiamon(6e5),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),i.showDialog(i.GIFTPAGE,!0),a.logEvent("pay_shop_success",{itemId:"apple_180000_half"})},function(){})},onClose:function(){i.hideDialog("ThanksSaleDialog"),this.data&&this.data.closeCb&&this.data.closeCb()},update:function(){0<o.get().getThanksgivingLeftTime()&&(this.timerLabel.string=s.formatTimeHMS(o.get().getThanksgivingLeftTime()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],TournamentDialog:[function(e,t,n){"use strict";cc._RF.push(t,"9f27bJunZlIPbvuELYaNz9B","TournamentDialog");var i=e("PageMgr"),o=e("AdHelper"),a=e("User"),s=e("Utils"),c=e("ListView");cc.Class({extends:cc.Component,properties:{createGroup:cc.Node,listGroup:cc.Node,listView:c,rewardLabel1:cc.Label,rewardLabel2:cc.Label,rewardLabel3:cc.Label},onLoad:function(){this.node.scale=cc.winSize.width/640},onEnable:function(){var n=this;this.createGroup.active=!0,this.listGroup.active=!this.createGroup.active;var e=TournamentMgr.rewardCfg;this.rewardLabel1.string="+"+e[0],this.rewardLabel2.string="+"+e[1],this.rewardLabel3.string="+"+e[2],TournamentMgr.reqTournamentIds(function(e){console.log("tournaments",e);var t=e.filter(function(e){var t=1!=a.get().getTournamentRewardStatus(e.tournament.contextId),n=!(e.tournament.remainSecs<=0&&-9999==e.getSelfRank());return console.log(t,n,e.tournament.remainSecs<=0,-9999==e.getSelfRank()),0<e.tournament.remainSecs?(console.log("000"),!0):-9999==e.getSelfRank()?(console.log("111"),!1):1!=a.get().getTournamentRewardStatus(e.tournament.contextId)||(console.log("222"),!1)});t.sort(function(e,t){return e.tournament.remainSecs<=0&&t.tournament.remainSecs<=0?e.getSelfRank()-t.getSelfRank():0<e.tournament.remainSecs&&0<t.tournament.remainSecs?t.total-e.total:e.tournament.remainSecs-t.tournament.remainSecs}),console.log("newDatas",t),n.listView.setItemsData(t),0<t.length?n.createGroup.active=!1:n.createGroup.active=!0,n.listGroup.active=!n.createGroup.active})},onCreateTournamentClicked:function(){var e=TournamentMgr.getOverdueTournamentId();TournamentMgr.stopContextTick(),window.FBInstant?(o.logEvent("recommend_show_t"),i.showLoading(),FBInstant.context.switchAsync(e).then(function(){o.logEvent("recommend_suc_t"),TournamentMgr.startContextTick(),s.playGame()}).catch(function(e){console.log(e),i.hideLoading()})):s.playGame()},onCloseClicked:function(){i.hideDialog("TournamentDialog")}}),cc._RF.pop()},{AdHelper:"AdHelper",ListView:"ListView",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],TournamentItem:[function(e,t,n){"use strict";cc._RF.push(t,"0befc04NuhLE63Wu5E6CPbU","TournamentItem");var i=e("Utils"),o=e("AdHelper"),a=e("User"),s=e("PageMgr");cc.Class({extends:cc.Component,properties:{itemNodes:[cc.Node],headBgSps:[cc.Sprite],headBgFrames:[cc.SpriteFrame],headSps:[cc.Sprite],nameLabels:[cc.Label],dotNode:cc.Node,rewardBtnNode:cc.Node,joinBtnNode:cc.Node,remainTimeLabel:cc.Label,rewardBtn:cc.Button,rewardLabel:cc.Label},updateItem:function(e,t){var i=this,n=(this.data=t).getSelfRank();3<n?n=3:n--,this.rewardCount=TournamentMgr.rewardCfg[n],this.rewardLabel.string=this.rewardCount,this.joinBtnNode.active=Date.now()<t.tournament.endTimeMS,this.rewardBtnNode.active=!this.joinBtnNode.active,this.remainTimeLabel.node.active=this.joinBtnNode.active,this.remainTimeLabel.string="";var o=t.entries||[],a=!1,s="";window.FBInstant&&(s=FBInstant.player.getID());for(var c=function(n){var e=o[n];e?(e.id==s?(a=!0,i.headBgSps[n].spriteFrame=i.headBgFrames[1]):i.headBgSps[n].spriteFrame=i.headBgFrames[0],i.itemNodes[n].active=!0,i.nameLabels[n].string=e.score,i.headSps[n].spriteFrame=null,cc.loader.load(e.photo,function(e,t){e?console.log(e):i.headSps[n].spriteFrame=new cc.SpriteFrame(t)})):i.itemNodes[n].active=!1},r=0;r<3;r++)c(r);this.dotNode.active=!1,this.itemNodes[3].active=!1,t.entry&&!a&&(this.dotNode.active=!0,this.itemNodes[3].active=!0,this.nameLabels[3].string=t.entry.score,this.headSps[3].spriteFrame=null,this.headBgSps[3].spriteFrame=this.headBgFrames[1],cc.loader.load(t.entry.photo,function(e,t){e?console.log(e):i.headSps[3].spriteFrame=new cc.SpriteFrame(t)})),console.log(t)},update:function(){if(this.joinBtnNode.active&&this.data){var e=Math.floor((this.data.tournament.endTimeMS-Date.now())/1e3);0<e&&(this.remainTimeLabel.string=i.formatTimeDay(e))}},onJoinClick:function(){var e=this.data.tournament.contextId;TournamentMgr.stopContextTick(),window.FBInstant&&FBInstant.context.getID()!=e?(o.logEvent("recommend_show_join"),s.showLoading(),FBInstant.context.switchAsync(e).then(function(){o.logEvent("recommend_suc_join"),window.isInTournament=!0,i.playGame()}).catch(function(e){console.log(e),s.hideLoading()})):i.playGame()},onCollectClick:function(){var e=this.data;0<e.getSelfRank()&&(a.get().setTournamentRewardStatus(e.tournament.contextId),this.rewardBtn.interactable=!1,a.get().addDiamon(this.rewardCount),s.getPage(s.GIFTPAGE).getComponent("GiftPage").setAppleCount(this.rewardCount),s.showDialog(s.GIFTPAGE,!0))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],TournamentMgr:[function(e,t,n){"use strict";cc._RF.push(t,"3b1f4g3eDhBybsY6pjQVcSZ","TournamentMgr");var h=window.GAME_ID,d=e("AdHelper"),u=e("User"),i=function(){var e="id1";return window.FBInstant&&(e=window.FBInstant.context.getID()),e},p=function(){var e="id1";return window.FBInstant&&(e=window.FBInstant.player.getID()),e},l=function(){var e="id1";return window.FBInstant&&(e=window.FBInstant.player.getPhoto()),e},g=function(){var e="id1";return window.FBInstant&&(e=window.FBInstant.player.getName()),e},o="3053685338071896",a="3800051926690195",f=function(){function i(e){this.creatorId="",this.creatorName="",this.creatorHead="",this.payload=null,this.contextId=e.contextId,this.endTime=e.endTime,this.createTime=this.endTime-172800,this.endTimeMS=1e3*this.endTime,this.createTimeMS=1e3*this.createTime}return Object.defineProperty(i.prototype,"isExpired",{get:function(){return 0<Date.now()-this.endTimeMS},enumerable:!0,configurable:!0}),i.prototype.toString=function(){return"contextId:"+this.contextId+";    isExpired:"+this.isExpired+"\tendTime:"+this.endTime+";\tcreateTime:"+this.createTime},Object.defineProperty(i.prototype,"remainSecs",{get:function(){return Math.floor((this.endTimeMS-Date.now())/1e3)},enumerable:!0,configurable:!0}),i.fromMSG=function(e){var t=new i({contextId:e.ctx,endTime:e.et});t.creatorId=e.cid,t.creatorName=e.cn,t.creatorHead=e.cp;try{t.payload=JSON.parse(e.pld||null)||null}catch(e){console.log("payload error")}return t},i.fromSelf=function(e,t){var n=new i({contextId:e,endTime:t});n.creatorId=p(),n.creatorName=g(),n.creatorHead=l();try{n.payload=null}catch(e){console.log("payload error")}return n},i}(),m=function(){function r(){this.total=0,this.tournament=null,this.friends=[],this.entry=null,this.entries=[]}return r.fromMSG=function(i,e){var o=new r;o.total=i.total||0,o.tournament=f.fromMSG(i.tInfo),console.log("fromMSG ",i);var t=i.myRank||-1;if(-1!=t&&(o.entry={},o.entry.id=p(),o.entry.name=g(),o.entry.photo=l(),o.entry.rank=t,o.entry.score=i.myScore),i.fJoin&&0<i.fJoin.length){var a={};e.forEach(function(e){return a[e.getID()]=e});var s=[];i.fJoin.forEach(function(e,t){if(a[e]){var n={score:i.fScore[t],id:a[e].getID(),name:a[e].getName(),photo:decodeURIComponent(a[e].getPhoto())};s.push(n)}}),o.friends=s}var c=!1;if(i.top&&0<i.top.length&&(o.entries=i.top.map(function(e,t){var n={id:e.id,name:e.name,photo:decodeURIComponent(e.photo),rank:t+1,score:e.score};return e.id==p()&&(c=!0,o.entry=n),n})),!c&&o.entry&&o.entries.push(o.entry),o.entries.sort(function(e,t){return t.score-e.score}),o.entry){var n={id:p(),name:g(),photo:l(),score:0};n.score=o.entry.score,o.friends.push(n),o.friends.sort(function(e,t){return t.score-e.score}),o.friends.forEach(function(e,t){return e.rank=t+1})}return console.log("friends -===",o.friends),console.log("getPlayerId() = "+p()),o},r.prototype.updateSelfScore=function(a){var e=function(e,t){for(var n=-1,i=0;i<e.length;i++)if(e[i].id==p()){n=i;break}if(-1!=n){if(!(a>e[n].score))return e;e[n].score=a,this.entry=e[n]}else{var o={id:p(),name:g(),photo:l(),score:a};e.push(o),this.entry=o,t&&(console.log("updateSelfScore 0000 this.total = "+this.total),this.total=this.total+1)}return e.sort(function(e,t){return t.score-e.score}),e.forEach(function(e,t){return e.rank=t+1}),e}.bind(this);this.friends=e(this.friends,!0),this.entries=e(this.entries,!1),this.entries=this.entries.slice(0,3)},r.fromSelf=function(e,t){var n=new r;n.total=1,n.tournament=f.fromSelf(e,t);return n.entry={},n.entry.id=p(),n.entry.name=g(),n.entry.photo=l(),n.entry.rank=1,n.entry.score=window.lastScore,n.entries.push(n.entry),n},r.prototype.getTopPercent=function(e){return Math.max(1,Math.floor(e/this.total*100))},r.prototype.getSelfScore=function(){console.log("getSelfScore -===",this.friends),console.log("getPlayerId() = "+p());for(var e=0;e<this.friends.length;e++)if(this.friends[e].id==p())return this.friends[e].score;return 0},r.prototype.getSelfRank=function(){for(var e=0;e<this.entries.length;e++)if(this.entries[e].id==p())return this.entries[e].rank;return-9999},r}(),s=function(){function e(){}return e.postToServer=function(e,t,n){void 0===n&&(n=function(e){});var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState){console.log(i.responseText);try{n(JSON.parse(decodeURIComponent(i.responseText)))}catch(e){n(i.responseText)}}};var o="";if(t)for(var a=Object.keys(t),s=0;s<a.length;s++){var c=t[a[s]];if(!Array.isArray(c)||0!=c.length)if(0<s&&(o+="&"),Array.isArray(c))for(var r=0;r<c.length;r++)0<r&&(o+="&"),o+=a[s]+"="+encodeURIComponent(c[r]);else o+=a[s]+"="+encodeURIComponent(c)}i.send(o),console.log("post ",e),console.log("params ",o)},e.startContextTick=function(){var e=this;this.stopContextTick(),this.lastContextId=i(),this.intervalHander=setInterval(function(){e.lastContextId!=i()&&(e.stopContextTick(),window.isInTournament=!0,d.logEvent("feed_share"),e.onUserCreatedTournament(i()))},16)},e.stopContextTick=function(){this.intervalHander&&(clearInterval(this.intervalHander),this.intervalHander=null)},e.isOverdueTournamentId=function(e){if(e==o||e==a)return!0},e.getOverdueTournamentId=function(){return i()==a?o:a},e.onUserCreatedTournament=function(e){var t={contextId:e,endTime:Math.floor(Date.now()/1e3)+604800};this.createdTournament(t,p(),g(),l())},e.onUserJoinTournament=function(i,o){var a=this,s=Math.floor(Date.now()/1e3)+259200;this.isExsitContextId(i,function(e){if(null!=e){s=e.tournament.endTime;var t=o.filter(function(e){return e.playerId!=p()})[0],n={contextId:i,endTime:s};a.createdTournament(n,t.playerId,t.name,encodeURIComponent(t.photo))}})},e.getSelfScoreByContextId=function(e){for(var t=0;t<this.suggested_tournaments.length;t++)if(this.suggested_tournaments[t].tournament.contextId==e)return this.suggested_tournaments[t].getSelfScore();return 0},e.getTournamentDataByContextId=function(e){for(var t=0;t<this.suggested_tournaments.length;t++)if(this.suggested_tournaments[t].tournament.contextId==e)return this.suggested_tournaments[t];return null},e.isExsitContextId=function(e,t){var n=this;null!=this.suggested_tournaments?this.checkTournaments(e,t):this.reqTournamentIdsCb=function(){n.checkTournaments(e,t)}},e.checkTournaments=function(e,t){t(this.getTournamentDataByContextId(e))},e.resetSelfScore=function(e,t){for(var n=null,i=0;i<this.suggested_tournaments.length;i++)this.suggested_tournaments[i].tournament.contextId==e&&(n=this.suggested_tournaments[i]);null!=n&&n.updateSelfScore(t)},e.createdTournament=function(e,t,n,i){var o=this,a={playerId:p(),tInfo:{ctx:e.contextId,et:e.endTime,ct:1,cid:void 0,cl:void 0,cn:void 0,cp:void 0,pld:JSON.stringify({})}};a.tInfo.cid=t,a.tInfo.cn=n,a.tInfo.cp=encodeURIComponent(i),a.tInfo.cl=cc.sys.language,u.get().setTournamentLastCreateTime(Date.now()),this.checkPushPlayerSelf(e),d.logEvent("tournament_share_suc"),a.tInfo=JSON.stringify(a.tInfo);var s="https://fb-api-new.capjoy.com/fbgame/v0/tournament_update_"+h;this.postToServer(s,a,function(e){0==e.error?o.postSessionScoreAsync(window.lastScore):console.log("tournament_update failed",e)})},e.watchTournament=function(a,e,t){var s=this;console.log("watchTournament ..."),this.isOverdueTournamentId(a.contextId)||u.get().getContextPlayers(function(e){var t=e.length,n={playerId:p(),tInfo:{ctx:a.contextId,et:a.endTime,ct:t,cid:void 0,cl:void 0,cn:void 0,cp:void 0,pld:JSON.stringify({})}};if(t<=1)n.tInfo.cid=p(),n.tInfo.cn=g(),n.tInfo.cp=encodeURIComponent(l()),n.tInfo.cl=cc.sys.language,u.get().setTournamentLastCreateTime(Date.now()),s.checkPushPlayerSelf(a),d.logEvent("tournament_share_suc");else if(2==t){var i=e.filter(function(e){return e.playerId!=p()})[0];i&&(n.tInfo.cid=i.playerId,n.tInfo.cn=i.name,n.tInfo.cp=encodeURIComponent(i.photo),n.tInfo.cl=cc.sys.language)}n.tInfo=JSON.stringify(n.tInfo);var o="https://fb-api-new.capjoy.com/fbgame/v0/tournament_update_"+h;s.postToServer(o,n,function(e){0==e.error?s.postSessionScoreAsync(window.lastScore):console.log("tournament_update failed",e)})})},e.checkPushPlayerSelf=function(e){for(var t=!0,n=0;n<this.suggested_tournaments.length;n++)if(e.contextId==this.suggested_tournaments[n].tournament.contextId){t=!1;break}t&&this.suggested_tournaments.push(m.fromSelf(e.contextId,e.endTime))},e.postSessionScoreAsync=function(o){var a=this;if(window.FBInstant)if(o<=0)console.log("postSessionScoreAsync error score",o);else{var s=i();this.checkTournaments(s,function(e){if(null!=e)if(!window.isInTournament||0<Date.now()-1e3*e.tournament.endTime)console.log("postSessionScoreAsync err",window.isInTournament,0<Date.now()-1e3*e.tournament.endTime);else{var t=u.get().getTournamentScore(s);if(o<=t)console.log("skip  tournament_update_score");else{a.resetSelfScore(s,o);var n="https://fb-api-new.capjoy.com/fbgame/v0/tournament_update_score_"+h,i={ctxId:s,sc:o,pid:p(),name:g(),photo:encodeURIComponent(l())};a.postToServer(n,i,function(e){0==e.error&&0<e.score&&u.get().setTournamentScore(s,o)})}}else console.log("checkTournamentstournamentData null")})}else console.log("postSessionScoreAsync error no fb")},e.reqTournamentIds=function(s,c,r){var l=this;if(void 0===c&&(c=!0),void 0===r&&(r=!0),window.FBInstant){var o="https://fb-api-new.capjoy.com/fbgame/v1/tournament_request_"+h;null==this.suggested_tournaments?(this.suggested_tournaments=[],u.get().getConnectedPlayersAsync(function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].getID());var i={pid:p(),friends:t,locale:cc.sys.language};l.postToServer(o,i,function(e){if(0==e.error){var i=e.data&&e.data.my||[],o=e.data&&e.data.friend||[],a={};u.get().getConnectedPlayersAsync(function(t){var e=i.map(function(e){return m.fromMSG(e,t)}),n=o.map(function(e){return m.fromMSG(e,t)});e.forEach(function(e){return 0<e.total&&!a[e.tournament.contextId]&&(l.suggested_tournaments.push(e),a[e.tournament.contextId]=!0)}),n.forEach(function(e){return 0<e.total&&!a[e.tournament.contextId]&&(l.suggested_tournaments.push(e),a[e.tournament.contextId]=!0)}),d.logEvent("tournament_count",{count:l.suggested_tournaments.length}),console.log("this.suggested_tournaments",l.suggested_tournaments),null!=l.reqTournamentIdsCb&&l.reqTournamentIdsCb(),s(l.hanlderDatas(c,r))})}})})):s(this.hanlderDatas(c,r))}else s([])},e.hanlderDatas=function(e,t){var n=this.suggested_tournaments.concat();return e&&(n=n.filter(function(e){return 0<e.tournament.remainSecs||-9999!=e.getSelfRank()&&1!=u.get().getTournamentRewardStatus(e.tournament.contextId)})),t?this.sortDatas(n):n},e.sortDatas=function(e){return e.sort(function(e,t){return e.tournament.remainSecs<=0&&t.tournament.remainSecs<=0?e.getSelfRank()-t.getSelfRank():0<e.tournament.remainSecs&&0<t.tournament.remainSecs?t.total-e.total:e.tournament.remainSecs-t.tournament.remainSecs}),e},e.reqTournamentInfo=function(e,n){if(window.FBInstant){var t="https://fb-api-new.capjoy.com/fbgame/v1/tournament_info_"+h,i={pid:p(),ctxId:e};this.postToServer(t,i,function(t){console.log(t),0==t.error?u.get().getConnectedPlayersAsync(function(e){n(m.fromMSG(t.data,e))}):n(null)})}else n(null)},e.rewardCfg=[1e3,600,400,200],e.suggested_tournaments=null,e.reqTournamentIdsCb=null,e.intervalHander=null,e.lastContextId=null,e}();window.TournamentMgr=s,cc._RF.pop()},{AdHelper:"AdHelper",User:"User"}],TurntableDialog:[function(e,t,n){"use strict";cc._RF.push(t,"bdeb67amZVGQ5GN+HxeM/IH","TurntableDialog");e("PageMgr");var i=e("AdHelper");cc.Class({extends:cc.Component,properties:{dialog_tip:cc.Label,btn_random:cc.Button,turntableNode:cc.Node,turntable:cc.Node,coka1:cc.Sprite,coka2:cc.Sprite,coka3:cc.Sprite,coka4:cc.Sprite,coka5:cc.Sprite,coka6:cc.Sprite,curCoka:cc.Sprite},onEnable:function(){this.dialog_tip.node.opacity=255,this.turntableNode.scale=0,this.turntableNode.rotation=0,this.turntable.rotation=0,this.curCoka.node.active=!1,this.curCoka.node.scale=1,this.curCoka.node.x=0,this.curCoka.node.y=90,this.curCoka.node.stopAllActions(),this.prizeRotation=[0,60,120,180,240,300],this.prizes=[this.coka1,this.coka2,this.coka3,this.coka4,this.coka5,this.coka6],this.prize_id=-1,this.turntableNode.runAction(cc.scaleTo(.2,1));var e=cc.scaleTo(1,1.5),t=cc.scaleTo(1,1);e.easing(cc.easeBackInOut(1)),t.easing(cc.easeBackInOut(1)),this.btn_random.node.runAction(cc.repeatForever(cc.sequence(e,t,cc.delayTime(.5)))),this.setupInput(),i.logEvent("spin_show")},onTouchBegan:function(){this.btn_random.node.stopAllActions(),this.btn_random.node.scale=2},onTouchMove:function(){},onTouchEnd:function(){var e=cc.scaleTo(.5,1);this.btn_random.node.runAction(e),this.onRandomHand(),this.removeInput(),i.logEvent("spin_click")},setupInput:function(){this.removeInput(),this.btn_random.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.btn_random.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.btn_random.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.btn_random.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},removeInput:function(){this.btn_random.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.btn_random.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.btn_random.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.btn_random.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},start:function(){},onRandomHand:function(){var t=this,e=this.GetRandomNum(0,5);this.prize_id=e,this.dialog_tip.node.runAction(cc.fadeOut(1));var n=this.prizes[e];this.getComponent("SpinLottery").run(e,function(){t.curCoka.spriteFrame=n.spriteFrame,t.curCoka.node.active=!0;var e=cc.scaleTo(.3,3);console.log("this.turntable.runActionthis.turntable.runAction"),t.curCoka.node.runAction(cc.sequence(e,cc.delayTime(.5),cc.callFunc(function(){t.hideTurntable(t.curCoka)})))})},getPrizeId:function(){return this.prize_id},setFinishCallback:function(e){this.onFinishCb=e},hideTurntable:function(e){var t=this,n=cc.scaleTo(.2,0);this.turntableNode.runAction(cc.sequence(n,cc.callFunc(function(){console.log("this.prize_idthis.prize_id:",t.prize_id),t.onFinishCb(t.prize_id)}))),e.node.runAction(cc.moveTo(.4,0,2e3))},GetRandomNum:function(e,t){var n=t-e,i=Math.random();return e+Math.round(i*n)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr"}],User:[function(e,t,n){"use strict";cc._RF.push(t,"1c533BAPW5G/5VBJFn8NQSQ","User");var c=e("SoundMgr"),o=e("PageMgr"),i=e("PlayerLvData"),a=e("PowerUpData"),d=e("Utils"),s=e("AdHelper"),u=e("md5"),r=null,l=function(){this.init()},h={time:Date.now(),curIndex:0,status:"unlocked",count:0},p={lastLoginTime:Date.now(),curMaxStage:0,curMaxKnife:0,curMaxRankKnife:0,diamon:50,curKnifeId1:1,unlockedKnife1:{1:!0},bossKnifeCount:0,videoKnifeData:{},videoKnifeCount:0,isShowGuide:!0,curTimeIndex:0,lastGiftTime:Date.now(),dir:!0,bossRecordNew:{},bossRecordDefented:{},player_lv:1,player_exp:0,chance_second:0,chance_extra:0,chance_giftApple:0,chance_goldApple:0,chance_videoApple:0,chance_doubleXp:0,groupContextsNew:[],chance_friends:{rate:0,startDay:0},friends_records:{},invite_continue:{count:10,startDay:0},newcountleft:0,lastSendFriendsTime:0,weeklyScore:{index:0,score:0},friendRankOpen:!1,botfriendsNew:[],lastShowNotice:0,isPKOpen:!1,aabb:!1,aacc:!1,isShortCreated:!1,payInfo:[],knifeFriends:{},adShowCount:0,halloween:{sweetCount:0,count:5,time:Date.now()},dailyTask:h,lastSpinTime:0,lastVideoTime:0,lastShowHoroscope:0,vsCollectedIds:{},tournamentLastCreateTime:0,tournamentInfoScore:{},tournamentInfo:{}},g=["1850445281733046","1733136923430740","1778769835493391","1693191317436282","1684508601665167","2160169987332938","1568793599895780","1672957819426594"],f=["week_1","week_2_","week_3","week_4","week_5","week_6","week_7","week_8","week_9","week_10","week_11","week_12","week_13","week_14","week_15","week_16","week_17"];l.get=function(){return r||(r=new l),r};var m=0;l.prototype.getLastLoginTime=function(){return m};var y=!(l.prototype.getVersion=function(){var t=0;if(!window.FBInstant)return t;var e=FBInstant.player.getID();try{t=parseInt(e.substring(e.length-2,e.length))}catch(e){return t}return t}),v={};l.prototype.initPay=function(){FBInstant.getSupportedAPIs().indexOf("payments.purchaseAsync")&&(FBInstant.payments.onReady(function(){y=!0}),FBInstant.payments.getCatalogAsync().then(function(e){for(var t=0;t<e.length;t++)v[e[t].productID]=e[t].price}).catch(function(e){}),FBInstant.payments.getPurchasesAsync().then(function(e){for(var t in e)FBInstant.payments.consumePurchaseAsync(e[t].purchaseToken).then(function(){}).catch(function(e){})}))},l.prototype.isPayReady=function(){return!FBInstant||y},l.prototype.getPrice=function(e,t){return v[e]||t},l.prototype.purchase=function(e,t,n){var i=this;y?(o.showLoading(),FBInstant.payments.purchaseAsync({productID:e,developerPayload:"knifelast"}).then(function(e){FBInstant.payments.consumePurchaseAsync(e.purchaseToken).then(function(){o.hideLoading(),t&&t()}).catch(function(e){o.hideLoading(),n&&n(e.message),s.logEvent("pay_consume_error",{code:e.code,message:e.message})}),p.payInfo.push({paymentID:e.paymentID,signedRequest:e.signedRequest}),i.save()}).catch(function(e){o.hideLoading(),n&&n(e.message),s.logEvent("pay_purchase_error",{code:e.code,message:e.message})})):FBInstant?n&&n("pay not ready"):t()},l.prototype.isAdRemoved=function(){return p.aabb},l.prototype.setRemoveAd=function(){p.aabb=!0,this.save()},l.prototype.isFreeContinue=function(){return p.aacc},l.prototype.setFreeContinue=function(){p.aacc=!0,this.save()},l.prototype.setBothFree=function(){p.aabb=!0,p.aacc=!0,this.save()};l.prototype.isPKOpen=function(){return p.isPKOpen},l.prototype.markPKOpen=function(){p.isPKOpen=!0},l.prototype.isShortCreated=function(){return p.isShortCreated},l.prototype.markShortCreated=function(){p.isShortCreated=!0},l.prototype.createShortcut=function(t){window.FBInstant&&!l.get().isShortCreated()?FBInstant.canCreateShortcutAsync().then(function(e){e?(s.logEvent("shortCut_show"),FBInstant.createShortcutAsync().then(function(){s.logEvent("shortCut_suc"),t&&t()}).catch(function(){t&&t()})):t&&t()}).catch(function(){t&&t()}):t&&t()},l.prototype.subscribeBot=function(e){window.FBInstant?FBInstant.player.canSubscribeBotAsync().then(function(){s.logEvent("bot_show"),FBInstant.player.subscribeBotAsync().then(function(){s.logEvent("bot_suc"),e&&e()}).catch(function(){e&&e()})}).catch(function(){e&&e()}):e&&e()},l.prototype.addFriendsCount=function(e){p.knifeFriends[e]=p.knifeFriends[e]||0,p.knifeFriends[e]++,this.save()},l.prototype.getFriendsCount=function(e){return p.knifeFriends[e]||0},l.prototype.getBotFriendsFilterd=function(e,t){for(var n={action:"playerInfo",playerId:FBInstant.player.getID(),payload:{}},i=0;i<e.length;i++)n.payload[e[i].getID()]={};return t&&t(n),[]};var I=1538982e3,A=0;l.prototype.getFriendRankName=function(){return A<f.length?f[A]:f[f.length-1]},l.prototype.isFriendOpen=function(){return p.friendRankOpen},l.prototype.markFriendOpen=function(){p.friendRankOpen||(p.friendRankOpen=!0,this.save())},l.prototype.getRankResetLeft=function(){for(var e=Math.floor(Date.now()/1e3);I<e;)A++,I+=604800;return d.formatTime(Math.floor((I-e)/60))},l.prototype.isBlocked=function(e){return 0<=g.indexOf(e||FBInstant.player.getID())},l.prototype.addAdShowCount=function(){p.adShowCount++,this.save()},l.prototype.sendFriendEvent=function(){if(FBInstant&&864e5<Date.now()-p.lastSendFriendsTime){p.lastSendFriendsTime=Date.now();var e=p.adShowCount;p.adShowCount=0,this.save(),this.getConnectedPlayersAsync(function(e){e.length,FBInstant.logEvent("player_friend_count",e.length,{count:e.length});for(var t=window.part1,n=window.part2,i=window.part3,o=window.part4,a={action:"friends",playerId:FBInstant.player.getID(),payload:[]},s=0;s<e.length;s++)a.payload.push(e[s].getID());var c=JSON.stringify(a),r=u(c+t+n+i+o),l=new XMLHttpRequest;l.open("POST","https://fb-bot.capjoy.com/api/v0/upload_11"),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){l.readyState};var h="data="+c+"&sign="+r;l.send(h)}),FBInstant.logEvent("apple_count",p.diamon,{count:Math.floor(p.diamon/500),playerLv:p.player_lv,max_knife:p.curMaxKnife});var t=0;for(var n in p.unlockedKnife1)t++;FBInstant.logEvent("knife_count",t,{count:t}),FBInstant.logEvent("WebRenderType",1,{type:cc._renderType}),FBInstant.logEvent("GpuInfo",1,{maxTextureSize:cc.configuration.getMaxTextureSize(),maxTextureUnits:cc.configuration.getMaxTextureUnits(),nPot:cc.configuration.supportsNPOT()?1:0,vao:cc.configuration.supportsShareableVAO()?1:0,version:cc.configuration.getValue("gl.version")}),FBInstant.logEvent("day_adshow_count",e,{count:e})}else FBInstant&&this.getConnectedPlayersAsync(function(e){e.length},function(e){console.log(e)})},l.prototype.isShowNotice=function(){var e=864e5<=Date.now()-p.lastShowNotice;return e&&(p.lastShowNotice=Date.now(),this.save()),e},l.prototype.isShowHoroscope=function(){return 864e5<=Date.now()-p.lastShowHoroscope},l.prototype.markShowHoroscope=function(){p.lastShowHoroscope=Date.now(),this.save()},l.prototype.getRankName=function(){return"rank_hight_score_global"},l.prototype.init=function(){this.isLoad=!1;for(var e=Math.floor(Date.now()/1e3);I<e;)A++,I+=604800},l.prototype.setGuideEnd=function(){p.isShowGuide=!1,this.save()},l.prototype.decAndGetCount=function(){return p.newcountleft--,0<=p.newcountleft&&this.save(),p.newcountleft},l.prototype.getDiamonCount=function(e){return p.diamon},l.prototype.addDiamon=function(e){isNaN(p.diamon)&&(p.diamon=0),p.diamon+=e,this.save()},l.prototype.decDiamon=function(e){p.diamon-=e,this.save()},l.prototype.addOneDiamon=function(e){var t=1;e&&(t*=2),this.addDiamon(t)};l.prototype.addShareDiamon=function(){this.addDiamon(30),this.save()};l.prototype.addAdDiamon=function(e){var t=e?2:1;return this.addDiamon(this.getAdDiamonCount()*t),this.save(),this.getAdDiamonCount()*t},l.prototype.getAdDiamonCount=function(){return Math.floor(60*(1+this.getChance_videoApple()/100))},l.prototype.getFreeGiftCount=function(){return Math.floor((100+Math.random()*this.getPlayer_lv())*(1+this.getChance_giftApple()/100))},l.prototype.getMaxStage=function(){return p.curMaxStage},l.prototype.getMaxScore=function(){return p.curMaxKnife};var T=0;l.prototype.resetSessionScore=function(){T=0},l.prototype.isPassSessionScore=function(e){return T<e},l.prototype.updateScoreAndStage=function(e,t){return window.lastScore=e,window.FBInstant&&T<e&&(FBInstant&&"SOLO"==FBInstant.context.getType()&&TournamentMgr.startContextTick(),console.log("postSessionScore",e),FBInstant.postSessionScore(e),FBInstant.logEvent("post_tourament",1,{}),T=e,TournamentMgr.postSessionScoreAsync(e)),6<=t&&(p.isPKOpen=!0),RankUtils.updateScore(e,{stageNum:p.curMaxStage,knifeId:this.getCurKnife()}),console.log(e,this.getMaxScore()),(e>this.getMaxScore()||t>this.getMaxStage())&&(p.curMaxStage=Math.max(p.curMaxStage,t),p.curMaxKnife=Math.max(p.curMaxKnife,e),p.curMaxKnife>30*t&&(p.curMaxKnife=e),this.save(),s.logEvent("max_score",{curMaxStage:p.curMaxStage,curMaxKnife:p.curMaxKnife,player_lv:p.player_lv}),!0)},l.prototype.getCurKnife=function(){return p.curKnifeId1},l.prototype.setCurKnife=function(e){p.curKnifeId1=e,this.save()},l.prototype.isKnifeUnlock=function(e){return p.unlockedKnife1[e+""]},l.prototype.getUnlockBossCount=function(){return p.bossKnifeCount},l.prototype.addWatchVideoCount=function(e){var t=p.videoKnifeData[e]||0;p.videoKnifeData[e]=t+1,this.save()},l.prototype.getVideoWatchCount=function(e){return p.videoKnifeData[e]||0},l.prototype.getUnlockVideoCount=function(){return p.videoKnifeCount},l.prototype.unlockKnife=function(e,t,n,i){this.decDiamon(t),p.unlockedKnife1[e]=!0,n&&p.bossKnifeCount++,i&&p.videoKnifeCount++,this.save()};var S=[10,30,60,120,240,480];l.prototype.isGiftAvailable=function(){return Date.now()-p.lastGiftTime>60*S[p.curTimeIndex]*1e3},l.prototype.getGiftLeftTime=function(){var e=60*S[p.curTimeIndex]-Math.ceil((Date.now()-p.lastGiftTime)/1e3),t=e%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,t=((e=Math.floor(e/60))<10?"0"+e:e)+t},l.prototype.collectGift=function(e){p.lastGiftTime=Date.now(),p.curTimeIndex++,p.curTimeIndex>=S.length&&(p.curTimeIndex=S.length-1),this.addDiamon(e)};l.prototype.isSpinAvailable=function(){return 288e5<Date.now()-p.lastSpinTime},l.prototype.getSpinLeftTime=function(){var e=28800-Math.ceil((Date.now()-p.lastSpinTime)/1e3),t=e%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,t=((e=Math.floor(e/60))<10?"0"+e:e)+t},l.prototype.resetSpinTime=function(e){p.lastSpinTime=Date.now(),this.save()},l.prototype.isVideoAvailable=function(){return 288e5<Date.now()-p.lastVideoTime},l.prototype.getVideoLeftTime=function(){var e=28800-Math.ceil((Date.now()-p.lastVideoTime)/1e3),t=e%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,t=((e=Math.floor(e/60))<10?"0"+e:e)+t},l.prototype.resetVideoTime=function(e){p.lastVideoTime=Date.now(),this.save()},l.prototype.getBossStageIndex=function(e){return p.bossRecordNew[e]?p.bossRecordNew[e]:1},l.prototype.addBossStageIndex=function(e,t){p.bossRecordNew[e]=p.bossRecordNew[e]||1,p.bossRecordNew[e]++,t&&p.bossRecordNew[e]>t+1&&(p.bossRecordNew[e]=t+1),this.save()},l.prototype.isBossDefented=function(e){return p.bossRecordDefented[e]},l.prototype.markBossDefented=function(e){p.bossRecordDefented[e]=!0},l.prototype.getBossDefentedCount=function(){return Object.keys(p.bossRecordDefented).length},l.prototype.getPlayer_lv=function(){return p.player_lv},l.prototype.setPlayer_lv=function(e){p.player_lv=e,this.save()},l.prototype.getPlayer_exp=function(){return p.player_exp},l.prototype.getMaxExp=function(){return i.getData(this.getPlayer_lv())},l.prototype.isMaxLevel=function(){return p.player_lv>=i.getMaxLv()&&p.player_exp==this.getMaxExp()},l.prototype.addExp=function(e){if(p.player_lv>=i.getMaxLv()&&p.player_exp+e>=this.getMaxExp())return p.player_exp=this.getMaxExp(),void this.save();if(p.player_exp+=e,p.player_exp>=this.getMaxExp()){p.player_exp-=this.getMaxExp();var t=a.getData(p.player_lv);switch(p.player_lv+=1,t.type){case 1:this.addChanceSecond(t.data);break;case 2:this.addChanceExtra(t.data);break;case 3:this.addChanceGiftApple(t.data);break;case 4:this.addChancGoldApple(t.data);break;case 5:this.addChanceVideoApple(t.data);case 6:this.addChanceDoubleXp(t.data)}s.logEvent("max_player_level",{curMaxStage:p.curMaxStage,curMaxKnife:p.curMaxKnife,player_lv:p.player_lv})}return this.save(),t&&t.type},l.prototype.getChanceTyType=function(e){switch(e){case 1:return this.getChance_second();case 2:return this.getChance_extra();case 3:return this.getChance_giftApple();case 4:return this.getChance_goldApple();case 5:return this.getChance_videoApple();case 6:return this.getChance_doubleXp()}},l.prototype.setPlayer_exp=function(e){p.player_exp=e,this.save()},l.prototype.getChance_second=function(){return p.chance_second},l.prototype.addChanceSecond=function(e){p.chance_second+=e,this.save()},l.prototype.getChance_extra=function(){return 100},l.prototype.addChanceExtra=function(e){p.chance_extra+=e,this.save()},l.prototype.getChance_giftApple=function(){return p.chance_giftApple},l.prototype.addChanceGiftApple=function(e){p.chance_giftApple+=e,this.save()},l.prototype.getChance_goldApple=function(){return p.chance_goldApple},l.prototype.addChancGoldApple=function(e){p.chance_goldApple+=e,this.save()},l.prototype.getChance_videoApple=function(){return p.chance_videoApple},l.prototype.addChanceVideoApple=function(e){p.chance_videoApple+=e,this.save()},l.prototype.getChance_doubleXp=function(){return p.chance_doubleXp},l.prototype.addChanceDoubleXp=function(e){p.chance_doubleXp+=e,this.save()},l.prototype.getFriendsChance=function(){return p.chance_friends.rate},l.prototype.addFriendsChance=function(e,t){e&&!this.isFriendsInvited(e)&&(p.chance_friends.rate+=10,t&&(p.chance_friends.rate+=10),100<p.chance_friends.rate&&(p.chance_friends.rate=100),p.friends_records[e]=Date.now(),this.save())};l.prototype.isFriendsInvited=function(e){var t=p.friends_records[e]||0;return Date.now()-t<864e5},l.prototype.getInviteContinueCount=function(){return p.invite_continue.count},l.prototype.decInviteContinueCount=function(){p.invite_continue.count--,0<=p.invite_continue.count&&this.save()},l.prototype.getFriendTimeLeft=function(e){var t=864e5-Math.ceil(Date.now()-p.friends_records[e]);return t=Math.floor(t/6e4),d.formatTime(t)},l.prototype.load=function(t){var e=null,n=this;FBInstant?FBInstant.player.getDataAsync(["data_cookingdaily"]).then(function(e){if(void 0!==e.data_cookingdaily)try{n.setData(JSON.parse(e.data_cookingdaily))}catch(e){}n.isLoad=!0,t()}):((e=cc.sys.localStorage.getItem("data_cookingdaily"))&&n.setData(JSON.parse(e)),t(),n.isLoad=!0)};var C=function(e){return e<20?e:1e4<=e&&e<=70001?Math.floor(e/1e4)+e%10:1000001<=e&&e<=10000004?1e3+e%10:void 0};l.prototype.setData=function(t){if(Object.keys(t).forEach(function(e){p[e]=t[e]}),m=p.lastLoginTime,p.lastLoginTime=Date.now(),t.curKnifeId){p.curKnifeId1=C(t.curKnifeId),p.curKnifeId=null;var e=Object.keys(p.unlockedKnife);p.unlockedKnife1={};for(var n=0;n<e.length;n++)p.unlockedKnife1[C(e[n])]=!0;p.unlockedKnife=null,this.save()}p.unlockedKnife&&(p.unlockedKnife[1]=!0);var i=new Date,o=new Date;o.setMonth(0),o.setDate(1);var a=i-o,s=Math.ceil(a/864e5);1<=s-p.chance_friends.startDay&&(p.chance_friends.startDay=s,p.chance_friends.rate=0),s-p.invite_continue.startDay&&(p.invite_continue.startDay=s,p.count=10),c.init(p.musicEnable,p.soundEnable),6<=p.curMaxStage&&(p.isPKOpen=!0),p.dailyTask&&864e5<Date.now()-p.dailyTask.time&&(p.dailyTask=h)},l.prototype.clearData=function(){FBInstant&&FBInstant.player.setDataAsync({data_cookingdaily:{}}),cc.sys.localStorage.removeItem("data_cookingdaily")},l.prototype.save=function(){p.soundEnable=c.isSoundEnable(),p.musicEnable=c.isMusicEnable(),this.isLoad&&(FBInstant?FBInstant.player.setDataAsync({data_cookingdaily:JSON.stringify(p)}):cc.sys.localStorage.setItem("data_cookingdaily",JSON.stringify(p)))},l.prototype.setRankScore=function(e,t,n,i){window.FBInstant&&(this.isBlocked(FBInstant.player.getID())||FBInstant.getLeaderboardAsync(e).then(function(e){return e.setScoreAsync(t,n||"")}).then(function(){i&&i()}).catch(function(e){i&&i(),console.log("error",e)}))},l.prototype.getMyRank=function(n,i){FBInstant&&FBInstant.getLeaderboardAsync(n).then(function(e){return e.getPlayerEntryAsync()}).then(function(e){var t={photo:e.getPlayer().getPhoto(),nickName:e.getPlayer().getName(),rank:e.getRank(),score:e.getScore(),costomData:e.getExtraData()};i(t,n)})},l.prototype.getSound=function(){return p.sound},l.prototype.setSound=function(e){p.sound=e,this.save()},l.prototype.getDir=function(){return p.dir},l.prototype.setDir=function(e){p.dir=e,this.save()},l.prototype.setTournamentScore=function(e){p.tournamentInfoScore[e]=score,this.save()},l.prototype.getTournamentScore=function(e){return p.tournamentInfoScore[e]||0},l.prototype.setTournamentRewardStatus=function(e){p.tournamentInfo[e]=1,this.save()},l.prototype.getTournamentRewardStatus=function(e){return p.tournamentInfo[e]||0},l.prototype.setTournamentLastCreateTime=function(e){p.tournamentLastCreateTime=e,this.save()},l.prototype.getTournamentLastCreateTime=function(){return p.tournamentLastCreateTime};var k=null,b=[];l.prototype.getConnectedPlayersAsync=function(e,t){window.FBInstant?k?e(k):(b.push(e),1<b.length||FBInstant.player.getConnectedPlayersAsync().then(function(t){k=t,b.forEach(function(e){e(t)}),b=[]}).catch(function(e){console.log("getConnectedPlayersAsync",e),t?t():b.forEach(function(e){e([])}),b=[]})):e([])};var w=[];l.prototype.getContextPlayers=function(e){window.FBInstant&&"SOLO"!=FBInstant.context.getType()?(w.push(e),1<w.length||FBInstant.context.getPlayersAsync().then(function(e){for(var t=[],n=0;n<e.length;n++)t.push({playerId:e[n].getID(),name:e[n].getName(),photo:e[n].getPhoto()});w.forEach(function(e){e(t)}),w=[]}).catch(function(e){console.log(e),w.forEach(function(e){e([])}),w=[]})):e([])},l.prototype.getRecommondId=function(){return 0==p.groupContextsNew.length?null:p.groupContextsNew[Math.floor(Math.random()*p.groupContextsNew.length)]},l.prototype.addGroupId=function(e){0<=p.groupContextsNew.indexOf(e)||(p.groupContextsNew.push(e),this.save())},l.prototype.updateGroupRank=function(t,e){if(FBInstant){var n="group_rank."+FBInstant.context.getID(),i=function(){FBInstant.updateAsync({action:"LEADERBOARD",name:n}),e()};FBInstant.getLeaderboardAsync(n).then(function(e){return e.setScoreAsync(t,"")}).then(function(){return[i()]}).catch(i)}},l.prototype.chooseFriend=function(e){TournamentMgr.stopContextTick(),s.logEvent("choose_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){e(!0),s.logEvent("choose_suc")},function(){e(!1)})},l.prototype.playWithFriend=function(e,t){var n=this;TournamentMgr.stopContextTick(),s.logEvent("recommend_show"),FBInstant.context.createAsync(e).then(function(){t(!0),s.logEvent("recommend_suc")}).catch(function(e){console.log(e),"SAME_CONTEXT"==e.code?t(!0):n.chooseFriend(function(e){t(e)})})},l.prototype.playWithGroup=function(e,t){var n=this;TournamentMgr.stopContextTick(),s.logEvent("recommend_show"),FBInstant.context.switchAsync(e).then(function(){t(!0),s.logEvent("recommend_suc"),TournamentMgr.isOverdueTournamentId(e)&&TournamentMgr.startContextTick()}).catch(function(e){console.log(e),n.chooseFriend(function(e){t(e)})})},l.prototype.challengeFriends=function(t){var a=this;TournamentMgr.stopContextTick(),o.showLoading();var n=p.groupContextsNew.length,s=function(e){o.hideLoading(),t(e)};this.getConnectedPlayersAsync(function(i){console.log(i);var e=i.length;if(e+n==0)a.chooseFriend(s);else if(Math.floor(Math.random()*(n+e))<n){var t=a.getRecommondId();a.playWithGroup(t,s)}else{var o=i[Math.floor(Math.random()*i.length)];"SOLO"!=FBInstant.context.getType()?FBInstant.context.getPlayersAsync().then(function(e){for(var t=null,n=0;n<e.length;n++)if(e[n].getID()!=FBInstant.player.getID()){t=e[n].getID();break}for(;t&&t==o.getID()&&1<i.length;)o=i[Math.floor(Math.random()*i.length)];a.playWithFriend(o.getID(),s)}).catch(function(e){a.playWithFriend(o.getID(),s)}):a.playWithFriend(o.getID(),s)}})};var _=[],P=0;l.prototype.challengeFriends2=function(l){var h=this;if(window.FBInstant){TournamentMgr.stopContextTick(),o.showLoading();var e=function(e){o.hideLoading(),l(e)};if(0<_.length){var t=_[P];++P>=_.length&&(P=0),"empty"==t.type?this.chooseFriend(e):"tournament"==t.type?this.playWithGroup(t.id,e):"friend"==t.type&&this.playWithFriend(t.id,e)}else{window.isInTournament&&window.entryContextId,this.getConnectedPlayersAsync(function(e){var t=e.length,n=p.groupContextsNew;if(0==t){_.push({type:"empty"}),_.push({type:"empty"});for(var i=0;i<30;i++)_.push({type:"empty"})}else{for(var o=[],a=[],s=0;s<t;s++)o.push({type:"friend",id:e[s].getID()});for(var c=n.length-1;0<=c&&(TournamentMgr.isOverdueTournamentId(n[c])||(a.push({type:"tournament",id:n[c]}),!(2<=a.length)));c--);for(0<o.length&&_.push(d.randomSelectOne(o,!0)),_.push({type:"empty"});0<o.length;)_.push(d.randomSelectOne(o,!0));for(;0<a.length;)_.push(d.randomSelectOne(a,!0));for(var r=0;r<30;r++)_.push({type:"empty"})}h.challengeFriends2(l)})}}else l()};var N=[],D=0;l.prototype.challengeFriends3=function(c){var r=this;TournamentMgr.stopContextTick(),o.showLoading();var t=function(e){o.hideLoading(),c(e)};if(0<N.length){var e=N[D];++D>=N.length&&(D=0),"empty"==e.type?t():"tournament"==e.type?(s.logEvent("recommond_group"),FBInstant.context.switchAsync(e.id).then(function(){t(!0),s.logEvent("recommond_group_success"),TournamentMgr.isOverdueTournamentId(contextId)&&TournamentMgr.startContextTick()}).catch(function(e){console.log(e),t(!1)})):"friend"==e.type&&(s.logEvent("recommond_player"),FBInstant.context.createAsync(e.id).then(function(){t(!0),s.logEvent("recommond_player_success")}).catch(function(e){t(!1)}))}else{var l="3053685338071896";N.push({type:"tournament",id:l}),this.getConnectedPlayersAsync(function(e){var t=e.length,n=p.groupContextsNew;if(t+n.length==0)N.push({type:"empty"}),N.push({type:"empty"});else{for(var i=[],o=[],a=0;a<t;a++)i.push({type:"friend",id:e[a].getID()});for(var s=0;s<n.length;s++)l!=n[s]&&i.push({type:"tournament",id:n[s]});for(;0<i.length+o.length;)0<i.length&&N.push(d.randomSelectOne(i,!0)),0<o.length&&N.push(d.randomSelectOne(o,!0))}r.challengeFriends3(c)})}},l.prototype.getRankDataList=function(i,t,o,a,s){if(FBInstant)if(this.catchedRankData)a(this.catchedRankData);else{var c=this;FBInstant.getLeaderboardAsync(i).then(function(e){return s?e.getConnectedPlayerEntriesAsync():e.getEntriesAsync(t,o)}).then(function(e){for(var t=[],n=0;n<e.length;n++)!c.isBlocked(e[n].getPlayer().getID())&&(e[n].getScore()<2500||FBInstant.player.getID()==e[n].getPlayer().getID())&&(o++,t.push({playerId:e[n].getPlayer().getID(),photo:e[n].getPlayer().getPhoto(),nickName:e[n].getPlayer().getName(),rank:o,fbRank:e[n].getRank(),score:e[n].getScore(),isFriend:s,costomData:e[n].getExtraData()}));a(t,i),this.catchedRankData=t}).catch(function(e){console.log(e),a(this.catchedRankData||[])})}else{for(var e=[],n=1;n<20;n++)e.push({playerId:"id"+n,photo:null,nickName:"name"+n,rank:n,fbRank:n,score:20*n,isFriend:s});a(e,i)}},l.prototype.decHalloweenCount=function(){p.halloween.count--,this.save()},l.prototype.getHalloweenCount=function(){var e=Math.floor((Date.now()-p.halloween.time)/1e3);return F<=e&&(p.halloween.count=5,p.halloween.time=Date.now(),this.save()),p.halloween.count};var F=14400;l.prototype.getHalloweenTime=function(){var e=Math.floor((Date.now()-p.halloween.time)/1e3);if(F<=e)return p.halloween.count=5,p.halloween.time=Date.now(),this.save(),"";var t=(e=F-e)%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,t=((e=Math.floor(e/60))<10?"0"+e:e)+t},l.prototype.getSweetCount=function(){return p.halloween.sweetCount},l.prototype.addSweetCount=function(e){p.halloween.sweetCount+=e,this.save()},l.prototype.unlockHalloweenKnife=function(e,t){p.unlockedKnife[e]=!0,p.halloween.sweetCount-=t,this.save()},l.prototype.getTaskIndex=function(){return p.dailyTask.curIndex},l.prototype.openNextTask=function(){p.dailyTask.curIndex++,p.dailyTask.count=0,p.dailyTask.status="inprogress",this.save()},l.prototype.getTaskCount=function(e){return p.dailyTask.count},l.prototype.setTaskCount=function(e){p.dailyTask.count=e,this.save()},l.prototype.getTaskStatus=function(e){return p.dailyTask.status},l.prototype.setTaskStatus=function(e){p.dailyTask.status!=e&&(p.dailyTask.status=e,this.save())},l.prototype.getThanksgivingLeftTime=function(){return Math.floor(1543046400-Date.now()/1e3)},l.prototype.getChristmasLeftTime=function(){return Math.floor(1545897600-Date.now()/1e3)},l.prototype.getNewYearLeftTime=function(){return Date.now()<15460704e5?-1:Math.floor(1546502400-Date.now()/1e3)},l.prototype.isVsCollected=function(e){return p.vsCollectedIds[e]},l.prototype.markVsCollected=function(e){p.vsCollectedIds[e]=!0},t.exports=l,cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",PlayerLvData:"PlayerLvData",PowerUpData:"PowerUpData",SoundMgr:"SoundMgr",Utils:"Utils",md5:"md5"}],Utils:[function(e,t,n){"use strict";cc._RF.push(t,"c15ebC5LmNCVLPSPeQvMSdK","Utils");var o=e("PageMgr"),r=(e("AdHelper"),{formatNum:function(e){return"0000".substr(0,4-(""+e).length)+e},randomInt:function(e){return Math.floor(Math.random()*e)},randomSelectOne:function(e){if(1<arguments.length&&void 0!==arguments[1]&&arguments[1]){var t=this.randomInt(e.length);return e.splice(t,1)[0]}return e[this.randomInt(e.length)]},formatTimeHMS:function(e){var t="";return 3600<=e&&(t+=Math.floor(e/3600).toString()+"h"),60<=e&&(t+=Math.floor(e%3600/60).toString()+"m"),t+=Math.floor(e%60).toString()+"s"},formatTime:function(e){var t=e%60<10?"H 0"+e%60+"M":"H "+e%60+"M";return t=((e=Math.floor(e/60))%24<10?"D 0"+e%24:"D "+e%24)+t,t=((e=Math.floor(e/24))<10?"0"+e:e)+t},formatTimeDay:function(e){var t=0;86400<e&&(t=Math.floor(e/86400),e%=86400);var n=e%60<10?":0"+e%60:":"+e%60;return n=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+n,n=((e=Math.floor(e/60))<10?"0"+e:e)+n,0<t?t+"day "+n:n}}),a=window.gl;r.captureScreen=function(e,c,r,l,t,h,d){var n=e._sgNode||e,u=a||cc._renderContext;c=Math.floor(c),r=Math.floor(r);var p=new cc.RenderTexture(c,r,cc.Texture2D.PIXEL_FORMAT_RGBA8888,cc.sys.isBrowser?u.DEPTH_STENCIL:u.DEPTH24_STENCIL8_OES);cc.sys.isBrowser&&p.setAutoDraw(!0);var i=e.y;e.scaleY=-e.scaleY,e.y=r;var o=cc.macro.ENABLE_CULLING;cc.macro.ENABLE_CULLING=!1,p.beginWithClear(0,0,0,255,0,0),n.visit(),p.end(),cc.macro.ENABLE_CULLING=o,e.scaleY=-e.scaleY,e.y=i,cc.sys.isBrowser&&(p.scaleY=-1),t&&t();var g="";cc.sys.isBrowser?setTimeout(function(){try{var t=null,n=null;if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)g=p.sprite.getTexture().getHtmlElementObj().toDataURL("image/png");else{var e=p.sprite.getTexture()._glID,i=r-(h=h||0)-(d=d||0);t=u.getParameter(u.FRAMEBUFFER_BINDING);var o=u.createFramebuffer();n=o,u.bindFramebuffer(u.FRAMEBUFFER,o),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,e,0);var a=new Uint8Array(c*i*4);u.readPixels(0,h,c,i,u.RGBA,u.UNSIGNED_BYTE,a),u.deleteFramebuffer(o),n=null;var s=document.createElement("canvas");s.id="captureCanvas",s.width=c,s.height=i,s.getContext("2d").putImageData(new ImageData(Uint8ClampedArray.from(a),c,i),0,0),g=s.toDataURL("image/jpg",.6)}l&&l(g,p)}catch(e){console.log(e),n&&(u.deleteFramebuffer(n),n=null),t&&(u.bindFramebuffer(u.FRAMEBUFFER,t),t=null),l&&l(g,p)}},0):l&&l(g,p)},r.getShareImg=function(n){var i=e("User").get().getMaxScore();cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e?o.hideLoading():r.getImageAsync("BestShareScreen",function(e){e.getChildByName("mask").getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),e.getChildByName("score").getComponent(cc.Label).string=i}).then(function(e){n(e)}).catch(function(e){console.log("getImageAsync err",e),o.hideLoading()})})};var l={};r.getImageAsync=function(s,c){return new Promise(function(i,o){var e=l[s],a=cc.director.getScene();if(e)return a.addChild(e),"function"==typeof c?c(e):e.emit("pre_capture",c),void r.captureScreen(e,e.width,e.height,i,function(){a.removeChild(e)});cc.loader.loadRes("sharePrefab/"+s,function(e,t){if(e)o("load prefab fail --\x3e"+s);else{var n=cc.instantiate(t);l[s]=n,a.addChild(n),"function"==typeof c?c(n):n.emit("pre_capture",c),r.captureScreen(n,n.width,n.height,i,function(){a.removeChild(n)})}})})},r.playGame=function(e){e=e||{};var t=o.getPage(o.GAMEMAIN);o.showLoading(),t.getComponent("GameMain").preloadAsync(e).then(function(){o.showPage(o.GAMEMAIN),o.hideLoading()})},t.exports=r,cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],VersionControl:[function(e,t,n){"use strict";cc._RF.push(t,"35bd4cX6mRP96KirZrnQmpH","VersionControl"),cc.Class({extends:cc.Component,properties:{indexStart:0,indexEnd:0},onLoad:function(){var e=User.getVersion();this.node.active=e>=this.indexStart&&e<this.indexEnd}}),cc._RF.pop()},{}],VsResultDialog:[function(e,t,n){"use strict";cc._RF.push(t,"cc403gcpyVOU5lPeY9qSsex","VsResultDialog");var i=e("PageMgr"),o=e("AdHelper"),a=e("User");cc.Class({extends:cc.Component,properties:{resultLabel:cc.Label,lNameLabel:cc.Label,rNameLabel:cc.Label,lPhotoSprite:cc.Sprite,rPhotoSprite:cc.Sprite,okNode:cc.Node,titleSprite:cc.Sprite,rewardCountLabel:cc.Label},setVSData:function(e){var n=this;this.data=e,this.lNameLabel.string=e.otherScore,this.rNameLabel.string=e.score,this.rewardCountLabel.string=e.rewardCount,e.winId==(FBInstant&&FBInstant.player.getID())?(this.okNode.active=!1,this.resultLabel.string="YOU WIN!",this.resultLabel.node.color=cc.hexToColor("#FFF36E"),a.get().isVsCollected(e.battleId)&&(this.okNode.active=!0)):(this.okNode.active=!0,this.resultLabel.string="YOU LOSE!",this.resultLabel.node.color=cc.hexToColor("#D6D6D6")),cc.loader.load(e.playerPhoto,function(e,t){e?console.log(e):n.lPhotoSprite.spriteFrame=new cc.SpriteFrame(t)}),cc.loader.load(e.otherPlayerPhoto,function(e,t){e?console.log(e):n.rPhotoSprite.spriteFrame=new cc.SpriteFrame(t)})},onEnable:function(){o.logEvent("vs_collect_show")},onCollect:function(){o.logEvent("vs_collect_click"),a.get().markVsCollected(this.data.battleId),a.get().addDiamon(this.data.rewardCount),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(this.data.rewardCount),i.showDialog(i.GIFTPAGE),i.hideDialog(i.VSRESULT)},onClose:function(){i.hideDialog(i.VSRESULT)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],crc16:[function(e,t,n){"use strict";cc._RF.push(t,"9cb4c3msqJDNq98yKsTD505","crc16");new Array(0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920);t.exports=function(e,t,n){t=t||0,n=n||e.length;for(var i=0,o=t;o<n;o++){var a=i>>>8&255;a^=255&e[o],i=i<<8&65535,i^=a^=a>>>4,i^=a=a<<5&65535,i^=a=a<<7&65535}return i},cc._RF.pop()},{}],enginefix:[function(e,t,n){"use strict";cc._RF.push(t,"28635UZy0xPAJ90E/RZ3jF8","enginefix");var w=Math.cos,_=Math.acos,P=Math.max,N=2*Math.PI,D=Math.sqrt;function F(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)}function a(e,t){var n=function(e,t){var n,i,o,a,s=t-0,c=t-e[0],r=3*s,l=3*c,h=3*(t-e[2]),d=1/(-s+l-h+(t-1)),u=(r-6*c+h)*d,p=u*(1/3),g=(-r+l)*d,f=1/3*(3*g-u*u),m=f*(1/3),y=(2*u*u*u-9*u*g+s*d*27)/27,v=y/2,I=v*v+m*m*m;if(I<0){var A=1/3*-f,T=D(A*A*A),S=-y/(2*T),C=_(S<-1?-1:1<S?1:S),k=2*F(T);return i=k*w(C*(1/3))-p,o=k*w((C+N)*(1/3))-p,a=k*w((C+2*N)*(1/3))-p,0<=i&&i<=1?0<=o&&o<=1?0<=a&&a<=1?P(i,o,a):P(i,o):0<=a&&a<=1?P(i,a):i:0<=o&&o<=1?0<=a&&a<=1?P(o,a):o:a}if(0===I)return o=-(n=v<0?F(-v):-F(v))-p,0<=(i=2*n-p)&&i<=1?0<=o&&o<=1?P(i,o):i:o;var b=D(I);return i=(n=F(-v+b))-F(v+b)-p}(e,t),i=1-n;return 0*i*i*i+3*e[1]*n*i*i+3*e[3]*n*n*i+1*n*n*n}cc.sys.isNative?console.log("贝塞尔曲线 请用浏览器"):(cc.EaseBezierActionEx=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(e){cc.ActionEase.prototype.ctor.call(this,e)},_updateTime:function(e,t,n,i,o){return a([e,t,n,i],o)},update:function(e){var t=this._updateTime(this._p0,this._p1,this._p2,this._p3,e);this._inner.update(t)},clone:function(){var e=new cc.EaseBezierAction;return e.initWithAction(this._inner.clone()),e.setBezierParamer(this._p0,this._p1,this._p2,this._p3),e},reverse:function(){var e=new cc.EaseBezierAction(this._inner.reverse());return e.setBezierParamer(this._p3,this._p2,this._p1,this._p0),e},setBezierParamer:function(e,t,n,i){this._p0=e||0,this._p1=t||0,this._p2=n||0,this._p3=i||0}}),cc.easeBezierActionEx=function(t,n,i,o){return{easing:function(e){return cc.EaseBezierActionEx.prototype._updateTime(t,n,i,o,e)},reverse:function(){return cc.EaseBezierActionEx(o,i,n,t)}}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var a=t[o];if(e.call(i,a,o,t))return a;o++}}}),cc._RF.pop()},{}],md5:[function(require,module,exports){(function(process,global){"use strict";cc._RF.push(module,"a3f5btzv1VKoa/whV6zRL0d","md5");var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function t(e){if(e)d[0]=d[16]=d[1]=d[2]=d[3]=d[4]=d[5]=d[6]=d[7]=d[8]=d[9]=d[10]=d[11]=d[12]=d[13]=d[14]=d[15]=0,this.blocks=d,this.buffer8=l;else if(a){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}var r="input is invalid type",e="object"==("undefined"==typeof window?"undefined":_typeof(window)),i=e?window:{};i.JS_MD5_NO_WINDOW&&(e=!1);var s=!e&&"object"==("undefined"==typeof self?"undefined":_typeof(self)),h=!i.JS_MD5_NO_NODE_JS&&"object"==(void 0===process?"undefined":_typeof(process))&&process.versions&&process.versions.node;h?i=global:s&&(i=self);var f=!i.JS_MD5_NO_COMMON_JS&&"object"==(void 0===module?"undefined":_typeof(module))&&module.exports,o="function"==typeof define&&define.amd,a=!i.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,n="0123456789abcdef".split(""),u=[128,32768,8388608,-2147483648],y=[0,8,16,24],c=["hex","array","digest","buffer","arrayBuffer","base64"],p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),d=[],l;if(a){var A=new ArrayBuffer(68);l=new Uint8Array(A),d=new Uint32Array(A)}!i.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!a||!i.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==(void 0===e?"undefined":_typeof(e))&&e.buffer&&e.buffer.constructor===ArrayBuffer});var b=function(n){return function(e){return new t(!0).update(e)[n]()}},v=function(){var n=b("hex");h&&(n=w(n)),n.create=function(){return new t},n.update=function(e){return n.create().update(e)};for(var e=0;e<c.length;++e){var i=c[e];n[i]=b(i)}return n},w=function w(t){var e=eval("require('crypto')"),i=eval("require('buffer').Buffer"),s=function(n){if("string"==typeof n)return e.createHash("md5").update(n,"utf8").digest("hex");if(null==n)throw r;return n.constructor===ArrayBuffer&&(n=new Uint8Array(n)),Array.isArray(n)||ArrayBuffer.isView(n)||n.constructor===i?e.createHash("md5").update(new i(n)).digest("hex"):t(n)};return s};t.prototype.update=function(e){if(!this.finalized){var t,n=void 0===e?"undefined":_typeof(e);if("string"!==n){if("object"!==n)throw r;if(null===e)throw r;if(a&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||a&&ArrayBuffer.isView(e)))throw r;t=!0}for(var i,o,s=0,c=e.length,l=this.blocks,h=this.buffer8;s<c;){if(this.hashed&&(this.hashed=!1,l[0]=l[16],l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),t)if(a)for(o=this.start;s<c&&o<64;++s)h[o++]=e[s];else for(o=this.start;s<c&&o<64;++s)l[o>>2]|=e[s]<<y[3&o++];else if(a)for(o=this.start;s<c&&o<64;++s)(i=e.charCodeAt(s))<128?h[o++]=i:(i<2048?h[o++]=192|i>>6:(i<55296||57344<=i?h[o++]=224|i>>12:(i=65536+((1023&i)<<10|1023&e.charCodeAt(++s)),h[o++]=240|i>>18,h[o++]=128|i>>12&63),h[o++]=128|i>>6&63),h[o++]=128|63&i);else for(o=this.start;s<c&&o<64;++s)(i=e.charCodeAt(s))<128?l[o>>2]|=i<<y[3&o++]:(i<2048?l[o>>2]|=(192|i>>6)<<y[3&o++]:(i<55296||57344<=i?l[o>>2]|=(224|i>>12)<<y[3&o++]:(i=65536+((1023&i)<<10|1023&e.charCodeAt(++s)),l[o>>2]|=(240|i>>18)<<y[3&o++],l[o>>2]|=(128|i>>12&63)<<y[3&o++]),l[o>>2]|=(128|i>>6&63)<<y[3&o++]),l[o>>2]|=(128|63&i)<<y[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,64<=o?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=u[3&t],56<=t&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},t.prototype.hash=function(){var e,t,n,i,o,a,s=this.blocks;this.first?t=((t=((e=((e=s[0]-680876937)<<7|e>>>25)-271733879<<0)^(n=((n=(-271733879^(i=((i=(-1732584194^2004318071&e)+s[1]-117830708)<<12|i>>>20)+e<<0)&(-271733879^e))+s[2]-1126478375)<<17|n>>>15)+i<<0)&(i^e))+s[3]-1316259209)<<22|t>>>10)+n<<0:(e=this.h0,t=this.h1,n=this.h2,t=((t+=((e=((e+=((i=this.h3)^t&(n^i))+s[0]-680876936)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[1]-389564586)<<12|i>>>20)+e<<0)&(e^t))+s[2]+606105819)<<17|n>>>15)+i<<0)&(i^e))+s[3]-1044525330)<<22|t>>>10)+n<<0),t=((t+=((e=((e+=(i^t&(n^i))+s[4]-176418897)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[5]+1200080426)<<12|i>>>20)+e<<0)&(e^t))+s[6]-1473231341)<<17|n>>>15)+i<<0)&(i^e))+s[7]-45705983)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+s[8]+1770035416)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[9]-1958414417)<<12|i>>>20)+e<<0)&(e^t))+s[10]-42063)<<17|n>>>15)+i<<0)&(i^e))+s[11]-1990404162)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+s[12]+1804603682)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[13]-40341101)<<12|i>>>20)+e<<0)&(e^t))+s[14]-1502002290)<<17|n>>>15)+i<<0)&(i^e))+s[15]+1236535329)<<22|t>>>10)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[1]-165796510)<<5|e>>>27)+t<<0)^t))+s[6]-1069501632)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[11]+643717713)<<14|n>>>18)+i<<0)^i))+s[0]-373897302)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[5]-701558691)<<5|e>>>27)+t<<0)^t))+s[10]+38016083)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[15]-660478335)<<14|n>>>18)+i<<0)^i))+s[4]-405537848)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[9]+568446438)<<5|e>>>27)+t<<0)^t))+s[14]-1019803690)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[3]-187363961)<<14|n>>>18)+i<<0)^i))+s[8]+1163531501)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[13]-1444681467)<<5|e>>>27)+t<<0)^t))+s[2]-51403784)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[7]+1735328473)<<14|n>>>18)+i<<0)^i))+s[12]-1926607734)<<20|t>>>12)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[5]-378558)<<4|e>>>28)+t<<0))+s[8]-2022574463)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[11]+1839030562)<<16|n>>>16)+i<<0))+s[14]-35309556)<<23|t>>>9)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[1]-1530992060)<<4|e>>>28)+t<<0))+s[4]+1272893353)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[7]-155497632)<<16|n>>>16)+i<<0))+s[10]-1094730640)<<23|t>>>9)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[13]+681279174)<<4|e>>>28)+t<<0))+s[0]-358537222)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[3]-722521979)<<16|n>>>16)+i<<0))+s[6]+76029189)<<23|t>>>9)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[9]-640364487)<<4|e>>>28)+t<<0))+s[12]-421815835)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[15]+530742520)<<16|n>>>16)+i<<0))+s[2]-995338651)<<23|t>>>9)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[0]-198630844)<<6|e>>>26)+t<<0)|~n))+s[7]+1126891415)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[14]-1416354905)<<15|n>>>17)+i<<0)|~e))+s[5]-57434055)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[12]+1700485571)<<6|e>>>26)+t<<0)|~n))+s[3]-1894986606)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[10]-1051523)<<15|n>>>17)+i<<0)|~e))+s[1]-2054922799)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[8]+1873313359)<<6|e>>>26)+t<<0)|~n))+s[15]-30611744)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[6]-1560198380)<<15|n>>>17)+i<<0)|~e))+s[13]+1309151649)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[4]-145523070)<<6|e>>>26)+t<<0)|~n))+s[11]-1120210379)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[2]+718787259)<<15|n>>>17)+i<<0)|~e))+s[9]-343485551)<<21|t>>>11)+n<<0,this.first?(this.h0=e+1732584193<<0,this.h1=t-271733879<<0,this.h2=n-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+i<<0)},t.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,o=this.h3;return n[e>>4&15]+n[15&e]+n[e>>12&15]+n[e>>8&15]+n[e>>20&15]+n[e>>16&15]+n[e>>28&15]+n[e>>24&15]+n[t>>4&15]+n[15&t]+n[t>>12&15]+n[t>>8&15]+n[t>>20&15]+n[t>>16&15]+n[t>>28&15]+n[t>>24&15]+n[i>>4&15]+n[15&i]+n[i>>12&15]+n[i>>8&15]+n[i>>20&15]+n[i>>16&15]+n[i>>28&15]+n[i>>24&15]+n[o>>4&15]+n[15&o]+n[o>>12&15]+n[o>>8&15]+n[o>>20&15]+n[o>>16&15]+n[o>>28&15]+n[o>>24&15]},t.prototype.toString=t.prototype.hex,t.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return[255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255]},t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},t.prototype.buffer=t.prototype.arrayBuffer,t.prototype.base64=function(){for(var e,t,n,i="",o=this.array(),a=0;a<15;)e=o[a++],t=o[a++],n=o[a++],i+=p[e>>>2]+p[63&(e<<4|t>>>4)]+p[63&(t<<2|n>>>6)]+p[63&n];return e=o[a],i+(p[e>>>2]+p[e<<4&63]+"==")};var _=v();f?module.exports=_:(i.md5=_,o&&define(function(){return _}))}(),cc._RF.pop()}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}]},{},["AdHelper","FBShare","GameConfig","Loading","PageRegister","ChristmasSaleDialog","GameHalloween","HalloweenDialog","HalloweenEndDialog","HalloweenPayDialog","HalloweenRankItem","HalloweenResultDialog","HoroscopeGame","HoroscopeItem","HoroscopePage","NewYearSaleDialog","SweetCollectDialog","ThanksSaleDialog","ImageNumber","JumpGame","ListItem","ListView","RankMgr","Rotate","TournamentMgr","VersionControl","BtnBreath","ButtonSync","SlotoBtn","SpinBtn","AnimationData","HalloweenLevelData","KnifeData","LevelData","PKLevelData","PlayerLvData","PowerUpData","PrizeData","ShopData","SlotData","TargetData","TaskData","AppleShopDialog","BestShareDialog","BonusAnim","Breath","ContinuePage","GameDuel","GameMain","GameSpin","GiftCollectDialog","GiftPage","HomePage","InviteDialog","InviteKnifePage","InviteTipDialog","IosShopPage","KnifeIcon","NoticeDialog","PKItem","PKPage","PKRecordItem","PKScreen","PayShop","PointControl","PointIcon","PowerIcon","PowerInfoDialog","PowerUpItem","PowerUpPage","RankItem","RankPage","ResultDialog","ResultItem","ResultRankItem","RoundDao","RoundItem","SendGiftDialog","SettingDialog","ShopDialog","ShowInviteKnifeDialog","ShowKnifeDialog","SloteList","SlotoItem","SpinDialog","SpinLottery","TournamentDialog","TournamentItem","TurntableDialog","VsResultDialog","enginefix","AnimalUtil","EventUtil","NetHelper","PageMgr","PageUtil.js","SoundMgr","SoundUtil","TaskMgr","User","Utils","md5","NetAPI","NetConfig","ProtoGenerated","PushAPI","NetMgr","crc16","TaskButton","TaskDialog","SendGiftItem"]);