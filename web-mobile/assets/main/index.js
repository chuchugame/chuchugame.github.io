window.__require=function e(t,n,i){function o(s,c){if(!n[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){return o(t[s][1][e]||e)},h,h.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t){var n,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function r(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}})();var l,h=[],d=!1,u=-1;function p(){d&&l&&(d=!1,l.length?h=l.concat(h):u=-1,h.length&&g())}function g(){if(!d){var e=c(p);d=!0;for(var t=h.length;t;){for(l=h,h=[];++u<t;)l&&l[u].run();u=-1,t=h.length}l=null,d=!1,r(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new f(e,t)),1!==h.length||d||c(g)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(){return[]},o.binding=function(){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],AdBreath:[function(e,t){"use strict";cc._RF.push(t,"e79f53iKtZBTIu//1Bl1E/A","AdBreath"),cc.Class({extends:cc.Component,properties:{},onEnable:function(){cc.Tween.stopAllByTarget(this.node),this.node.scale=1,window.AdBreathOpen&&cc.tween(this.node).to(.5,{scale:1.1}).to(.5,{scale:1}).union().repeatForever().start()}}),cc._RF.pop()},{}],AdHelper:[function(e,t){"use strict";cc._RF.push(t,"b177fHRLNdPJbL4EN8oTbsS","AdHelper");var n=["1250735238360354_1300946710005873","1250735238360354_1300946766672534","1250735238360354_1595262370574304"],i=0,o=null,a=!1,s=!1,c=["1250735238360354_1300947150005829","1250735238360354_1300947366672474","1250735238360354_1300947393339138"],r=0,l=null,h=!1,d={},u=0,p={loadAsync:function(e,t){if(s||FBInstant.getSupportedAPIs().indexOf("getInterstitialAdAsync")<0)t&&t();else{var c=function(){s=!1,o&&(a=!0,e&&e(),p.logEvent("interstitial_success_"+i))},r=function(c){a=!1,s=!1,p.logEvent("interstitial_fail_"+i),"ADS_NO_FILL"!=c.code&&"ADS_FREQUENT_LOAD"!=c.code&&"NETWORK_FAILURE"!=c.code||(d[n[i]]=o),o=null,++i<n.length?(s=!0,setTimeout(function(){s=!1,p.loadAsync(e,t)},5e3)):(i=0,s=!0,setTimeout(function(){s=!1},9e4),t&&t(c)),p.logEvent("aderrornew",{code:c.code})},l=n[i];p.logEvent("interstitial_load_"+i),s=!0,o=d[l],d[l]=null,o?o.loadAsync().then(c,r):FBInstant.getInterstitialAdAsync(l).then(function(e){return o=e,e.loadAsync()},function(e){s=!1,t&&t(e),p.logEvent("aderrornew",{code:e.code})}).then(c,r)}},isInterstitialLoad:function(){return!window.FBInstant||!e("User").get().isAdRemoved()&&(a||p.loadAsync(),o&&a)},showInterstitialAd:function(){},showInterstitialAd_:function(t,n){return f=0,console.log("showInterstitialAd"),window.FBInstant?!e("User").get().isAdRemoved()&&void(o&&a?(e("User").get().addAdShowCount(),o.showAsync().then(function(){a=!1,i=0,o=null,p.loadAsync(),t(),cc.sys.isMobile||p.logEvent("ad_web_show")},function(){n&&n(),a=!1,i=0,o=null,p.loadAsync()}),p.logEvent("interstitial_show_"+i),u++,p.logEvent("interstitial_show_count",{count:u})):n("unknown error")):(console.log("\u5f53\u524d\u73af\u5883\u6728\u6709\u5e7f\u544a"),void t())},debugMsg:function(){}},g=0;p.isSupporteVideo=function(){return!FBInstant||FBInstant&&FBInstant.getSupportedAPIs().indexOf("getRewardedVideoAsync")>=0},p.getVideoLoadedCount=function(){return g},p.loadVideoAsync=function(e,t){if(h||FBInstant.getSupportedAPIs().indexOf("getRewardedVideoAsync")<0)return t&&t(),void p.debugMsg("isVideoLoading true");console.log("loadVideoAsync");var n=function(){h=!1,l&&(e&&e(),p.logEvent("reward_success_"+r),g++)},i=function(e){h=!1,"ADS_NO_FILL"!=e.code&&"ADS_FREQUENT_LOAD"!=e.code&&"NETWORK_FAILURE"!=e.code&&"UNKNOWN"!=e.code||(d[c[r]]=l),l=null,p.logEvent("reward_fail_"+r),++r<c.length?(h=!0,setTimeout(function(){h=!1,p.loadVideoAsync()},5e3)):(r=0,h=!0,setTimeout(function(){h=!1},9e4),t&&t(e)),p.debugMsg(e.code),p.logEvent("aderrornew",{code:e.code})},o=c[r];p.logEvent("reward_load_"+r),h=!0,l=d[o],d[o]=null,l?l.loadAsync().then(n,i):FBInstant.getRewardedVideoAsync(o).then(function(e){return l=e,e.loadAsync()},function(e){h=!1,t&&t(e),p.debugMsg(e.code),p.logEvent("aderrornew",{code:e.code})}).then(n,i)},p.isVideoLoad=function(){return window.platfromMgr.isVideoLoad()},p.showVideoAd=function(e){return window.platfromMgr.showVideoAd("showVideo",e)},p.logEvent=function(e,t){window.platfromMgr.logEvent(e,t)};var f=3;p.autoShowAd=function(e){e=e||function(){},++f>=3&&p.isInterstitialLoad()?(p.logEvent("autoShowAd"),this.showInterstitialAd(e,e)):e()},t.exports=p,cc._RF.pop()},{User:"User"}],AdapterScale:[function(e,t){"use strict";cc._RF.push(t,"e2cbf6kW/5Chaal4gt7e9vE","AdapterScale"),cc.Class({extends:cc.Component,properties:{},start:function(){this.node.scale=cc.winSize.width/640}}),cc._RF.pop()},{}],AnimalUtil:[function(e,t){"use strict";cc._RF.push(t,"f3c9d3fV6hE3avj/OjdJlqB","AnimalUtil"),cc.Class({extends:cc.Component,properties:{},getPowerIconAnimal:function(){var e=this;new cc.Sprite,cc.loader.loadRes("ui_shop/guang.png",function(t,n){t||(e.guang.spriteFrame=new cc.SpriteFrame(n))})}}),cc._RF.pop()},{}],AnimationData:[function(e,t){"use strict";cc._RF.push(t,"55f24g75pVFupBCLKMNEufI","AnimationData");var n=[{index:1,beginRotation:0,actions:[[3,360,0,0,1,1]]},{index:2,beginRotation:0,actions:[[4,480,0,0,1,1]]},{index:3,beginRotation:0,actions:[[3,480,0,0,1,1]]},{index:4,beginRotation:0,actions:[[5,630,0,0,1,1],[5,-540,0,0,1,1]]},{index:5,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:6,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:7,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:8,beginRotation:0,actions:[[5,540,.5,0,.5,1]]},{index:9,beginRotation:0,actions:[[4,450,.5,0,.5,1]]},{index:10,beginRotation:0,actions:[[8,540,.5,-.92,.5,1.92]]},{index:11,beginRotation:0,actions:[[7,540,.5,-.92,.5,1.92]]},{index:12,beginRotation:0,actions:[[6,540,.5,-.92,.5,1.92]]},{index:13,beginRotation:45,actions:[[5,750,.5,-.92,.5,1.92]]},{index:14,beginRotation:45,actions:[[7,810,.5,-.92,.5,1.92],[7,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92]]},{index:15,beginRotation:0,actions:[[3,480,0,0,1,1]]},{index:16,beginRotation:0,actions:[[4,480,0,0,1,1]]},{index:17,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:18,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:19,beginRotation:45,actions:[[7,810,.5,-.92,.5,1.92],[7,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92],[5,810,.5,-.92,.5,1.92]]},{index:20,beginRotation:45,actions:[[5,630,0,0,1,1]]},{index:21,beginRotation:0,actions:[[3,120,.7,-.56,.42,1.81],[3,330,.7,-.56,.42,1.81]]},{index:22,beginRotation:0,actions:[[5,420,.1,.75,.48,.98]]},{index:23,beginRotation:0,actions:[[5,270,.1,.75,.48,.98]]},{index:24,beginRotation:0,actions:[[5,480,0,.42,.46,.99],[5,-360,0,.42,.46,.99]]},{index:25,beginRotation:0,actions:[[4,120,.5,-.62,.43,1.55],[4,360,.5,.5,.5,.5]]},{index:26,beginRotation:0,actions:[[5,450,.5,-.62,.43,1.55]]},{index:27,beginRotation:0,actions:[[3,360,.5,-.62,.43,1.55],[4,420,.5,.5,.5,.5]]},{index:28,beginRotation:0,actions:[[4,450,.5,-.62,.43,1.55]]},{index:29,beginRotation:45,actions:[[5,450,.5,-.62,.43,1.55]]},{index:30,beginRotation:0,actions:[[3,432,.04,1.01,.55,1.34]]},{index:31,beginRotation:0,actions:[[.5,-80,.5,0,.5,1],[1,160,.5,0,.5,1],[.9,-145,.5,0,.5,1],[.9,130,.5,0,.5,1],[.8,-115,.5,0,.5,1],[.8,100,.5,0,.5,1],[.7,-85,.5,0,.5,1],[.7,70,.5,0,.5,1],[.6,-55,.5,0,.5,1],[.6,40,.5,0,.5,1],[.6,-20,.5,0,.5,1]]},{index:32,beginRotation:0,actions:[[3,360,0,0,1,1]]},{index:33,beginRotation:0,actions:[[4,480,0,0,1,1]]},{index:34,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:35,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:36,beginRotation:0,actions:[[5,630,0,0,1,1],[5,-540,0,0,1,1]]},{index:37,beginRotation:0,actions:[[1,30,1,0,0,1],[2,-60,1,0,0,1],[1,420,0,0,1,1]]},{index:38,beginRotation:0,actions:[[2,360,0,0,1,1],[4,360,0,0,1,1],[4,360,0,0,1,1]]},{index:39,beginRotation:0,actions:[[6,450,.47,-.65,.42,1.75]]},{index:40,beginRotation:0,actions:[[6,450,.5,.5,.53,.88]]},{index:41,beginRotation:0,actions:[[6.5,450,.47,-.65,.42,1.75]]},{index:42,beginRotation:0,actions:[[6,450,.5,.5,.53,.88]]},{index:43,beginRotation:0,actions:[[5,630,0,0,1,1],[5,-540,0,0,1,1]]},{index:44,beginRotation:0,actions:[[6,450,.47,-.65,.42,1.75]]},{index:45,beginRotation:0,actions:[[1.5,30,1,0,0,1],[2.5,-60,1,0,0,1],[1.5,420,0,0,1,1]]},{index:46,beginRotation:0,actions:[[1.5,360,0,0,1,1],[3.5,360,0,0,1,1],[3.5,360,0,0,1,1]]},{index:47,beginRotation:0,actions:[[4,420,.46,.74,.33,.61]]},{index:48,beginRotation:0,actions:[[6,450,.74,-.7,.16,1.68]]},{index:49,beginRotation:0,actions:[[6,450,.74,-.7,.16,1.68]]},{index:50,beginRotation:0,actions:[[3,450,.5,0,.5,1]]},{index:51,beginRotation:0,actions:[[3,400,.5,0,.5,1]]},{index:52,beginRotation:0,actions:[[2.5,-432,.7,0,.61,.99]]},{index:53,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:54,beginRotation:0,actions:[[6,450,.5,.5,.53,.88]]},{index:55,beginRotation:0,actions:[[7,540,.5,-.92,.5,1.92]]},{index:56,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:57,beginRotation:0,actions:[[2.5,480,0,0,1,1]]},{index:58,beginRotation:0,actions:[[3.5,480,0,0,1,1]]},{index:59,beginRotation:0,actions:[[2,180,.55,.01,.54,.99]]},{index:60,beginRotation:0,actions:[[3,-432,.7,0,.61,.99]]},{index:61,beginRotation:45,actions:[[6,750,.5,-.92,.5,1.92]]}];t.exports={getData:function(e){return n[e-1]}},cc._RF.pop()},{}],AppleShopDialog:[function(e,t){"use strict";cc._RF.push(t,"958dbsYmd5A45eeE88FG97D","AppleShopDialog");var n=e("PageMgr"),i=e("User"),o=e("AdHelper");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label},onEnable:function(){this.price1.string=i.get().getPrice("apple_package","$1.99"),this.price2.string=i.get().getPrice("apple_car_half","$4.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){o.logEvent("pay_shop_click",{itemId:"apple_package"}),i.get().purchase("apple_package",function(){i.get().addDiamon(2500),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(2500),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_package"})},function(){})},onBuyItem2:function(){o.logEvent("pay_shop_click",{itemId:"apple_car_half"}),i.get().purchase("apple_car_half",function(){i.get().addDiamon(25e3),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(25e3),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_car_half"})},function(){})},onClose:function(){n.hideDialog("AppleShopDialog"),this.data&&this.data.closeCb&&this.data.closeCb()}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],BestShareDialog:[function(e,t){"use strict";cc._RF.push(t,"33b14SPe/VCVrnUmcBoGf8O","BestShareDialog");var n=e("PageMgr"),i=e("AdHelper");cc.Class({extends:cc.Component,properties:{},start:function(){},onEnable:function(){i.logEvent("best_share_show")},setShareCb:function(e){this.shareCb=e},onShare:function(){i.logEvent("best_share_click"),this.shareCb(),n.hideDialog("BestShareDialog")}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr"}],BonusAnim:[function(e,t){"use strict";cc._RF.push(t,"09c78o15OJJoL3uCde/ngxn","BonusAnim");var n=e("SoundMgr");cc.Class({extends:cc.Component,properties:{topLabel:cc.Label,bottomLabel:cc.Label,iconSp:sp.Skeleton,iconsSp:[sp.SkeletonData]},onLoad:function(){this.configs=[["\u4e8c\u6b21","\u673a\u4f1a",n.PWR_UP_SECOND_CHANCE],["\u989d\u5916\u7684","\u7ee7\u7eed"],["\u989d\u5916\u7684","\u82f9\u679c"],["",""],["",""],["\u53cc\u500d","\u7ecf\u9a8c"],["\u4e09\u6b21","\u673a\u4f1a"]]},setType:function(e){var t=e-1;this.iconSp.skeletonData=this.iconsSp[t],this.iconSp.setAnimation(0,"animation"),this.topLabel.string=this.configs[t][0],this.bottomLabel.string=this.configs[t][1],3==this.configs[t].length&&n.play(this.configs[t][2])}}),cc._RF.pop()},{SoundMgr:"SoundMgr"}],ChristmasSaleDialog:[function(e,t){"use strict";cc._RF.push(t,"66b67u2ir9NIJ21EZmsR/DZ","ChristmasSaleDialog");var n=e("PageMgr"),i=e("User"),o=e("AdHelper"),a=e("Utils");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label,price3:cc.Label,timerLabel:cc.Label},onEnable:function(){this.price1.string=i.get().getPrice("apple_box","$2.99"),this.price2.string=i.get().getPrice("apple_60000","$28.99"),this.price3.string=i.get().getPrice("apple_180000_half","$49.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){o.logEvent("pay_shop_click",{itemId:"apple_box"}),i.get().purchase("apple_box",function(){i.get().addDiamon(7500),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(7500),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})},onBuyItem2:function(){o.logEvent("pay_shop_click",{itemId:"apple_60000"}),i.get().purchase("apple_60000",function(){i.get().addDiamon(18e4),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(18e4),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})},onBuyItem3:function(){o.logEvent("pay_shop_click",{itemId:"apple_180000_half"}),i.get().purchase("apple_180000_half",function(){i.get().addDiamon(6e5),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_180000_half"})},function(){})},onClose:function(){n.hideDialog("ChristmasSaleDialog"),this.data&&this.data.closeCb&&this.data.closeCb()},update:function(){i.get().getChristmasLeftTime()>0&&(this.timerLabel.string=a.formatTimeHMS(i.get().getChristmasLeftTime()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],ContinuePage:[function(e,t){"use strict";cc._RF.push(t,"878e4gMd1pE0qZpqw1RsCpW","ContinuePage");var n=e("PageMgr"),i=e("SoundMgr"),o=e("AdHelper"),a=e("User"),s=e("Utils");cc.Class({extends:cc.Component,properties:{knifeCountLabel:cc.Label,stageLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,continueBreath:cc.Animation,diamonCount:cc.Label,videoBtn:cc.Button,adIconNode:cc.Node,continueLabelNode:cc.Node},onLoad:function(){this.appleCount=200},start:function(){},updateUI:function(e){this.data=e,this.from=e.from,this.onContinueCb=e.onContinue,this.onNoContinueCb=e.onNoContinue;var t=e.curKnifeAmount,n=e.curStage,i=e.isBoss,s=e.name,c=e.continueCount;this.knifeCountLabel.string=t,this.diamonCount.string=a.get().getDiamonCount(),this.curStage=n;var r=n%5;i?(this.stageLabel.string=s,this.pointsNode.active=!1,this.pkIcon.x=0,this.pkIcon.color=this.stageLabel.node.color):(this.pkIcon.color=cc.Color.WHITE,this.pointsNode.active=!0,this.pkIcon.x=70,this.stageLabel.string="\u5173\u5361 "+n),this.pointsNode.getComponent("PointControl").setCount(r);var l=this.node.getComponent(cc.Animation);this.isFreeContinue=1==c&&a.get().isFreeContinue(),this.isAdContinue=!this.isFreeContinue,this.videoBtn.interactable=o.isVideoLoad();var h="none";c>1?l.play("continueStateYellow"):l.play("continueStateGreen"),l.sample(),this.isFreeContinue?(this.adIconNode.active=!1,this.continueLabelNode.x=0,h="buyad_free"):(this.adIconNode.active=!0,this.continueLabelNode.x=32,h=1==c?"ad_first":"ad_second","gamespin"==this.from?h="games_turntable":"game_halloween"==this.from&&(h="halloween_"+h)),this.state=h,o.logEvent("continue_show",{state:this.state})},onEnable:function(){this.continueBreath.stop();var e=this.node.getComponent(cc.Animation);e.setCurrentTime(0),e.play("continue");var t=this;e.off("finished"),e.on("finished",function(){e.off("finished"),setTimeout(function(){t.onThanksButton()},200)}),this.audioId=i.play(i.CONITINUE_TIMER)},onAdButton:function(e){var t=this;if(this.isFriendInvite)this.onInviteFriend();else{i.stop(i.CONITINUE_TIMER),e.currentTarget.getComponent(cc.Button).interactable=!1;var s=this.node.getComponent(cc.Animation);s.pause();var c=function(i){e.currentTarget.getComponent(cc.Button).interactable=!0,n.hideDialog(n.CONTINUE),i&&(i=-i),t.onContinueCb(-i)};if(o.logEvent("continue_adclick",{state:this.state}),!this.isFreeContinue)return this.isAppleContinue?(a.get().decDiamon(200),void c(200)):void o.showVideoAd(c,function(){s&&s.resume()});c()}},onInviteFriend:function(){var e=this;if(!FBInstant)return n.hideDialog(n.CONTINUE),void this.onContinueCb();n.showLoading();var t=this.node.getComponent(cc.Animation);t.pause(),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){FBInstant.context.getPlayersAsync().then(function(e){var t="";e.map(function(e){e.getID()!=FBInstant.player.getID()&&(t=e.getName())}),s.getShareImg(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:"hey\uff0c"+t+"\uff0c"+FBInstant.player.getName()+"  is waiting for you\uff01",image:e,data:{from:"continue_invite"},strategy:"IMMEDIATE",notification:"PUSH"})})}),i.stop(i.CONITINUE_TIMER),a.get().decInviteContinueCount(),n.hideDialog(n.CONTINUE),e.onContinueCb(),n.hideLoading(),o.logEvent("continue_invite_finish",{state:e.state})}).catch(function(e){if("SAME_CONTEXT"==e.code){var i=n.getPage(n.INVITETINVALID);i.getChildByName("timer").getComponent(cc.Label).string="LATER",n.showDialog(n.INVITETINVALID,!0),i.once("close",function(){t&&t.resume()})}else t&&t.resume();n.hideLoading()}),o.logEvent("continue_invite_click",{state:this.state})},onThanksButton:function(){var e=this;n.hideDialog(n.CONTINUE),o.logEvent("continue_nothank_click",{state:this.state}),i.stop(i.CONITINUE_TIMER),this.curStage>5&&o.isInterstitialLoad()&&Math.random()>=.3?(o.logEvent("noThanksShowAd",{state:this.state}),o.showInterstitialAd(function(){a.get().updateScoreAndStage(e.data.curKnifeAmount,e.curStage)},function(){a.get().updateScoreAndStage(e.data.curKnifeAmount,e.curStage)})):a.get().updateScoreAndStage(this.data.curKnifeAmount,this.curStage),this.onNoContinueCb()},onAppleContinue:function(e){var t=this;i.stop(i.CONITINUE_TIMER);var s,c="enough";if(a.get().getDiamonCount()>=this.appleCount)a.get().decDiamon(this.appleCount),s=this.appleCount,n.hideDialog(n.CONTINUE),e.currentTarget.getComponent(cc.Button).interactable=!0,s&&(s=-s),t.onContinueCb(s);else if(a.get().isPayReady()){var r=this.node.getComponent(cc.Animation);r.pause(),a.get().getThanksgivingLeftTime()>0?n.showDialogAsync("ThanksSaleDialog",{closeCb:function(){t.diamonCount.string=a.get().getDiamonCount(),r.resume()}},!0):a.get().getChristmasLeftTime()>0?n.showDialogAsync("ChristmasSaleDialog",{closeCb:function(){t.diamonCount.string=a.get().getDiamonCount(),r.resume()}},!0):a.get().getNewYearLeftTime()>0?n.showDialogAsync("NewYearSaleDialog",{closeCb:function(){t.diamonCount.string=a.get().getDiamonCount(),r.resume()}},!0):n.showDialogAsync("AppleShopDialog",{closeCb:function(){t.diamonCount.string=a.get().getDiamonCount(),r.resume()}},!0)}else this.diamonCount.node.runAction(cc.sequence(cc.scaleTo(.3,2),cc.delayTime(1),cc.scaleTo(.3,1))),c="not_enough",this.continueBreath.play(),n.showTip("\u82f9\u679c\u4e0d\u8db3\uff01"),setTimeout(function(){n.hideTip()},3e3);o.logEvent("continue_apple_click",{isok:c,state:this.state})}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils"}],EventUtil:[function(e,t){"use strict";cc._RF.push(t,"c251av5S5hKzK/VV27L//lJ","EventUtil"),cc.Class({extends:cc.Component,emitEvent:function(e,t){this.node.emit(t)}}),cc._RF.pop()},{}],FBShare:[function(e,t){"use strict";cc._RF.push(t,"1ab80lNf/dO1q5hJ1lxn6sR","FBShare"),e("User"),cc.Class({extends:cc.Component,properties:{},onShare:function(){FBInstant&&FBInstant.shareAsync({intent:"SHARE",image:"",text:"This game is very funny!",data:{myReplayData:"data"}}).then(function(){})},onRequet:function(){FBInstant.shareAsync({intent:"REQUEST",image:"",text:"X is asking for your help!",data:{myReplayData:"data"}}).then(function(){})},onInvite:function(){FBInstant.shareAsync({intent:"INVITE",image:"",text:"play with me!",data:{myReplayData:"data"}}).then(function(){})},onChallenge:function(){FBInstant.shareAsync({intent:"CHALLENGE",image:"",text:"come on to play with me!",data:{myReplayData:"data"}}).then(function(){})},start:function(){},logEvent:function(e,t){FBInstant&&FBInstant.logEvent(t,1,{})}}),window.shareImg="",cc._RF.pop()},{User:"User"}],GameConfig:[function(e,t){"use strict";cc._RF.push(t,"326e1SwBLRIXqKlhmB5FJFc","GameConfig"),window.GameVersion="0.62",window.DEV=!1,window.FUNCTION_VERSION=1,window.GAME_ID=11,window.appId="1250735238360354",window.lastScore=Math.floor(50*Math.random()),window.VersionCode=1,window.AdBreathOpen=!1;try{window.FBInstant&&!window.DEV&&(console.log=function(){})}catch(n){}cc._RF.pop()},{}],GameDuel:[function(e,t){"use strict";cc._RF.push(t,"fce86pVEVdFQ7GsjC4C9L9r","GameDuel");var n=e("User"),i=e("PrizeData"),o=(e("LevelData"),e("PKLevelData")),a=e("TargetData"),s=e("AnimationData"),c=e("KnifeData"),r=e("SoundMgr"),l=e("PageMgr"),h=e("AdHelper"),d=e("Utils"),u=e("NetAPI");e("enginefix"),cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bonusAnim:cc.Prefab,pkTop:cc.Node,myNameLabel:cc.Label,opponentNameLabel:cc.Label,roundLabel:cc.Label,mySprite:cc.Sprite,opponentSprite:cc.Sprite,myKnifeGroup:cc.Node,opponentKnifeGroup:cc.Node,stakeSprite:cc.Sprite,defaltHeadFrame:cc.SpriteFrame,yoff:-500,stopY:-180,speed:100},init:function(){var e=this;this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.preBossData=null,this.preBossTexture=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.friendIndex=0,this.gotoUnlockLevel=15,this.myknifes=this.myknifes||[],this.opponentknifes=this.opponentknifes||[],this.knifesInPkTargets=this.knifesInPkTargets||[],this.roundKnifeData=[],!this.myPhotoTexure&&FBInstant&&FBInstant.player.getPhoto()&&cc.loader.load(FBInstant.player.getPhoto(),function(t,n){t||(e.myPhotoTexure=n)}),this.otherPlayer=null,this.playWithMsg=null,this.playerCount=0},setKnifeTempLate:function(e){e instanceof cc.SpriteFrame?this.knifeTemplate.getComponent(cc.Sprite).spriteFrame=e:this.knifeTemplate=e,this.knifeTemplate.scale=1,this.knifeTemplate.rotation=0,this.setupKnifesPool()},showCostTip:function(e){this.costTipNode.active=!0,this.costTipNode.stopAllActions(),this.costTipNode.scale=0,this.costTipNode.y=-203,this.costTipNode.opacity=255,this.costTipNode.getChildByName("label").getComponent(cc.Label).string=e,this.costTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50))))},onEnable:function(){var e=this;if(this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),window.FBInstant){this.targetAnim.node.scale=0,this.roundLabel.node.opacity=0;var t=this.pkTop.getComponent(cc.Animation);this.roundLabel.string="ROUND "+this.pkInfo.round,this.pkInfo.fightId?(t.once("finished",function(){if(e.isInPlayback=!0,1==e.pkInfo.round)e.playPKStage(e.simDatas,function(){l.showTurn("It is your turn!"),e.beginPKStage()});else{e.roundLabel.string="ROUND "+(e.pkInfo.round-1);for(var t=[4,3,2,1][e.pkInfo.round-2],n=[],i=[],o=0;o<e.simDatas.length;o++)o<t?n.push(e.simDatas[o]):i.push(e.simDatas[o]);e.playPKStage(n,function(){e.playRoundChange(e.pkInfo.round),e.playPKStage(i,function(){l.showTurn("It is your turn!"),e.beginPKStage()})})}}),t.play("pkstart")):(this.pkTop.y=647,l.getPageAsync(l.TURNTABLE).then(function(n){n.getComponent("TurntableDialog").setFinishCallback(function(n){l.hideDialog(l.TURNTABLE),e.pkInfo.stake=n,e.addPkPlayersDisplay(),e.pkTop.y=347,t.once("finished",function(){e.beginPKStage()}),t.play("pkstart")}),l.showDialog(l.TURNTABLE)}))}},preparePkAsync:function(e){var t=this;this.isPkMod=!1,this.removeKnifes(!0),this.removeApples(!0),this.pkInfo=e,this.leftRound=this.pkInfo.fightId&&this.pkInfo.round<=3?2:1,this.isPkMod=!0,this.knifeTextures={},this.init(),this.addPkPlayersDisplay();var i=[],l=this.pkInfo.myDatas||[],h=this.pkInfo.opponentDatas||[],d=["33",n.get().getCurKnife()];l.forEach(function(e){var t=e>>16;d.indexOf(t)<0&&d.push(t),i.push({id:t,rotation:65535&e})}),h.forEach(function(e){var t=e>>16;d.indexOf(t)<0&&d.push(t),i.push({id:t,rotation:65535&e})}),this.knifesInPkTargets=i;var u=o.getData(1),p=u.target,g=a.getData(p),f=u.animation;this.pkInfo.round,cc.loader.loadRes("target/target_1",function(e,n){e||(t.targetSprite.spriteFrame=new cc.SpriteFrame(n))}),this.curActionsData=s.getData(f),this.curTargetData=g,this.sounds={hitTarget:r.HIT,hitBlock:r.KNIFE_HIT,hitApple:r.APPLE_HIT};var m=null!=this.pkInfo.randomIndex?this.pkInfo.randomIndex:Math.floor(Math.random()*u.knifes.length),v=u.knifes[m],y=u.diamons[m];this.pkInfo.randomIndex=m;for(var I=0;I<v.length;I++){var _=this.defaultKnifePool.get();_.rotation=v[I],this.addKnifeToTarget(_),this.knifesInPkTargets.unshift({id:"33",rotation:v[I]})}if(!this.pkInfo.fightId)for(var A=0;A<y.length;A++){var b=this.applePool.get();b.rotation=y[A],this.addAppleToTarget(b)}var k=function(){for(var e=t.knifesInPkTargets,n=[4,7,5,3],i=t.pkInfo.round<=n.length?n[t.pkInfo.round-1]:1,o=0;o<e.length-i;o++){var a=t.defaultKnifePool.get();a.rotation=e[o].rotation,t.addKnifeToTarget(a,e[o].id)}for(t.simDatas=[];o<e.length;o++)t.simDatas.push(e[o])};return new Promise(function(e){var i=0;if(0==d.length)return k(),void e();for(var o=function(o){var a=c.getData(d[o]);a&&a.img&&cc.loader.loadRes("knife/"+a.img,function(a,s){a?console.log("error",a):(t.knifeTextures[d[o]]=s,d[o]==n.get().getCurKnife()&&t.setKnifeTempLate(new cc.SpriteFrame(s)),++i>=d.length&&(k(),e()))})},a=0;a<d.length;a++)o(a)})},addPkPlayersDisplay:function(){var e=this;this.myNameLabel.string=FBInstant.player.getName();var t=FBInstant.player.getPhoto();this.myPhotoTexure?this.mySprite.spriteFrame=new cc.SpriteFrame(this.myPhotoTexure):t&&cc.loader.load(t,function(t,n){t||(e.mySprite.spriteFrame=new cc.SpriteFrame(n))}),this.opponentNameLabel.string=this.pkInfo.nickname,this.opponentSprite.spriteFrame=this.defaltHeadFrame,this.pkInfo.photo&&cc.loader.load(this.pkInfo.photo,function(t,n){t||(e.opponentSprite.spriteFrame=new cc.SpriteFrame(n))});var n=i.getData(this.pkInfo.stake);n&&n.img&&cc.loader.loadRes("stakes/"+n.img,function(t,n){t||(e.stakeSprite.spriteFrame=new cc.SpriteFrame(n))})},playPKStage:function(e,t){var n=this;this.resetKnifes(e.length),this.resetUpLeftKnifes(e.length),this.resetUpRightKnifes(e.length),this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){for(var i=function(i){var o=n.defaultKnifePool.get();o.rotation=e[i].rotation,setTimeout(function(){n.addKnifeToTarget(o,e[i].id,!0),r.play(n.sounds.hitTarget),n.consumeOneKnife(),i==e.length-1&&t()},500*i)},o=0;o<e.length;o++)i(o)})))},playRoundChange:function(e){var t=this;this.roundLabel.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,0),cc.fadeOut()),cc.callFunc(function(){t.roundLabel.string="ROUND "+e,t.roundLabel.node.scale=4}),cc.spawn(cc.scaleTo(.1,1),cc.fadeIn())))},beginPKStage:function(e){this.isInPlayback=!1;var t=[4,3,2,1],n=o.getData(1),i=n.target,c=a.getData(i),r=(n.animation,this.pkInfo.round),l=r<=t.length?t[r-1]:1;if(this.curActionsData=s.getData(n.animation),this.curTargetData=c,this.resetKnifes(l),this.pkInfo.fightId&&!e||(this.resetUpLeftKnifes(l),this.resetUpRightKnifes(l)),e)return this.isStageBegin=!0,this.showKnifeIn(),void this.playRoundChange(this.pkInfo.round);this.beginStageActions()},onPkRoundEnd:function(e){var t=this;if(this.leftRound--,!e&&this.leftRound>0)return this.pkInfo.round++,void this.beginPKStage(!0);for(var o=[],a=n.get().getCurKnife(),s=0;s<this.roundKnifeData.length;s++)this.roundKnifeData[s]=this.roundKnifeData[s]%360,this.roundKnifeData[s]<0&&(this.roundKnifeData[s]+=360),o.push(a<<16|Math.round(this.roundKnifeData[s])),this.knifesInPkTargets.push({id:a,rotation:Math.round(this.roundKnifeData[s])});this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),l.showTip("Sending score...",null,-200);var c=null,r="",d="",p=!1,g=this.myNameLabel.string,f=this.opponentNameLabel.string,m=[4,3,2,1],v=i.getData(this.pkInfo.stake).emoji,y=-1,I=!1,_=this.pkInfo.round;if(this.pkInfo.fightId&&!e){var A=_<=m.length?m[_-1]:1;4==_&&this.pkInfo.promoterPlayerId!=this.pkInfo.opponentPlayerId?(c=u.FightOverAsync(this.pkInfo.fightId,0,o,_),r="Draw! Great game! Will "+f+" want a duel?",I=!0,d="START NEW MATCH",p=!0):(c=u.FightRoundAsync(this.pkInfo.fightId,this.isUsingContinue,o,_),r="Round "+_+" starts with "+g+" casting "+A+" knives first and then "+f+".",d="PLAY")}else e?(y=this.pkInfo.opponentDatas.length+this.pkInfo.myDatas.length+o.length,c=u.FightOverAsync(this.pkInfo.fightId,this.pkInfo.opponentPlayerId,o,_),r=g+"  lost aginst "+f+"! "+g+" is obliged to buy "+v+" for "+f+".",d="START NEW MATCH",p=!0):(c=u.FightWithFriendAsync(this.pkInfo.opponentFacebookId,this.pkInfo.contextId,this.pkInfo.stake,o,this.isUsingContinue,this.pkInfo.randomIndex),r=g+" challenges "+f+" to a duel and the prize is "+v+".Round 1 starts and then "+f+".",d="ACCEPT PK");var b="";c.then(function(e){return b=e.sign,t.getScreenImageAsync(y,I,o)}).then(function(e){var n=function(){l.showTip("Score sent!",null,-200,!0),h.logEvent("pkmessage_send"),setTimeout(function(){if(l.hideTip(),p){var e=t.pkTop.getChildByName("mask");e.active=!0;var n=I?t.pkTop.getChildByName("draw"):t.pkTop.getChildByName("lose");n.active=!0,n.scale=4,n.opacity=0,n.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,1),cc.fadeIn(.1)),cc.delayTime(2),cc.callFunc(function(){n.active=!1,e.active=!1,l.showPage(l.PKPAGE)},t)))}else l.showTurn("It's your friend's turn !"),setTimeout(function(){l.showPage(l.PKPAGE)},3e3)},1e3)};FBInstant.updateAsync({action:"CUSTOM",cta:d,template:"pk_turn",text:r,image:e,data:{isPk:!0,sign:b,fightId:t.pkInfo.fightId,isNewMatch:p,from:"pk"},strategy:"IMMEDIATE",notification:"PUSH"}).then(n,n),t.isPkMod=!1,t.pkInfo=null}).catch(function(e){console.log(e),l.hideTip(),l.showPage(l.PKPAGE)})},getScreenImageAsync:function(e,t,n,i){var o=this.myNameLabel.string,a=this.opponentNameLabel.string,s=this.pkInfo.round,c=[4,3,2,1],r=!this.pkInfo.fightId||this.pkInfo.promoterPlayerId!=this.pkInfo.opponentPlayerId,l=this.mySprite.spriteFrame.getTexture(),h=this.opponentSprite.spriteFrame.getTexture(),u=s>1?c[s-2]:5,p=n.length%u,g=r?0:c[s-1],f={myName:r?o:a,opponentName:r?a:o,myTexture:r?l:h,opponentTexture:r?h:l,round:this.pkInfo.round,stakeTexture:this.stakeSprite.spriteFrame.getTexture(),knifes:this.knifesInPkTargets,knifeTextures:this.knifeTextures,loseIndex:e,isDraw:t,isMyTurn:!r,isMyWin:i||!r,leftCount:r?p:g,rightCount:r?g:p};return new Promise(function(e,t){d.getImageAsync("PKScreen",f).then(e).catch(t)})},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++)(t=new cc.Node).isDefaultKnife=!0,this.defaultKnifePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.defaultKnifeIcon;for(e=0;e<30;e++)(t=new cc.Node).scale=.53,t.width=136,t.height=162,this.applePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.appleIcon;for(e=0;e<10;e++){var t;(t=new cc.Node).scale=.6,t.width=72,t.height=86,this.goldApplePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.goldAppleIcon}},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){var e=this;0==this.leftAmount&&(this.isStageBegin=!1,h.logEvent("pk_round_finish",{curStage:this.curStage}),setTimeout(function(){e.onPkRoundEnd()},1e3))},removeKnifes:function(e){if(!this.isPkMod)for(var t=this.targetBack.children,n=this,i=.3,o=t.length-1;o>=0;o--){var a=t[o];e?s(a):c(a)}function s(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?n.defaultKnifePool.put(e):n.knifePool.put(e),e.opacity=255}function c(e){var t=2*Math.random()+3,n=cc.moveBy(i,-e.x*t,-e.y*t),o=cc.rotateBy(i,380*Math.random()-180),a=cc.sequence(cc.delayTime(i-.05),cc.fadeOut(.05));e.runAction(cc.sequence(cc.spawn(n,o,a),cc.callFunc(s.bind(null,e))))}},removeApples:function(){if(!this.isPkMod)for(var e=this.targetUp.children,t=this,n=e.length-1;n>=0;n--)i(e[n]);function i(e){e.isGold?t.goldApplePool.put(e):t.applePool.put(e)}},removeSpecial:function(){this.specialBack.removeAllChildren(),this.specailUp.removeAllChildren()},resetUpLeftKnifes:function(e){for(var t=0;t<e;t++){if(t>=this.myknifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.myknifes.push(n),this.myKnifeGroup.addChild(n)}this.myknifes[t].x=30*t,this.myknifes[t].y=0,this.myknifes[t].active||(this.myknifes[t].active=!0),this.myknifes[t].getComponent("KnifeIcon").setSelect(!0),this.myknifes[t].runAction(cc.hide()),this.myknifes[t].runAction(cc.sequence(cc.delayTime(.1*t),cc.show()))}for(;t<this.myknifes.length;t++)this.myknifes[t].active=!1},resetUpRightKnifes:function(e){for(var t=0;t<e;t++){if(t>=this.opponentknifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.opponentknifes.push(n),this.opponentKnifeGroup.addChild(n)}this.opponentknifes[t].x=-30*t,this.opponentknifes[t].y=0,this.opponentknifes[t].active||(this.opponentknifes[t].active=!0);var i=this.pkInfo.promoterPlayerId!=this.pkInfo.opponentPlayerId||!this.pkInfo.fightId,o=i&&(1==this.pkInfo.round||3==this.pkInfo.round)||!i&&(2==this.pkInfo.round||4==this.pkInfo.round||5==this.pkInfo.round);this.opponentknifes[t].getComponent("KnifeIcon").setSelect(this.isInPlayback||o),this.opponentknifes[t].runAction(cc.hide()),this.opponentknifes[t].runAction(cc.sequence(cc.delayTime(.1*t),cc.show()))}for(;t<this.opponentknifes.length;t++)this.opponentknifes[t].active=!1},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1),this.isPkMod&&(this.isInPlayback?this.opponentknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1):this.myknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)))},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){n.get().addOneDiamon(e)},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),r.play(r.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.showKnifeIn()},getActions:function(e){for(var t=[],n=3*Math.random()>2,i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s;return s=t.length>1?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e,t,n){var i=e.rotation,o=i*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-i,e.x=this.targetBack.x+160*Math.cos(o),e.y=this.targetBack.y+160*Math.sin(o),t&&(e.preFrame=e.getComponent(cc.Sprite).spriteFrame,e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.knifeTextures[t])),n){var a=e.x,s=e.y;e.x=this.targetBack.x+500*Math.cos(o),e.y=this.targetBack.y+500*Math.sin(o),e.runAction(cc.moveTo(.05,a,s))}},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+198*Math.cos(n),e.y=this.targetUp.y+198*Math.sin(n)},showResult:function(){var e=this;l.hideDialog(l.CONTINUE),setTimeout(function(){e.onPkRoundEnd(!0)},0)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++)if((u=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(u*Math.PI/180),o=-Math.abs(Math.cos(u*Math.PI/180));p&&(i=-i);var a=Math.max(.1,u/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*u*20),c=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*c*10,o*=c;var l=cc.moveBy(a,i,o),h=this,d=cc.spawn(l,s);this.curMoveKnife.runAction(cc.sequence(d,cc.callFunc(function(){h.knifePool.put(h.curMoveKnife),h.curMoveKnife=null,setTimeout(function(){h.onGameOver()},200)}))),this.playDieEffect(u,p),r.play(this.sounds.hitBlock);break}for(e=this.targetUp.children,t=15,n=0;n<e.length;n++){var u,p;if((u=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){var g=e[n].isGold;this.addOneDiamon(g),g?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var f=g?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);f.x=30*Math.random()-15,f.y=-131,this.node.getChildByName("upEffectGroup").addChild(f),r.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var e=this,t=1==this.continueCount&&100*Math.random()<n.get().getChance_extra(),i=this.freeBonusCount<1&&100*Math.random()<n.get().getChance_second(),o=c.getData(n.get().getCurKnife()).rate||0,a=this.freeBonusCount<1&&100*Math.random()<o;if(this.freeBonusCount++,this.isPkMod&&!this.pkInfo.fightId&&(i=!0),a){var s=this;this.showBonus(function(){s.continueGame(!0)},7)}else i?(s=this,this.showBonus(function(){s.continueGame(!0)},1)):(t||0==this.continueCount&&(this.curStage>=5||this.isPkMod))&&h.isVideoLoad()||0==this.continueCount&&!this.isPkMod&&this.curStage>=5?(this.continueCount++,l.getPage(l.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.curTargetData.name,continueCount:this.continueCount,isBoss:!1,onContinue:function(t){t&&e.showCostTip(t),e.continueGame()},onNoContinue:function(){e.showResult()},from:"gamemain"}),l.showDialog(l.CONTINUE),this.isPkMod&&h.logEvent("pk_continue_show")):(this.showResult(),h.logEvent("game_end",{curStage:this.curStage,leftAmount:this.leftAmount,targetId:this.curTargetData?this.curTargetData.index:1}));(t||0==this.continueCount&&this.curStage>5)&&!h.isVideoLoad()&&cc.sys.isMobile&&h.logEvent("continue_noads")},continueGame:function(e){this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn(),!e&&this.isPkMod&&h.logEvent("pk_continue_click")},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,r.play(this.sounds.hitTarget),this.roundKnifeData.push(this.curMoveKnife.rotation),this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife);var e=cc.instantiate(this.parNode);e.y=-131,this.node.getChildByName("effectGroup").addChild(e),e.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd()}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",KnifeData:"KnifeData",LevelData:"LevelData",NetAPI:"NetAPI",PKLevelData:"PKLevelData",PageMgr:"PageMgr",PrizeData:"PrizeData",SoundMgr:"SoundMgr",TargetData:"TargetData",User:"User",Utils:"Utils",enginefix:"enginefix"}],GameHalloween:[function(e,t){"use strict";cc._RF.push(t,"5594ay5lTZN1rrU6TXeubwU","GameHalloween");var n=e("User"),i=e("HalloweenLevelData"),o=e("TargetData"),a=e("AnimationData"),s=e("KnifeData"),c=e("SoundMgr"),r=e("PageMgr"),l=e("AdHelper"),h=e("Utils");e("enginefix");var d=[50,100,150,200];cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,stageLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,bossDefentedAnim:cc.Prefab,bonusAnim:cc.Prefab,bossEye1:cc.Node,bossEye2:cc.Node,bossLight:cc.Node,lastBossLight:cc.Node,cameraBtn:cc.Node,screenNode:cc.Node,costTipNode:cc.Node,yoff:0,stopY:0,speed:0},init:function(){var e=this;this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.preBossData=null,this.preBossTexture=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,!this.myPhotoTexure&&FBInstant&&FBInstant.player.getPhoto()&&cc.loader.load(FBInstant.player.getPhoto(),function(t,n){t||(e.myPhotoTexure=n)}),this.otherPlayer=null,this.playWithMsg=null,this.playerCount=0,FBInstant&&FBInstant.context.getPlayersAsync().then(function(t){for(var i in e.playerCount=t.length,t)if(t[i].getID()!=FBInstant.player.getID()){e.otherPlayer=t[i],r.showPK("Playing with "+t[i].getName());break}e.playerCount>2&&n.get().addGroupId(FBInstant.context.getID())})},onUpdateData:function(e){this.setKnifeTempLate(e.knifeNode)},setKnifeTempLate:function(e){e instanceof cc.SpriteFrame?this.knifeTemplate.getComponent(cc.Sprite).spriteFrame=e:this.knifeTemplate=e,this.knifeTemplate.scale=1,this.knifeTemplate.rotation=0,this.setupKnifesPool()},setPlayerGroupVisible:function(e,t){this.playerPhoto.node.parent.parent.active=e,this.playerPhoto.node.parent.parent.zIndex=t?-1:1},addPlayerPhoto:function(e){var t=this;cc.loader.loadRes("target/"+this.curTargetData.avator+"_mask",function(n,i){if(n)console.log("load =====error ",n);else{var o=t.playerPhoto.node.parent;o.getComponent(cc.Mask).spriteFrame=new cc.SpriteFrame(i),o.parent.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),o.width=i.width,o.height=i.height,e||"boss_s4"==t.curTargetData.avator||(o.width-=20,o.height-=20),window.FBInstant?(l.logEvent("specialboss_show_"+t.curTargetData.avator),function(n){cc.loader.load(n,function(n,i){n?console.log(n):t.isBossStage()&&(t.setPlayerGroupVisible(!0,e),t.playerPhoto.spriteFrame=new cc.SpriteFrame(i),t.playerPhoto.node.width=o.width,t.playerPhoto.node.height=o.height)})}(t.otherPlayer&&t.otherPlayer.getPhoto()||FBInstant.player.getPhoto())):cc.loader.loadRes("test",function(n,i){n?console.log("load =====error ",n):(t.setPlayerGroupVisible(!0,e),t.playerPhoto.spriteFrame=new cc.SpriteFrame(i),t.playerPhoto.node.width=o.width,t.playerPhoto.node.height=o.height)})}})},showCostTip:function(e){this.costTipNode.active=!0,this.costTipNode.stopAllActions(),this.costTipNode.scale=0,this.costTipNode.y=-203,this.costTipNode.opacity=255,this.costTipNode.getChildByName("label").getComponent(cc.Label).string=e,this.costTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50))))},onCameraClick:function(){this.cameraBtn.active=!1,c.play(c.CAMERA),this.whiteMask.node.active=!1;var e=this.targetAnim.node.rotation;this.targetAnim.node.rotation=0;var t=cc.director.getRunningScene(),n=cc.winSize.height;"boss_s4"==this.curTargetData.avator&&this.ballLaba&&(this.ballLaba.scale=1,this.targetBack.active=!1),h.captureScreen(t,cc.winSize.width,n,function(e,t){this.shareBase64Img=e,this.screenNode.parent.active=!0;var n=(this.screenNode.width-50)/cc.winSize.width,i=this.screenNode.parent.getChildByName("share"),o=this.screenNode.parent.getChildByName("chahao");i.scale=0,o.scale=0,t.runAction(cc.sequence(cc.scaleTo(.3,n,n*t.scaleY),cc.targetedAction(i,cc.scaleTo(.2,1)),cc.targetedAction(o,cc.scaleTo(.2,1)))),this.screenNode._sgNode.addChild(t),this.screenNode.rtt=t,this.screenNode.height=50+(this.screenNode.width-50)*cc.winSize.height/cc.winSize.width}.bind(this),function(){this.targetAnim.node.rotation=e,t.scale=1,t.runAction(cc.flipY(!1)),t.y=0,t.x=0,this.targetBack.active=!0,this.ballLaba&&(this.ballLaba.removeFromParent(),this.ballLaba=null)}.bind(this),300)},onShare:function(){if(FBInstant){l.logEvent("specialboss_shareclick_"+this.curTargetData.avator);var e="boss_s1"==this.curTargetData.avator?"I caught a ninja turtle,do you want it? ":"Who inserted the knife? is it you? \ud83d\udc96\ud83d\udc96\ud83d\udc96\ud83d\udc96";"boss_s4"==this.curTargetData.avator&&(e="Decisive world cup ! \u26bd\ufe0f\u26bd\ufe0f\u26bd\ufe0f"),FBInstant.shareAsync({intent:"SHARE",image:this.shareBase64Img,text:e,data:{myReplayData:"data",from:"boss"}}).then(function(){l.logEvent("specialboss_share_send_"+this.curTargetData.avator),this.showBossDefeated()}.bind(this)).catch(this.showBossDefeated.bind(this))}else this.showBossDefeated();this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onShareClose:function(){this.showBossDefeated(),this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onEnable:function(){this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),this.gotoStage(this.curStage),this.showKnifeIn()},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++)(t=new cc.Node).isDefaultKnife=!0,this.defaultKnifePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.defaultKnifeIcon;for(e=0;e<30;e++)(t=new cc.Node).scale=.53,t.width=136,t.height=162,this.applePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.appleIcon;for(e=0;e<10;e++){var t;(t=new cc.Node).scale=.6,t.width=72,t.height=86,this.goldApplePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.goldAppleIcon}},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){0==this.leftAmount&&(this.isStageBegin=!1,l.logEvent("halloween_level_finish",{curStage:this.curStage}),this.isBossStage()?this.curTargetData.hasPlayerImg?(this.cameraBtn.active=!0,this.cameraBtn.stopAllActions(),this.cameraBtn.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.2),cc.scaleTo(.5,1))))):this.showBossDefeated():this.showStagePass(!0))},isBossStage:function(){return this.curStage%5==0},showBossDefeated:function(){var e=this;if(this.setPlayerGroupVisible(!1),n.get().markBossDefented(this.curTargetData.index),n.get().isKnifeUnlock(this.curTargetData.drop))Math.random()<.5?this.showStagePass(!0):this.showStagePass(!1,function(){r.showDialogAsync("SweetCollectDialog",{count:d[Math.floor(e.curStage/5)-1],name:e.curTargetData.name,onClose:function(){e.gotoNextStage()}})});else{var t=r.getPage(r.SHOWKNIFE).getComponent("ShowKnifeDialog");t.setKnifeInfo(this.curTargetData,this.preKnifeTexture,!1),this.preKnifeTexture=null;var i=this;this.showStagePass(!1,function(){r.showDialog(r.SHOWKNIFE)}),t.registerOnClose(function(e,t){e&&i.setKnifeTempLate(t),i.gotoNextStage()})}},showStagePass:function(e,t){var i=this;this.targetAnim.node.stopAllActions(),this.targetAction=null,this.targetSprite.node.scale=0,this.removeKnifes(),this.removeApples(),this.removeSpecial();var o=this;if(this.isBossStage()){var a=cc.instantiate(this.parBrokenNode);this.node.getChildByName("effectGroup").addChild(a),o=this,setTimeout(function(){var a=n.get(),s=cc.instantiate(o.bossDefentedAnim);o.node.getChildByName("upEffectGroup").addChild(s);var r=s.getComponent(cc.Animation),l=s.getChildByName("bossgroup").getChildByName("progressBar");l.getChildByName("info").getComponent(cc.Label).string="Level "+a.getPlayer_lv();var h=l.getComponent(cc.ProgressBar),d=!1;h.progress=a.getPlayer_exp()/a.getMaxExp();var u=a.addExp(o.isDoubleXp?2*o.curTargetData.exp:o.curTargetData.exp),p=a.getPlayer_exp()/a.getMaxExp(),g=!1;!n.get().isMaxLevel()&&p<h.progress&&(p=1,g=!0),l.getChildByName("backbar").getComponent(cc.Sprite).fillRange=p;var f=p-h.progress;o.isDoubleXp&&(p=h.progress+f/2);var m=s.getChildByName("upgrageGroup");function v(e){l.color=e,s.getChildByName("zi").color=e;var t=s.getChildByName("bossgroup");t.getChildByName("bossdunbg").color=e,t.getChildByName("bossxiaodao1").color=e,t.getChildByName("bossxiaodao").color=e,t.getChildByName("bossdun").color=e,t.getChildByName("bosszui").color=e,t.getChildByName("progressBar").color=e,s.getChildByName("guang").color=e}h.schedule(function(){if(d)if(h.progress<p)h.progress+=.02;else{if(d=!1,g){r.pause();var e=n.get().getChanceTyType(u)+["% FOR SECOND CHANCE","% FOR EXTRA CONTINUE","% MORE APPLES IN FREE GIFT ","% FOR GOLDEN APPLE","APPLES FOR VIDEO","% FOR DOUBLE XP"][u-1];m.getChildByName("info").getComponent(cc.Label).string=e,m.getChildByName("icon").getComponent("PowerIcon").setIcon(u),m.active=!0,m.scale=.8,m.runAction(cc.scaleTo(.3,1))}o.isDoubleXp&&setTimeout(function(){d=!0,p+=f/2,o.isDoubleXp=!1},300)}},0),r.beginProgress=function(){d=!0},i.curTargetData.bossLv>0?v(cc.color().fromHEX(["#fce352","#a750f5"][i.curTargetData.bossLv-1])):v(cc.color().fromHEX("#ffffff")),s.on("clickOk",function(){m.active=!1,r.resume()}),r.on("finished",function(){r.off("finished"),s.removeFromParent(),e?o.gotoNextStage():t&&t()}),c.play(c.BOSS_DEFENTED)},500);var s=a.getComponent(cc.ParticleSystem);s.resetSystem(),this.curTargetData.color&&(s.startColor=s.startColor.fromHEX(this.curTargetData.color),s.endColor=s.endColor.fromHEX(this.curTargetData.color))}else{for(var r=cc.instantiate(o.targetBrokenAnim),l=1;l<=3;l++)r.getChildByName("kuai"+l).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.targetSprite.spriteFrame.getTexture());o.node.getChildByName("upEffectGroup").addChild(r);var h=r.getComponent(cc.Animation);h.play("broken"),h.on("finished",function(){h.off("finished"),r.removeFromParent(),e?o.gotoNextStage():t&&t()})}},removeKnifes:function(e){if(!this.isPkMod)for(var t=this.targetBack.children,n=this,i=.3,o=t.length-1;o>=0;o--){var a=t[o];e?s(a):c(a)}function s(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?n.defaultKnifePool.put(e):n.knifePool.put(e),e.opacity=255}function c(e){var t=2*Math.random()+3,n=cc.moveBy(i,-e.x*t,-e.y*t),o=cc.rotateBy(i,380*Math.random()-180),a=cc.sequence(cc.delayTime(i-.05),cc.fadeOut(.05));e.runAction(cc.sequence(cc.spawn(n,o,a),cc.callFunc(s.bind(null,e))))}},removeApples:function(){if(!this.isPkMod)for(var e=this.targetUp.children,t=this,n=e.length-1;n>=0;n--)i(e[n]);function i(e){e.isGold?t.goldApplePool.put(e):t.applePool.put(e)}},removeSpecial:function(){this.specialBack.removeAllChildren(),this.bossEye1.active=!1,this.bossEye2.active=!1,this.bossLight.active=!1,this.lastBossLight.active=!1},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1),this.isPkMod&&(this.isInPlayback?this.opponentknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1):this.myknifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)))},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){n.get().addOneDiamon(e),this.diamonCountLabel.string=n.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),c.play(c.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoNextStage:function(){this.curStage++,this.curStage>20?r.showDialogAsync("HalloweenEndDialog"):this.gotoStage(this.curStage)},preLoadBoss:function(e){for(var t=i.getData(e),a=t.targetInfo,r=t.rareInfo,l=null,h=0;h<a.length;h++)if(!n.get().isBossDefented(a[h].target)){l=a[h];break}if(r&&!l)for(var d=0;d<r.length;d++)if(!n.get().isBossDefented(r[d].target)){l=r[d];break}var u=null;if(l)u=l;else{var p=n.get().getMaxStage()>=8?.9:.5,g=r&&r.length>0&&Math.random()>p?r:a;u=g[Math.floor(Math.random()*g.length)]}var f=t.test;null!=f&&(u=t.test<a.length?a[f]:r[f-a.length]),this.preBossData=u;var m=u.target||1,v=o.getData(m),y=this;if(v.avator&&cc.loader.loadRes("target/"+v.avator,function(e,t){y.preBossTexture=t}),v.hitTarget&&c.preLoad(c[v.hitTarget]),v.drop){var I=s.getData(v.drop);cc.loader.loadRes("knife/"+I.img,function(e,t){e?console.log("error",e):y.preKnifeTexture=t})}},gotoStage:function(e){this.curStage=e,this.curStage%5==1?this.preLoadBoss(this.curStage+4):this.setPlayerGroupVisible(!1);var t=i.getData(this.curStage),s=t.targetInfo,r=t.rareInfo,l=n.get().getMaxStage()>=8?.9:.5,h=r&&Math.random()>l?r:s,d=h[Math.floor(Math.random()*h.length)],u=t.test;null!=u?d=t.test<s.length?s[u]:r[u-s.length]:this.isBossStage()&&(this.preBossData||this.preLoadBoss(this.curStage),d=this.preBossData);var p=d.target;p||(p=1);var g=o.getData(p),f=t.diamons?t.diamons:d.diamons,m=t.gold?t.gold:d.gold,v=d.knifes,y=(d.animation,d.count);this.curActionsData=a.getData(d.animation),1==p&&(g={index:p,avator:"target_111"}),this.resetKnifes(y);for(var I=0;I<v.length;I++)(_=this.defaultKnifePool.get()).rotation=v[I],this.addKnifeToTarget(_);for(I=0;f&&I<f.length;I++)(_=this.applePool.get()).rotation=f[I],_.isGold=!1,this.addAppleToTarget(_);for(I=0;m&&I<m.length;I++){var _;(_=this.goldApplePool.get()).rotation=m[I],_.isGold=!0,this.addAppleToTarget(_)}if(this.sounds={hitTarget:c.HIT,hitBlock:c.KNIFE_HIT,hitApple:c.APPLE_HIT},g.hasPlayerImg=!1,this.curTargetData!=g){this.sounds.hitTarget=c[g.hitTarget]||this.sounds.hitTarget,this.curTargetData=g;var A=this;this.isBossStage()&&A.preBossTexture?(A.targetSprite.spriteFrame=new cc.SpriteFrame(A.preBossTexture),A.whiteMask.spriteFrame=new cc.SpriteFrame(A.preBossTexture),A.targetSprite.node.width=A.preBossTexture.width,A.targetSprite.node.height=A.preBossTexture.height,A.preBossTexture=null):cc.loader.loadRes("target/"+g.avator,function(e,t){A.targetSprite.spriteFrame=new cc.SpriteFrame(t),A.whiteMask.spriteFrame=new cc.SpriteFrame(t),A.targetSprite.node.width=t.width,A.targetSprite.node.height=t.height})}this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.curStage%5==0?this.setupStageBoss():this.beginStageActions()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.updateUI(),this.showKnifeIn()},getActions:function(e){for(var t=[],n=3*Math.random()>2,i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s;return s=t.length>1?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e){this.knifeCountLabel.string=this.curKnifeAmount;var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetBack,e.rotation=270-t,e.x=this.targetBack.x+160*Math.cos(n),e.y=this.targetBack.y+160*Math.sin(n)},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+198*Math.cos(n),e.y=this.targetUp.y+198*Math.sin(n)},setupStageBoss:function(){var e=cc.instantiate(this.bossFightAnim),t=this;this.node.getChildByName("upEffectGroup").addChild(e);var i=e.getComponent(cc.Animation);function o(t){e.getChildByName("bossxiaodaoL").color=t,e.getChildByName("bossxiaodaoR").color=t,e.getChildByName("bossziti2").color=t,e.getChildByName("guang").color=t;var n=e.getChildByName("bossdun");n.getChildByName("bossdun").color=t,n.getChildByName("bosszui").color=t}this.curTargetData.bossLv>0?o(cc.color().fromHEX(["#fce352","#a750f5"][this.curTargetData.bossLv-1])):o(cc.color().fromHEX("#ffffff")),i.playSound=function(){c.play(c.BOSS_FIGHT)},i.on("finished",function(){i.off("finished"),e.removeFromParent(),t.isDoubleXp=100*Math.random()<n.get().getChance_doubleXp(),t.isDoubleXp?t.showBonus(function(){t.beginStageActions()},6):t.beginStageActions()}),this.curTargetData.hasPlayerImg&&this.addPlayerPhoto(this.curTargetData.isBack),"boss_80000"==this.curTargetData.avator&&(this.bossEye1.active=!0,this.bossEye2.active=!0,this.bossEye1.scale=.5,this.bossEye2.scaleX=-.5,this.bossEye2.scaleY=.5),"boss_80001"==this.curTargetData.avator&&(this.bossLight.active=!0,this.bossLight.opacity=0),"boss_80003"==this.curTargetData.avator&&(this.lastBossLight.active=!0,this.lastBossLight.opacity=0)},showResult:function(){r.showPageAsync("HalloweenResultDialog",{score:this.curKnifeAmount,stageNum:this.curStage,playerTexture:this.myPhotoTexure,playerCount:this.playerCount})},updateUI:function(){this.diamonCountLabel.string=n.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5));var e=this.curStage%5;if(0==e)this.stageLabel.string="BOSS: "+this.curTargetData.name,this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#ed524b"),this.pointsNode.active=!1,this.pkIcon.runAction(cc.moveTo(.5,0,this.pkIcon.y)),this.pkIcon.color=this.stageLabel.node.color;else{this.stageLabel.node.color=cc.Color.WHITE,this.pkIcon.color=cc.Color.WHITE;var t=this;this.pkIcon.runAction(cc.sequence(cc.moveTo(.5,70,this.pkIcon.y),cc.callFunc(function(){t.pointsNode.active=!0}))),this.stageLabel.string="Stage "+this.curStage}this.pointsNode.getComponent("PointControl").setCount(e)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++)if((u=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(u*Math.PI/180),o=-Math.abs(Math.cos(u*Math.PI/180));p&&(i=-i);var a=Math.max(.1,u/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*u*20),r=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*r*10,o*=r;var l=cc.moveBy(a,i,o),h=this,d=cc.spawn(l,s);this.curMoveKnife.runAction(cc.sequence(d,cc.callFunc(function(){h.knifePool.put(h.curMoveKnife),h.curMoveKnife=null,setTimeout(function(){h.onGameOver()},200)}))),this.playDieEffect(u,p),c.play(this.sounds.hitBlock);break}for(e=this.targetUp.children,t=15,n=0;n<e.length;n++){var u,p;if((u=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){var g=e[n].isGold;this.addOneDiamon(g),g?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var f=g?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);f.x=30*Math.random()-15,f.y=-131,this.node.getChildByName("upEffectGroup").addChild(f),c.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var e=this,t=1==this.continueCount&&100*Math.random()<n.get().getChance_extra(),i=this.freeBonusCount<1&&100*Math.random()<n.get().getChance_second(),o=s.getData(n.get().getCurKnife()).rate||0,a=this.freeBonusCount<1&&100*Math.random()<o;if(this.freeBonusCount++,a){var c=this;this.showBonus(function(){c.continueGame(!0)},7)}else i?(c=this,this.showBonus(function(){c.continueGame(!0)},1)):(t||0==this.continueCount&&(this.curStage>=5||this.isPkMod))&&l.isVideoLoad()||0==this.continueCount&&!this.isPkMod&&this.curStage>=5?(this.continueCount++,r.getPage(r.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.curTargetData.name,continueCount:this.continueCount,isBoss:this.isBossStage(),onContinue:function(t){t&&e.showCostTip(t),e.continueGame()},onNoContinue:function(){e.showResult()},from:"game_halloween"}),r.showDialog(r.CONTINUE)):(this.setPlayerGroupVisible(!1),this.showResult(),this.isPkMod||l.autoShowAd(),l.logEvent("halloween_game_end",{curStage:this.curStage,leftAmount:this.leftAmount,targetId:this.curTargetData?this.curTargetData.index:1}));(t||0==this.continueCount&&this.curStage>5)&&!l.isVideoLoad()&&cc.sys.isMobile&&l.logEvent("continue_noads")},continueGame:function(){this.diamonCountLabel.string=n.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn()},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0!=this.leftAmount||this.isPkMod)c.play(this.sounds.hitTarget);else{var e=this.isBossStage()?c.HIT_LAST_SPECIAL:c.HIT_LAST;c.play(e)}this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife);var t=cc.instantiate(this.parNode);t.y=-131,this.node.getChildByName("effectGroup").addChild(t),t.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd(),this.bossEye1.active?(this.bossEye1.scale=1,this.bossEye1.stopAllActions(),this.bossEye1.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,.5))),this.bossEye2.scaleX=-1,this.bossEye2.scaleY=1,this.bossEye2.stopAllActions(),this.bossEye2.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,-.5,.5)))):this.bossLight.active?(this.bossLight.stopAllActions(),this.bossLight.runAction(cc.sequence(cc.fadeTo(.01,255),cc.delayTime(.5),cc.fadeTo(.3,0)))):this.lastBossLight.active&&(this.lastBossLight.stopAllActions(),this.lastBossLight.runAction(cc.sequence(cc.fadeTo(.01,255),cc.delayTime(.5),cc.fadeTo(.3,0))))}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",HalloweenLevelData:"HalloweenLevelData",KnifeData:"KnifeData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",TargetData:"TargetData",User:"User",Utils:"Utils",enginefix:"enginefix"}],GameMain:[function(e,t){"use strict";cc._RF.push(t,"6a6b8Fgt6BD7KiUjrymfHhJ","GameMain");var n=e("User"),i=e("LevelData"),o=e("TargetData"),a=e("AnimationData"),s=e("KnifeData"),c=e("SoundMgr"),r=e("PageMgr"),l=e("AdHelper"),h=e("Utils"),d=e("TaskMgr");e("enginefix"),cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,stageLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,bossFightSp:sp.Skeleton,upgradeNode:cc.Node,bossBarSp:cc.Sprite,playerLvLabel:cc.Label,bossDefentedAnim:cc.Prefab,bonusAnim:cc.Prefab,cameraBtn:cc.Node,screenNode:cc.Node,gotoGroup:cc.Node,costTipNode:cc.Node,playerdes:cc.Sprite,rankPlayerScore:cc.Label,iconPlayerS:cc.Sprite,iconTipLabel:cc.Label,vsTop:cc.Node,singleTop:cc.Node,myCountLabel:cc.Label,opponentCountLabel:cc.Label,mySprite:cc.Sprite,opponentSprite:cc.Sprite,defaltHeadFrame:cc.SpriteFrame,yoff:-500,stopY:-180,speed:100},onLoad:function(){this.defaultKnifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple(),this.level5BossIndex=0,this.mobileCanera=null},init:function(){this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.iconPlayerS.node.active=!1,this.iconTipLabel.node.active=!1,this.bossFightSp.node.active=!1,this.bossBarSp.node.active=!1,this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.preBossData=null,this.preBossTexture=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.friendIndex=0,this.gotoUnlockLevel=15,window.platfromMgr.recorderStart()},clearMobileCamera:function(){this.updateMobileFun&&(this.unschedule(this.updateMobileFun),this.updateMobileFun=null),this.mobileCanera&&(this.mobileCanera.destroy(),this.mobileCanera=null)},createMobileCamera:function(){var e=this;window.tt&&(this.mobileCanera=tt.createCamera(),this.playerPhoto.node.parent.parent.active&&this.mobileCanera&&(this.mobileCanera.setBeautifyParam(.8,.79,.4,.58),this.mobileCanera.start("front",!0).then(function(t){console.log("succeed to open camera");var n=new cc.Texture2D;n.initWithElement(t),e.updateMobileFun=function(){n.initWithElement(t)},e.schedule(e.updateMobileFun),e.playerPhoto.spriteFrame=new cc.SpriteFrame(n);var i=e.playerPhoto.node.parent;e.playerPhoto.node.scale=i.width/e.playerPhoto.node.width,l.logEvent("camera_open")}).catch(function(e){console.log(e)})))},setKnifeTempLate:function(e){e instanceof cc.SpriteFrame?this.knifeTemplate.getComponent(cc.Sprite).spriteFrame=e:this.knifeTemplate=e,this.knifeTemplate.scale=1,this.knifeTemplate.rotation=0,this.setupKnifesPool()},setPlayerGroupVisible:function(e,t){this.playerPhoto.node.parent.parent.active=e,this.playerPhoto.node.parent.parent.zIndex=t?-1:1},addPlayerPhoto:function(e){if(console.log("addPlayerPhoto",window.platfromMgr.getAvatarUrl()),window.platfromMgr&&(!window.platfromMgr||null!=window.platfromMgr.getAvatarUrl())){var t=this;cc.loader.loadRes("target/"+this.curTargetData.avator+"_mask",function(n,i){if(n)console.log("load =====error ",n);else{var o=t.playerPhoto.node.parent;if(o.getComponent(cc.Mask).spriteFrame=new cc.SpriteFrame(i),o.parent.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),o.width=i.width,o.height=i.height,!e&&t.curTargetData.avator,window.platfromMgr){l.logEvent("specialboss_show_"+t.curTargetData.avator);var a=window.platfromMgr.getAvatarUrl();null!=a&&function(n){cc.assetManager.loadRemote(n,{ext:".png"},function(n,i){if(n)console.log(n,i);else if(console.log("ok",i),t.isBossStage()){t.setPlayerGroupVisible(!0,e),t.playerPhoto.spriteFrame=new cc.SpriteFrame(i);var a=Math.max(o.width,o.height);t.playerPhoto.node.scale=1,t.playerPhoto.node.width=a,t.playerPhoto.node.height=a}})}(a)}else cc.loader.loadRes("test",function(n,i){n?console.log("load =====error ",n):(t.setPlayerGroupVisible(!0,e),t.playerPhoto.spriteFrame=new cc.SpriteFrame(i),t.playerPhoto.node.width=o.width,t.playerPhoto.node.height=o.height)})}})}},showGotoBtn:function(){var e=this,t=(n.get().isPayReady()||n.get().getDiamonCount(),l.isVideoLoad()),i=this.gotoGroup.getChildByName("adgotobtn"),o=this.gotoGroup.getChildByName("applegotobtn");i.active=t,o.active=!0,this.gotoGroup.x=t?0:90,this.isGotoShow=!0,l.logEvent("GotoLevelShow",{mod:this.gotoMod}),i.scale=1.2,o.scale=1.2,this.gotoGroup.active=!0,i.stopAllActions(),o.stopAllActions(),i.runAction(cc.sequence(cc.repeat(cc.sequence(cc.scaleTo(.5,1),cc.scaleTo(.5,1.2)),3),cc.scaleTo(.2,0))),o.runAction(cc.sequence(cc.repeat(cc.sequence(cc.scaleTo(.5,1),cc.scaleTo(.5,1.2)),3),cc.scaleTo(.2,0))),this.gotoGroup.runAction(cc.sequence(cc.delayTime(3.2),cc.callFunc(function(){e.gotoGroup.stopAllActions(),e.gotoGroup.active=!1,e.isGotoShow=!1,e.playWithMsg&&(r.showPK(e.playWithMsg),e.playWithMsg=null)})))},gotoLevel:function(e,t){this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.gotoGroup.active=!1,this.curStage=e-1,this.curKnifeAmount=t,this.gotoNextStage()},onAdGotoClick:function(){this.gotoMod=1,this.onGotoLevelClick()},onAppleGotoClick:function(){n.get().getDiamonCount()<200?(n.get().isPayReady()?(r.showDialogAsync("AppleShopDialog"),r.showTip("APPLE NOT ENOUGH",null,-200)):r.showDialogAsync("IosShopPage"),setTimeout(function(){r.hideTip()},2e3)):(this.showCostTip(-200),this.gotoMod=0,this.onGotoLevelClick())},showCostTip:function(e){this.costTipNode.active=!0,this.costTipNode.stopAllActions(),this.costTipNode.scale=0,this.costTipNode.y=-203,this.costTipNode.opacity=255,this.costTipNode.getChildByName("label").getComponent(cc.Label).string=e,this.costTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50))))},onGotoLevelClick:function(){var e=this;l.logEvent("GotoLevelClick",{mod:this.gotoMod}),this.isGotoShow=!1,this.playWithMsg&&(r.showPK(this.playWithMsg),this.playWithMsg=null),this.curStage;var t=function(){e.gotoLevel(11,102),e.stageLabel.node.runAction(cc.sequence(cc.scaleTo(.5,1.5),cc.scaleTo(.5,1)))};0==this.gotoMod?(n.get().decDiamon(200),t()):l.showVideoAd(t,function(){})},onCameraClick:function(){this.cameraBtn.active=!1,c.play(c.CAMERA),this.whiteMask.node.active=!1;var e=this.targetAnim.node.rotation;this.targetAnim.node.rotation=0;var t=cc.director.getRunningScene(),n=cc.winSize.height;"boss_s4"==this.curTargetData.avator&&this.ballLaba&&(this.ballLaba.scale=1,this.targetBack.active=!1),this.knifeGroup.active=!1,h.captureScreen(t,cc.winSize.width,n,function(e,t){this.shareBase64Img=e,this.screenNode.parent.active=!0;var n=(this.screenNode.width-50)/cc.winSize.width,i=this.screenNode.parent.getChildByName("share"),o=this.screenNode.parent.getChildByName("chahao"),a=this.screenNode.parent.getChildByName("white");i.scale=0,o.scale=0,t.y=-90,t.scaleX=n,t.scaleY=n*t.scaleY,this.screenNode._sgNode.addChild(t),this.screenNode.rtt=t,this.screenNode.height=50+(this.screenNode.width-50)*(cc.winSize.height-660)/cc.winSize.width,a.width=this.screenNode.width,a.height=this.screenNode.height,this.screenNode.height-=50,this.screenNode.scale=1.1,this.screenNode.runAction(cc.scaleTo(.3,1)),a.scale=1.1,a.runAction(cc.sequence(cc.scaleTo(.3,1),cc.targetedAction(i,cc.scaleTo(.2,1)),cc.delayTime(1),cc.targetedAction(o,cc.scaleTo(.2,1))))}.bind(this),function(){this.targetAnim.node.rotation=e,t.scale=1,t.runAction(cc.flipY(!1)),t.y=0,t.x=0,this.targetBack.active=!0,this.knifeGroup.active=!0,this.ballLaba&&(this.ballLaba.removeFromParent(),this.ballLaba=null)}.bind(this),200,460)},onShare:function(){if(FBInstant){l.logEvent("specialboss_shareclick_"+this.curTargetData.avator);var e="";"boss_s4"==this.curTargetData.avator?e="Decisive world cup ! \u26bd\ufe0f\u26bd\ufe0f\u26bd\ufe0f":"boss_s1"==this.curTargetData.avator?e="I caught a ninja turtle,do you want it? ":"boss_s2"==this.curTargetData.avator?e="Who inserted the knife? is it you? \ud83d\udc96\ud83d\udc96\ud83d\udc96\ud83d\udc96 ":"boss_s10"==this.curTargetData.avator&&(e="My new record, coming soon! \ud83e\udd23\ud83e\udd23\ud83e\udd23"),l.logEvent("boss_share",{boss:this.curTargetData.avator}),FBInstant.shareAsync({intent:"SHARE",image:this.shareBase64Img,text:e,data:{myReplayData:"data",from:"boss",boss:this.curTargetData.avator}}).then(function(){l.logEvent("specialboss_share_send_"+this.curTargetData.avator),this.showBossDefeated()}.bind(this)).catch(this.showBossDefeated.bind(this))}else this.showBossDefeated();this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onShareClose:function(){this.showBossDefeated(),this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},showRankFriend:function(e){var t=this;this.curFriendData=e,this.rankPlayerScore.string="passed",e.photo&&cc.loader.load(e.photo,function(e,n){if(!e){t.playerdes.spriteFrame=new cc.SpriteFrame(n),t.playerdes.node.width=t.playerdes.node.height=75,t.playerdes.node.active=!0;var i=t.playerdes.node.parent;i.x=500,i.opacity=255,i.stopAllActions(),t.rankPlayerScore.node.active=!0,t.rankPlayerScore.node.opacity=255;var o=t.rankPlayerScore.node,a=o.getChildByName("daoL"),s=o.getChildByName("daoR");a.active=!1,s.active=!1,o.x=500,o.opacity=255,o.stopAllActions()}})},showFriendDefend:function(){var e=this.playerdes.node.parent;e.stopAllActions(),e.runAction(cc.moveTo(.3,230,e.y));var t=this.rankPlayerScore.node;t.stopAllActions(),t.runAction(cc.moveTo(.3,230,t.y)),setTimeout(function(){e.runAction(cc.fadeOut(.3)),t.runAction(cc.fadeOut(.3))},2e3)},checkAndShowFriend:function(){var e=this,t=this.iconPlayerS.node;if(this.tipsData&&this.tipsData.length>0&&this.tipsData[0].lv==this.curStage){var n=this.tipsData.shift();this.iconTipLabel.string=n.text;var i=this.iconTipLabel.node,o=this.iconPlayerS.node.parent;i.x=500,o.x=500,cc.loader.load(n.photo,function(n,a){n?console.log(n):(e.iconPlayerS.spriteFrame=new cc.SpriteFrame(a),e.iconPlayerS.node.width=e.iconPlayerS.node.height=75,t.active=!0,i.active=!0,o.opacity=255,i.opacity=255,o.stopAllActions(),o.runAction(cc.moveTo(.3,230,o.y)),i.stopAllActions(),i.runAction(cc.moveTo(.3,230,i.y)),setTimeout(function(){o.runAction(cc.fadeOut(.3)),i.runAction(cc.fadeOut(.3))},3e3))})}},showVSDefend:function(){var e=this.vsTop.getChildByName("right"),t=e.getChildByName("daoL").getComponent(cc.Sprite),n=e.getChildByName("daoR").getComponent(cc.Sprite);t.node.active=!0,n.node.active=!0,t.fillStart=1,n.fillStart=1;var i=0,o=setInterval(function(){++i<=10?t.fillStart=(10-i)/10:n.fillStart=(20-i)/10,20==i&&clearInterval(o)},30)},startGame:function(){this.setupInput(),this.gotoStage(this.curStage),this.showKnifeIn(),n.get().getMaxStage()>=this.gotoUnlockLevel&&this.showGotoBtn()},onEnable:function(){this.isVS?(this.startGame(),this.myCountLabel.node.active=!0,this.opponentCountLabel.node.active=!0):this.startGame()},setPlay:function(e){this.isWithFriend=e},preloadAsync:function(e){var t=this;if(this.isVS=e.isVS,this.opponentScore=e.score,this.battleId=e.battleId,this.rewardCount=e.rewardCount,this.setPlayerGroupVisible(!1),this.init(),this.singleTop.active=!0,this.vsTop.active=!1,this.myCountLabel.string=0,this.opponentCountLabel.string=this.opponentScore||"?",this.isVS){var i=this.vsTop.getChildByName("right"),o=i.getChildByName("daoL").getComponent(cc.Sprite),a=i.getChildByName("daoR").getComponent(cc.Sprite);o.node.active=!1,a.node.active=!1}return this.playerdes.node.active=!1,this.rankPlayerScore.node.active=!1,o=this.rankPlayerScore.node.getChildByName("daoL"),a=this.rankPlayerScore.node.getChildByName("daoR"),o.active=!1,a.active=!1,this.requestRankFriends(),new Promise(function(e){var i=0,o=function(){3==++i&&t.scheduleOnce(e)};window.FBInstant?(!t.myPhotoTexure&&FBInstant&&FBInstant.player.getPhoto()?cc.loader.load(FBInstant.player.getPhoto(),function(e,n){o(),e||(t.myPhotoTexure=n,t.mySprite.spriteFrame=new cc.SpriteFrame(n))}):(o(),t.mySprite.spriteFrame=new cc.SpriteFrame(t.myPhotoTexure)),t.opponentSprite.spriteFrame=t.defaltHeadFrame):cc.loader.loadRes("test",function(e,n){o(),e||(t.myPhotoTexure=n,t.mySprite.spriteFrame=new cc.SpriteFrame(n))});var a=n.get().getCurKnife();if(t.curKnifeId==a)o();else{var c=s.getData(a);c&&c.img&&cc.loader.loadRes("knife/"+c.img,function(e,n){o(),e?console.log("error",e):(t.curKnifeId=a,t.knifeTemplate.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),t.setupKnifesPool())})}t.otherPlayer=null,t.playWithMsg=null,t.playerCount=0,FBInstant?FBInstant.context.getPlayersAsync().then(function(e){for(var i in t.playerCount=e.length,t.playerCount>2&&n.get().addGroupId(FBInstant.context.getID()),e)if(e[i].getID()!=FBInstant.player.getID()){t.otherPlayer=e[i],t.isWithFriend&&(t.isGotoShow?t.playWithMsg="Playing with "+e[i].getName():r.showPK("Playing with "+e[i].getName()),t.isWithFriend=!1);break}t.otherPlayer?cc.loader.load(t.otherPlayer.getPhoto(),function(e,n){o(),e||(t.opponentSprite.spriteFrame=new cc.SpriteFrame(n))}):o()}).catch(o):o()})},prepareTipsData:function(e){this.tipsData=[];for(var t=e.slice(),n=t.length,i=["Cool!","Great!","Nice!","Good!"],o=0;o<n/2;o++){var a=t.splice(h.randomInt(t.length),1)[0];this.tipsData.push({lv:5*o+h.randomInt(3)+2,text:i[h.randomInt(i.length)],photo:a.photo}),t.length>0&&(a=t.splice(h.randomInt(t.length),1)[0],this.tipsData.push({lv:5*(o+1),text:i[h.randomInt(i.length)],photo:a.photo}))}},requestRankFriends:function(){var e=this;if(this.friendsData&&this.friendsData.length>0)this.prepareTipsData(this.resultFriendsData);else{this.friendsData=[],this.resultFriendsData=[];var t=[];n.get().getRankDataList(n.get().getFriendRankName(),100,0,function(i){for(var o=i.length-1;o>=0;o--)i[o].playerId!=(FBInstant&&FBInstant.player.getID())&&e.resultFriendsData.push(i[o]),t.push(i[o].playerId);e.friendsData=i,n.get().getConnectedPlayersAsync(function(n){for(var i=n.length-1;i>=0;i--)t.indexOf(n[i].getID())<0&&(e.resultFriendsData.unshift({playerId:n[i].getID(),nickName:n[i].getName(),photo:n[i].getPhoto()}),t.push(n[i].getID()));e.prepareTipsData(e.resultFriendsData)})},!0)}},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++)(t=new cc.Node).isDefaultKnife=!0,this.defaultKnifePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.defaultKnifeIcon;for(e=0;e<30;e++)(t=new cc.Node).scale=.53,t.width=136,t.height=162,this.applePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.appleIcon;for(e=0;e<10;e++){var t;(t=new cc.Node).scale=.6,t.width=72,t.height=86,this.goldApplePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.goldAppleIcon}},setupKnifesPool:function(){this.knifePool||(this.knifePool=new cc.NodePool),this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){0==this.leftAmount&&(this.isStageBegin=!1,l.logEvent("level_finish",{curStage:this.curStage}),this.curStage==i.getLeveCount()&&l.logEvent("max_level_finish",{continueCount:this.continueCount}),this.isBossStage()?(5==this.curStage&&(this.level5BossIndex+=1),this.showBossDefeated()):this.showStagePass(!0))},isBossStage:function(){return this.curStage%5==0},showBossDefeated:function(){if(this.setPlayerGroupVisible(!1),n.get().markBossDefented(this.curTargetData.index),d.onBeatBoss(this.curTargetData.index),n.get().isKnifeUnlock(this.curTargetData.drop))this.showStagePass(!0);else{var e=5==this.curStage&&1==n.get().getBossDefentedCount()||!l.isVideoLoad()&&n.get().getDiamonCount()<50;e&&n.get().unlockKnife(this.curTargetData.drop,0,!0);var t=r.getPage(r.SHOWKNIFE).getComponent("ShowKnifeDialog");t.setKnifeInfo(this.curTargetData,this.preKnifeTexture,e),this.preKnifeTexture=null;var i=this;i.showStagePass(!1,function(){window.platfromMgr.recorderPause(),r.showDialog(r.SHOWKNIFE)}),t.registerOnClose(function(e,t){window.platfromMgr.recorderResume(),e&&i.setKnifeTempLate(t),i.gotoNextStage()})}},showStagePass:function(e,t){var i=this;this.targetAnim.node.stopAllActions(),this.targetAction=null,this.targetSprite.node.scale=0,this.removeKnifes(),this.removeApples(),this.removeSpecial();var o=this;if(this.isBossStage()){var a=cc.instantiate(this.parBrokenNode);this.node.getChildByName("effectGroup").addChild(a);var s=a.getComponent(cc.ParticleSystem);s.resetSystem(),this.curTargetData.color&&(s.startColor=s.startColor.fromHEX(this.curTargetData.color),s.endColor=s.endColor.fromHEX(this.curTargetData.color)),o=this,setTimeout(function(){var a=n.get(),s=a.getPlayer_exp()/a.getMaxExp(),r=a.addExp(o.isDoubleXp?2*o.curTargetData.exp:o.curTargetData.exp),l=a.getPlayer_exp()/a.getMaxExp(),h=!1;!n.get().isMaxLevel()&&l<s&&(l=1,h=!0),i.bossFightSp.node.active=!0,i.bossBarSp.fillRange=s,i.playerLvLabel.string="Lv: "+a.getPlayer_lv();var d=i.bossFightSp.setAnimation(0,i.curTargetData.bossLv>0?"xiyoujieshu":"putongjieshu",!1);i.bossFightSp.setTrackEventListener(d,function(e,t){"kaishi"==t.data.name&&(i.bossBarSp.node.active=!0,i.upgradeNode.active=!1,i.scheduleOnce(function(){i.bossBarSp.schedule(function(){if(i.bossBarSp.fillRange<l)i.bossBarSp.fillRange+=.02;else if(i.bossBarSp.unscheduleAllCallbacks(),h){d.timeScale=0;var e=i.upgradeNode,t=n.get().getChanceTyType(r)+["% \u4e8c\u6b21\u673a\u4f1a","% \u989d\u5916\u7684\u7ee7\u7eed","% \u989d\u5916\u7684\u82f9\u679c","% \u91d1\u82f9\u679c","% \u770b\u5e7f\u544a\u83b7\u53d6\u7684\u82f9\u679c","% \u53cc\u500d\u7ecf\u9a8c"][r-1];e.getChildByName("info").getComponent(cc.Label).string=t,e.getChildByName("icon").getComponent("PowerIcon").setIcon(r),e.active=!0,e.scale=.8,e.runAction(cc.scaleTo(.3,1)),e.getChildByName("OK").once("click",function(){e.active=!1,d.timeScale=1})}},0)},.1))}),i.bossFightSp.setTrackCompleteListener(d,function(){i.bossFightSp.node.active=!1,i.bossBarSp.node.active=!1,e?o.gotoNextStage():t&&t()}),c.play(c.BOSS_DEFENTED)},500)}else{for(var r=cc.instantiate(o.targetBrokenAnim),l=1;l<=3;l++)r.getChildByName("kuai"+l).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.targetSprite.spriteFrame.getTexture());o.node.getChildByName("upEffectGroup").addChild(r);var h=r.getComponent(cc.Animation);h.play("broken"),h.on("finished",function(){h.off("finished"),r.removeFromParent(),e?o.gotoNextStage():t&&t()})}},removeKnifes:function(e){var t=this.targetBack.children,n=this,i=.3;function o(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?n.defaultKnifePool.put(e):n.knifePool.put(e),e.opacity=255}function a(e){var t=2*Math.random()+3,n=cc.moveBy(i,-e.x*t,-e.y*t),a=cc.rotateBy(i,380*Math.random()-180),s=cc.sequence(cc.delayTime(i-.05),cc.fadeOut(.05));e.runAction(cc.sequence(cc.spawn(n,a,s),cc.callFunc(o.bind(null,e))))}for(var s=t.length-1;s>=0;s--){var c=t[s];e?o(c):a(c)}},removeApples:function(){var e=this.targetUp.children,t=this;function n(e){e.isGold?t.goldApplePool.put(e):t.applePool.put(e)}for(var i=e.length-1;i>=0;i--)n(e[i])},removeSpecial:function(){this.specialBack.removeAllChildren(),this.specailUp.removeAllChildren(),this.node.getChildByName("upEffectGroup").removeAllChildren()},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){n.get().addOneDiamon(e),this.diamonCountLabel.string=n.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),c.play(c.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoNextStage:function(){for(this.curStage++,this.gotoStage(this.curStage),this.playerdes.node.active=!1;this.friendsData&&this.friendIndex<this.friendsData.length&&!(this.friendsData[this.friendIndex].score>this.curKnifeAmount+this.leftAmount);this.friendIndex++)if(this.friendsData[this.friendIndex].score>this.curKnifeAmount){this.showRankFriend(this.friendsData[this.friendIndex]),this.friendIndex++;break}},preLoadBoss:function(e){var t=i.getData(e),a=t.targetInfo,r=t.rareInfo,l=null;if(!l){for(var h=0;h<a.length;h++)if(!n.get().isBossDefented(a[h].target)){l=a[h];break}if(r&&!l)for(var d=0;d<r.length;d++)if(!n.get().isBossDefented(r[d].target)){l=r[d];break}}5==e&&(this.level5BossIndex>=a.length&&(this.level5BossIndex=0),l?this.level5BossIndex=0:l=a[this.level5BossIndex]);var u=null;if(l)u=l;else{var p=n.get().getMaxStage()>=8?.8:.5,g=r&&r.length>0&&Math.random()>p?r:a;u=g[Math.floor(Math.random()*g.length)]}var f=t.test;null!=f&&(u=t.test<a.length?a[f]:r[f-a.length]),this.preBossData=u;var m=u.target||1,v=o.getData(m),y=this;if(v.avator&&cc.loader.loadRes("target/"+v.avator,function(e,t){y.preBossTexture=t}),v.hitTarget&&c.preLoad(c[v.hitTarget]),v.drop){var I=s.getData(v.drop);cc.loader.loadRes("knife/"+I.img,function(e,t){e?console.log("error",e):y.preKnifeTexture=t})}"boss_80000"==v.avator?cc.loader.loadRes("target/boss_80000_eye"):"boss_s10"==v.avator?cc.loader.loadRes("target/boss_s10_pan"):"boss_s2"==v.avator?cc.loader.loadRes("target/boss_s2_top"):"boss_s5"==v.avator?cc.loader.loadRes("target/boss_s5_flag"):"boss_s7"==v.avator?cc.loader.loadRes("target/boss_s7_mask_2"):"boss_40003"==v.avator&&cc.loader.loadRes("target/boss_40003_mask_2")},gotoStage:function(e){this.curStage=e,this.curStage%5==1?this.preLoadBoss(this.curStage+4):this.setPlayerGroupVisible(!1);var t=i.getData(this.curStage),s=t.targetInfo,r=t.rareInfo,l=n.get().getMaxStage()>=8?.9:.5,h=r&&Math.random()>l?r:s,d=h[Math.floor(Math.random()*h.length)],u=t.test;null!=u?d=t.test<s.length?s[u]:r[u-s.length]:this.isBossStage()&&(this.preBossData||this.preLoadBoss(this.curStage),d=this.preBossData);var p=d.target;p||(p=1);var g=o.getData(p),f=t.diamons?t.diamons:d.diamons,m=d.knifes,v=(d.animation,d.count);if(this.curActionsData=a.getData(d.animation),1==p){var y=Math.ceil(this.curStage/10);y>9&&(y=9),g={index:p,avator:"target_"+y},y+1<=9&&cc.loader.loadRes("target/target_"+(y+1),function(){})}this.resetKnifes(v);for(var I=0;I<m.length;I++)(_=this.defaultKnifePool.get()).rotation=m[I],this.addKnifeToTarget(_);for(I=0;f&&I<f.length;I++)if(Math.random()<.15+n.get().getChance_giftApple()||null!=u||this.isBossStage()){var _,A=100*Math.random()<n.get().getChance_goldApple();(_=A?this.goldApplePool.get():this.applePool.get()).rotation=f[I],_.isGold=A,this.addAppleToTarget(_)}if(this.sounds={hitTarget:c.HIT,hitBlock:c.KNIFE_HIT,hitApple:c.APPLE_HIT},this.curTargetData!=g){this.sounds.hitTarget=c[g.hitTarget]||this.sounds.hitTarget,this.curTargetData=g;var b=this;this.isBossStage()&&b.preBossTexture?(b.targetSprite.spriteFrame=new cc.SpriteFrame(b.preBossTexture),b.whiteMask.spriteFrame=new cc.SpriteFrame(b.preBossTexture),b.targetSprite.node.width=b.preBossTexture.width,b.targetSprite.node.height=b.preBossTexture.height,b.preBossTexture=null):cc.loader.loadRes("target/"+g.avator,function(e,t){b.targetSprite.spriteFrame=new cc.SpriteFrame(t),b.whiteMask.spriteFrame=new cc.SpriteFrame(t),b.targetSprite.node.width=t.width,b.targetSprite.node.height=t.height})}this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.targetSprite.node.parent.x=0,this.curStage%5==0?this.setupStageBoss():this.beginStageActions(),this.clearMobileCamera()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.updateUI(),this.showKnifeIn()},getActions:function(e){for(var t=[],n=3*Math.random()>2,i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s;return s=t.length>1?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e,t,n){this.knifeCountLabel.string=this.curKnifeAmount,this.myCountLabel.string=this.curKnifeAmount;var i=e.rotation,o=i*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-i,e.x=this.targetBack.x+160*Math.cos(o),e.y=this.targetBack.y+160*Math.sin(o),t&&(e.preFrame=e.getComponent(cc.Sprite).spriteFrame,e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this.knifeTextures[t])),n){var a=e.x,s=e.y;e.x=this.targetBack.x+500*Math.cos(o),e.y=this.targetBack.y+500*Math.sin(o),e.runAction(cc.moveTo(.05,a,s))}},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+198*Math.cos(n),e.y=this.targetUp.y+198*Math.sin(n)},setupStageBoss:function(){var e=this,t=this;this.bossFightSp.node.active=!0;var i=this.bossFightSp.setAnimation(0,this.curTargetData.bossLv>0?"xiyoujinchang4":"putongjinchang4",!1);this.bossFightSp.setTrackEventListener(i,function(e,t){"dao"==t.data.name&&c.play(c.BOSS_FIGHT)}),this.bossFightSp.setTrackCompleteListener(i,function(){e.bossFightSp.node.active=!1,t.isDoubleXp=100*Math.random()<n.get().getChance_doubleXp(),t.isDoubleXp?t.showBonus(function(){t.beginStageActions()},6):t.beginStageActions()});var o=this.targetSprite.node.parent.getChildByName("playerGroup");if(o.x=0,o.y=0,this.curTargetData.hasPlayerImg&&this.addPlayerPhoto(this.curTargetData.isBack),"boss_s1"==this.curTargetData.avator){var a=new cc.Node,s=a.addComponent(cc.Sprite);cc.loader.loadRes("target/boss_s1_head",function(e,t){e||(s.spriteFrame=new cc.SpriteFrame(t))}),this.specialBack.addChild(a);var r=90*Math.PI/180;a.x=this.specialBack.x+80*Math.cos(r),a.y=this.specialBack.y+80*Math.sin(r),a.tx=a.x,a.ty=a.y,a.runAction(cc.moveBy(2,0,90))}if("boss_s4"==this.curTargetData.avator){var l=new cc.Node,h=l.addComponent(cc.Sprite);cc.loader.loadRes("target/boss_s4_laba",function(e,t){e||(h.spriteFrame=new cc.SpriteFrame(t))}),this.specailUp.addChild(l),l.y=-90,l.x=10,l.scale=0,this.ballLaba=l;var d=new cc.Node;l.addChild(d);var u=d.addComponent(cc.Label);u.node.y=-20,u.node.x=-10,u.string=this.otherPlayerName||FBInstant?FBInstant.player.getName():"test"}if("boss_80000"==this.curTargetData.avator){var p=new cc.Node,g=p.addComponent(cc.Sprite);cc.loader.loadRes("target/boss_80000_eye",function(e,t){e||(g.spriteFrame=new cc.SpriteFrame(t))}),this.specailUp.addChild(p),p.x=-78,p.y=39,p.scale=.5;var f=new cc.Node,m=f.addComponent(cc.Sprite);cc.loader.loadRes("target/boss_80000_eye",function(e,t){e||(m.spriteFrame=new cc.SpriteFrame(t))}),this.specailUp.addChild(f),f.x=70,f.y=37,f.scaleX=-.5,f.scaleY=.5}if("boss_s10"==this.curTargetData.avator){var v=new cc.Node;g=v.addComponent(cc.Sprite),cc.loader.loadRes("target/boss_s10_pan",function(e,t){e||(g.spriteFrame=new cc.SpriteFrame(t))}),this.specailUp.addChild(v);var y=new cc.Node;v.addChild(y),y.addComponent(cc.Mask),y.width=y.height=90;var I=new cc.Node,_=I.addComponent(cc.Label);_.fontSize=20,_.lineHeight=22,_.overflow=cc.Label.Overflow.RESIZE_HEIGHT,I.width=90,y.addChild(I)}if("boss_s2"==this.curTargetData.avator&&null!=window.platfromMgr.getAvatarUrl()){var A=new cc.Node;g=A.addComponent(cc.Sprite),cc.loader.loadRes("target/boss_s2_top",function(e,t){e||(g.spriteFrame=new cc.SpriteFrame(t))}),this.specailUp.addChild(A)}if("boss_s5"==this.curTargetData.avator){var b=new cc.Node;b.anchorX=.5,b.anchorY=.8803398,b.scale=0;var k=b.addComponent(cc.Sprite);cc.loader.loadRes("target/boss_s5_flag",function(e,t){e||(k.spriteFrame=new cc.SpriteFrame(t))}),this.node.getChildByName("upEffectGroup").addChild(b),onLevelStart=function(){b.runAction(cc.scaleTo(.3,1))}}if("boss_s7"==this.curTargetData.avator)for(var C=function(t){var n=new cc.Node;n.width=39,n.height=27;var i=n.addComponent(cc.Mask);i.type=cc.Mask.Type.IMAGE_STENCIL,i.alphaThreshold=.5,cc.loader.loadRes("target/boss_s7_mask_2",function(e,t){e||(i.spriteFrame=new cc.SpriteFrame(t),o.width=o.height=39)});var o=new cc.Node;n.addChild(o),o.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e.myPhotoTexure),o.width=o.height=39,n.y=-83;var a=new cc.Node;a.addChild(n),a.rotation=30*t,e.specailUp.addChild(a)},T=0;T<12;T++)C(T);if("boss_40003"==this.curTargetData.avator){var S=new cc.Node;S.addComponent(cc.Mask).type=cc.Mask.Type.ELLIPSE;var w=new cc.Node;S.addChild(w);var P=w.addComponent(cc.Sprite);P.spriteFrame=new cc.SpriteFrame(this.myPhotoTexure),this.scheduleOnce(function(){w.width=w.height=35}),this.otherPlayer&&this.otherPlayer.getPhoto()?cc.loader.load(this.otherPlayer.getPhoto(),function(e,t){e||(P.spriteFrame=new cc.SpriteFrame(t),S.width=S.height=35)}):n.get().getConnectedPlayersAsync(function(e){e.length>0&&cc.loader.load(e[0].getPhoto(),function(e,t){e||(P.spriteFrame=new cc.SpriteFrame(t),S.width=S.height=35)})}),S.y=81,S.x=-3,S.width=S.height=35,this.specailUp.addChild(S)}"boss_s12"==this.curTargetData.avator&&(o.x=0,o.y=70)},showResult:function(e){var t=this;window.platfromMgr.recorderStop(),window.platfromMgr.isCanRecorderShare()?r.getPageAsync("VideoShareDialog").then(function(n){var i=n.getComponent("VideoShareDialog");i.onCloseCb=function(){t.showResult_internal(e)},r.showDialog("VideoShareDialog"),i.screenShot(t.node.getChildByName("camera").getComponent(cc.Camera))}).catch(function(){}):this.showResult_internal(e)},showResult_internal:function(e){r.getPage(r.RESULT).getComponent("ResultDialog").updateData({knifeCount:this.curKnifeAmount,stageNum:this.curStage,diamonCount:n.get().getDiamonCount(),playerTexture:this.myPhotoTexure,knifeSpriteFrame:this.knifeTemplate.getComponent(cc.Sprite).spriteFrame,otherPlayerId:this.otherPlayer?this.otherPlayer.getID():"",otherPlayerPhoto:this.otherPlayer?this.otherPlayer.getPhoto():"",otherPlayerName:this.otherPlayer?this.otherPlayer.getName():"",friendsData:this.resultFriendsData,playerCount:this.playerCount,opponentScore:this.opponentScore,battleId:this.battleId,rewardCount:this.rewardCount,isVS:this.isVS,isSkip:e}),r.showPage(r.RESULT),this.clearMobileCamera()},updateUI:function(){this.diamonCountLabel.string=n.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5));var e=this.curStage%5;if(0==e)this.stageLabel.string=this.curTargetData.name,this.stageLabel.node.x=0,this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#ed524b"),this.pointsNode.active=!1,this.pkIcon.runAction(cc.moveTo(.5,0,this.pkIcon.y)),this.pkIcon.color=this.stageLabel.node.color;else{this.stageLabel.node.color=cc.Color.WHITE,this.pkIcon.color=cc.Color.WHITE;var t=this;this.pkIcon.runAction(cc.sequence(cc.moveTo(.5,70,this.pkIcon.y),cc.callFunc(function(){t.pointsNode.active=!0}))),this.pkIcon.x=70,this.stageLabel.node.x=0,this.stageLabel.string="\u5173\u5361 "+this.curStage}this.pointsNode.getComponent("PointControl").setCount(e)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++)if((u=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(u*Math.PI/180),o=-Math.abs(Math.cos(u*Math.PI/180));p&&(i=-i);var a=Math.max(.1,u/30),s=cc.rotateBy(a,-Math.ceil(Math.abs(i))*u*20),r=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*r*10,o*=r;var l=cc.moveBy(a,i,o),h=this,d=cc.spawn(l,s);this.curMoveKnife.runAction(cc.sequence(d,cc.callFunc(function(){h.knifePool.put(h.curMoveKnife),h.curMoveKnife=null,setTimeout(function(){h.onGameOver()},200)}))),this.playDieEffect(u,p),c.play(this.sounds.hitBlock);break}for(e=this.targetUp.children,t=15,n=0;n<e.length;n++){var u,p;if((u=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){var g=e[n].isGold;this.addOneDiamon(g),g?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var f=g?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);f.x=30*Math.random()-15,f.y=-131,this.node.getChildByName("upEffectGroup").addChild(f),c.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var e=this,t=1==this.continueCount&&100*Math.random()<n.get().getChance_extra(),i=this.freeBonusCount<1&&100*Math.random()<n.get().getChance_second(),o=s.getData(n.get().getCurKnife()).rate||0,a=this.freeBonusCount<1&&100*Math.random()<o;if(this.freeBonusCount++,a){var c=this;this.showBonus(function(){c.continueGame(!0)},7)}else i?(c=this,this.showBonus(function(){c.continueGame(!0)},1)):(t||0==this.continueCount&&(this.curStage>=5||this.isPkMod))&&l.isVideoLoad()||0==this.continueCount&&!this.isPkMod&&this.curStage>=5?(window.platfromMgr.recorderPause(),this.continueCount++,r.getPage(r.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.curTargetData.name,continueCount:this.continueCount,isBoss:this.isBossStage(),onContinue:function(t){window.platfromMgr.recorderResume(),t&&e.showCostTip(t),e.continueGame()},onNoContinue:function(){window.platfromMgr.recorderResume(),e.showResult(!0)},from:"gamemain"}),r.showDialog(r.CONTINUE),this.isPkMod&&l.logEvent("pk_continue_show")):(this.setPlayerGroupVisible(!1),l.logEvent("game_end",{curStage:this.curStage,leftAmount:this.leftAmount,targetId:this.curTargetData?this.curTargetData.index:1}),this.showResult());(t||0==this.continueCount&&this.curStage>5)&&!l.isVideoLoad()&&cc.sys.isMobile&&(l.logEvent("continue_noads"),l.isInterstitialLoad()&&l.logEvent("continue_interstitial_ok"))},continueGame:function(e){this.diamonCountLabel.string=n.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn(),!e&&this.isPkMod&&l.logEvent("pk_continue_click")},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0!=this.leftAmount||this.isPkMod)c.play(this.sounds.hitTarget);else{var e=this.isBossStage()?c.HIT_LAST_SPECIAL:c.HIT_LAST;c.play(e)}this.isPkMod&&this.roundKnifeData.push(this.curMoveKnife.rotation),this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife),this.curFriendData&&this.curKnifeAmount==this.curFriendData.score&&this.showFriendDefend(),this.isVS&&this.opponentScore>0&&this.curKnifeAmount==this.opponentScore+1&&this.showVSDefend();var t=cc.instantiate(this.parNode);if(t.y=-131,this.node.getChildByName("effectGroup").addChild(t),t.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd(),this.curTargetData&&"boss_s1"==this.curTargetData.avator&&this.specialBack.children[0]){var n=this.specialBack.children[0];n.stopAllActions(),n.runAction(cc.sequence(cc.moveTo(.1,n.tx,n.ty),cc.moveTo(1,n.tx,n.ty+90)))}if(this.curTargetData&&"boss_80000"==this.curTargetData.avator&&this.specailUp.children[0]&&this.specailUp.children[1]){var i=this.specailUp.children[0],o=this.specailUp.children[1];i.scale=1,i.stopAllActions(),i.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,.5))),o.scaleX=-1,o.scaleY=1,o.stopAllActions(),o.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,-.5,.5)))}}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",KnifeData:"KnifeData",LevelData:"LevelData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",TargetData:"TargetData",TaskMgr:"TaskMgr",User:"User",Utils:"Utils",enginefix:"enginefix"}],GameSpin:[function(e,t){"use strict";cc._RF.push(t,"cf323YU88RGA4gI/m6qE7Oz","GameSpin");var n=e("User"),i=e("AnimationData"),o=e("KnifeData"),a=e("SoundMgr"),s=e("PageMgr"),c=e("AdHelper"),r=e("Utils");e("enginefix"),cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,stageLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,bossDefentedAnim:cc.Prefab,bonusAnim:cc.Prefab,appleCount:cc.Label,uiGroup:cc.Node,cameraBtn:cc.Node,screenNode:cc.Node,yoff:0,stopY:0,speed:0},init:function(){this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.rewardAppleCount=0,this.appleCount.string=this.rewardAppleCount,this.bossName="\u8f6c\u76d8",this.levelData={count:25,knifes:[100,440,270,230,310],animation:1},window.platfromMgr.recorderStart()},preLoad:function(e){var t=this;if(this.curKnifeId!=n.get().getCurKnife()){this.curKnifeId=n.get().getCurKnife();var i=o.getData(this.curKnifeId);cc.loader.loadRes("knife/"+i.img,function(n,i){n?console.log("error",n):(t.knifeTemplate.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),t.knifeTemplate.scale=1,t.knifeTemplate.rotation=0,t.setupKnifesPool(),e())})}else e()},onCameraClick:function(){this.cameraBtn.active=!1,a.play(a.CAMERA),this.whiteMask.node.active=!1;var e=this.targetAnim.node.rotation;this.targetAnim.node.rotation=0;var t=cc.director.getRunningScene(),n=cc.winSize.height;"boss_s4"==this.curTargetData.avator&&this.ballLaba&&(this.ballLaba.scale=1,this.targetBack.active=!1),r.captureScreen(t,cc.winSize.width,n,function(e,t){this.shareBase64Img=e,this.screenNode.parent.active=!0;var n=(this.screenNode.width-50)/cc.winSize.width,i=this.screenNode.parent.getChildByName("share"),o=this.screenNode.parent.getChildByName("chahao");i.scale=0,o.scale=0,t.runAction(cc.sequence(cc.scaleTo(.3,n,n*t.scaleY),cc.targetedAction(i,cc.scaleTo(.2,1)),cc.targetedAction(o,cc.scaleTo(.2,1)))),this.screenNode._sgNode.addChild(t),this.screenNode.rtt=t,this.screenNode.height=50+(this.screenNode.width-50)*cc.winSize.height/cc.winSize.width}.bind(this),function(){this.targetAnim.node.rotation=e,t.scale=1,t.runAction(cc.flipY(!1)),t.y=0,t.x=0,this.targetBack.active=!0,this.ballLaba&&(this.ballLaba.removeFromParent(),this.ballLaba=null)}.bind(this),300)},onShare:function(){FBInstant?(c.logEvent("gameturntable_share"),FBInstant.shareAsync({intent:"SHARE",image:this.shareBase64Img,text:"Who inserted the knife? is it you? \ud83d\udc96\ud83d\udc96\ud83d\udc96\ud83d\udc96",data:{myReplayData:"data",from:"gamespin"}}).then(function(){c.logEvent("gameturntable_share_success"),this.showResult()}.bind(this)).catch(this.showResult.bind(this))):this.showResult(),this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onShareClose:function(){this.showResult(),this.screenNode._sgNode.removeChild(this.screenNode.rtt),this.screenNode.rtt=null,this.screenNode.parent.active=!1,this.shareBase64Img=null},onEnable:function(){this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),this.gotoStage(this.curStage),this.showKnifeIn(),c.logEvent("gameturntable_show"),s.hidePage(s.HOME)},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){0==this.leftAmount&&(this.isStageBegin=!1,c.logEvent("turntable_finish"),this.showResult())},isBossStage:function(){return this.curStage%5==0},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++){var t=new cc.Node;t.isDefaultKnife=!0,this.defaultKnifePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.defaultKnifeIcon}},removeKnifes:function(e){var t=this.targetBack.children,n=this,i=.3;function o(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?n.defaultKnifePool.put(e):n.knifePool.put(e),e.opacity=255}function a(e){var t=2*Math.random()+3,n=cc.moveBy(i,-e.x*t,-e.y*t),a=cc.rotateBy(i,380*Math.random()-180),s=cc.sequence(cc.delayTime(i-.05),cc.fadeOut(.05));e.runAction(cc.sequence(cc.spawn(n,a,s),cc.callFunc(o.bind(null,e))))}for(var s=t.length-1;s>=0;s--){var c=t[s];e?o(c):a(c)}},removeApples:function(){var e=this.targetUp.children,t=this;function n(e){e.isGold?t.goldApplePool.put(e):t.applePool.put(e)}for(var i=e.length-1;i>=0;i--)n(e[i])},removeSpecial:function(){this.specialBack.removeAllChildren()},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){n.get().addOneDiamon(e),this.diamonCountLabel.string=n.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),a.play(a.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoStage:function(e){this.curStage=e;var t=this.levelData,n=(t.diamons,t.knifes),o=t.animation,s=t.count;this.curActionsData=i.getData(o),this.resetKnifes(s);for(var c=0;c<n.length;c++){var r=this.defaultKnifePool.get();r.rotation=n[c],this.addKnifeToTarget(r)}this.sounds={hitTarget:a.HIT,hitBlock:a.KNIFE_HIT,hitApple:a.APPLE_HIT},this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.beginStageActions()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.updateUI(),this.showKnifeIn()},getActions:function(){return Math.random()<.5?cc.repeatForever(cc.rotateBy(5,-360)):cc.repeatForever(cc.rotateBy(5,360))},addKnifeToTarget:function(e,t){this.knifeCountLabel.string=this.curKnifeAmount;var n=e.rotation,i=n*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-n,e.x=this.targetBack.x+160*Math.cos(i),e.y=this.targetBack.y+160*Math.sin(i),t){var o=n%360;o<0&&(o+=360),o>=80&&o<=100?this.rewardAppleCount*=4:o>=235&&o<=305?this.rewardAppleCount*=2:this.rewardAppleCount+=1,this.appleCount.string=this.rewardAppleCount,this.uiGroup.stopAllActions(),this.uiGroup.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1)))}},showResult:function(){var e=this;window.platfromMgr.recorderStop(),window.platfromMgr.isCanRecorderShare()?s.getPageAsync("VideoShareDialog").then(function(t){var n=t.getComponent("VideoShareDialog");n.onCloseCb=function(){e.showResult_internal()},s.showDialog("VideoShareDialog"),n.screenShot(e.node.getChildByName("camera").getComponent(cc.Camera))}).catch(function(){}):this.showResult_internal()},showResult_internal:function(){s.showPage(s.HOME),s.showDialogAsync("GiftCollectDialog",{count:this.rewardAppleCount},!0)},updateUI:function(){this.diamonCountLabel.string=n.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5)),this.stageLabel.string=this.bossName,this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#ed524b"),this.pointsNode.active=!1,this.pkIcon.runAction(cc.moveTo(.5,0,this.pkIcon.y)),this.pkIcon.color=this.stageLabel.node.color,this.pointsNode.getComponent("PointControl").setCount(4)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++)if((u=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(u*Math.PI/180),o=-Math.abs(Math.cos(u*Math.PI/180));p&&(i=-i);var s=Math.max(.1,u/30),c=cc.rotateBy(s,-Math.ceil(Math.abs(i))*u*20),r=Math.min(300/Math.abs(i),300/Math.abs(o));i=i*r*10,o*=r;var l=cc.moveBy(s,i,o),h=this,d=cc.spawn(l,c);this.curMoveKnife.runAction(cc.sequence(d,cc.callFunc(function(){h.knifePool.put(h.curMoveKnife),h.curMoveKnife=null,setTimeout(function(){h.onGameOver()},200)}))),this.playDieEffect(u,p),a.play(this.sounds.hitBlock);break}for(e=this.targetUp.children,t=15,n=0;n<e.length;n++){var u,p;if((u=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){var g=e[n].isGold;this.addOneDiamon(g),g?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var f=g?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);f.x=30*Math.random()-15,f.y=-131,this.node.getChildByName("upEffectGroup").addChild(f),a.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var e=this;0==this.continueCount&&c.isVideoLoad()?(this.continueCount++,window.platfromMgr.recorderPause(),s.getPage(s.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.bossName,isBoss:!0,continueCount:this.continueCount,onContinue:function(){window.platfromMgr.recorderResume(),e.continueGame()},onNoContinue:function(){window.platfromMgr.recorderResume(),e.showResult()},from:"gamespin"}),s.showDialog(s.CONTINUE,!0)):this.showResult()},continueGame:function(){this.diamonCountLabel.string=n.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn()},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0==this.leftAmount){var e=this.isBossStage()?a.HIT_LAST_SPECIAL:a.HIT_LAST;a.play(e)}else a.play(this.sounds.hitTarget);this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife,!0);var t=cc.instantiate(this.parNode);t.y=-131,this.node.getChildByName("effectGroup").addChild(t),t.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd()}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",KnifeData:"KnifeData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils",enginefix:"enginefix"}],GiftCollectDialog:[function(e,t){"use strict";cc._RF.push(t,"ca4efFHpY5Lh5OXJG6eQXYn","GiftCollectDialog");var n=e("AdHelper"),i=e("PageMgr"),o=e("User");cc.Class({extends:cc.Component,properties:{giftLabel:cc.Label,giftX2Label:cc.Label,videoBtn:cc.Button,guang:cc.Node},onLoad:function(){this.guang.runAction(cc.repeatForever(cc.rotateBy(1,10)))},onEnable:function(){this.isWaitingAd=!1;var e=this.node.getChildByName("content");e.scale=.8,e.runAction(cc.scaleTo(.1,cc.winSize.width/640)),n.logEvent("CollectPage_Show")},onDisable:function(){this.isWaitingAd=!1},setGiftCount:function(e){this.count=e,this.giftLabel.string="x"+e},onUpdateData:function(e){this.setGiftCount(e.count)},onCollect:function(){this.showGift(!1),this.onClose(),n.logEvent("Collect")},onCollectX2:function(){var e=this;n.logEvent("Collectx2"),n.isVideoLoad()?(this.onClose(),n.logEvent("CollectAd_show"),n.showVideoAd(this.showGift.bind(this,!0),function(){})):(i.showLoading("",!0),this.isWaitingAd=!0,this.timeoutHandler=setTimeout(function(){e.timeoutHandler=null,e.isWaitingAd=!1,i.hideLoading(),i.showTip("NO ADS AVAILBLE",null,-200),e.onClose(),setTimeout(function(){i.hideTip()},3e3),e.showGift()},6e3))},showGift:function(e){var t=e?2:1;o.get().collectGift(this.count*t),n.logEvent("turntable_apple_count",{isDouble:e?"ad":"normal",count:this.count*t},this.count*t),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(this.count,e),i.showDialog(i.GIFTPAGE)},onClose:function(){i.hideDialog("GiftCollectDialog"),i.hideDialog(i.GAMESPIN)},update:function(){var e=this;this.videoBtn.interactable=n.isSupporteVideo(),this.isWaitingAd&&n.isVideoLoad()&&(this.isWaitingAd=!1,this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=null),n.showVideoAd(this.showGift.bind(this,!0),function(){}),n.logEvent("CollectAd_show"),setTimeout(function(){i.hideLoading(),e.onClose()},2e3))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],GiftPage:[function(e,t){"use strict";cc._RF.push(t,"df2a4sMX8ZPt7yheTLliqJy","GiftPage");var n=e("PageMgr"),i=e("SoundMgr");cc.Class({extends:cc.Component,properties:{appleGroup:cc.Node,infoGroup:cc.Node,appleTemplate:cc.Node,sweetTemplate:cc.Node,appleAnim:cc.Prefab},setAppleCount:function(e,t,n,i,o){this.appleCount=e,this.isDouble=t,this.isThree=n,this.finishCb=i,this.isSweet=o,this.infoGroup.getChildByName("label").getComponent(cc.Label).string="+"+e},playEffect:function(e){e=e||function(){},i.play(i.APPLES_COINS),this.infoGroup.opacity=0,this.infoGroup.getChildByName("jinbi").active=!this.isSweet,this.infoGroup.getChildByName("sweeticon").active=this.isSweet,this.infoGroup.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.2))),this.node.opacity=0,this.node.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(2),cc.fadeOut(.2),cc.callFunc(e)));var t=this;function n(e,n){var i=cc.instantiate(t.appleAnim);i.x=e,i.y=n,t.appleGroup.addChild(i)}var o=this.isSweet?this.appleCount:this.appleCount/2,a=600;o>100&&(o=100),o>50&&(a=cc.winSize.height);for(var s=0;s<o;s++){var c=this.isSweet?this.sweetTemplate:this.appleTemplate,r=cc.instantiate(c);this.appleGroup.addChild(r),r.x=640*Math.random()-320,r.y=Math.random()*a-a/2,r.scale=2*Math.random(),r.opacity=255*Math.random(),this.isSweet?(r.rotation=360*Math.random(),r.runAction(cc.sequence(cc.spawn(cc.scaleTo(Math.random(),.8),cc.fadeIn(Math.random())),cc.moveBy(Math.random(),0,-cc.winSize.height),cc.removeSelf()))):r.runAction(cc.sequence(cc.spawn(cc.scaleTo(Math.random(),.8),cc.fadeIn(Math.random())),cc.removeSelf(),cc.callFunc(n.bind(null,r.x,r.y))))}},onEnable:function(){var e=this;this.playEffect(function(){e.isDouble||e.isThree?e.playEffect(function(){e.isThree?e.playEffect(function(){e.closePage()}):e.closePage()}):e.closePage()})},closePage:function(){n.hideDialog(n.GIFTPAGE),this.finishCb&&this.finishCb()}}),cc._RF.pop()},{PageMgr:"PageMgr",SoundMgr:"SoundMgr"}],HalloweenDialog:[function(e,t){"use strict";cc._RF.push(t,"afd7c0K9hxFlrz54LO3O8QO","HalloweenDialog");var n=e("AdHelper"),i=e("PageMgr"),o=e("User"),a=e("Utils");cc.Class({extends:cc.Component,properties:{timer:cc.Label,playBtn:cc.Button,dian:cc.Node,countLabel:cc.Label},onShare:function(){n.logEvent("halloween_share_click"),i.showLoading(),a.getImageAsync("HalloweenScreen",function(){}).then(function(e){FBInstant.shareAsync({intent:"SHARE",text:"Trick or Treat!",image:e,data:{from:"halloween_share"}}).then(function(){i.hideLoading(),n.logEvent("halloween_share_success")}).catch(function(){i.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),i.hideLoading()})},onUpdateData:function(e){this.data=e},onPlay:function(){var e=this;n.logEvent("halloween_play_click");var t=function(){i.hideLoading(),o.get().decHalloweenCount(),i.showPageAsync("GameHalloween",e.data)};FBInstant?(i.showLoading(),o.get().getConnectedPlayersAsync(function(i){var a=o.get().getRecommondId();if(a&&Math.random()>i.length/(i.length+2))n.logEvent("halloween_play_recommond_group"),FBInstant.context.switchAsync(a).then(function(){t(),n.logEvent("halloween_play_recommond_group_success")}).catch(function(){t()});else if(i.length>1&&Math.random()<i.length/(i.length+2)){n.logEvent("halloween_play_recommond_player");for(var s=i[Math.floor(Math.random()*i.length)];e.data.otherPlayerId==s.getID();)s=i[Math.floor(Math.random()*i.length)];FBInstant.context.createAsync(s.getID()).then(function(){t(),n.logEvent("halloween_play_recommond_player_success")}).catch(function(){t()})}else n.logEvent("halloween_play_choose_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){t(),n.logEvent("halloween_play_choose_success")},function(){t()})})):t()},onClose:function(){i.hideDialog("HalloweenDialog")},onEnable:function(){n.logEvent("halloween_show")},update:function(){this.dian.active=o.get().getHalloweenCount()>0,this.countLabel.string=o.get().getHalloweenCount(),o.get().getHalloweenCount()>0?(this.playBtn.interactable=!0,this.timer.string=""):(this.playBtn.interactable=!1,this.timer.string=o.get().getHalloweenTime())}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],HalloweenEndDialog:[function(e,t){"use strict";cc._RF.push(t,"da039I/wTRCRb/ZxVUGYDc5","HalloweenEndDialog");var n=e("AdHelper"),i=e("PageMgr"),o=e("User"),a=e("Utils");cc.Class({extends:cc.Component,properties:{},onShare:function(){n.logEvent("halloween_share_click",{from:"end"}),i.showLoading(),a.getImageAsync("HalloweenScreen",function(){}).then(function(e){FBInstant.shareAsync({intent:"SHARE",text:"Trick or Treat!",image:e,data:{from:"halloween_end_share"}}).then(function(){i.hideLoading(),n.logEvent("halloween_share_success",{from:"end"})}).catch(function(){i.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),i.hideLoading()})},onEnable:function(){n.logEvent("halloween_end_show")},onOK:function(){n.logEvent("halloween_endok_click"),o.get().decHalloweenCount(),i.showPage(i.HOME)},onClose:function(){i.showPage(i.HOME)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],HalloweenLevelData:[function(e,t){"use strict";cc._RF.push(t,"5782fLpLkVI67D/kx8hQNFq","HalloweenLevelData");var n=[{index:1,diamons:[],test:0,targetInfo:[{count:7,knifes:[],animation:1}]},{index:2,diamons:[0,180],test:0,targetInfo:[{count:9,knifes:[],animation:1}]},{index:3,diamons:[350,15,170,195],test:0,targetInfo:[{count:10,knifes:[90],animation:2}]},{index:4,diamons:[0,25,335,180,205,155],test:0,targetInfo:[{count:8,knifes:[90,230,310],animation:2}]},{index:5,isBoss:0,targetInfo:[{count:12,knifes:[],animation:4,diamons:[0,25,50,75,100,125,150,175],target:36}]},{index:6,diamons:[0,180],targetInfo:[{count:9,knifes:[30,330,150,210],animation:5}]},{index:7,diamons:[350,15,170,195],targetInfo:[{count:11,knifes:[90],animation:6}]},{index:8,diamons:[0,25,335,180,205,155],targetInfo:[{count:8,knifes:[90,270],animation:9}]},{index:9,diamons:[0,25,335,180,205,155],targetInfo:[{count:12,knifes:[50,130,230,310],animation:10}]},{index:10,isBoss:1,targetInfo:[{count:10,knifes:[90,230,310],animation:14,diamons:[],gold:[0,25,335,180,205,155],target:37}]},{index:11,diamons:[45,135,225,315],targetInfo:[{count:13,knifes:[0,90,180],animation:15}]},{index:12,diamons:[20,45,135,160,225,315],targetInfo:[{count:13,knifes:[0,90,180],animation:15}]},{index:13,diamons:[0,25,335,180,205,155],targetInfo:[{count:10,knifes:[50,90,130,270,230,310],animation:17}]},{index:14,diamons:[45,135,225,315],targetInfo:[{count:10,knifes:[0,90,180,270],animation:17}]},{index:15,isBoss:1,targetInfo:[{count:9,knifes:[],animation:31,gold:[195,220,245,270,295,320,345],target:38}]},{index:16,diamons:[0,180],targetInfo:[{count:11,knifes:[30],animation:21}]},{index:17,diamons:[20,45,135,160,225,315],targetInfo:[{count:12,knifes:[0,90,180],animation:23}]},{index:18,diamons:[0,25,335,180,205,155],targetInfo:[{count:12,knifes:[50,90,130,270,230,310],animation:25}]},{index:19,diamons:[45,135,225,315],targetInfo:[{count:12,knifes:[0,90,180,270],animation:27}]},{index:20,isBoss:1,targetInfo:[{count:16,knifes:[355,5,85,95,175,185,265,275],animation:29,gold:[200,225,250,290,315,340],diamons:[40,140],target:39}]}],i=function(e){return(e-=1)>=n.length&&(e=n.length-10+(e-n.length)%n.length%10),n[e]};t.exports={getData:i,getLength:function(e){var t=i(e);return t.targetInfo.length+(t.rareInfo?t.rareInfo.length:0)}},cc._RF.pop()},{}],HalloweenPayDialog:[function(e,t){"use strict";cc._RF.push(t,"7ea94Gfx5pB0avqn5rcwt1E","HalloweenPayDialog");var n=e("User"),i=e("PageMgr"),o=e("AdHelper");cc.Class({extends:cc.Component,properties:{},onEnable:function(){o.logEvent("pay_sale_show")},onPayClicked:function(){var e="apple_car_half";o.logEvent("pay_sale_click",{itemId:e}),n.get().purchase(e,function(){n.get().addDiamon(25e3),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(25e3),i.showDialog(i.GIFTPAGE,!0),o.logEvent("pay_sale_success",{itemId:e})},function(){})},onCloseClicked:function(){i.hideDialog("HalloweenPayDialog"),n.get().isGiftAvailable()&&i.showDialog(i.SPINDIALOG)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],HalloweenRankItem:[function(e,t){"use strict";cc._RF.push(t,"151ceSJZnVDJqEwDBvs1PPO","HalloweenRankItem");var n=e("AdHelper"),i=e("PageMgr"),o=e("User");cc.Class({extends:cc.Component,properties:{num1:cc.Node,num2:cc.Node,num3:cc.Node,playerRank:cc.Label,diban:cc.Node,playerSprite:cc.Sprite,playerName:cc.Label,playerScore:cc.Label,defaultPeople:cc.SpriteFrame,friendBtn:cc.Node},updateItem:function(e,t){this.colors=this.colors||["#ffd366","#7b9bb6","#c5753a"],this.itemId=e,this.data=t,this.reset(),this.friendBtn.active=t.isFriend&&t.playerId!=(FBInstant&&FBInstant.player.getID()),this.num1.active=1==t.rank,this.num2.active=2==t.rank,this.num3.active=3==t.rank,this.playerRank.node.active=t.rank>3,this.playerRank.string=t.rank,FBInstant&&t.playerId!=FBInstant.player.getID()?(this.diban.opacity=178.5,this.diban.color=cc.hexToColor("#000000")):(this.diban.opacity=204,this.diban.color=cc.hexToColor("#3be0cb")),t.rank<=3?this.playerScore.node.color=cc.hexToColor(this.colors[t.rank-1]):this.playerScore.node.color=cc.hexToColor("#ffffff");var n=this;t.photo&&cc.loader.load(t.photo,function(e,i){e||n.data!=t||(n.playerSprite.spriteFrame=new cc.SpriteFrame(i),n.playerSprite.node.width=n.playerSprite.node.height=70)}),this.playerName.string=t.nickName,this.playerScore.string=t.score},reset:function(){this.playerSprite.spriteFrame=this.defaultPeople,this.playerSprite.node.width=this.playerSprite.node.height=70},onPlay:function(){if(n.logEvent("halloween_rank_play"),o.get().getHalloweenCount()<=0)return i.showTip("AVAILABLE IN "+o.get().getHalloweenTime()),void setTimeout(function(){i.hideTip()},1e3);FBInstant&&(i.showLoading(),FBInstant.context.createAsync(this.data.playerId).then(function(){n.logEvent("halloween_rank_play_success"),o.get().decHalloweenCount(),i.showPageAsync("GameHalloween"),i.hideLoading()}))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],HalloweenResultDialog:[function(e,t){"use strict";cc._RF.push(t,"0e9a5U8gHlI7r4QgzVCby3e","HalloweenResultDialog");var n=e("AdHelper"),i=e("PageMgr"),o=e("User"),a=e("Utils"),s=e("SoundMgr"),c=e("ListView");cc.Class({extends:cc.Component,properties:{diamonLabel:cc.Label,scoreLabel:cc.Label,list:c,playBtn:cc.Button,timer:cc.Label,dian:cc.Node,countLabel:cc.Label,shareNode:cc.Node,playScore:cc.Label,playPhoto:cc.Sprite},start:function(){},sendMessageToFb:function(){var e=this,t=this.data,n=(FBInstant.getEntryPointData(),function(){i.showTip("Score sent!",null,-cc.winSize.height/2+30,!0),setTimeout(function(){i.hideTip()},1e3)});t.playerCount>2?o.get().updateGroupRank(t.score,n):setTimeout(function(){e.shareNode.active=!0,a.captureScreen(e.shareNode,960,500,function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"CHALLENGE",template:"play_turn",text:FBInstant.player.getName()+" has challenged you to a match of Last Knife !",image:e,data:{playerId:FBInstant.player.getID(),otherPlayerName:FBInstant.player.getName(),stageNum:t.stageNum,knifeCount:t.score,otherPlayerPhoto:FBInstant.player.getPhoto(),from:"challenge"},strategy:"IMMEDIATE",notification:"PUSH"}).then(n,n)}.bind(e)),e.shareNode.active=!1},0)},onEnable:function(){var e=this;n.logEvent("halloween_result_show"),this.diamonLabel.string=o.get().getDiamonCount();var t=this.getComponent(cc.Animation);t.once("finished",function(){FBInstant&&"SOLO"!=FBInstant.context.getType()&&i.showTip("Sending score...",function(){this.sendMessageToFb()}.bind(this),-cc.winSize.height/2+30)}.bind(this)),t.play("halloweenResultIPageIn"),s.play(s.GAME_OVER),this.listData=this.listData||null,o.get().getRankDataList("halloween_rank",100,0,function(t){null==e.listData&&e.list.setItemsData(t),e.listData=t},!0),this.listData&&this.list.setItemsData(this.listData)},onUpdateData:function(e){if(this.data=e,this.stageNum=e.stageNum,o.get().setRankScore("halloween_rank",e.score),this.scoreLabel.string=e.score,this.playScore.string=e.score,this.playPhoto.spriteFrame=new cc.SpriteFrame(e.playerTexture),this.listData){var t=this.listData.find(function(e){return FBInstant&&FBInstant.player.getID()==e.playerId});if(t&&t.score<e.score){t.score=e.score,this.listData.sort(function(e,t){return e.score-t.score});for(var n=0;n<this.listData.length;n++)this.listData[n].rank=n+1}}},onRestart:function(){var e=this;if(n.logEvent("halloween_restart_click"),o.get().getHalloweenCount()<=0)return i.showTip("AVAILABLE IN "+o.get().getHalloweenTime()),void setTimeout(function(){i.hideTip()},1e3);var t=function(){i.hideLoading(),o.get().decHalloweenCount(),i.showPageAsync("GameHalloween")};FBInstant&&this.stageNum>=5?(i.showLoading(),o.get().getConnectedPlayersAsync(function(i){var a=o.get().getRecommondId();if(a&&Math.random()>i.length/(i.length+2))n.logEvent("halloween_restart_recommond_group"),FBInstant.context.switchAsync(a).then(function(){t(),n.logEvent("halloween_restart_recommond_group_success")}).catch(function(){t()});else if(i.length>1&&Math.random()<i.length/(i.length+2)){n.logEvent("halloween_restart_recommond_player");for(var s=i[Math.floor(Math.random()*i.length)];e.data.otherPlayerId==s.getID();)s=i[Math.floor(Math.random()*i.length)];FBInstant.context.createAsync(s.getID()).then(function(){t(),n.logEvent("halloween_restart_recommond_player_success")}).catch(function(){t()})}else n.logEvent("halloween_restart_choose_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){t(),n.logEvent("halloween_restart_choose_success")},function(){t()})})):t()},update:function(){this.dian.active=o.get().getHalloweenCount()>0,this.countLabel.string=o.get().getHalloweenCount(),o.get().getHalloweenCount()>0?(this.playBtn.interactable=!0,this.timer.string=""):(this.playBtn.interactable=!1,this.timer.string=o.get().getHalloweenTime())}}),cc._RF.pop()},{AdHelper:"AdHelper",ListView:"ListView",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils"}],HomePage:[function(e,t){"use strict";cc._RF.push(t,"6d360vaEnlBS7g9q5raGxmJ","HomePage");var n=e("PageMgr"),i=e("AdHelper"),o=e("User"),a=e("KnifeData"),s=e("Utils");e("NetAPI"),cc.Class({extends:cc.Component,properties:{diamonLabel:cc.Label,spriteKnife:cc.Sprite,bestStage:cc.Label,bestScore:cc.Label,giftTimeLabel:cc.Label,knifeMask:cc.Node,giftMask:cc.Node,inviteMask:cc.Node,inviteLabel:cc.Label,playSingleNode:cc.Node,horoscopeNode:cc.Node,inviteRed:cc.Node,inviteNode:cc.Node,version:cc.Label},onLoad:function(){this.isFirst=!0,this.isRecommonded=!1,this.curKnifeId=0,this.knifeMask.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.3,100),cc.fadeTo(.3,200),cc.delayTime(.3)))),this.giftMask.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.3,100),cc.fadeTo(.3,200),cc.delayTime(.3)))),this.inviteMask.active=!1,this.inviteMask.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.3,100),cc.fadeTo(.3,200),cc.delayTime(.3)))),this.isShowInviteMask=!1,this.version.string="Version "+window.VERSION,window.platfromMgr.init()},showPlayWithFriend:function(e){FBInstant&&"SOLO"==FBInstant.context.getType()?(n.showLoading(),i.logEvent("play_choose_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){n.hideLoading(),e(!0),i.logEvent("play_choose_success")},function(){n.hideLoading(),e(!1)})):e()},onEnable:function(){var e=this.node.getComponent(cc.Animation);e.onStartPlay=function(){console.log("onStartPlay")},e.onOutPlay=function(){},e.play("pageStartOut"),e.setCurrentTime(0,"pageStartOut"),e.sample("pageStartOut"),e.play("pageStartanim");var t=[154,155,156,157];this.inviteRed.active=!1;for(var i=0;i<t.length;i++)if(!o.get().isKnifeUnlock(t[i])){this.inviteRed.active=!0;break}o.get().getMaxStage()<10&&(this.inviteRed.active=!1),!this.isPkEntry&&o.get().isGiftAvailable()&&setTimeout(function(){n.showDialogAsync(n.SPINDIALOG)},0),o.get().subscribeBot(),this.isPkEntry=!1,this.isFirst=!1},showInviteDialog:function(e){var t=n.getPage(n.INVITE);t.off("invite_finish"),t.off("invite_finish_double"),t.on("invite_finish",function(){this.inviteNode.runAction(cc.sequence(cc.scaleTo(.3,1.2),cc.scaleTo(.3,.8),cc.scaleTo(.3,1.1),cc.scaleTo(.3,1))),o.get().addFriendsChance(e,!1)}.bind(this)),t.on("invite_finish_double",function(){this.inviteNode.runAction(cc.sequence(cc.scaleTo(.3,1.2),cc.scaleTo(.3,.8),cc.scaleTo(.3,1.1),cc.scaleTo(.3,1))),o.get().addFriendsChance(e,!0)}.bind(this)),n.showPage(n.INVITE)},showInviteInvildDialog:function(e){n.getPage(n.INVITETINVALID).getChildByName("timer").getComponent(cc.Label).string=o.get().getFriendTimeLeft(e),n.showDialog(n.INVITETINVALID)},onFriendsInvite:function(){if(o.get().getMaxStage()<10)return n.getPage(n.TIPDIALOG).getChildByName("tip").getComponent(cc.Label).string="\u901a\u8fc710\u5173\u540e\u89e3\u9501",void n.showDialog(n.TIPDIALOG);this.isShowInviteMask=!1,this.inviteMask.active=this.isShowInviteMask,n.showPageAsync("InviteKnifePage")},onPlaySingle:function(){i.logEvent("home_playsingle_click"),o.get().createShortcut(function(){s.playGame()})},onPlay:function(){var e=this;if(i.logEvent("home_play_click"),this.isRecommonded)this.showPlayWithFriend(this.onPlay_pre.bind(this));else{this.isRecommonded=!0;var t=o.get().getRecommondId(),a=function(e){n.hideLoading(),s.playGame({isVS:e})};t&&Math.random()>.8?(n.showLoading(),i.logEvent("recommond_group"),FBInstant.context.switchAsync(t).then(function(){a(!0),i.logEvent("recommond_group_success")}).catch(function(){a()})):o.get().getConnectedPlayersAsync(function(t){if(t.length>1&&e.node.active){n.showLoading(),i.logEvent("recommond_player");var o=t[Math.floor(Math.random()*t.length)];FBInstant.context.createAsync(o.getID()).then(function(){a(!0),i.logEvent("recommond_player_success")}).catch(function(){a()})}else e.showPlayWithFriend(e.onPlay_pre.bind(e))})}},onPlay_pre:function(e){var t=this.node.getComponent(cc.Animation);this.isFirst=!1,t.play("pageStartOut"),t.once("finished",function(){s.playGame({isVS:e})})},onPayShopClick:function(){i.logEvent("pay_home_click",{payState:o.get().isPayReady()?"YES":"NO"}),n.showDialogAsync("IosShopPage")},onGiftClick:function(){n.showDialogAsync(n.SPINDIALOG)},onHalloweenClick:function(){i.logEvent("halloween_click"),n.showDialogAsync("HalloweenDialog",{knifeNode:this.spriteKnife.node})},onHoroscopeClick:function(){i.logEvent("horoscope_click"),n.showDialogAsync("HoroscopePage")},onThanksgivingClick:function(){i.logEvent("thanksgiving_click"),n.showDialogAsync("ThanksSaleDialog")},onNewYearClick:function(){i.logEvent("newyear_click"),n.showDialogAsync("NewYearSaleDialog")},onChiristmasClick:function(){i.logEvent("newyear_click"),n.showDialogAsync("ChristmasSaleDialog")},onDuelClick:function(){var e=n.getPage(n.PKPAGE).getComponent("PKPage");i.logEvent("deul_click",{maxStage:o.get().getMaxStage()}),e.homeConnectServer(function(e){e?1==e.maintance&&n.showDialog(n.MAINTANCEDIALOG):(i.logEvent("deul_connect_success"),n.showPage(n.PKPAGE))})},update:function(){if(this.diamonLabel.string=o.get().getDiamonCount(),this.bestStage.string=o.get().getMaxStage(),this.bestScore.string=o.get().getMaxScore(),o.get().isGiftAvailable()?(this.giftTimeLabel.string="\u5c31\u7eea!",this.giftMask.active=!0):(this.giftTimeLabel.string=o.get().getGiftLeftTime(),this.giftMask.active=!1),this.curKnifeId!=o.get().getCurKnife()){var e=this;this.curKnifeId=o.get().getCurKnife();var t=a.getData(this.curKnifeId);cc.loader.loadRes("knife/"+t.img,function(t,n){t?console.log("error",t):e.spriteKnife.spriteFrame=new cc.SpriteFrame(n)});var n=o.get().getChristmasLeftTime()>0,i=o.get().getNewYearLeftTime()>0;this.horoscopeNode.active=o.get().isPayReady()&&(n||i)}}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",NetAPI:"NetAPI",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],HoroscopeGame:[function(e,t){"use strict";cc._RF.push(t,"bba08L7OX5A06J6YV/H0Y9v","HoroscopeGame");var n=e("User"),i=e("AnimationData"),o=e("SoundMgr"),a=e("PageMgr"),s=e("AdHelper"),c=e("Utils");e("enginefix");var r=["If your financial projects run into problems, you might get discouraged. But don\u2019t give up, fight for yourself. You will then see things move very quickly.","You tend not to master every situation. Fortunately, luck will allow you to sort out things by discussing them with someone willing to help you. ","With a good physical condition you can have all the tools you need to resolve a situation that is unsatisfying or neverending. You deserve better than that in life.","You will be in good spirits and you will have to keep it that way. Keep acting in a positive way. In certain circumstances, a positive attitude is necessary. ","Someone will surprise you once more. Somebody will make you an offer that you will be tempted to accept. You will be glad to hear it.","You have a lot to do, and fortunately you\u2019re in good health. Someone will give you a helpful hand in your work. Answer with gratitude so you can count on more help in the future.","You will find a way to stir your boat in a sea of troubles. You will receive a subtle offer that might charm you. But you will know how to resist to these calls which will enable you to come out of this maze victoriously.","You are experiencing difficult relationships with some people. But you will be lucky enough to get out of such a bad time. You will have to remain the same if you want to keep such relationships intact.","You are absolutely right to want to make the necessary remarks that will earn you respect.  Your judicious observations will be noted.","You are showing signs of impatience, but try to control it! A major event will mess up your schedule, but you will be able to deliver on all your deadlines. ","Take this great opportunity that will present itself. You will enjoy it if you keep it for yourself. Your commitment and absence of bias will serve you right.","You will be in good spirits despite a delicate situation especially since another apparently delicate situation will get solved easily."],l=["Red","Orange","Yellow","Green","Blue","Purple","White","Black","Grey","Pink","Golden","Silver"];cc.Class({extends:cc.Component,properties:{knifeIconTemplate:cc.Prefab,knifeTemplate:cc.Node,knifeGroup:cc.Node,knifeFire:cc.Node,knifeCountLabel:cc.Label,diamonCountLabel:cc.Label,pointsNode:cc.Node,pkIcon:cc.Node,stageLabel:cc.Label,appleIcon:cc.SpriteFrame,goldAppleIcon:cc.SpriteFrame,defaultKnifeIcon:cc.SpriteFrame,targetSprite:cc.Sprite,playerPhoto:cc.Sprite,whiteMask:cc.Mask,targetAnim:cc.Animation,specialBack:cc.Node,specailUp:cc.Node,targetBack:cc.Node,targetUp:cc.Node,parNode:cc.Node,parBrokenNode:cc.Node,appleAnim:cc.Prefab,goldAppleAnim:cc.Prefab,targetBrokenAnim:cc.Prefab,bossFightAnim:cc.Prefab,bossDefentedAnim:cc.Prefab,bonusAnim:cc.Prefab,shareDialog:cc.Node,screenNode:cc.Node,playerSprite:cc.Sprite,horoSprite:cc.Sprite,frames:[cc.SpriteFrame],horoDateLabel:cc.Label,luckyColorLabel:cc.Label,luckyNumLabel:cc.Label,loveStars:[cc.Node],dailyDes:cc.Label,shareBtnNode:cc.Node,closeBtnNode:cc.Node,luckyColorTitleNode:cc.Node,luckyNumTitleNode:cc.Node,loveTitleNode:cc.Node,yoff:-500,stopY:-180,speed:100},onLoad:function(){this.bossName="HOROSCOPE",this.levelData={count:12,knifes:[],animation:c.randomInt(6)+4}},init:function(){this.knifePool||(this.defaultKnifePool=new cc.NodePool,this.knifePool=new cc.NodePool,this.applePool=new cc.NodePool,this.goldApplePool=new cc.NodePool,this.setupDefaultKnifesAndApple()),this.targetAnim.node.stopAllActions(),this.targetAction&&(this.targetAction=null),this.targetAnim.node.rotation=0,this.knifeGroup.getComponent(cc.Widget).isAlignLeft=n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).isAlignRight=!n.get().getDir(),this.knifeGroup.getComponent(cc.Widget).left=this.knifeGroup.getComponent(cc.Widget).right=44,this.knifeGroup.getComponent(cc.Widget).updateAlignment(),this.removeKnifes(!0),this.removeApples(),this.removeSpecial(),this.knifes=this.knifes||[],this.curMoveKnife=null,this.isGameOver=!1,this.isStageBegin=!1,this.isUsingContinue=!1,this.curKnifeAmount=0,this.allAmount=0,this.leftAmount=0,this.curStage=1,this.continueCount=0,this.curTargetData=null,this.friendBonusCount=0,this.freeBonusCount=0,this.horoIndexs=[]},onUpdateData:function(e){var t=this;this.selectIndex=e.index,FBInstant&&cc.loader.load(FBInstant.player.getPhoto(),function(e,n){e||(t.playerSprite.spriteFrame=new cc.SpriteFrame(n))}),this.horoSprite.spriteFrame=this.frames[this.selectIndex],this.horoDateLabel.string=e.date,this.textIndex=c.randomInt(r.length),this.dailyDes.string=r[this.textIndex]},onShare:function(){FBInstant?(s.logEvent("gamehoroscope_share",{color:this.luckyColorLabel.string,num:this.luckyNumLabel.string,star:this.starCount,textIndex:this.textIndex,selectIndex:this.selectIndex}),a.showLoading(),c.captureScreen(this.screenNode,960,500,function(e){FBInstant.shareAsync({intent:"SHARE",image:e,text:"What's your horoscope today?Try it!",data:{from:"gamehoroscope"}}).then(function(){s.logEvent("gamehoroscope_share_success"),a.hideLoading(),a.showPage(a.HOME)}).catch(function(){a.hideLoading(),a.showPage(a.HOME)})})):a.showPage(a.HOME)},onShareClose:function(){a.showPage(a.HOME)},onEnable:function(){this.shareDialog.active=!1,this.init(),this.setupInput(),(this.needKnifePoolSetup||0==this.knifePool.size())&&(this.setupKnifesPool(),this.needKnifePoolSetup=!1),this.gotoStage(this.curStage),this.showKnifeIn(),s.logEvent("gamehoroscope_show")},setupInput:function(){this.removeInput(),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},removeInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this)},setupKnifesPool:function(){if(null!=this.knifePool){this.knifePool.clear(),this.removeKnifes(!0);for(var e=0;e<30;e++){var t=cc.instantiate(this.knifeTemplate);this.knifePool.put(t)}this.curKnife&&(this.curKnife.removeFromParent(),this.curKnife=null),this.curKnife=this.knifePool.get(),this.curKnife.y=this.yoff,this.knifeFire.addChild(this.curKnife)}else this.needKnifePoolSetup=!0},onTouchBegan:function(){this.curMoveKnife||this.isGameOver||0!=this.leftAmount&&this.isStageBegin&&(this.fireToTarget(),this.consumeOneKnife())},checkStageEnd:function(){0==this.leftAmount&&(this.isStageBegin=!1,s.logEvent("horoscope_finish"),this.showResult())},isBossStage:function(){return this.curStage%5==0},setupDefaultKnifesAndApple:function(){for(var e=0;e<30;e++){var t=new cc.Node;t.isDefaultKnife=!0,this.defaultKnifePool.put(t),(t=t.addComponent(cc.Sprite)).spriteFrame=this.defaultKnifeIcon}},removeKnifes:function(e){var t=this.targetBack.children,n=this,i=.3;function o(e){e.preFrame&&(e.getComponent(cc.Sprite).spriteFrame=e.preFrame,e.preFrame=null),e.isDefaultKnife?n.defaultKnifePool.put(e):n.knifePool.put(e),e.opacity=255}function a(e){var t=2*Math.random()+3,n=cc.moveBy(i,-e.x*t,-e.y*t),a=cc.rotateBy(i,380*Math.random()-180),s=cc.sequence(cc.delayTime(i-.05),cc.fadeOut(.05));e.runAction(cc.sequence(cc.spawn(n,a,s),cc.callFunc(o.bind(null,e))))}for(var s=t.length-1;s>=0;s--){var c=t[s];e?o(c):a(c)}},removeApples:function(){var e=this.targetUp.children,t=this;function n(e){e.isGold?t.goldApplePool.put(e):t.applePool.put(e)}for(var i=e.length-1;i>=0;i--)n(e[i])},removeSpecial:function(){this.specialBack.removeAllChildren()},resetKnifes:function(e){this.leftAmount=e,this.allAmount=e;for(var t=0;t<e;t++){if(t>=this.knifes.length){var n=cc.instantiate(this.knifeIconTemplate);this.knifes.push(n),this.knifeGroup.addChild(n)}this.knifes[t].x=0,this.knifes[t].y=40*t,this.knifes[t].active||(this.knifes[t].active=!0),this.knifes[t].getComponent("KnifeIcon").setSelect(!0)}for(;t<this.knifes.length;t++)this.knifes[t].active=!1},consumeOneKnife:function(){this.leftAmount--,this.leftAmount<0?this.leftAmount=0:this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!1)},pushbackOneKnife:function(){this.leftAmount<0?this.leftAmount=0:(this.knifes[this.leftAmount].getComponent("KnifeIcon").setSelect(!0),this.leftAmount++)},addOneDiamon:function(e){n.get().addOneDiamon(e),this.diamonCountLabel.string=n.get().getDiamonCount()},fireToTarget:function(){this.curKnife.active=!1,this.curMoveKnife=this.knifePool.get(),this.curMoveKnife.x=0,this.curMoveKnife.y=this.yoff,this.curMoveKnife.rotation=0,this.curMoveKnife.active=!0,this.knifeFire.addChild(this.curMoveKnife),o.play(o.THROW)},showKnifeIn:function(){if(!(this.leftAmount<=0||this.curKnife.active)){this.curKnife.stopAllActions(),this.curKnife.y=this.yoff-300,this.curKnife.opacity=0,this.curKnife.active=!0;var e=cc.spawn(cc.fadeIn(.1),cc.moveTo(.1,0,this.yoff));this.curKnife.runAction(cc.sequence(cc.delayTime(.1),e))}},gotoStage:function(e){this.curStage=e;var t=this.levelData,n=(t.diamons,t.knifes),a=t.animation,s=t.count;this.curActionsData=i.getData(a),this.resetKnifes(s);for(var c=0;c<n.length;c++){var r;(r=this.defaultKnifePool.get()).rotation=n[c],this.addKnifeToTarget(r)}(r=new cc.Node).scale=.6,r.width=72,r.height=86,r.addComponent(cc.Sprite).spriteFrame=this.goldAppleIcon,r.rotation=30*this.selectIndex-180+15,r.isGold=!0,this.addAppleToTarget(r),this.sounds={hitTarget:o.HIT,hitBlock:o.KNIFE_HIT,hitApple:o.APPLE_HIT},this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.targetAnim.node.scale=0,this.targetSprite.node.scale=1,this.beginStageActions()},beginStageActions:function(){this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null);var e=this.curActionsData;this.targetAnim.node.rotation=e.beginRotation;var t=this;this.targetAnim.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){t.isStageBegin=!0,t.targetAction=t.targetAnim.node.runAction(t.getActions(e.actions))}))),this.updateUI(),this.showKnifeIn()},getActions:function(e){for(var t=[],n=3*Math.random()>2,i=0;i<e.length;i++){var o=e[i];if(o){var a=n?-o[1]:o[1];6==o.length&&cc.easeBezierActionEx?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierActionEx(o[2],o[3],o[4],o[5]))):4==o.length?t.push(cc.rotateBy(o[0],a).easing(cc.easeBezierAction(0,o[2],o[3],1))):t.push(cc.rotateBy(o[0],a))}}var s;return s=t.length>1?cc.sequence(t):t[0],cc.repeatForever(s)},addKnifeToTarget:function(e,t){this.knifeCountLabel.string=this.curKnifeAmount;var n=e.rotation,i=n*Math.PI/180;if(e.parent=this.targetBack,e.rotation=270-n,e.x=this.targetBack.x+160*Math.cos(i),e.y=this.targetBack.y+160*Math.sin(i),t){var o=n%360;o<0&&(o+=360);var a=Math.ceil(o/30)-6;a<0&&(a+=12),0==a&&(a=12),this.horoIndexs.push(a)}},addAppleToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.targetUp,e.rotation=270-t,e.x=this.targetUp.x+198*Math.cos(n),e.y=this.targetUp.y+198*Math.sin(n)},showResult:function(){var e=this;this.shareDialog.active=!0,this.targetAction&&(this.targetAnim.node.stopAction(this.targetAction),this.targetAction=null),this.luckyColorLabel.string=c.randomSelectOne(l),this.luckyNumLabel.string=c.randomInt(13);var t=2;this.isUsingContinue&&(t+=1),0==this.leftAmount&&(t+=c.randomInt(2)+1);for(var i=0;i<this.loveStars.length;i++)this.loveStars[i].active=i<t,this.loveStars[i].opacity=0;this.starCount=t,this.shareDialog.opacity=0,this.luckyColorLabel.node.opacity=0,this.luckyNumLabel.node.opacity=0,this.dailyDes.node.opacity=0,this.luckyColorTitleNode.opacity=0,this.luckyNumTitleNode.opacity=0,this.loveTitleNode.opacity=0,this.shareBtnNode.opacity=0,this.closeBtnNode.opacity=0,this.shareBtnNode.active=!1,this.closeBtnNode.active=!1,this.shareDialog.runAction(cc.sequence(cc.fadeIn(.3),cc.delayTime(.3),cc.spawn(cc.targetedAction(this.luckyColorTitleNode,cc.fadeIn(.2)),cc.targetedAction(this.luckyColorLabel.node,cc.fadeIn(.2))),cc.delayTime(.3),cc.spawn(cc.targetedAction(this.luckyNumTitleNode,cc.fadeIn(.2)),cc.targetedAction(this.luckyNumLabel.node,cc.fadeIn(.2))),cc.delayTime(.3),cc.targetedAction(this.loveTitleNode,cc.fadeIn(.1)),cc.targetedAction(this.loveStars[0],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[1],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[2],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[3],cc.fadeIn(.1)),cc.targetedAction(this.loveStars[4],cc.fadeIn(.1)),cc.delayTime(.3),cc.targetedAction(this.dailyDes.node,cc.fadeIn(.2)),cc.callFunc(function(){e.shareBtnNode.active=!0,e.closeBtnNode.active=!0}),cc.targetedAction(this.shareBtnNode,cc.fadeIn(.2)),cc.delayTime(2),cc.targetedAction(this.closeBtnNode,cc.fadeIn(.2)))),s.logEvent("gamehoroscope_result_show",{color:this.luckyColorLabel.string,num:this.luckyNumLabel.string,star:this.starCount,textIndex:this.textIndex,selectIndex:this.selectIndex}),n.get().markShowHoroscope()},updateUI:function(){this.diamonCountLabel.string=n.get().getDiamonCount(),this.knifeCountLabel.string=this.curKnifeAmount,this.stageLabel.node.opacity=0,this.stageLabel.node.runAction(cc.fadeIn(.5)),this.stageLabel.string="BOSS: "+this.bossName,this.stageLabel.node.color=this.stageLabel.node.color.fromHEX("#ed524b"),this.pointsNode.active=!1,this.pkIcon.runAction(cc.moveTo(.5,0,this.pkIcon.y)),this.pkIcon.color=this.stageLabel.node.color,this.pointsNode.getComponent("PointControl").setCount(4)},checkCollision:function(){for(var e=this.targetBack.children,t=8,n=0;n<e.length;n++)if((u=(e[n].rotation+this.targetBack.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){this.targetAnim.node.pauseAllActions(),this.isGameOver=!0;var i=Math.sin(u*Math.PI/180),a=-Math.abs(Math.cos(u*Math.PI/180));p&&(i=-i);var s=Math.max(.1,u/30),c=cc.rotateBy(s,-Math.ceil(Math.abs(i))*u*20),r=Math.min(300/Math.abs(i),300/Math.abs(a));i=i*r*10,a*=r;var l=cc.moveBy(s,i,a),h=this,d=cc.spawn(l,c);this.curMoveKnife.runAction(cc.sequence(d,cc.callFunc(function(){h.knifePool.put(h.curMoveKnife),h.curMoveKnife=null,setTimeout(function(){h.onGameOver()},200)}))),this.playDieEffect(u,p),o.play(this.sounds.hitBlock);break}for(e=this.targetUp.children,t=15,n=0;n<e.length;n++){var u,p;if((u=(e[n].rotation+this.targetUp.parent.rotation)%360)<0&&(u+=360),u=(p=u>270)?360-u:u,Math.abs(u)<t&&this.curMoveKnife.y>this.stopY-180+3*u){var g=e[n].isGold;this.addOneDiamon(g),g?this.goldApplePool.put(e[n]):this.applePool.put(e[n]);var f=g?cc.instantiate(this.goldAppleAnim):cc.instantiate(this.appleAnim);f.x=30*Math.random()-15,f.y=-131,this.node.getChildByName("upEffectGroup").addChild(f),o.play(this.sounds.hitApple);break}}},showBonus:function(e,t){var n=cc.instantiate(this.bonusAnim);this.node.getChildByName("upEffectGroup").addChild(n);var i=n.getComponent(cc.Animation);t&&n.getComponent("BonusAnim").setType(t),i.on("finished",function(){i.off("finished"),n.removeFromParent(),e()})},onGameOver:function(){var e=this;0==this.continueCount&&s.isVideoLoad()?(this.continueCount++,a.getPage(a.CONTINUE).getComponent("ContinuePage").updateUI({curKnifeAmount:this.curKnifeAmount,curStage:this.curStage,name:this.bossName,isBoss:!0,continueCount:this.continueCount,onContinue:function(){e.continueGame()},onNoContinue:function(){e.showResult()},from:"gamehoroscope"}),a.showDialog(a.CONTINUE,!0)):this.showResult()},continueGame:function(){this.diamonCountLabel.string=n.get().getDiamonCount(),this.targetAnim.node.resumeAllActions(),this.pushbackOneKnife(),this.isGameOver=!1,this.isUsingContinue=!0,this.showKnifeIn()},playDieEffect:function(){var e=this.node.getChildByName("diemask");e.opacity=200,e.runAction(cc.fadeOut(.2));var t=this.node.getChildByName("knifeMask");t.opacity=200,t.scale=.4,t.runAction(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,1)))},update:function(){if(!this.isGameOver&&(this.curMoveKnife&&(this.curMoveKnife.y+=this.speed,this.checkCollision(this.curMoveKnife)),!this.isGameOver&&this.curMoveKnife&&this.curMoveKnife.y>this.stopY)){if(this.curMoveKnife.rotation=this.targetAnim.node.rotation-90,0==this.leftAmount){var e=this.isBossStage()?o.HIT_LAST_SPECIAL:o.HIT_LAST;o.play(e)}else o.play(this.sounds.hitTarget);this.curKnifeAmount++,this.addKnifeToTarget(this.curMoveKnife,!0);var t=cc.instantiate(this.parNode);t.y=-131,this.node.getChildByName("effectGroup").addChild(t),t.getComponent(cc.ParticleSystem).resetSystem(),this.curMoveKnife=null,this.targetAnim.playAdditive("targetHit"),this.showKnifeIn(),this.checkStageEnd()}}}),cc._RF.pop()},{AdHelper:"AdHelper",AnimationData:"AnimationData",PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User",Utils:"Utils",enginefix:"enginefix"}],HoroscopeItem:[function(e,t){"use strict";cc._RF.push(t,"6d9d9yLUehEMr4rxmZmm9W4","HoroscopeItem"),cc.Class({extends:cc.Component,properties:{iconSprite:cc.Sprite,nameLabel:cc.Label,dateLabel:cc.Label,frames:[cc.SpriteFrame]},updateItem:function(e){this.data=e,this.nameLabel.string=e.name,this.dateLabel.string=e.date,this.iconSprite.spriteFrame=this.frames[e.index]},onClick:function(){this.data.onSelect(this.data)}}),cc._RF.pop()},{}],HoroscopePage:[function(e,t){"use strict";cc._RF.push(t,"df2df1LRrBJZbEZzJ7Zwm5E","HoroscopePage");var n=e("AdHelper"),i=e("PageMgr");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},onLoad:function(){for(var e=[["Aries","3/21-4/20"],["Taurus","4/21-5/20"],["Gemini","5/21-6/21"],["Cancer","6/22-7/22"],["Leo","7/23-8/22"],["Virgo","8/23-9/22"],["Libra","9/23-10/22"],["Scorpio","10/23-11/21"],["Sagittarious","11/22-12/21"],["Capricorn","12/22-1/19"],["Aquarius","1/20-2/18"],["Pisces","2/19-3/20"]],t=0;t<4;t++)for(var n=0;n<3;n++){var i=cc.instantiate(this.itemPrefab);this.node.addChild(i),i.getComponent("HoroscopeItem").updateItem({index:3*t+n,name:e[3*t+n][0],date:e[3*t+n][1],onSelect:this.onSelect.bind(this)}),i.x=170*(n-1),i.y=220-210*t}},onEnable:function(){n.logEvent("horoscope_show")},onSelect:function(e){n.logEvent("horoscope_select",{index:e.index}),i.showPageAsync("HoroscopeGame",e)},onClose:function(){n.logEvent("horoscope_close"),i.showPage(i.HOME)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr"}],InviteDialog:[function(e,t){"use strict";cc._RF.push(t,"c4193BsDbRCL6CE+UuBTrq7","InviteDialog");var n=e("PageMgr"),i=e("Utils");cc.Class({extends:cc.Component,properties:{labelCount:cc.Label,editbox:cc.EditBox,personal:cc.Button},onEnable:function(){this.editbox.string="",this.personal.interactable=this.editbox.string.length>0,this.editbox.placeholder="Come on,play with me!!!",this.labelCount.string="0/"+this.editbox.maxLength},onClose:function(){n.showDialog(n.INVITETIP)},onEditChange:function(){this.labelCount.string=this.editbox.string.length+"/"+this.editbox.maxLength,this.personal.interactable=this.editbox.string.length>0},onPersonalize:function(){var e=this;if(!FBInstant)return e.node.emit("invite_finish_double"),void n.hideDialog(n.INVITE);n.showLoading(),i.getShareImg(function(t){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:this.editbox.string,image:t,data:{},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){e.node.emit("invite_finish_double"),n.hideDialog(n.INVITE),n.hideLoading()}).catch(function(e){console.log("updateAsync err",e),n.hideLoading()})}.bind(this))},onProfile:function(){var e=this;if(!FBInstant)return e.node.emit("invite_finish"),void n.hideDialog(n.INVITE);n.showLoading(),i.getShareImg(function(t){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:this.editbox.placeholder,image:t,data:{},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){e.node.emit("invite_finish"),n.hideDialog(n.INVITE),n.hideLoading()}).catch(function(e){console.log("updateAsync err",e),n.hideLoading()})}.bind(this))}}),cc._RF.pop()},{PageMgr:"PageMgr",Utils:"Utils"}],InviteKnifePage:[function(e,t){"use strict";cc._RF.push(t,"78e8d952TRLzLnFPEIcCo/B","InviteKnifePage");var n=e("User"),i=e("Utils"),o=e("PageMgr"),a=e("AdHelper"),s=e("KnifeData"),c=e("NetHelper");cc.Class({extends:cc.Component,properties:{diamon:cc.Label,info:cc.Label,appleCost:cc.Label,inviteLabel:cc.Label,knifes:[cc.Sprite],knifeGroup:cc.Node,equipNode:cc.Node,bottomGroup:cc.Node,equip:cc.Node,tip:cc.Node,adBtn:cc.Node,inviteTipLabel:cc.Label},onLoad:function(){var e=this,t=[154,155,156,157];this.knifeDatas=[],this.curIndex=0;for(var i=function(i){var o=s.getData(t[i]);e.knifeDatas.push(o),cc.loader.loadRes("knife/"+o.img,function(t,n){t?console.log("error",t):e.knifes[i].spriteFrame=new cc.SpriteFrame(n)}),n.get().isKnifeUnlock(t[i])&&(e.curIndex=i+1)},o=0;o<t.length;o++)i(o);this.curIndex=Math.min(3,this.curIndex),this.updateUI(this.knifeDatas[this.curIndex])},start:function(){this.knifeGroup.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.knifeGroup.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.knifeGroup.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},onTouchStart:function(){},onTouchMove:function(e){this.isMove=!0;var t=e.getDelta();this.knifeGroup.x+=t.x,this.knifeGroup.x>0&&(this.knifeGroup.x=0),this.knifeGroup.x<-600&&(this.knifeGroup.x=-600)},onTouchEnd:function(){this.isMove=!1;var e=Math.abs(Math.round(this.knifeGroup.x/200));this.curIndex=e,this.updateUI(this.knifeDatas[this.curIndex])},onEnable:function(){this.diamon.string=n.get().getDiamonCount(),this.updateUI(this.curData)},updateUI:function(e){var t=this;this.curData=e,this.appleCost.string=this.curData.price,this.adBtn.active=!0;var i=this.adBtn.active?"\u514d\u8d39(":"INVITE(",o=this.curData.id,a=this.curData.friend_num;this.inviteLabel.string=i+n.get().getFriendsCount(o)+"/"+this.curData.friend_num+")";var s=FBInstant&&FBInstant.player.getID()||"123";this.inviteTipLabel.string="Refer "+a+" friends \nOnly new player login could you get it",c.getShareCount(s,"inviteknife_"+o,function(e){o==t.curData.id&&(e=parseInt(e),e+=n.get().getFriendsCount(o),t.inviteLabel.string=i+e+"/"+a+")",!n.get().isKnifeUnlock(t.curData.id)&&e>=a&&(n.get().unlockKnife(t.curData.id,0),t.showKnifeDialog(t.curData.id),t.equip.active=n.get().isKnifeUnlock(t.curData.id)&&t.curData.id==n.get().getCurKnife(),t.equipNode.active=n.get().isKnifeUnlock(t.curData.id)&&t.curData.id!=n.get().getCurKnife(),t.bottomGroup.active=!n.get().isKnifeUnlock(t.curData.id)))}),this.info.string=this.curData.rate+"% \u4e09\u6b21\u673a\u4f1a",this.equip.active=n.get().isKnifeUnlock(this.curData.id)&&this.curData.id==n.get().getCurKnife(),this.equipNode.active=n.get().isKnifeUnlock(this.curData.id)&&this.curData.id!=n.get().getCurKnife(),this.bottomGroup.active=!n.get().isKnifeUnlock(this.curData.id)},onKnifeClick:function(e,t){this.curIndex=t,this.updateUI(this.knifeDatas[this.curIndex])},onAppleBuyClick:function(){var e=this;a.logEvent("knife_buy_click"),n.get().getDiamonCount()>=this.curData.price?(n.get().unlockKnife(this.curData.id,this.curData.price),this.showKnifeDialog(this.curData.id),this.updateUI(this.curData)):(this.tip.active=!0,setTimeout(function(){e.tip.active=!1},4e3))},onInviteClick:function(){var e=this,t=function(){n.get().addFriendsCount(e.curData.id),n.get().getFriendsCount(e.curData.id)>=e.curData.friend_num&&(n.get().unlockKnife(e.curData.id,0),e.showKnifeDialog(e.curData.id)),e.updateUI(e.curData)};FBInstant?(a.logEvent("knife_invite_click",{type:this.adBtn.active?"ad":"invite"}),this.adBtn.active?a.showVideoAd(t,function(){}):(o.showLoading("",!0),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(t,n){t?o.hideLoading():i.getImageAsync("InviteScreen",function(e){e.getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)}).then(function(t){FBInstant.updateAsync({action:"CUSTOM",cta:"PLAY NOW",template:"invite_knife",text:"This \ud83c\udfaf game is awesome! You should try it!\ud83d\ude1d",image:t,data:{from:"knife_invite",playerId:FBInstant.player.getID(),shareType:"inviteknife_"+e.curData.id},strategy:"IMMEDIATE",notification:"PUSH"}).then(function(){a.logEvent("knife_invite_finish"),o.hideLoading()}).catch(function(e){console.log("updateAsync err",e),o.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),o.hideLoading()})})}).catch(function(e){console.log("chooseAsync err",e),o.hideLoading()}))):t()},onEquipClick:function(){n.get().setCurKnife(this.curData.id),o.getPage(o.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(this.knifes[this.curIndex].node)),this.updateUI(this.curData),o.showPage(o.HOME)},showKnifeDialog:function(e){var t=this,n=o.getPage(o.SHOWINVITEKNIFE).getComponent("ShowInviteKnifeDialog");n.setKnifeInfo(e,this.info.string),n.registerOnClose(function(e,n){e&&(o.getPage(o.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(n)),t.updateUI(t.curData),o.showPage(o.HOME))}),o.showDialog(o.SHOWINVITEKNIFE)},update:function(){for(var e=this.node.width/2,t=0;t<this.knifes.length;t++){var n=this.knifes[t].node.convertToWorldSpaceAR(cc.v2(0,0));Math.abs(e-n.x)<150?this.knifes[t].node.scale=1.3-.5*Math.abs(e-n.x)/150:this.knifes[t].node.scale=.8}if(!this.isMove){var i=200*-this.curIndex;i!=this.knifeGroup.x&&(this.knifeGroup.x>i?(this.knifeGroup.x-=10,this.knifeGroup.x<=i&&(this.knifeGroup.x=i)):(this.knifeGroup.x+=10,this.knifeGroup.x>=i&&(this.knifeGroup.x=i)))}}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",NetHelper:"NetHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],InviteTipDialog:[function(e,t){"use strict";cc._RF.push(t,"c3fb61d1zVFTKETs+sAGh6t","InviteTipDialog");var n=e("PageMgr");cc.Class({extends:cc.Component,properties:{},onChooseFriend:function(){n.hideDialog(n.INVITETIP);var e=n.getPage(n.HOME).getComponent("HomePage");FBInstant?FBInstant.context.chooseAsync().then(function(){var t=FBInstant.context.getID();User.get().isFriendsInvited(t)?e.showInviteInvildDialog():e.showInviteDialog()}).catch(function(e){console.log("chooseAsync err",e)}):e.showInviteDialog()},start:function(){}}),cc._RF.pop()},{PageMgr:"PageMgr"}],IosShopPage:[function(e,t){"use strict";cc._RF.push(t,"80764YU74VICIJfeCDse5yO","IosShopPage");var n=e("PageMgr"),i=e("AdHelper"),o=e("SlotData"),a=e("SloteList"),s=e("SoundMgr"),c=e("User"),r=e("TaskMgr");cc.Class({extends:cc.Component,properties:{videoTime:cc.Label,spinTime:cc.Label,freeVideoBtn:cc.Button,videoBtn:cc.Button,spinBtn:cc.Button,noVideo:cc.Node,spinVideoIcon:cc.Node,spinList1:a,spinList2:a,spinList3:a,spinSwitcher:cc.Animation},onEnable:function(){i.logEvent("payios_show"),this.spinVideoIcon.active=i.isVideoLoad(),this.spinList1.node.opacity=this.spinVideoIcon.active?0:255},update:function(){this.freeVideoBtn.interactable=i.isVideoLoad(),this.videoBtn.interactable=i.isVideoLoad(),this.videoBtn.interactable=i.isVideoLoad()&&c.get().isVideoAvailable(),this.spinBtn.interactable=i.isVideoLoad()&&c.get().isSpinAvailable(),this.noVideo.active=!i.isVideoLoad(),c.get().isSpinAvailable()?this.spinTime.string="":this.spinTime.string=c.get().getSpinLeftTime(),c.get().isVideoAvailable()?this.videoTime.string="":this.videoTime.string=c.get().getVideoLeftTime()},showGetApples:function(e){c.get().addDiamon(e),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(e),n.showDialog(n.GIFTPAGE,!0)},onVideoClicked:function(){var e=this;i.logEvent("payios_video_click"),i.showVideoAd(function(){e.showGetApples(200)},function(){})},onTimedVideoClicked:function(){var e=this;c.get().resetVideoTime(),i.logEvent("payios_timevideo_click"),i.showVideoAd(function(){e.showGetApples(400)},function(){})},onSpinSloto_start:function(){var e=this;r.onSpinSlot(),this.spinList1.node.opacity=255,s.play(s.SLOT_START);var t=Math.floor(Math.random()*o.length),a=o[t];i.logEvent("payios_spin_random",{randomIndex:t});var l=a.slice();Math.random()>.8&&(l[Math.floor(Math.random()*l.length)]=10);var h=Math.floor(Math.random()*l.length),d=l.splice(h,1)[0];l.splice(Math.floor(Math.random()*l.length),0,d);for(var u=[],p=0;p<l.length;p++)u.indexOf(l[p])<0?l[p]:u.push(l[p]);var g=2==u.length,f=1==u.length;this.spinBtn.interactable=!1,this.spinVideoIcon.active=!1,this.spinList1.node.opacity=255,this.spinSwitcher.play("resultslot"),this.spinSwitcher.once("finished",function(){e.spinList1.scorllToIndex(l[0],function(){s.play(s.SLOT_STOP)}),setTimeout(function(){e.spinList2.scorllToIndex(l[1],function(){s.play(s.SLOT_STOP)},1)},200),setTimeout(function(){e.spinList3.scorllToIndex(l[2],function(){s.play(s.SLOT_STOP),e.spinSwitcher.play("resultspinback"),g&&(s.play(s.SLOT_2),n.showTip("REWARD X2",null,-200),setTimeout(function(){n.hideTip()},3e3)),f&&(e.spinList1.showLightEffect(),e.spinList2.showLightEffect(),e.spinList3.showLightEffect(),s.play(s.SLOT_3),n.showTip("REWARD X3",null,-200),setTimeout(function(){n.hideTip()},3e3)),setTimeout(function(){for(var t=0,i=-1,o=0;o<3;o++){var a=e["spinList"+(o+1)].getCurrentData();"knife"==a.type?i=a.id:t+=a.count*("apple"==a.type?2:4)}f?c.get().addDiamon(3*t):g?c.get().addDiamon(2*t):c.get().addDiamon(t),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(t,g,f,function(){i>0&&e.showKnifeGet(0,i)}),n.showDialog(n.GIFTPAGE,!0),e.spinBtn.interactable=!0},800)},2)},400)})},onSpinClicked:function(){var e=this;i.logEvent("payios_spin_click"),c.get().resetSpinTime(),i.showVideoAd(function(){e.onSpinSloto_start()},function(){})},showKnifeGet:function(e,t,i){var o=n.getPage(n.SHOWINVITEKNIFE).getComponent("ShowInviteKnifeDialog");o.setKnifeInfo(t,""),o.registerOnClose(function(e,t){e&&n.getPage(n.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(t)),i&&i()}),n.showDialog(n.SHOWINVITEKNIFE,!0)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",SlotData:"SlotData",SloteList:"SloteList",SoundMgr:"SoundMgr",TaskMgr:"TaskMgr",User:"User"}],JumpGame:[function(e,t){"use strict";cc._RF.push(t,"c40db7XjlpN5bhD9tHmFTRq","JumpGame");var n=e("AdHelper");cc.Class({extends:cc.Component,properties:{img:cc.Sprite,gameId:"1250735238360354",fromGame:"lastknife"},start:function(){this.node.on("click",this.onSwitchGame.bind(this))},onEnable:function(){var e=this;if(!this.data){this.getComponent(cc.Button).interactable=!1;var t=new XMLHttpRequest;if(t.open("POST","https://fb-api.capjoy.com/fbapi/v0/getRecommendGames"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==t.readyState){console.log(t.responseText);try{var n=JSON.parse(t.responseText).data;console.log(n),n.ads&&n.ads.length>0&&e.setAdData(n.ads[0])}catch(i){}}},window.FBInstant){var n="Other";switch(cc.sys.os){case cc.sys.OS_IOS:n="IOS";break;case cc.sys.OS_ANDROID:n="ANDROID";break;case cc.sys.OS_WINDOWS:n="WINDOWS";break;case cc.sys.OS_OSX:n="MAC"}var i="playerId="+FBInstant.player.getID()+"&nickname="+FBInstant.player.getName()+"&appId="+this.gameId+"&locale="+cc.sys.language+"&deviceOS="+n+"&timezoneOffset="+(new Date).getTimezoneOffset();t.send(i)}}},setAdData:function(e){var t=this;switch(this.data=e,cc.loader.load({url:e.icon,type:"jpg"},function(e,n){e?console.log(e):(t.img.spriteFrame=new cc.SpriteFrame(n),t.getComponent(cc.Button).interactable=!0)}),this.node.stopAllActions(),e.breathType){case 1:this.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.7,1.1),cc.scaleTo(.7,1))));break;case 2:this.node.runAction(cc.repeatForever(cc.sequence(cc.rotateBy(.5,5),cc.rotateBy(.5,-5))))}},onSwitchGame:function(){var e=this;n.logEvent("switch_game_click"),window.FBInstant&&FBInstant.switchGameAsync(this.data.appId,{from:this.fromGame,switchGameInfo:{appId:this.gameId,appName:this.fromGame},type:this.fromGame}).then(function(){n.logEvent("switch_game_success",{game:e.data.appName,appId:e.data.appId})}).catch(function(e){console.log(e)})}}),cc._RF.pop()},{AdHelper:"AdHelper"}],KnifeData:[function(e,t){"use strict";cc._RF.push(t,"b7664SQMuZDR5surAOhYW0Z","KnifeData");var n=[{id:1,img:"knife_0",boss_id:0,price:600,ad_num:0,friend_num:0},{id:2,img:"knife_1",boss_id:0,price:600,ad_num:0,friend_num:0},{id:3,img:"knife_2",boss_id:0,price:600,ad_num:0,friend_num:0},{id:4,img:"knife_3",boss_id:0,price:600,ad_num:0,friend_num:0},{id:5,img:"knife_4",boss_id:0,price:600,ad_num:0,friend_num:0},{id:6,img:"knife_5",boss_id:0,price:600,ad_num:0,friend_num:0},{id:7,img:"knife_6",boss_id:0,price:600,ad_num:0,friend_num:0},{id:8,img:"knife_7",boss_id:0,price:600,ad_num:0,friend_num:0},{id:9,img:"knife_8",boss_id:0,price:600,ad_num:0,friend_num:0},{id:10,img:"knife_9",boss_id:0,price:600,ad_num:0,friend_num:0},{id:11,img:"knife_10",boss_id:0,price:600,ad_num:0,friend_num:0},{id:12,img:"knife_11",boss_id:0,price:600,ad_num:0,friend_num:0},{id:13,img:"knife_12",boss_id:0,price:600,ad_num:0,friend_num:0},{id:14,img:"knife_13",boss_id:0,price:600,ad_num:0,friend_num:0},{id:15,img:"knife_14",boss_id:0,price:600,ad_num:0,friend_num:0},{id:16,img:"knife_15",boss_id:0,price:0,ad_num:4},{id:17,img:"knife_16",boss_id:0,price:0,ad_num:4},{id:18,img:"knife_17",boss_id:0,price:0,ad_num:4},{id:19,img:"knife_18",boss_id:0,price:0,ad_num:4},{id:20,img:"knife_19",boss_id:0,price:0,ad_num:4},{id:21,img:"knife_20",boss_id:0,price:0,ad_num:4},{id:22,img:"knife_21",boss_id:0,price:0,ad_num:4},{id:23,img:"knife_22",boss_id:0,price:0,ad_num:4},{id:24,img:"knife_23",boss_id:0,price:0,ad_num:4},{id:25,img:"knife_24",boss_id:0,price:0,ad_num:4},{id:26,img:"knife_25",boss_id:0,price:0,ad_num:4},{id:27,img:"knife_26",boss_id:0,price:0,ad_num:4},{id:28,img:"knife_27",boss_id:0,price:0,ad_num:4},{id:29,img:"knife_28",boss_id:0,price:0,ad_num:4},{id:30,img:"knife_29",boss_id:0,price:0,ad_num:4},{id:31,img:"knife_30",boss_id:0,price:0,ad_num:4},{id:32,img:"knife_31",boss_id:4,price:0,ad_num:0},{id:33,img:"knife_32",boss_id:0,price:600,ad_num:0},{id:34,img:"knife_33",boss_id:16,price:0,ad_num:0},{id:35,img:"knife_34",boss_id:4,price:0,ad_num:0},{id:36,img:"knife_35",boss_id:2,price:0,ad_num:0},{id:37,img:"knife_36",boss_id:50,price:0,ad_num:0},{id:38,img:"knife_37",boss_id:8,price:0,ad_num:0},{id:39,img:"knife_38",boss_id:15,price:0,ad_num:0},{id:40,img:"knife_39",boss_id:26,price:0,ad_num:0},{id:41,img:"knife_40",boss_id:22,price:0,ad_num:0},{id:42,img:"knife_41",boss_id:0,price:0,ad_num:0},{id:43,img:"knife_42",boss_id:0,price:0,ad_num:0},{id:44,img:"knife_43",boss_id:0,price:0,ad_num:0},{id:45,img:"knife_44",boss_id:6,price:0,ad_num:0},{id:46,img:"knife_45",boss_id:3,price:0,ad_num:0},{id:47,img:"knife_46",boss_id:17,price:0,ad_num:0},{id:48,img:"knife_47",boss_id:12,price:0,ad_num:0},{id:49,img:"knife_48",boss_id:11,price:0,ad_num:0},{id:50,img:"knife_49",boss_id:5,price:0,ad_num:0},{id:51,img:"knife_50",boss_id:14,price:0,ad_num:0},{id:52,img:"knife_51",boss_id:10,price:0,ad_num:0},{id:53,img:"knife_52",boss_id:9,price:0,ad_num:0},{id:54,img:"knife_53",boss_id:7,price:0,ad_num:0},{id:55,img:"knife_54",boss_id:13,price:0,ad_num:0},{id:56,img:"knife_55",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:57,img:"knife_56",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:58,img:"knife_57",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:59,img:"knife_58",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:60,img:"knife_59",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:61,img:"knife_60",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:62,img:"knife_61",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:63,img:"knife_62",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:64,img:"knife_63",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:65,img:"knife_64",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:66,img:"knife_65",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:67,img:"knife_66",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:68,img:"knife_67",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:69,img:"knife_68",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:70,img:"knife_69",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:71,img:"knife_70",boss_id:0,price:1200,ad_num:0,friend_num:0},{id:72,img:"knife_71",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:73,img:"knife_72",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:74,img:"knife_73",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:75,img:"knife_74",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:76,img:"knife_75",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:77,img:"knife_76",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:78,img:"knife_77",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:79,img:"knife_78",boss_id:0,price:1600,ad_num:0,friend_num:0},{id:80,img:"knife_79",boss_id:0,price:0,ad_num:4},{id:81,img:"knife_80",boss_id:0,price:0,ad_num:4},{id:82,img:"knife_81",boss_id:0,price:0,ad_num:4},{id:83,img:"knife_82",boss_id:0,price:0,ad_num:4},{id:84,img:"knife_83",boss_id:0,price:0,ad_num:4},{id:85,img:"knife_84",boss_id:0,price:0,ad_num:4},{id:86,img:"knife_85",boss_id:0,price:0,ad_num:4},{id:87,img:"knife_86",boss_id:0,price:0,ad_num:4},{id:88,img:"knife_87",boss_id:0,price:0,ad_num:0},{id:89,img:"knife_88",boss_id:0,price:0,ad_num:0},{id:90,img:"knife_89",boss_id:0,price:0,ad_num:0},{id:91,img:"knife_90",boss_id:0,price:0,ad_num:0},{id:92,img:"knife_91",boss_id:0,price:0,ad_num:0},{id:93,img:"knife_92",boss_id:0,price:0,ad_num:0},{id:94,img:"knife_93",boss_id:0,price:0,ad_num:0},{id:95,img:"knife_94",boss_id:0,price:0,ad_num:0},{id:96,img:"knife_95",boss_id:0,price:0,ad_num:0},{id:97,img:"knife_96",boss_id:0,price:0,ad_num:0},{id:98,img:"knife_97",boss_id:0,price:0,ad_num:0},{id:99,img:"knife_98",boss_id:0,price:0,ad_num:0},{id:100,img:"knife_99",boss_id:0,price:0,ad_num:0},{id:101,img:"knife_100",boss_id:0,price:0,ad_num:0},{id:102,img:"knife_101",boss_id:0,price:0,ad_num:0},{id:103,img:"knife_102",boss_id:0,price:0,ad_num:0},{id:104,img:"knife_103",boss_id:0,price:0,ad_num:3},{id:105,img:"knife_104",boss_id:0,price:0,ad_num:6},{id:106,img:"knife_105",boss_id:0,price:0,ad_num:9},{id:107,img:"knife_106",boss_id:0,price:0,ad_num:12},{id:108,img:"knife_107",boss_id:0,price:0,ad_num:3},{id:109,img:"knife_108",boss_id:0,price:0,ad_num:6},{id:110,img:"knife_109",boss_id:0,price:0,ad_num:9},{id:111,img:"knife_110",boss_id:0,price:0,ad_num:12},{id:112,img:"knife_111",boss_id:0,price:0,ad_num:3},{id:113,img:"knife_112",boss_id:0,price:0,ad_num:6},{id:114,img:"knife_113",boss_id:0,price:0,ad_num:9},{id:115,img:"knife_114",boss_id:0,price:0,ad_num:12},{id:116,img:"knife_115",boss_id:0,price:0,ad_num:3},{id:117,img:"knife_116",boss_id:0,price:0,ad_num:6},{id:118,img:"knife_117",boss_id:0,price:0,ad_num:9},{id:119,img:"knife_118",boss_id:0,price:0,ad_num:12},{id:120,img:"knife_119",boss_id:41,price:0,ad_num:0},{id:121,img:"knife_120",boss_id:42,price:0,ad_num:0},{id:122,img:"knife_121",boss_id:43,price:0,ad_num:0},{id:123,img:"knife_122",boss_id:44,price:0,ad_num:0},{id:124,img:"knife_123",boss_id:45,price:0,ad_num:0},{id:125,img:"knife_124",boss_id:46,price:0,ad_num:0},{id:126,img:"knife_125",boss_id:47,price:0,ad_num:0},{id:127,img:"knife_126",boss_id:48,price:0,ad_num:0},{id:128,img:"knife_127",boss_id:49,price:0,ad_num:0},{id:129,img:"knife_128",boss_id:0,price:0,ad_num:0},{id:130,img:"knife_129",boss_id:0,price:0,ad_num:0},{id:131,img:"knife_130",boss_id:0,price:0,ad_num:0},{id:132,img:"knife_131",boss_id:0,price:0,ad_num:0},{id:133,img:"knife_132",boss_id:0,price:0,ad_num:0},{id:134,img:"knife_133",boss_id:0,price:0,ad_num:0},{id:135,img:"knife_134",boss_id:0,price:0,ad_num:0},{id:136,img:"knife_500",boss_id:18,price:0,ad_num:0},{id:137,img:"knife_501",boss_id:27,price:0,ad_num:0},{id:138,img:"knife_502",boss_id:0,price:0,ad_num:0},{id:139,img:"knife_503",boss_id:0,price:0,ad_num:0},{id:140,img:"knife_504",boss_id:30,price:0,ad_num:0},{id:141,img:"knife_505",boss_id:19,price:0,ad_num:0},{id:142,img:"knife_506",boss_id:23,price:0,ad_num:0},{id:143,img:"knife_507",boss_id:24,price:0,ad_num:0},{id:144,img:"knife_700",boss_id:32,price:0,ad_num:0},{id:145,img:"knife_701",boss_id:33,price:0,ad_num:0},{id:146,img:"knife_702",boss_id:40,price:0,ad_num:0},{id:147,img:"knife_703",boss_id:24,price:0,ad_num:0},{id:148,img:"knife_704",boss_id:25,price:0,ad_num:0},{id:149,img:"knife_705",boss_id:29,price:0,ad_num:0},{id:150,img:"knife_706",boss_id:21,price:0,ad_num:0},{id:151,img:"knife_707",boss_id:20,price:0,ad_num:0},{id:152,img:"knife_708",boss_id:34,price:0,ad_num:0},{id:153,img:"knife_709",boss_id:35,price:0,ad_num:0},{id:154,img:"knife_1000",boss_id:0,price:5e3,ad_num:0,rate:20,friend_num:1},{id:155,img:"knife_1001",boss_id:0,price:7e3,ad_num:0,rate:40,friend_num:5},{id:156,img:"knife_1002",boss_id:0,price:8e3,ad_num:0,rate:50,friend_num:10},{id:157,img:"knife_1003",boss_id:0,price:15e3,ad_num:0,rate:70,friend_num:15},{id:158,img:"knife_8000",boss_id:36,candy_num:0,isHalloween:1},{id:159,img:"knife_8001",boss_id:37,candy_num:0,isHalloween:1},{id:160,img:"knife_8002",boss_id:38,candy_num:0,isHalloween:1},{id:161,img:"knife_8003",boss_id:39,candy_num:0,isHalloween:1},{id:162,img:"knife_8010",boss_id:0,price:500,isHalloween:1},{id:163,img:"knife_8011",boss_id:0,price:500,isHalloween:1},{id:164,img:"knife_8012",boss_id:0,price:500,isHalloween:1},{id:165,img:"knife_8013",boss_id:0,price:500,isHalloween:1},{id:166,img:"knife_8014",boss_id:0,price:1e3,isHalloween:1},{id:167,img:"knife_8015",boss_id:0,price:1e3,isHalloween:1},{id:168,img:"knife_8016",boss_id:0,price:1e3,isHalloween:1},{id:169,img:"knife_8017",boss_id:0,price:1e3,isHalloween:1}];t.exports={getData:function(e){return n[e-1]},getAllData:function(){return n}},cc._RF.pop()},{}],KnifeIcon:[function(e,t){"use strict";cc._RF.push(t,"f6592BiNgFNaJsiYM/iHmyo","KnifeIcon"),cc.Class({extends:cc.Component,properties:{knife:{default:null,type:cc.Node,serializable:!0}},setSelect:function(e){this.knife.active=e}}),cc._RF.pop()},{}],LevelData:[function(e,t){"use strict";cc._RF.push(t,"eba9alkANFG152AdNjg6FHl","LevelData");var n=[{index:1,diamons:[90,180],targetInfo:[{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1},{count:5,knifes:[],animation:1}]},{index:2,diamons:[0,60,300],targetInfo:[{count:7,knifes:[],animation:1},{count:7,knifes:[],animation:1},{count:7,knifes:[],animation:1},{count:7,knifes:[],animation:1},{count:7,knifes:[330],animation:1},{count:7,knifes:[30],animation:1}]},{index:3,diamons:[60,90,270,300],targetInfo:[{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,180],animation:2},{count:7,knifes:[0],animation:3},{count:7,knifes:[0],animation:3},{count:7,knifes:[180],animation:3},{count:7,knifes:[180],animation:3}]},{index:4,diamons:[60,270,300],targetInfo:[{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[0,120,240],animation:2},{count:7,knifes:[30,0,330],animation:3},{count:7,knifes:[0,170],animation:3},{count:7,knifes:[0,180],animation:3}]},{index:5,isBoss:1,targetInfo:[{count:10,knifes:[],animation:4,diamons:[],target:35},{count:10,knifes:[],animation:4,diamons:[0,30,60,90,120,150,180],target:36},{count:10,knifes:[],animation:4,diamons:[],target:46},{count:10,knifes:[],animation:4,diamons:[],target:2},{count:10,knifes:[],animation:4,diamons:[0,90,180,270],target:41},{count:10,knifes:[],animation:4,diamons:[],target:3},{count:10,knifes:[],animation:4,diamons:[],target:49},{count:10,knifes:[],animation:4,diamons:[],target:50}],rareInfo:[]},{index:6,diamons:[0,180],targetInfo:[{count:9,knifes:[30,330,150,210],animation:5}]},{index:7,diamons:[90,270],targetInfo:[{count:11,knifes:[0],animation:6},{count:11,knifes:[0,180],animation:7}]},{index:8,diamons:[90,270],targetInfo:[{count:8,knifes:[0,120,240],animation:9},{count:8,knifes:[0,120,240],animation:9},{count:9,knifes:[0,180],animation:8},{count:9,knifes:[0,180],animation:8}]},{index:9,diamons:[90,270],targetInfo:[{count:12,knifes:[0],animation:10},{count:12,knifes:[0],animation:11},{count:12,knifes:[0],animation:12},{count:12,knifes:[0,180],animation:10},{count:12,knifes:[0,180],animation:11},{count:12,knifes:[0,180],animation:12},{count:9,knifes:[0,120,240],animation:10},{count:9,knifes:[0,120,240],animation:11},{count:9,knifes:[0,120,240],animation:12}]},{index:10,isBoss:1,targetInfo:[{count:10,knifes:[0,120,240],animation:14,diamons:[60,180,300],target:6},{count:12,knifes:[],animation:14,diamons:[0,90,180,270],target:7},{count:10,knifes:[0,120,240],animation:14,diamons:[60,180,300],target:43},{count:12,knifes:[0,180],animation:13,diamons:[],target:27},{count:10,knifes:[0,120,240],animation:14,diamons:[60,180,300],target:44}],rareInfo:[{count:12,knifes:[],animation:4,diamons:[],target:33}]},{index:11,diamons:[45,135,225],targetInfo:[{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,180],animation:16},{count:13,knifes:[0,180],animation:16}]},{index:12,diamons:[45,135,225],targetInfo:[{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,90,180],animation:15},{count:13,knifes:[0,180],animation:16},{count:13,knifes:[0,180],animation:16}]},{index:13,diamons:[60,90,270,300],targetInfo:[{count:12,knifes:[0,120,240],animation:17},{count:12,knifes:[0,180],animation:18}]},{index:14,diamons:[45,135,225,315],targetInfo:[{count:10,knifes:[0,120,240],animation:17},{count:10,knifes:[0,120,240],animation:18},{count:10,knifes:[0,90,180,270],animation:17},{count:10,knifes:[0,90,180,270],animation:18}]},{index:15,isBoss:1,targetInfo:[{count:9,knifes:[45,117,189,261,333],animation:19,diamons:[81,153,225,297,369],target:8},{count:8,knifes:[0,30,150,180,210,330],animation:20,diamons:[55,80,105,130,230,255,280,305],target:9},{count:12,knifes:[0,180],animation:19,diamons:[90,270],target:40}]},{index:16,diamons:[0,180],targetInfo:[{count:11,knifes:[30],animation:21},{count:11,knifes:[330,30,150,210],animation:22}]},{index:17,diamons:[45,135,270],targetInfo:[{count:12,knifes:[0,90,180],animation:23},{count:10,knifes:[0,120,240],animation:24}]},{index:18,diamons:[45,135,270],targetInfo:[{count:12,knifes:[0,90,180],animation:25},{count:12,knifes:[0,180],animation:26}]},{index:19,diamons:[60,270,300],targetInfo:[{count:12,knifes:[0,180],animation:27},{count:11,knifes:[330,30,150,210],animation:28}]},{index:20,isBoss:1,targetInfo:[{count:12,knifes:[355,5,85,95,175,185,265,275],animation:29,diamons:[45,135,225,315],target:11},{count:12,knifes:[],animation:30,diamons:[0,72,144,216,288],target:12},{count:10,knifes:[],animation:31,diamons:[],target:13},{count:15,knifes:[],animation:32,diamons:[],target:22}]},{index:21,diamons:[45,135],targetInfo:[{count:11,knifes:[0,90,180],animation:32},{count:11,knifes:[0,180],animation:33}]},{index:22,diamons:[60,300],targetInfo:[{count:16,knifes:[],animation:32},{count:13,knifes:[],animation:33},{count:13,knifes:[0,90,180],animation:32},{count:13,knifes:[0,180],animation:33}]},{index:23,diamons:[90,270],targetInfo:[{count:13,knifes:[0,180],animation:34},{count:13,knifes:[0,180],animation:35}]},{index:24,diamons:[0,90,180,270],targetInfo:[{count:16,knifes:[],animation:36}]},{index:25,isBoss:1,targetInfo:[{count:9,knifes:[0,90,180,270],animation:37,diamons:[45,135,225,315],target:14},{count:20,knifes:[],animation:38,diamons:[0,45,90,135,180,225,270,315],target:15}],rareInfo:[{count:12,knifes:[],animation:4,diamons:[],target:34}]},{index:26,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,180],animation:39},{count:16,knifes:[0,90,180],animation:40}]},{index:27,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,90,180],animation:41},{count:17,knifes:[0,180],animation:42}]},{index:28,diamons:[45,135,225,315],targetInfo:[{count:13,knifes:[0,90,180],animation:43}]},{index:29,diamons:[45,135,225,315],targetInfo:[{count:15,knifes:[0,90,180],animation:44}]},{index:30,diamons:[0,90,180,270],isBoss:1,targetInfo:[{count:18,knifes:[],animation:45,target:16},{count:20,knifes:[],animation:46,target:17}]},{index:31,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,180],animation:47}]},{index:32,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0,90,180],animation:48}]},{index:33,diamons:[45,135,225,315],targetInfo:[{count:13,knifes:[30,150,210,330],animation:49}]},{index:34,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0],animation:50}]},{index:35,diamons:[0,90,180,270],isBoss:1,targetInfo:[{count:14,knifes:[30,60,120,150,210,240,300,330],animation:51,target:18},{count:20,knifes:[],animation:51,target:21}]},{index:36,diamons:[45,225,315],test:0,targetInfo:[{count:14,knifes:[0,180],animation:52}]},{index:37,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[30,150,210,330],animation:53}]},{index:38,diamons:[45,135,225,315],targetInfo:[{count:16,knifes:[0,90,180,270],animation:54}]},{index:39,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0],animation:55}]},{index:40,diamons:[30,60,90,150,180,210,270,300,330],isBoss:1,targetInfo:[{count:18,knifes:[0,120,240],animation:56,target:19}]},{index:41,diamons:[45,225,315],targetInfo:[{count:14,knifes:[0,180],animation:57}]},{index:42,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[30,150,210,330],animation:58}]},{index:43,diamons:[45,135,225,315],targetInfo:[{count:16,knifes:[0,90,180,270],animation:59}]},{index:44,diamons:[45,135,225,315],targetInfo:[{count:14,knifes:[0],animation:60}]},{index:45,diamons:[30,60,90,150,180,210,270,300,330],isBoss:1,targetInfo:[{count:15,knifes:[0,120,240],animation:61,target:20}]}],i=function(e){return(e-=1)>=n.length&&(e=n.length-10+(e-n.length)%n.length%10),n[e]};t.exports={getData:i,getLength:function(e){var t=i(e);return t.targetInfo.length+(t.rareInfo?t.rareInfo.length:0)},getLeveCount:function(){return n.length}},cc._RF.pop()},{}],ListItem:[function(e,t){"use strict";cc._RF.push(t,"b6237p+1IxD2rSevt+73Nq8","ListItem"),cc.Class({extends:cc.Component,updateItem:function(){}}),cc._RF.pop()},{}],ListView:[function(e,t){"use strict";cc._RF.push(t,"3cc05tSy9xLNpEQZY+8R+Js","ListView"),cc.Class({extends:cc.ScrollView,properties:{itemPrefab:cc.Prefab,spacing:0},onLoad:function(){this.lastIndex=0,this.listData=[],this.items=[],this.updateTimer=0,this.lastContentPosY=0,this.itemName=this.itemPrefab.name,this.itemHeight=this.itemPrefab.data.height<=0?100:this.itemPrefab.data.height,this.bufferZone=this.node.height/2*1.2,this.spawnCount=Math.floor(2.4*this.bufferZone/this.itemHeight),this.content||(this.content=new cc.Node,this.node.addChild(this.content)),this.content.y=this.node.height/2,this.onItemClickCB=null;for(var e=0;e<this.spawnCount;e++){var t=cc.instantiate(this.itemPrefab);this.content.addChild(t),t.y=-(e+.5)*(this.itemHeight+this.spacing),t.active=!1,this.items.push(t),t.on("click",this._onItemClick.bind(this))}},onItemClick:function(e){this.onItemClickCB=e},_onItemClick:function(e){this.onItemClickCB&&this.onItemClickCB(e.currentTarget.getComponent(this.itemName))},initItems:function(){if(this.items){for(var e=0;e<this.items.length;e++){var t=this.items[e].getComponent(this.itemName);this.items[e].y=-(e+.5)*(this.itemHeight+this.spacing),e<this.listData.length?(t.updateItem(e,this.listData[e]),this.items[e].active=!0):this.items[e].active=!1}this.content.height=this.listData.length*(this.itemHeight+this.spacing)+this.spacing}},removeAllItems:function(){for(var e=0;e<this.items.length;e++)this.items[e].active=!1;this.content.stopAllActions(),this.content.y=0,this.lastContentPosY=0},getItem:function(e){this.items;for(var t=0;t<this.items.length;t++){var n=this.items[t].getComponent(this.itemName);if(n.itemId==e)return n}},setItemsData:function(e){this.listData=e,this.lastContentPosY=0,this.content.y=this.node.height/2,this.initItems()},addItemsData:function(e){this.listData.push.apply(this.listData,e),this.lastIndex+=e.length,this.content.height=this.listData.length*(this.itemHeight+this.spacing)+this.spacing},requestMoreData:function(){},getPositionInView:function(e){var t=e.parent.convertToWorldSpaceAR(e.position);return this.node.convertToNodeSpaceAR(t)},update:function(e){if(cc.ScrollView.prototype.update.call(this,e),this.updateTimer+=e,!(Math.abs(this.lastContentPosY-this.content.y)<this.itemHeight)){this.updateTimer=0;for(var t=this.items,n=this.bufferZone,i=this.content.y<this.lastContentPosY,o=(this.itemHeight+this.spacing)*t.length,a=0;a<t.length;++a){var s=this.getPositionInView(t[a]);if(i){if(s.y<-n&&t[a].y+o<0){t[a].setPositionY(t[a].y+o);var c=t[a].getComponent(this.itemName),r=c.itemId-t.length;r>=0&&r<this.listData.length&&c.updateItem(r,this.listData[r])}}else if(s.y>n&&t[a].y-o>-this.content.height){t[a].setPositionY(t[a].y-o);var l=t[a].getComponent(this.itemName),h=l.itemId+t.length;l.updateItem(h,this.listData[h]),h>this.listData.length-10&&this.requestMoreData()}}this.lastContentPosY=this.content.y}}}),cc._RF.pop()},{}],NetAPI:[function(e,t){"use strict";cc._RF.push(t,"9a20eZDwJ1D0KenUTbp3P32","NetAPI");var n=e("NetMgr"),i=e("NetConfig"),o={},a=[];o.getFBSignAsync=function(){return new Promise(function(e,t){a.push({resolve:e,reject:t}),a.length>1||FBInstant.player.getSignedPlayerInfoAsync(JSON.stringify({nickname:FBInstant.player.getName()})).then(function(e){a.forEach(function(t){t.resolve(e)}),a=[]}).catch(function(e){a.forEach(function(t){t.reject(e)}),a=[]})})},o.getPkCountAsync=function(e){return new Promise(function(t,n){var o="last_knife_"+e,a=i.wssServer.replace("wss","https").replace("/knife/","/knife_count/"),s=i.serverId,c=new XMLHttpRequest,r=a+"?game_id="+i.game_id+"&platform=instant&game="+i.gameName+"&channel=0&account="+o+"&sign=&serverId="+s;c.open("GET",r),c.onreadystatechange=function(){4==c.readyState&&(200==c.status?t(Number(c.responseText)):(n("request error code : "+c.status),console.log(c.status,c.responseText)))},c.send()})},o.isConnected=function(){return n.isConnected},o.disConnect=function(){return n.disConnect()},o.loginAsync=function(e,t,i,o){return n.loginAsync(e,t,i,o)},o.loadPlayerAsync=function(e){var t={serverSign:e};return n.sendAsync("LoadPlayer",t)},o.FightWithFriendAsync=function(e,t,i,o,a,s){var c={facebookId:e,contextId:t,stake:i,datas:o,anotherChance:a,cdata:""+s};return n.sendAsync("FightWithFriend",c)},o.FightRoundAsync=function(e,t,i,o){var a={fightId:e,useAnotherChance:t,datas:i,round:o};return n.sendAsync("FightRound",a)},o.FightOverAsync=function(e,t,i,o){return i={fightId:e,winId:t,datas:i,round:o},n.sendAsync("FightOver",i)},o.BattleLogAsync=function(){return n.sendAsync("BattleLog",{})},t.exports=o,cc._RF.pop()},{NetConfig:"NetConfig",NetMgr:"NetMgr"}],NetConfig:[function(e,t){"use strict";cc._RF.push(t,"e3bae6wAw5BvZcm17R6en68","NetConfig"),t.exports={httpsDomain:"https://cj-api.capjoy.com",wssServer:"wss://game-knife-01.capjoy.com/game/knife/1",serverId:"21101",game_id:11,gameName:"knife",version:0,isDev:DEV},cc._RF.pop()},{}],NetHelper:[function(e,t){"use strict";cc._RF.push(t,"96ee1kQtttJwYzaRXOkBUQo","NetHelper");var n={},i=window.GAME_ID;n.postToServer=function(e,t,n){n=n||function(){};var i=new XMLHttpRequest,o="https://fb-api.capjoy.com/"+e;i.open("POST",o),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState){console.log(i.responseText);try{n(JSON.parse(i.responseText))}catch(e){n(i.responseText)}}};var a="";if(t)for(var s=Object.keys(t),c=0;c<s.length;c++)c>0&&(a+="&"),a+=s[c]+"="+t[s[c]];i.send(a),console.log("post ",o),console.log("params ",a)},n.sendAd=function(e,t,n){var i={v:window.GameVersion};this.postToServer("fbapi/v0/ads/report/"+e+"/"+n+"/"+t,i)},n.sendShare=function(e,t,n){if(e!=t){var o={playerId:e,sharePlayerId:t,type:n};this.postToServer("api/game/v0/shareUpdate_"+i,o)}},n.getShareCount=function(e,t,n){var o={playerId:e,type:t};this.postToServer("api/game/v0/shareGet_"+i,o,function(e){0==e.error?n(e.data.count):n(0)})};var o=!1,a=!1;n.getFuntionOpen=function(e,t,n){if(a)n(o);else{var s={locale:cc.sys.language,nickname:e,timezoneOffset:(new Date).getTimezoneOffset(),playerId:t,appId:window.appId};this.postToServer("fbapi/v0/testCase_"+i,s,function(e){0==e.error?(o=1==parseInt(e.data),n(o)):n(!1),a=!0})}},t.exports=n,cc._RF.pop()},{}],NetMgr:[function(e,t){"use strict";cc._RF.push(t,"44249YSvNJLKKD1UqNoLtsq","NetMgr"),e("ProtoGenerated");var n=e("AdHelper"),i=e("NetConfig"),o=e("crc16"),a={},s=i.httpsDomain,c=i.game_id,r=i.serverId,l=i.wssServer,h=i.gameName,d=i.version,u=i.isDev,p="",g="",f="",m=null,v="wss",y="",I=443,_=null,A={},b={},k=null,C=0,T=0;a.getAccountAsync=function(e,t){return new Promise(function(n,i){if(""==g){var o=new XMLHttpRequest,a=s+"/instant?game_id="+c+"&platform=instant&game="+h+"&playerId="+e+"&signature="+t;o.open("GET",a),console.log(a),o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status){var e=JSON.parse(o.responseText);p=e.sign,g=e.account,f=e.nickname,0==e.error?n(e):i(e),console.log("getAccount Http",o.responseText,o.status,e)}else i("requesnt error code : "+o.status),console.log(o.status,o.responseText)},o.send()}else n({account:g,sign:p,nickname:f})})},a.getServerListAsync=function(e,t,n){return new Promise(function(i,o){if(m)i(m);else{var a=new XMLHttpRequest,c=s+"/serverlist?game_id="+e+"&platform=instant&game="+t+"&channel=0&account="+n+"&isdev="+(DEV?"1":"0");a.open("GET",c),a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status){var e=JSON.parse(a.responseText);m=e,0==e.error?e.notice&&e.notice.maintance&&1==e.notice.maintance.maintance?o(e.notice.maintance):i(e):o(e),console.log("getServerListAsync",e)}else o("request error code : "+a.status)},a.send()}})},a.connectAsync=function(e){return new Promise(function(t,n){a.connect(e,null,null,function(e){e?n(e):t()})})},a.loginAsync=function(e,t,i,o){return new Promise(function(t,s){a.connectAsync(l).then(function(){return n.logEvent("net_Version"),a.sendAsync("Version",{})}).then(function(t){if(n.logEvent("net_Login"),t.version==d){var s={account:"last_knife_"+e,serverId:r,signature:p,ssl:!0,facebookId:e,name:i,headUrl:o};return a.sendAsync("Login",s)}throw Error("version not equal")}).then(function(){w(),t()}).catch(function(e){console.log(e),s(e)})})},a.getTime=function(){return T},a.clearCache=function(){};var S=function(e){var t=new DataView(e),n=t.getUint32(0),i=new DataView(e,4,n-4),s=t.getUint32(n),c=o(new Uint8Array(e),4,n);(c^=65535&i.getUint32(0))!=s&&console.error("crc doesn't consistent: "+c+":"+s);for(var r=i.getUint32(4),l=i.getUint16(8),h=new Uint8Array(l),d=0;d<h.length;d++)h[d]=~i.getUint8(10+d);var p=N(h),g=new Uint8Array(i.buffer,14+l,n-(14+l)),f=a.decodePb(p,g);u&&"Ping"!=p&&console.log("receiveMgs<<<<<<<<",p,f),b[r]&&"function"==typeof b[r]&&(b[r](f),b[r]=null),a.emit(p,f)},w=function(){P(),k=setInterval(function(){a.send("Ping",{upTime:T},function(e){T=e.time})},3e5)},P=function(){k&&(clearInterval(k),k=null)},D=function(e){for(var t=(e=unescape(encodeURIComponent(e))).split(""),n=[],i=0;i<t.length;i++)n.push(t[i].charCodeAt(0));return new Uint8Array(n)},N=function(e){var t=String.fromCharCode.apply(null,e);return decodeURIComponent(escape(t))};a.isConnected=function(){return!(!_||_.readyState!=WebSocket.OPEN)},a.disConnect=function(){a.close(),a.clearCache(),A={},b={}},a.connect=function(e,t,i,o){y=e||y,I=t||I,v=i||v,a.close();var s=y.startsWith("ws")?y+":"+I:v+"://"+y+":"+I;(_=new WebSocket(s)).binaryType="arraybuffer",_.onopen=function(){o&&o(null),_.onopen=function(){}},_.onmessage=function(e){S(e.data)},_.onerror=function(e){console.log("Send Text fired an error",e),o&&o(e)},_.onclose=function(e){a.clearCache(),a.emit("onclose"),n.logEvent("net_close",{code:e.code,reason:e.reason,wasClean:e.wasClean}),console.log("WebSocket instance closed.")}},a.sendAsync=function(e,t){return new Promise(function(n,i){var o=-1,s=setTimeout(function(){clearTimeout(s),s=null,b[o]=null,i("timeout")},3e4);o=a.send(e,t,function(e){null!=s&&(clearTimeout(s),s=null,n(e))},i)})},a.send=function(e,t,n,i){if(a.isConnected()){b[++C]=n;var s=D(e),c=a.encodePb(e,t),r=14+s.length+c.length+4,l=new ArrayBuffer(r),h=new DataView(l),d=0;h.setUint32(d,0),d+=4,h.setUint32(d,C),d+=4,h.setUint32(d,0),d+=4,h.setUint16(d,s.length),d+=2;for(var p=0;p<s.length;p++)h.setUint8(d,~s[p]),d++;for(var g=0;g<c.length;g++)h.setUint8(d,c[g]),d++;h.setUint32(0,d);var f=o(new Uint8Array(l),4,r-4);return f^=65535&C,h.setUint32(d,f),_.send(l),u&&"Ping"!=e&&console.log("sendMgs>>>>>>>",e,t),C}i&&i("socket not connected")},a.emit=function(e,t){A[e]&&A[e].forEach(function(e){e(t)})},a.on=function(e,t){A[e]||(A[e]=[]);var n=A[e].indexOf(t);return n>=0?(console.warn(e+" push already register for funtion ",t),e+"&"+n):(A[e].push(t),e+"&"+(A[e].length-1))},a.off=function(e,t){if(A[e])if(t){var n=A[e].indexOf(t);n>=0&&A[e].splice(n,1)}else A[e]=[]},a.removeAllPush=function(){A=[]},a.removePush=function(e){var t=e.split("&");2==t.length?A[t[0]]&&t[1]<A[t[0]].length&&A[t[0]].splice(t[1],1):console.log(e+" noticeid is not illgal")},a.close=function(){_&&(_.close(),_=null)},a.decodePb=function(e,t){return protobuf.de(e+".Down",t)},a.encodePb=function(e,t){return protobuf.en(e+".Up",t)},t.exports=a,cc._RF.pop()},{AdHelper:"AdHelper",NetConfig:"NetConfig",ProtoGenerated:"ProtoGenerated",crc16:"crc16"}],NewYearSaleDialog:[function(e,t){"use strict";cc._RF.push(t,"818821XJdlAlqUSk9PeCkjF","NewYearSaleDialog");var n=e("PageMgr"),i=e("User"),o=e("AdHelper"),a=e("Utils");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label,price3:cc.Label,timerLabel:cc.Label},onEnable:function(){this.price1.string=i.get().getPrice("apple_box","$2.99"),this.price2.string=i.get().getPrice("apple_60000","$28.99"),this.price3.string=i.get().getPrice("apple_180000_half","$49.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){o.logEvent("pay_shop_click",{itemId:"apple_box"}),i.get().purchase("apple_box",function(){i.get().addDiamon(7500),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(7500),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})},onBuyItem2:function(){o.logEvent("pay_shop_click",{itemId:"apple_60000"}),i.get().purchase("apple_60000",function(){i.get().addDiamon(18e4),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(18e4),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})},onBuyItem3:function(){o.logEvent("pay_shop_click",{itemId:"apple_180000_half"}),i.get().purchase("apple_180000_half",function(){i.get().addDiamon(6e5),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_180000_half"})},function(){})},onClose:function(){n.hideDialog("NewYearSaleDialog"),this.data&&this.data.closeCb&&this.data.closeCb()},update:function(){i.get().getNewYearLeftTime()>0&&(this.timerLabel.string=a.formatTimeHMS(i.get().getNewYearLeftTime()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],NoticeDialog:[function(e,t){"use strict";cc._RF.push(t,"dc8f4T12WVA+KzEt7JuK+k+","NoticeDialog"),e("../AdHelper"),cc.Class({extends:cc.Component,properties:{nameLabel:cc.Label,spAvatar:cc.Sprite},start:function(){},onEnable:function(){this.remoteUrl="",this.setUserAvatar(window.platfromMgr.getAvatarUrl(),this.spAvatar),this.nameLabel.string=window.platfromMgr.getNickName()},setUserAvatar:function(e,t){null!=e&&(this.remoteUrl=e,cc.assetManager.loadRemote(this.remoteUrl,function(e,n){console.log("loadRemoteloadRemoteloadRemoteloadRemote"),console.log(e),e?console.log(e):t.spriteFrame=new cc.SpriteFrame(n)}))},onUpdateData:function(){},onClickShare:function(){window.platfromMgr.shareGame(function(){})}}),cc._RF.pop()},{"../AdHelper":"AdHelper"}],PKItem:[function(e,t){"use strict";cc._RF.push(t,"2f42doFZcdPuICxyGVdLA/N","PKItem");var n=e("ListItem"),i=(e("Utils"),e("PageMgr")),o=e("PrizeData"),a=e("AdHelper"),s={};cc.Class({extends:n,properties:{itemGroup:cc.Node,title:cc.Label,playNode:cc.Node,nudgeNode:cc.Node,playName:cc.Label,playSprite:cc.Sprite,defaultPeople:cc.SpriteFrame,gift:cc.Sprite,timeLabel:cc.Label},ctor:function(){this.labelTexts=["Your Turn:","Friends' Turn:","Suggested friends:"],this.labelColors=["#9af737","#fcf300","#06cdeb"]},updateItem:function(e,t){var n=this;if(this.itemId=e,this.data=t,6!=t.type)if(this.node.scale=1,this.title.node.active=t.type<3,this.itemGroup.active=t.type>=3,t.type<3)this.title.string=this.labelTexts[t.type],this.title.node.color=cc.hexToColor(this.labelColors[t.type]);else{if(this.playSprite.spriteFrame=this.defaultPeople,t.photo&&cc.loader.load(t.photo,function(e,i){e||n.data!=t||(n.playSprite.spriteFrame=new cc.SpriteFrame(i))}),this.playNode.active=3==t.type||5==t.type,this.nudgeNode.active=4==t.type&&Math.floor(Date.now()/1e3)-this.data.lastActTime>3600&&!s[this.data.fightId]&&""!=this.data.contextId,this.playName.string=t.nickname,this.gift.node.active=3==t.type||4==t.type,this.timeLabel.string="",this.data.leftTime<43200&&4==t.type){var i=Math.floor(this.data.leftTime/3600)+"H:"+Math.floor(this.data.leftTime/60%60)+"M";this.timeLabel.string=i}var a=o.getData(this.data.stake);a&&a.img&&cc.loader.loadRes("stakes/"+a.img,function(e,t){e||(n.gift.spriteFrame=new cc.SpriteFrame(t))})}else this.node.scale=0},onPlayClick:function(){if(FBInstant){a.logEvent("pkitem_play"),i.showLoading();var e=this.data,t=function(){e.contextId=FBInstant.context.getID(),e.round=e.round||1,i.hideLoading(),i.getPage(i.PKPAGE).getComponent("PKPage").entryPKGame(e)};FBInstant.context.createAsync(this.data.opponentFacebookId).then(t).catch(function(e){console.log(e),"SAME_CONTEXT"!=e.code?i.hideLoading():t()})}},onNudgeClick:function(){var e=this;if(FBInstant){a.logEvent("pkitem_nudge"),i.showLoading();var t=this.data;i.getPageAsync("GameDuel").then(function(n){var o=n.getComponent("GameDuel");FBInstant.context.switchAsync(t.contextId).then(function(){return o.preparePkAsync(t)},function(e){if("SAME_CONTEXT"==e.code)return o.preparePkAsync(t);throw new Error("switchAsync fail")}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(){o.getScreenImageAsync(-1,!1,[]).then(function(n){var o=function(){i.hideLoading(),s[t.fightId]=!0,e.nudgeNode.active=!1,i.showTip("Message sent!"),setTimeout(function(){i.hideTip()},2e3)};FBInstant.updateAsync({action:"CUSTOM",cta:"PLAY NOW",template:"pk_turn",text:FBInstant.player.getName()+" is waiting for you!It's your turn!",image:n,data:{isPk:!0,fightId:t.fightId,from:"pk"},strategy:"IMMEDIATE",notification:"PUSH"}).then(o,o)}).catch(function(e){console.log(e),i.hideLoading(),i.hideTip()})})}).catch(function(e){console.log(e),i.hideLoading(),i.hideTip()})})}}}),cc._RF.pop()},{AdHelper:"AdHelper",ListItem:"ListItem",PageMgr:"PageMgr",PrizeData:"PrizeData",Utils:"Utils"}],PKLevelData:[function(e,t){"use strict";cc._RF.push(t,"64936zCsRZNK4uQD+3MUBr5","PKLevelData");var n=[{index:1,animation:1,target:1,knifes:[[0,180],[30,330],[0,90]],diamons:[[90,270],[0,180],[180,270]]}];t.exports={getData:function(e){return n[e-1]}},cc._RF.pop()},{}],PKPage:[function(e,t){"use strict";cc._RF.push(t,"5c2c8ZBKRBJzrnF63EcdkKo","PKPage");var n=e("AdHelper"),i=e("PageMgr"),o=e("ListView"),a=e("PushAPI"),s=e("NetAPI"),c=e("User");cc.Class({extends:cc.Component,properties:{listView:o,connectTip:cc.Node,pkrecordDialog:cc.Node,ruleDialog:cc.Node,historyList:o,redMark:cc.Node},onLoad:function(){},onEnable:function(){this.pkrecordDialog.active=!1,this.getComponent(cc.Animation).play("pkpageopen"),this.listView.node.stopAllActions(),this.listView.node.y=-cc.winSize.height,this.listView.node.runAction(cc.moveTo(.1,this.listView.node.x,-142))},onReconnect:function(){i.showLoading(),this.connectServer()},onReconnectClose:function(){i.showPage(i.HOME)},homeConnectServer:function(e){this.isConnected?e():(this.isConnected=!0,this.node.active=!0,this.isConnected=!1,this.connectServer(null,null,null,e),this.node.active=!1)},connectServer:function(e,t,o,r){var l=this;if(console.log("sign, fightId, isNewMatch",e,t,o,this.isConnecting),!this.isConnecting){this.connectTip.active=!1,this.isConnecting=!0,this.playerId=0,this.myTurnData=[],this.friendsTurnData=[],this.suggestedData=[],this.friendsPlayer={},this.friendsInMatch={},this.lastBlockedFacebookId=null;var h=function(e){var t={contextId:e.contextId,fightId:e.fightId,leftTime:e.leftTime,lastActTime:e.lastActTime,myDatas:e.myDatas,opponentDatas:e.opponentDatas,opponentFacebookId:e.opponentFacebookId,round:e.round,stake:e.stake,anotherChance:e.anotherChance,turnPlayerId:e.turnPlayerId,opponentPlayerId:e.opponentPlayerId,promoterPlayerId:e.promoterPlayerId,photo:null,nickname:"opponent",randomIndex:parseInt(e.cdata)},n=l.friendsPlayer[e.opponentFacebookId];n&&(t.photo=n.getPhoto(),t.nickname=n.getName(),l.friendsInMatch[e.opponentFacebookId]=!0,e.turnPlayerId==l.playerId?l.myTurnData.push(t):l.friendsTurnData.push(t))},d=function(e){for(var t in l.myTurnData)if(l.myTurnData[t].fightId==e)return l.lastBlockedFacebookId=l.myTurnData[t].opponentFacebookId,l.myTurnData.splice(t,1)[0];for(var n in l.friendsTurnData)if(l.friendsTurnData[n].fightId==e){var i=l.friendsTurnData.splice(n,1)[0];return u(i.opponentFacebookId),i}},u=function(e){var t=!1;for(var n in l.myTurnData)l.myTurnData[n].opponentFacebookId==e&&(t=!0);for(var i in l.friendsTurnData)l.friendsTurnData[i].opponentFacebookId==e&&(t=!0);l.friendsInMatch[e]=t};this.updateFacebookId=u;var p=function(){for(var e in l.suggestedData=[],l.friendsPlayer)l.friendsInMatch[e]||l.suggestedData.push({opponentFacebookId:l.friendsPlayer[e].getID(),photo:l.friendsPlayer[e].getPhoto(),nickname:l.friendsPlayer[e].getName()})};a.removeAllNotice(),a.SocketCloseNotice(function(){console.log("SocketCloseNotice"),l.isConnected=!1,l.connectTip.active=!0}),a.TextNotice(function(){}),a.UpdateBattleNotice(function(e){e.items.forEach(function(e){d(e.fightId),h(e)}),p(),l.updateList()}),a.DeleteBattleNotice(function(e){e.ids.forEach(function(e){d(e)}),p(),l.updateList()}),a.BattleTimeoutNotice(function(){}),a.NewBattleLogNotice(function(e){l.redMark.active=e.count>0}),i.showLoading("Connecting Server"),s.loginAsync(FBInstant.player.getID(),"",FBInstant.player.getName(),FBInstant.player.getPhoto()).then(function(){return n.logEvent("deul_loginAsync"),new Promise(function(e,t){c.get().getConnectedPlayersAsync(e,t)})}).then(function(t){return t.forEach(function(e){l.friendsPlayer[e.getID()]=e}),n.logEvent("pk_friend_count",{count:t.length}),s.loadPlayerAsync(e)}).then(function(e){l.isConnecting=!1,l.isConnected=!0,n.logEvent("net_loadPlayer"),l.playerId=e.playerId,l.fightId=e.fightId||t;var a=e.datas;l.redMark.active=e.newBattlelog>0,l.timeoutOverDatas=e.timeoutOverDatas;for(var s=l.friendsTurnData.length-1;s>=0;s--){var c=l.friendsTurnData[s];d(c.fightId),h(c)}if(a.forEach(function(e){h(e)}),p(),l.updateList(),o)l.createNewMatchAsync().then(i.hideLoading,function(){i.showPage(i.PKPAGE),i.hideLoading()});else{if(l.fightId){for(var u in i.hideLoading(),l.myTurnData)if(l.myTurnData[u].fightId==l.fightId)return void l.entryPKGame(l.myTurnData[u]);for(var g in l.friendsTurnData)if(l.friendsTurnData[g].fightId==l.fightId)return i.showPage(i.PKPAGE),void i.showDialog(i.TIPDIALOG)}else i.hideLoading();r&&r()}}).catch(function(e){n.logEvent("deul_error",{code:e.code}),console.log(e),i.hideLoading(),l.isConnecting=!1,l.isConnected=!1,l.connectTip.active=!0,r&&r(e)})}},updateList:function(){var e=[];this.myTurnData.length>0&&e.push({type:0}),this.myTurnData.forEach(function(t){t.type=3,e.push(t)}),this.friendsTurnData.length>0&&e.push({type:1}),this.friendsTurnData.forEach(function(t){t.type=4,e.push(t)}),this.suggestedData.length>0&&e.push({type:2}),this.suggestedData.forEach(function(t){t.type=5,e.push(t)});for(var t=e.length;t<11;t++)e.push({type:6});this.listView.setItemsData(e)},onNewGame:function(){var e=this;FBInstant&&(i.showLoading(),n.logEvent("new_game_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"],minSize:2,maxSize:2}).then(function(){return n.logEvent("new_game_choose_success"),e.createNewMatchAsync()}).then(i.hideLoading).catch(i.hideLoading))},entryPKGame:function(e){i.showLoading(),i.getPageAsync("GameDuel").then(function(t){t.getComponent("GameDuel").preparePkAsync(e).then(function(){i.hideLoading(),i.showPage("GameDuel")}).catch(function(e){i.hideLoading(),console.log(e)})}),this.lastBlockedFacebookId&&e.opponentFacebookId!=this.lastBlockedFacebookId&&(this.updateFacebookId(this.lastBlockedFacebookId),this.lastBlockedFacebookId=null)},createNewMatchAsync:function(){var e=this,t=function(t,n,i,o,a){var s={contextId:t,opponentFacebookId:i,nickname:n,photo:o,stake:a,round:1,datas:[]};e.entryPKGame(s)};return new Promise(function(o,a){FBInstant.context.getPlayersAsync().then(function(s){var c="OPPONENT",r="",l=null,h=FBInstant.context.getID();for(var d in s)if(s[d].getID()!=FBInstant.player.getID()){c=s[d].getName(),r=s[d].getID(),l=s[d].getPhoto();break}e.friendsInMatch[r]?(i.showTip("A match is already in progress!"),setTimeout(function(){i.hideTip()},3e3),a()):(t(h,c,r,l,1),o(),n.logEvent("pk_choose_opponent",{isNew:""==r}))}).catch(function(e){console.log(e),a()})})},onClose:function(){i.showPage(i.HOME),s.disConnect(),this.isConnected=!1},onHistory:function(){var e=this;n.logEvent("history_show"),this.pkrecordDialog.active=!0,this.pkrecordDialog.active=!1,this.redMark.active=!1,i.showLoading(),s.BattleLogAsync().then(function(t){for(var n=[],o=t.datas.length-1;o>=0;o--){var a=e.friendsPlayer[t.datas[o].opponentFacebookId];n.push({stake:t.datas[o].stake,photo:a?a.getPhoto():null,nickname:a?a.getName():null,timestamp:t.datas[o].overTime,winId:t.datas[o].winId,opponentPlayerId:t.datas[o].opponentPlayerId,promoterPlayerId:t.datas[o].promoterPlayerId,myPlayerId:e.playerId,myDatas:t.datas[o].myDatas,opponentDatas:t.datas[o].opponentDatas,round:t.datas[o].round})}e.historyList.setItemsData(n),e.pkrecordDialog.active=!0,i.hideLoading()})},onHistoryClose:function(){this.pkrecordDialog.active=!1},onRuleOpen:function(){n.logEvent("rule_show"),this.ruleDialog.active=!0},onRuleClose:function(){this.ruleDialog.active=!1}}),cc._RF.pop()},{AdHelper:"AdHelper",ListView:"ListView",NetAPI:"NetAPI",PageMgr:"PageMgr",PushAPI:"PushAPI",User:"User"}],PKRecordItem:[function(e,t){"use strict";cc._RF.push(t,"cf33cg6HqZApZ69chlY6eLl","PKRecordItem");var n=e("ListItem"),i=e("PageMgr"),o=e("PrizeData"),a=e("AdHelper");cc.Class({extends:n,properties:{playName:cc.Label,resultLabel:cc.Label,playSprite:cc.Sprite,defaultPeople:cc.SpriteFrame,gift:cc.Sprite,time:cc.Label},ctor:function(){this.labelTexts=["Your Turn:","Friends' Turn:","Suggested friends:"],this.labelColors=["#9af737","#fcf300","#06cdeb"]},updateItem:function(e,t){var n=this;this.itemId=e,this.data=t,this.playSprite.spriteFrame=this.defaultPeople,t.photo&&cc.loader.load(t.photo,function(e,i){e||n.data!=t||(n.playSprite.spriteFrame=new cc.SpriteFrame(i))});var i=o.getData(this.data.stake);i&&i.img&&cc.loader.loadRes("stakes/"+i.img,function(e,t){e||(n.gift.spriteFrame=new cc.SpriteFrame(t))}),this.resultLabel.string="DRAW",this.resultLabel.node.color=cc.hexToColor("#4ba4ff"),this.data.winId==this.data.opponentPlayerId&&(this.resultLabel.string="LOSE",this.resultLabel.node.color=cc.hexToColor("#c8c8c8")),this.data.winId==this.data.myPlayerId&&(this.resultLabel.string="WIN",this.resultLabel.node.color=cc.hexToColor("#ffe400"));var a=new Date(1e3*this.data.timestamp);this.time.string=a.getMonth()+1+"/"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()},onPlayClick:function(){if(FBInstant){i.showLoading();var e=this.data,t=function(){e.contextId=FBInstant.context.getID(),e.round=e.round||1,i.getPage(i.PKPAGE).getComponent("PKPage").entryPKGame(e),i.hideLoading()};FBInstant.context.createAsync(this.data.opponentFacebookId).then(t).catch(function(e){console.log(e),"SAME_CONTEXT"!=e.code?i.hideLoading():t()})}},onShareClick:function(){var e=this;if(FBInstant){i.showLoading();var t=this.data;i.getPageAsync("GameDuel",!0).then(function(n){var s=n.getComponent("GameDuel"),c=0==t.winId,r=e.data.winId==e.data.myPlayerId,l=FBInstant.player.getName(),h=l,d=t.nickname,u=t.promoterPlayerId==t.myPlayerId,p=o.getData(t.stake),g=r?l:d,f=r?d:l,m=g;a.logEvent("history_share",{isLose:!c&&!r,isWin:r,isDraw:c}),u?h="I":(d=h,h=t.nickname,d="me"),f==l&&(f="I"),g==l&&(g="I",m="me");var v=h+" challenges "+d+" to a duel and the prize is "+p.emoji+".",y=f+" misses the target and thus  "+g+" win."+f+" is obliged to buy "+p.emoji+" for "+m+".",I=" [\ud83e\udd23,\ud83e\udd23,\ud83e\udd23]  Do you want to join this game?",_=v+y+"[\ud83d\ude2d,\ud83d\ude2d,\ud83d\ude2d]  Can you beat him for me ?";r?_=v+y+I:c&&(_=v+"The result is a draw. Great game !"+I),s.preparePkAsync(t).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(){s.getScreenImageAsync(c?-1:t.myDatas.length+t.opponentDatas.length,c,[],r).then(function(e){FBInstant.shareAsync({intent:"SHARE",text:_,image:e,data:{isPk:!0,from:"pk_recored_share"}}),i.hideLoading()}).catch(function(e){console.log(e),i.hideLoading()})})})})}}}),cc._RF.pop()},{AdHelper:"AdHelper",ListItem:"ListItem",PageMgr:"PageMgr",PrizeData:"PrizeData"}],PKScreen:[function(e,t){"use strict";cc._RF.push(t,"80fe6goKdlLxbz/skZuRb7Z","PKScreen"),cc.Class({extends:cc.Component,properties:{pkTop:cc.Node,winTop:cc.Node,leftItem:cc.Node,rightItem:cc.Node,pkLeft:cc.Node,pkRight:cc.Node,winLeft:cc.Node,winRight:cc.Node,target:cc.Node,targetFront:cc.Node,scoreLable:cc.Label,dao1:cc.Node,dao2:cc.Node,dao3:cc.Node,dao4:cc.Node,dao5:cc.Node,dao6:cc.Node,dao7:cc.Node,dao8:cc.Node},onLoad:function(){this.leftDao=[this.dao1,this.dao2,this.dao3,this.dao4],this.rightDao=[this.dao8,this.dao7,this.dao6,this.dao5],this.center=this.pkTop.getChildByName("center"),this.roundLabel=this.center.getChildByName("round").getComponent(cc.Label),this.prize=this.center.getChildByName("coka"),this.pkMe=this.pkLeft.getChildByName("myplayer"),this.pkOpp=this.pkLeft.getChildByName("opponentplayer");var e=this;this.node.on("pre_capture",function(t){e.setInfo(t.detail)})},start:function(){},setDao:function(e,t,n){for(var i=0;i<n.length;i++){var o=n[i].getComponent("RoundDao");i<e?t?o.setMode("white"):o.setMode("black"):o.setMode("none")}},setInfo:function(e){this.infoData=e;var t=this.infoData;if(e.loseIndex>=0||e.isDraw){this.winTop.active=!0,this.pkTop.active=!1;var n=this.winLeft.getChildByName("nv"),i=this.winRight.getChildByName("nv"),o=this.winLeft.getChildByName("prize_2"),a=this.winRight.getChildByName("prize_2"),s=this.winLeft.getChildByName("myplayer"),c=this.winRight.getChildByName("opponentplayer"),r=this.winLeft.getChildByName("myName").getComponent(cc.Label),l=this.winRight.getChildByName("opponentName").getComponent(cc.Label);r.string=t.myName,l.string=t.opponentName;var h=this.pkLeft.getChildByName("headlight"),d=this.pkRight.getChildByName("headlight");t.isDraw?(this.scoreLable.string="DRAW",n.active=!0,i.active=!0,o.active=a.active=!0):t.isMyWin?(n.active=!0,i.active=!1,o.active=!0,a.active=!1,h.active=!0,d.active=!1,this.scoreLable.string=t.myName+" WIN!"):(n.active=!1,i.active=!0,o.active=!1,a.active=!0,h.active=!0,d.active=!1,this.scoreLable.string=t.opponentName+" WIN!");var u=s.getChildByName("jiazaitouxiang").getComponent(cc.Sprite),p=c.getChildByName("jiazaitouxiang").getComponent(cc.Sprite);u.spriteFrame=new cc.SpriteFrame(t.myTexture),p.spriteFrame=new cc.SpriteFrame(t.opponentTexture),o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.stakeTexture),a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.stakeTexture),this.target.x=this.targetFront.x=482,this.target.y=this.targetFront.y=237}else{this.winTop.active=!1,this.pkTop.active=!0;var g=this.pkLeft.getChildByName("myName").getComponent(cc.Label),f=this.pkRight.getChildByName("opponentName").getComponent(cc.Label),m=this.pkLeft.getChildByName("headlight"),v=this.pkRight.getChildByName("headlight"),y=this.pkLeft.getChildByName("myplayer"),I=this.pkRight.getChildByName("opponentplayer"),_=y.getChildByName("singleColor"),A=I.getChildByName("singleColor");this.roundLabel.string="ROUND"+t.round,g.string=t.myName,f.string=t.opponentName,t.isMyTurn?(m.active=!0,v.active=!1,_.active=!1,A.active=!0):(m.active=!1,v.active=!0,_.active=!0,A.active=!1);var b=[0,4,3,2,1];t.isMyTurn?(this.setDao(b[t.round],!0,this.leftDao),this.setDao(b[t.round],!1,this.rightDao)):(this.setDao(b[t.round],!1,this.leftDao),this.setDao(b[t.round],!0,this.rightDao));var k=y.getChildByName("jiazaitouxiang").getComponent(cc.Sprite),C=I.getChildByName("jiazaitouxiang").getComponent(cc.Sprite);k.spriteFrame=new cc.SpriteFrame(t.myTexture),C.spriteFrame=new cc.SpriteFrame(t.opponentTexture),this.prize.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.stakeTexture),this.target.x=this.targetFront.x=482,this.target.y=this.targetFront.y=177}var T=this.leftItem.getComponent("RoundItem"),S=this.rightItem.getComponent("RoundItem");T.setHead(new cc.SpriteFrame(t.myTexture)),S.setHead(new cc.SpriteFrame(t.opponentTexture)),this.getRoundNum(t.round),t.loseIndex>=0||t.isDraw?t.isDraw?(T.setData(t.round,!1,t.loseIndex),S.setData(t.round,!1,t.loseIndex)):(this.checkCount(t),console.log(" ==== >>checkCount : ",t.leftCount,t.rightCount),t.isMyWin?(T.setData(t.leftCount,!1,t.leftCount),S.setData(t.rightCount,!0,t.rightCount)):(T.setData(t.leftCount,!0,t.leftCount),S.setData(t.rightCount,!1,t.rightCount))):t.isMyTurn?(T.setData(t.round,!0,t.loseIndex),S.setData(t.round,!1,t.loseIndex)):(T.setData(t.round,!1,t.loseIndex),S.setData(t.round,!0,t.loseIndex)),this.target.removeAllChildren();for(var w=0;w<t.knifes.length;w++){var P=t.knifes[w],D=new cc.Node;D.addComponent(cc.Sprite),D.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t.knifeTextures[P.id]),D.rotation=P.rotation,this.addKnifeToTarget(D)}},getRoundNum:function(e){return[0,4,7,9][e-1]},addKnifeToTarget:function(e){var t=e.rotation,n=t*Math.PI/180;e.parent=this.target,e.rotation=270-t,e.x=0+160*Math.cos(n),e.y=0+160*Math.sin(n)},checkCount:function(e){var t=[4,4,3,3,2,2,1,1],n=[1,2,2,1,1,2,2,1],i=0,o=0;if(e.loseIndex<0)return e.leftCount=0,void(e.rightCount=0);for(var a=e.loseIndex+1,s=0;s<t.length;s++){if(!(a-t[s]>0))return void(1==n[s]?(e.leftCount=a+i-1,e.rightCount=o-1):(e.leftCount=i-1,e.rightCount=a+o-1));a-=t[s],1==n[s]?i+=t[s]:o+=t[s]}}}),cc._RF.pop()},{}],PageMgr:[function(e,t){"use strict";cc._RF.push(t,"9d47ek3KiZFCpcwMGuMTbyZ","PageMgr");var n=e("AdHelper"),i=function(){},o={};i.HOME="HOME",i.GAMEMAIN="GAMEMAIN",i.GAMESPIN="GameSpin",i.SETTING="SettingDialog",i.SHOP="ShopDialog",i.PAYSHOP="ShopPage",i.RANK="RankPage",i.RESULT="RESULT",i.POWERUP="PowerUpPage",i.GIFTPAGE="GIFTPAGE",i.INVITE="INVITE",i.INVITETIP="INVITETIP",i.INVITETINVALID="INVITETINVALID",i.NOTICEDIALOG="NoticeDialog",i.PKPAGE="PKPAGE",i.TIPDIALOG="TIPDIALOG",i.MAINTANCEDIALOG="MAINTANCEDIALOG",i.SHOWKNIFE="SHOWKNIFE",i.SHOWINVITEKNIFE="SHOWINVITEKNIFE",i.CONTINUE="CONTINUE",i.TURNTABLE="TurntableDialog",i.POWERINFODIALOG="PowerInfoDialog",i.SPINDIALOG="SpinDialog",i.BESTSHARE="BestShareDialog",i.VSRESULT="VsResultDialog";var a=null,s=null,c=1;i.register=function(e,t){o[e]=t},i.getPage=function(e){return o[e]},i.showPage=function(e){console.log("showPage==",e),a&&a.active&&(a.active=!1,a=null),s&&s.active&&(s.active=!1,s=null),o[e]&&!o[e].active&&(c++,o[e].zIndex=c,o[e].active=!0),o[e]?a=o[e]:console.log("page not find ==",e)},i.hidePage=function(e){o[e]&&o[e].active&&(o[e].active=!1,a==o[e]&&(a=null))},i.showDialog=function(e,t){console.log("showDialog==",e),t?o[e]&&!o[e].active&&(c++,o[e].zIndex=c,o[e].active=!0):(s&&s.active&&(s.active=!1,s=null),o[e]&&!o[e].active&&(c++,o[e].zIndex=c,o[e].active=!0),o[e]&&(s=o[e]))},i.hideDialog=function(e){o[e]&&o[e].active&&(o[e].active=!1,o[e].emit("close"),s==o[e]&&(s=null))},i.hideAllDialog=function(){s&&s.active&&(s.active=!1,s=null)};var r=null;i.showLoading=function(e,t){i.hideLoading(),i.loading.getChildByName("tip").getComponent(cc.Label).string=e||"",i.loading.active=!0,t||(r=setTimeout(function(){i.hideLoading()},1e4))},i.hideLoading=function(){r&&(clearTimeout(r),r=null),i.loading.active=!1},i.showTip=function(e,t,n,o){t=t||function(){},i.tip.active=!0,i.tip.opacity=255,i.tip.y=n||55,i.tip.getChildByName("label").getComponent(cc.Label).string=e,o||(i.tip.scale=0,i.tip.stopAllActions(),i.tip.runAction(cc.sequence(cc.scaleTo(.3,1).easing(cc.easeBackOut()),cc.callFunc(t))))},i.showPK=function(e){i.tip.active=!0,i.tip.y=-200,i.tip.getChildByName("label").getComponent(cc.Label).string=e,i.tip.stopAllActions(),i.tip.opacity=0,i.tip.runAction(cc.sequence(cc.spawn(cc.fadeTo(.3,255),cc.moveBy(.3,0,100)),cc.delayTime(1),cc.spawn(cc.fadeTo(.3,0),cc.moveBy(.3,0,-100))))},i.showTurn=function(e,t){i.tip.active=!0,i.tip.y=-cc.winSize.height/2-35,i.tip.getChildByName("label").getComponent(cc.Label).string=e,t=t||function(){},i.tip.stopAllActions(),i.tip.opacity=0,i.tip.runAction(cc.sequence(cc.spawn(cc.fadeTo(.3,255),cc.moveBy(.3,0,100)),cc.delayTime(2),cc.spawn(cc.fadeTo(.3,0),cc.moveBy(.3,0,-100)),cc.callFunc(t)))},i.hideTip=function(){i.tip.active=!1};var l=null;i.showAdAnimationIn=function(e){(l=l||cc.find("Canvas/AdMask")).active=!0,l.zIndex=1001;var t=l.getChildByName("content");t.width=cc.winSize.width,t.height=cc.winSize.height,t.y=-cc.winSize.height,t.stopAllActions(),t.runAction(cc.sequence(cc.moveTo(.3,0,0),cc.delayTime(.8),cc.callFunc(function(){e()})))},i.showAdAnimationOut=function(e){var t=(l=l||cc.find("Canvas/AdMask")).getChildByName("content");t.width=cc.winSize.width,t.height=cc.winSize.height,t.stopAllActions(),t.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.3,0,-cc.winSize.height),cc.callFunc(function(){l.active=!1,e()})))},i.getPageAsync=function(e,t){return new Promise(function(a,s){if(o[e])a(o[e]);else{var c=i.showLoading,r=i.hideLoading;t&&(c=function(e){e&&e()},r=function(e){e&&e()}),c(),n.logEvent("load_page",{name:e}),cc.loader.loadRes("pagePrefab/"+e,function(t,o){if(t)return r(),console.log("getPageAsync err",e),void s(t);n.logEvent("load_page_finish",{name:e});var c=cc.instantiate(o);c.active=!1,cc.find("Canvas/pages").addChild(c),i.register(e,c),a(c),r()})}})},i.showPageAsync=function(e,t){return new Promise(function(n){i.getPageAsync(e).then(function(o){t&&o.getComponent(e)&&o.getComponent(e).onUpdateData&&o.getComponent(e).onUpdateData(t),i.showPage(e),n(o)}).catch(function(e){console.log(e)})})},i.showDialogAsync=function(e,t,n){return new Promise(function(o){i.getPageAsync(e).then(function(a){i.showDialog(e,n),t&&a.getComponent(e)&&a.getComponent(e).onUpdateData&&a.getComponent(e).onUpdateData(t),o(a)})})},t.exports=i,cc._RF.pop()},{AdHelper:"AdHelper"}],PageRegister:[function(e,t){"use strict";cc._RF.push(t,"e9b6d7esm9F9ajL5Fup2YB0","PageRegister"),e("GameConfig"),window.VERSION=GameVersion;var n={},i=e("TaskMgr"),o=e("Utils"),a=e("NetHelper");window.part1="3415",window.sendReport=function(e){try{if(n[e.message])return;if(console.log(e),n[e.message]=!0,window.FBInstant){var t={game:"knife",version:window.VERSION,type:"code_error",msg:e.message+"\n"+e.stack,url:e.source,line:e.line,col:e.colno,error:e.stack},i=new XMLHttpRequest;i.open("POST","https://client-report.capjoy.com:1443/api/v1/logs/"),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(JSON.stringify(t)),console.log("sendReported")}}catch(o){}},window.addEventListener&&window.addEventListener("error",function(e){sendReport({message:e.message,source:e.filename,stack:e.error&&e.error.stack,line:e.lineno,colno:e.colno})});var s=e("PageMgr"),c=e("SoundMgr"),r=e("User"),l=e("AdHelper"),h=e("KnifeData");cc.Class({extends:cc.Component,properties:{game:cc.Prefab,home:cc.Prefab,result:cc.Prefab,showKnife:cc.Prefab,continue:cc.Prefab,gift:cc.Prefab,inviteKnife:cc.Prefab,inviteInvalid:cc.Prefab,tipDialog:cc.Prefab,loading:cc.Node,tip:cc.Node},onLoad:function(){window.part2="a003e21f95e",this.isFbStart=!1,this.loading.zIndex=1e3,s.loading=this.loading,s.tip=this.tip,window.FBInstant=window.FBInstant||!1,window.FBINIT=window.FBINIT||!1,this.preLoadSounds(),this.loadAllPages(),DEV&&this.showDebugConsole(),FBInstant||this.loadUserData(),cc.dynamicAtlasManager.enabled=!1},showDebugConsole:function(){if(window.document&&cc.sys.isMobile){var e=document.createElement("script");e.async=!0,e.src="vconsole.min.js",e.addEventListener("load",function(){new VConsole},!1),document.body.appendChild(e)}},preLoadSounds:function(){window.part3="4673f549";for(var e=[c.CLICK,c.THROW,c.HIT,c.HIT_LAST,c.HIT_LAST_SPECIAL,c.BOSS_DEFENTED,c.BOSS_FIGHT,c.KNIFE_HIT,c.APPLE_HIT,c.APPLES_COINS,c.GAME_OVER],t=0;t<e.length;t++)c.preLoad(e[t],function(){});cc.sys.os==cc.sys.OS_IOS&&c.preLoad("iosidle",function(e,t){e?cc.log(e):cc.audioEngine.play(t,!0,0)})},loadAllPages:function(){var e=0;this.register(s.HOME,this.home),e++,this.setProgress(e/24),this.register(s.GAMEMAIN,this.game),e++,this.setProgress(e/24),this.register(s.RESULT,this.result),e++,this.setProgress(e/24),this.register(s.SHOWKNIFE,this.showKnife),e++,this.setProgress(e/24),this.register(s.CONTINUE,this.continue),e++,this.setProgress(e/24),this.register(s.GIFTPAGE,this.gift),e++,this.setProgress(e/24),this.register(s.INVITETINVALID,this.inviteInvalid),e++,this.setProgress(e/24),this.register(s.TIPDIALOG,this.tipDialog),e++,this.setProgress(e/24),this.register(s.SHOWINVITEKNIFE,this.inviteKnife),e++,this.setProgress(e/24)},loadUserData:function(){var e=r.get(),t=this;e.load(function(){t.setProgress(1);var e=r.get().getCurKnife(),n=h.getData(e);cc.loader.loadRes("knife/"+n.img,function(e,n){if(e)return console.log("error",e),void t.startGame();s.getPage(s.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(new cc.SpriteFrame(n)),t.startGame()})})},startGame:function(){var e=this;this.setProgress(1),window.part4="86d63c7e2",FBInstant?FBInstant.startGameAsync().then(function(){var t=FBInstant.context.getType(),n=FBInstant.player.getName(),i=FBInstant.player.getID(),o=FBInstant.getEntryPointData();e.entryGame(),l.loadAsync(),l.loadVideoAsync(),e.setPush(),r.get().initPay(),r.get().sendFriendEvent();var s="facebook";if(o){s=o.from||o.type;var c=!1;0==r.get().getMaxStage()&&(c=!0,o.switchGameInfo&&a.sendAd(o.switchGameInfo.appId,i,"1250735238360354"),o.shareType&&a.sendShare(i,o.playerId,o.shareType)),o.boss&&l.logEvent("boss_entry",{boss:o.boss,type:t,isNewUser:c?"new":"old"})}l.logEvent("entry_game",{from:s,index:r.get().getVersion()}),a.getFuntionOpen(n,i,function(){})}).catch(function(e){console.log(e)}):r.get().load(this.entryGame.bind(this))},entryGame:function(){var e=this;i.setTaskIndex(r.get().getTaskIndex());var t=FBInstant&&FBInstant.getEntryPointData();if(console.log("entryPointData",t),t&&t.isPk){var n=t.sign,a=t.fightId,c=t.isNewMatch;s.getPage(s.PKPAGE).getComponent("PKPage").connectServer(n,a,c),s.showPage(s.PKPAGE),s.getPage(s.HOME).getComponent("HomePage").isPkEntry=!0,s.showPage(s.HOME),r.get().markPKOpen(),l.logEvent("pkmessage_clicked")}else if(FBInstant&&"SOLO"!=FBInstant.context.getType())if(t&&"gamehoroscope"==t.from)s.showPage(s.HOME);else if(t){var h=t.knifeCount;"end"==t.vsType&&t.battleId?(s.getPageAsync(s.VSRESULT).then(function(e){e.getComponent(s.VSRESULT).setVSData(t),s.showDialog(s.VSRESULT,!0)}).catch(function(){}),s.showPage(s.HOME)):"start"==t.vsType&&t.playerId!=FBInstant.player.getID()?o.playGame({isVS:!0,score:h,rewardCount:t.rewardCount,battleId:t.battleId}):o.playGame({isVS:!0,score:h})}else o.playGame({isVS:!0,score:0});else s.showPage(s.HOME),window.platfromMgr.login(),r.get().isGiftAvailable()||r.get().isShowNotice()&&r.get().getMaxStage()>=5&&s.showDialogAsync(s.NOTICEDIALOG);window.tt&&(tt.onShow(function(t){console.log("\u542f\u52a8\u53c2\u6570\u5982\u4e0b\uff1a",t.query),console.log("\u6765\u6e90\u4fe1\u606f\u5982\u4e0b\uff1a",t.refererInfo),e.requestCfg()}),this.requestCfg()),this.requestCfg()},requestCfg:function(){var e="https://chuchu.games:8888/servercfg/knifehit2/"+window.VersionCode+".json";console.log("requestCfg");var t=new XMLHttpRequest;t.addEventListener("load",function(){var e=JSON.parse(this.responseText);console.log(e),window.AdBreathOpen=e.AdBreathOpen}),t.open("GET",e),t.send()},tickContextChange:function(){var e=this;setInterval(function(){if(e.contextId!=FBInstant.context.getID()){e.contextId=FBInstant.context.getID();var t="contextural_rank."+e.contextId,n=function(){console.log("updateAsync LEADERBOARD"),FBInstant.updateAsync({action:"LEADERBOARD",name:t})};console.log("tickContextChange",e.contextId),FBInstant.getLeaderboardAsync(t).then(function(e){return e.setScoreAsync(window.lastScore,"")}).then(function(){return[n()]}).catch(n)}},3e3)},setProgress:function(e){FBInstant&&FBINIT&&FBInstant.setLoadingProgress(80+20*e)},register:function(e,t){cc.director.getScene();var n=cc.instantiate(t);n.active=!1,this.node.addChild(n),s.register(e,n)},setPush:function(){var e={bg:"img_apple",t:"text_apple",da:{t:"Play Now",u:"game_play",pld:{type:"hours23_da"}},tm:82800,pms:{nk:FBInstant.player.getName()}},t={};if(t.nickname=FBInstant.player.getName(),FBInstant){var n={target:[],tpl:[{bg:FBInstant.player.getPhoto(),t:FBInstant.player.getName()+" has joined the game!",tm:0,bts:[{t:"Play Now",u:"game_play"}]}]};t.playerInfo={head:FBInstant.player.getPhoto(),score:r.get().getMaxScore()},0==r.get().getMaxStage()?(t.newFriend=n,r.get().getConnectedPlayersAsync(function(i){for(var o in i)if(i[o].getID()!=FBInstant.player.getID()&&n.target.push(i[o].getID()),o>15)break;i.length<2&&(e.bts=[{t:"Play Now",u:"game_play",pld:{type:"hours23"}}]),FBInstant.setSessionData(t)},function(e){console.log(e)})):r.get().getConnectedPlayersAsync(function(n){t.friends=r.get().getBotFriendsFilterd(n),n.length<2&&(e.bts=[{t:"Play Now",u:"game_play",pld:{type:"hours23"}}]),FBInstant.setSessionData(t)},function(e){FBInstant.setSessionData(t),console.log(e)})}},update:function(){FBINIT&&!this.isFbStart&&(this.isFbStart=!0,this.loadUserData())}}),cc._RF.pop()},{AdHelper:"AdHelper",GameConfig:"GameConfig",KnifeData:"KnifeData",NetHelper:"NetHelper",PageMgr:"PageMgr",SoundMgr:"SoundMgr",TaskMgr:"TaskMgr",User:"User",Utils:"Utils"}],PageUtil:[function(e,t){"use strict";cc._RF.push(t,"44a5fMw4uVH/ZRFrnfPLu/r","PageUtil");var n=e("PageMgr"),i=e("AdHelper"),o=e("Utils");cc.Class({extends:cc.Component,properties:{},openPage:function(e,t){n.showPage(t)},openPageAsync:function(e,t){n.showPageAsync(t)},closePage:function(e,t){n.hidePage(t)},openDialog:function(e,t){n.showDialog(t)},openDialogAsync:function(e,t){console.log("!@!!!!!!!!"),console.log(e),console.log(t),n.showDialogAsync(t)},closeDialog:function(e,t){n.hideDialog(t)},noticeShare:function(){i.logEvent("notice_share_click"),n.showLoading(),cc.loader.load(FBInstant.player.getPhoto(),function(e,t){e?n.hideLoading():o.getImageAsync("NoticeScreen",function(e){e.getChildByName("mask").getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),e.getChildByName("name").getComponent(cc.Label).string=FBInstant.player.getName()}).then(function(e){FBInstant.shareAsync({intent:"SHARE",text:"I am challenging this boss, \ud83d\ude13 Are you joining?",image:e,data:{from:"notice_share"}}).then(function(){n.hideLoading(),i.logEvent("notice_share_success")}).catch(function(){n.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),n.hideLoading()})})}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",Utils:"Utils"}],PayShop:[function(e,t){"use strict";cc._RF.push(t,"b53e0lRnUFOyIY4HQOvqviJ","PayShop");var n=e("User"),i=e("PageMgr"),o=e("AdHelper");cc.Class({extends:cc.Component,properties:{adfreeBtn:cc.Button,removeAdBtn:cc.Button,bothRemove:cc.Button,removeAdPrice:cc.Label,removeContinuePrice:cc.Label,removeBoth:cc.Label,packageLabel:cc.Label,apple_boxLabel:cc.Label,appleCarLabel:cc.Label,packagesLabel:cc.Label,boxsLabel:cc.Label,appleCarsLabel:cc.Label,appleCarsPreLabel:cc.Label,appleCarPreLabel:cc.Label},start:function(){},onEnable:function(){this.updateButtonState(),this.removeAdPrice.string=n.get().getPrice("remove_a_d","$1.99"),this.removeContinuePrice.string=n.get().getPrice("remove_a_continue","$1.99"),this.removeBoth.string=n.get().getPrice("remove_a_both","$2.99"),this.packageLabel.string=n.get().getPrice("apple_package","$1.99"),this.apple_boxLabel.string=n.get().getPrice("apple_box","$4.99"),this.appleCarPreLabel.string=n.get().getPrice("apple_car","$9.99"),this.appleCarLabel.string=n.get().getPrice("apple_car_half","$4.99"),this.packagesLabel.string=n.get().getPrice("apple_25000","$19.99"),this.boxsLabel.string=n.get().getPrice("apple_60000","$39.99"),this.appleCarsPreLabel.string=n.get().getPrice("apple_180000","$99.99"),this.appleCarsLabel.string=n.get().getPrice("apple_180000_half","$49.99")},updateButtonState:function(){this.adfreeBtn.interactable=!n.get().isFreeContinue(),this.removeAdBtn.interactable=!n.get().isAdRemoved(),this.bothRemove.interactable=this.adfreeBtn.interactable&&this.removeAdBtn.interactable},showSuccess:function(){i.showTip("Pay Success"),setTimeout(function(){i.hideTip()},2e3)},onContinueFree:function(){var e=this;n.get().isPayReady()?(o.logEvent("pay_shop_click",{itemId:"remove_a_continue"}),n.get().purchase("remove_a_continue",function(){n.get().setFreeContinue(),e.updateButtonState(),e.showSuccess(),o.logEvent("pay_shop_success",{itemId:"remove_a_continue"})},function(){})):i.showDialog(i.PAYTIP,!0)},onRemoveAd:function(){var e=this;n.get().isPayReady()?(o.logEvent("pay_shop_click",{itemId:"remove_a_d"}),n.get().purchase("remove_a_d",function(){n.get().setRemoveAd(),e.updateButtonState(),e.showSuccess(),o.logEvent("pay_shop_success",{itemId:"remove_a_d"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBothFree:function(){var e=this;n.get().isPayReady()?(o.logEvent("pay_shop_click",{itemId:"remove_a_both"}),n.get().purchase("remove_a_both",function(){n.get().setBothFree(),e.updateButtonState(),e.showSuccess(),o.logEvent("pay_shop_success",{itemId:"remove_a_both"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuyPackage:function(){n.get().isPayReady()?(o.logEvent("pay_shop_click",{itemId:"apple_package"}),n.get().purchase("apple_package",function(){n.get().addDiamon(2500),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(2500),i.showDialog(i.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_package"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuyBox:function(){n.get().isPayReady()?(o.logEvent("pay_shop_click",{itemId:"apple_box"}),n.get().purchase("apple_box",function(){n.get().addDiamon(7500),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(7500),i.showDialog(i.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuyCar:function(){if(n.get().isPayReady()){var e="apple_car_half";o.logEvent("pay_shop_click",{itemId:e}),n.get().purchase(e,function(){n.get().addDiamon(25e3),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(25e3),i.showDialog(i.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:e})},function(){})}else i.showDialog(i.PAYTIP,!0)},onBuy60000:function(){n.get().isPayReady()?(o.logEvent("pay_shop_click",{itemId:"apple_60000"}),n.get().purchase("apple_60000",function(){n.get().addDiamon(18e4),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(18e4),i.showDialog(i.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuy25000:function(){n.get().isPayReady()?(o.logEvent("pay_shop_click",{itemId:"apple_25000"}),n.get().purchase("apple_25000",function(){n.get().addDiamon(6e4),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e4),i.showDialog(i.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_25000"})},function(){})):i.showDialog(i.PAYTIP,!0)},onBuy180000:function(){if(n.get().isPayReady()){var e="apple_180000_half";o.logEvent("pay_shop_click",{itemId:e}),n.get().purchase(e,function(){n.get().addDiamon(6e5),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),i.showDialog(i.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:e})},function(){})}else i.showDialog(i.PAYTIP,!0)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],PlatfromTT:[function(e,t,n){"use strict";cc._RF.push(t,"d0c7bNtWtROKr3HdYB/lA5U","PlatfromTT"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(){this.env=null,this.isLogin=!1,this.videoPath="",this.duration=300,this.isRecordering=!1,this.rewardVideoTag=!1,this.rewardAdUnitId="",this.rewardVideoAd=null,this.rewardVideoAdSuccessCallBack=null,this.rewardVideoAFrom="",this.sdkVersion="",this.allTime=0,this.lastTimeStamp=0,this.isUmengTag=!0,this.nikeName="",this.avatarUrl=null}return e.prototype.init=function(){if(this.env=window.tt,null!=this.env){var e=this.env.getSystemInfoSync();this.sdkVersion=e.SDKVersion,this.isLogin=!1,this.initRewardVideoAd(),this.initMenuShare()}},e.prototype.login=function(){var e=this;null==this.env||this.isLogin||this.env.login({force:!1,success:function(t){console.log("\u767b\u5f55\u6210\u529f",t),e.isLogin=!0,e.checkAuthorize(!1)},fail:function(e){console.log("\u767b\u5f55\u5931\u8d25",e)}})},e.prototype.submitScore=function(e,t){if(null!=this.env){var n={ttgame:{score:e,update_time:Date.now()},cost_ms:36500};console.log("submitScore keyTag = ",this.getRankKeyTag(t)),this.env.setUserCloudStorage({KVDataList:[{key:this.getRankKeyTag(t),value:JSON.stringify(n)}],success:function(t){console.log("submitScore \u63d0\u4ea4\u7528\u6237\u6570\u636e\u6210\u529f score = "+e),console.log(t)},fail:function(t){console.log("submitScore \u63d0\u4ea4\u7528\u6237\u6570\u636e\u5931\u8d25 score = "+e),console.log(t)}})}},e.prototype.getRankKeyTag=function(e){return e?"level":"endless"},e.prototype.checkAuthorize=function(e){var t=this;void 0===e&&(e=!1),null!=this.env&&this.env.getSetting({success:function(n){if(console.log(n),console.log(n.authSetting["scope.userInfo"]),void 0===n.authSetting["scope.userInfo"]||n.authSetting["scope.userInfo"])console.log("\u53ef\u4ee5\u8c03\u7528\u6388\u6743\u754c\u9762 00"),t.authorize();else{if(!e)return;t.env.openSetting({success:function(e){console.log("openSetting success"),console.log(e),console.log(e.authSetting.userInfo)},fail:function(e){console.log("openSetting fail"),console.log(e)},complete:function(e){console.log("openSetting complete"),console.log(e),e.authSetting["scope.userInfo"]&&(console.log("\u53ef\u4ee5\u8c03\u7528\u6388\u6743\u754c\u9762 11"),t.authorize())}})}},fail:function(){console.log("getSetting \u8c03\u7528\u5931\u8d25")}})},e.prototype.showFriendRank=function(e,t,n,i){void 0===i&&(i=0),console.log("showFriendRank 00"),null!=this.env&&(console.log("showFriendRank 11  ",e),this.env.getOpenDataContext().postMessage({command:"friendRank",rankTag:e,width:t,height:n,pageType:i}))},e.prototype.getUserCloudInfo=function(){null!=this.env&&this.env.getOpenDataContext().postMessage({command:"userInfo"})},e.prototype.recorderStart=function(){if(null!=this.env){var e=this.env.getGameRecorderManager();this.isRecordering&&e.stop({duration:this.duration}),this.isRecordering=!0,this.allTime=0,this.lastTimeStamp=Date.now(),e.start({duration:this.duration})}},e.prototype.recorderStop=function(e){var t=this;if(void 0===e&&(e=!0),null!=this.env){var n=this.env.getGameRecorderManager();this.allTime+=Date.now()-this.lastTimeStamp,this.isRecordering=!1,console.log("recorderStop 00000"),n.onStop(function(i){t.videoPath=i.videoPath,console.log(i.videoPath),console.log("recorderStop \u5f55\u5236\u5b8c\u6210"),e||n.clipVideo({path:i.videoPath,timeRange:[30,0],success:function(e){console.log("clipVideo \u5b8c\u6210"),t.videoPath=e.videoPath,console.log(e.videoPath)},fail:function(e){console.error(e)}})}),n.stop({duration:this.duration})}},e.prototype.recorderPause=function(){null!=this.env&&(this.allTime+=Date.now()-this.lastTimeStamp,this.env.getGameRecorderManager().pause())},e.prototype.recorderResume=function(){null!=this.env&&(this.lastTimeStamp=Date.now(),this.env.getGameRecorderManager().resume())},e.prototype.recorderShare=function(e){var t=this;this.isCanRecorderShare()?null!=this.env&&(this.logEvent("share_recorder"),console.log("recorderShare this.videoPath ",this.videoPath),this.env.shareAppMessage({channel:"video",extra:{videoPath:this.videoPath,defaultBgm:"https://v.douyin.com/eRu7kTV/",hashtag_list:["\u5fcd\u8005","\u66b4\u8d70\u5fcd\u8005"],video_title:"\u52a8\u52a8\u624b\u6307\u5c31\u80fd\u5f53\u5fcd\u8005"},success:function(n){t.logEvent("share_recorder_suc"),console.log("\u5206\u4eab\u89c6\u9891\u6210\u529f",n),null!=e&&e()},fail:function(n){null!=e&&e(),t.logEvent("share_recorder_fail"),console.log("\u5206\u4eab\u89c6\u9891\u5931\u8d25",n)}})):console.log("\u5f55\u5236\u65f6\u95f4\u592a\u77ed\u4e0d\u53ef\u5206\u4eab")},e.prototype.isCanRecorderShare=function(){return!(null!=this.env&&this.allTime<=5e3&&(console.log("\u5f55\u5236\u65f6\u95f4\u592a\u77ed\u4e0d\u53ef\u5206\u4eab"),1))},e.prototype.authorize=function(){var e=this;null!=this.env&&this.env.authorize({scope:"scope.userInfo",success:function(){console.log("\u7528\u6237\u5df2\u6388\u6743"),e.env.getUserInfo({success:function(t){console.log("getUserInfo \u8c03\u7528\u6210\u529f",t.userInfo),e.avatarUrl=t.userInfo.avatarUrl,e.nikeName=t.userInfo.nickName},fail:function(e){console.log("getUserInfo \u8c03\u7528\u5931\u8d25",e.errMsg)}})},fail:function(){console.log("\u7528\u6237\u672a\u6388\u6743")},complete:function(){console.log("\u63a5\u53e3\u5df2\u8c03\u7528")}})},e.prototype.isVideoLoad=function(){return null==this.env||this.rewardVideoTag},e.prototype.showVideoAd=function(e,t){void 0===t&&(t=function(){}),null!=this.env?this.sdkVersion<"1.3.0"?t():this.rewardVideoTag&&(this.logEvent("rad_show",{from:e}),this.rewardVideoAFrom=e,this.rewardVideoAdSuccessCallBack=t,this.rewardVideoAd.show()):t()},e.prototype.initRewardVideoAd=function(){var e=this;null!=this.env&&""!=this.rewardAdUnitId&&(this.sdkVersion<"1.3.0"||(this.rewardVideoAd=this.env.createRewardedVideoAd({adUnitId:this.rewardAdUnitId}),this.rewardVideoAd.onLoad(function(t){e.rewardVideoTag=!0,console.log("initRewardVideoAd onLoad",t)}),this.rewardVideoAd.onClose(function(t){console.log("initRewardVideoAd onClose",t),t.isEnded&&(e.logEvent("rad_show_suc",{from:e.rewardVideoAFrom}),e.rewardVideoAdSuccessCallBack&&e.rewardVideoAdSuccessCallBack()),e.lastTimeStamp=Date.now()}),this.rewardVideoAd.onError(function(t){console.log("initRewardVideoAd onError",t),e.rewardVideoTag=!1,setTimeout(function(){e.rewardVideoAd.load()},1e4)}),this.rewardVideoAd.load()))},e.prototype.logEvent=function(e,t){void 0===t&&(t={}),null!=this.env&&this.isUmengTag&&this.env.uma.trackEvent(e,t)},e.prototype.logButtonClickEvent=function(e){null!=this.env&&this.logEvent("btn_click",{from:e})},e.prototype.shareGame=function(e){var t=this;null!=this.env&&(this.logEvent("share_game"),console.log("shareGame 000"),this.env.shareAppMessage({title:"\u52a8\u52a8\u624b\u6307\u5c31\u80fd\u5f53\u5fcd\u8005",desc:"\u52a8\u52a8\u624b\u6307\u5c31\u80fd\u5f53\u5fcd\u8005",imageUrl:"https://bytedancegame.oss-cn-beijing.aliyuncs.com/ninjashare/share.jpeg",success:function(){t.logEvent("share_game_suc"),console.log("\u5206\u4eab\u6210\u529f"),null!=e&&e(1)},fail:function(){null!=e&&e(0),t.logEvent("share_game_fail"),console.log("\u5206\u4eab\u5931\u8d25")}}))},e.prototype.initMenuShare=function(){null!=this.env&&this.env.onShareAppMessage(function(e){return console.log(e.channel),{title:"\u52a8\u52a8\u624b\u6307\u5c31\u80fd\u5f53\u5fcd\u8005",desc:"\u52a8\u52a8\u624b\u6307\u5c31\u80fd\u5f53\u5fcd\u8005",imageUrl:"https://bytedancegame.oss-cn-beijing.aliyuncs.com/ninjashare/share.jpeg",success:function(){console.log("\u5206\u4eab\u6210\u529f")},fail:function(e){console.log("\u5206\u4eab\u5931\u8d25",e)}}})},e.prototype.getAvatarUrl=function(){return this.avatarUrl},e.prototype.getNickName=function(){return this.nikeName},e}();n.default=i,window.platfromMgr=new i,cc._RF.pop()},{}],PlayerLvData:[function(e,t){"use strict";cc._RF.push(t,"470caVtTZlDRoNwh58uhDOV","PlayerLvData");var n=[100,150,200,250,300,350,400,450,500,600,700,800,900,1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200,2300,2400,2500,2600,2700,2800,2900,3e3,3100,3200,3300,3400,3500,3600,3700,3800,3900,4e3,4100,4200,4300,4400,4500,4600,4700,4800,5e3,5200,5400,5600,5800,6e3,6200,6400,6600,7e3];t.exports={getData:function(e){return n[e-1]},getMaxLv:function(){return n.length}},cc._RF.pop()},{}],PointControl:[function(e,t){"use strict";cc._RF.push(t,"6e2fayc6uFDuL21LaVE8EhO","PointControl");var n=e("PointIcon");cc.Class({extends:cc.Component,properties:{point1:{default:null,type:n,serializable:!0},point2:{default:null,type:n,serializable:!0},point3:{default:null,type:n,serializable:!0},point4:{default:null,type:n,serializable:!0}},start:function(){},setCount:function(e){for(var t=0;t<4;t++)this["point"+(t+1)].setSelect(t<e)}}),cc._RF.pop()},{PointIcon:"PointIcon"}],PointIcon:[function(e,t){"use strict";cc._RF.push(t,"882dan3hP9FJ477OvHF8zlb","PointIcon"),cc.Class({extends:cc.Component,properties:{pointNode:{default:null,type:cc.Node,serializable:!0}},setSelect:function(e){this.pointNode.active=e},start:function(){}}),cc._RF.pop()},{}],PowerIcon:[function(e,t){"use strict";cc._RF.push(t,"2b7fbK2kkhDNoILF8o9Jg4C","PowerIcon"),cc.Class({extends:cc.Component,properties:{icon1:{default:null,type:cc.Node},icon2:{default:null,type:cc.Node,serializable:!0},icon3:{default:null,type:cc.Node,serializable:!0},icon4:{default:null,type:cc.Node,serializable:!0},icon5:{default:null,type:cc.Node,serializable:!0},icon6:{default:null,type:cc.Node,serializable:!0}},setIcon:function(e){this.icon1.active=1==e,this.icon2.active=2==e,this.icon3.active=3==e,this.icon4.active=4==e,this.icon5.active=5==e,this.icon6.active=6==e}}),cc._RF.pop()},{}],PowerInfoDialog:[function(e,t){"use strict";cc._RF.push(t,"feff0xtgYpDHpv6yIT549Cx","PowerInfoDialog");var n=e("PowerIcon");cc.Class({extends:cc.Component,properties:{info_txt:cc.Label,info_name:cc.Label,icon:n},start:function(){},setInfo:function(e,t){console.log("-----\x3e : ",e,t),this.info_txt.string=t+["% \u4e8c\u6b21\u673a\u4f1a\n\u6295\u63b7\u98de\u5200\u5931\u8bef\u540e\u6709\u4e00\u5b9a\u6982\u7387\u53ef\u4ee5\u514d\u8d39\u7ee7\u7eed\u6295\u63b7","% \u989d\u5916\u7684\u7ee7\u7eed\n\u4e00\u6b21\u300c\u7ee7\u7eed\u300d\u540e\uff0c\u53ef\u4ee5\u518d\u6b21\u83b7\u5f97\u300c\u7ee7\u7eed\u300d\u7684\u673a\u4f1a","% \u989d\u5916\u7684\u82f9\u679c\n\u6e38\u620f\u4e2d\u6709\u6982\u7387\u51fa\u73b0\u66f4\u591a\u7684\u82f9\u679c","% \u91d1\u82f9\u679c\n\u6e38\u620f\u4e2d\u6709\u4e00\u5b9a\u6982\u7387\u51fa\u73b0\u91d1\u82f9\u679c","% \u770b\u5e7f\u544a\u83b7\u53d6\u7684\u82f9\u679c\n\u89c2\u770b\u89c6\u9891\u540e\u6709\u6982\u7387\u83b7\u5f97\u66f4\u591a\u7684\u82f9\u679c","% \u53cc\u500d\u7ecf\u9a8c\n\u51fb\u8d25BOSS\u540e\u6709\u4e00\u5b9a\u6982\u7387\u83b7\u5f97\u53cc\u500d\u7ecf\u9a8c\u503c"][e-1],this.icon.setIcon(e)},onUpdateData:function(e){this.setInfo(e.index,e.num)}}),cc._RF.pop()},{PowerIcon:"PowerIcon"}],PowerUpData:[function(e,t){"use strict";cc._RF.push(t,"e99a2e30zlNCpSumGUC/Jgp","PowerUpData");var n=[{lv:1,type:1,data:5},{lv:2,type:2,data:10},{lv:3,type:3,data:5},{lv:4,type:4,data:5},{lv:5,type:5,data:5},{lv:6,type:6,data:5},{lv:7,type:1,data:1},{lv:8,type:2,data:5},{lv:9,type:3,data:5},{lv:10,type:4,data:2},{lv:11,type:5,data:5},{lv:12,type:6,data:2},{lv:13,type:1,data:2},{lv:14,type:2,data:5},{lv:15,type:3,data:5},{lv:16,type:4,data:3},{lv:17,type:5,data:3},{lv:18,type:6,data:2},{lv:19,type:1,data:3},{lv:20,type:2,data:5},{lv:21,type:3,data:5},{lv:22,type:4,data:3},{lv:23,type:5,data:5},{lv:24,type:6,data:2},{lv:25,type:1,data:2},{lv:26,type:2,data:5},{lv:27,type:3,data:5},{lv:28,type:4,data:3},{lv:29,type:5,data:5},{lv:30,type:6,data:1},{lv:31,type:1,data:2},{lv:32,type:2,data:5},{lv:33,type:3,data:5},{lv:34,type:4,data:3},{lv:35,type:5,data:5},{lv:36,type:6,data:2},{lv:37,type:1,data:2},{lv:38,type:2,data:5},{lv:39,type:3,data:5},{lv:40,type:4,data:3},{lv:41,type:5,data:5},{lv:42,type:6,data:2},{lv:43,type:1,data:2},{lv:44,type:2,data:5},{lv:45,type:3,data:5},{lv:46,type:4,data:3},{lv:47,type:5,data:5},{lv:48,type:6,data:2},{lv:49,type:1,data:2},{lv:50,type:2,data:5},{lv:51,type:3,data:5},{lv:52,type:4,data:3},{lv:53,type:5,data:5},{lv:54,type:6,data:2},{lv:55,type:1,data:2},{lv:56,type:2,data:5},{lv:57,type:3,data:5},{lv:58,type:4,data:3},{lv:59,type:5,data:5},{lv:60,type:6,data:2}];t.exports={getData:function(e){return n[e-1]}},cc._RF.pop()},{}],PowerUpItem:[function(e,t){"use strict";cc._RF.push(t,"27a1a/u/BlD64cpFFpQAn7w","PowerUpItem");var n=e("PowerIcon"),i=e("PageMgr");e("User"),cc.Class({extends:cc.Component,properties:{lock:cc.Node,label:cc.Label,icon:n,item_bg1:cc.Node,item_bg2:cc.Node,label2:cc.Label},start:function(){},setLock:function(e){this.lock.active=e},setIcon:function(e){this.index=e,this.icon.setIcon(e)},setLight:function(e){this.item_bg1.active=e,this.item_bg2.active=!e},setLable:function(e,t){this.num=t,this.label2.string="",this.label.string=e},openDialog:function(){console.log("this.index:",this.index),this.index<1||i.showDialogAsync(i.POWERINFODIALOG,{index:this.index,num:this.num},!0)}}),cc._RF.pop()},{PageMgr:"PageMgr",PowerIcon:"PowerIcon",User:"User"}],PowerUpPage:[function(e,t){"use strict";cc._RF.push(t,"1a0d3fv6q1MMIeRfC2y0IXd","PowerUpPage");var n=e("User"),i=e("PlayerLvData");cc.Class({extends:cc.Component,properties:{item:{default:null,type:cc.Prefab},bar:{default:null,type:cc.Node},level:{default:null,type:cc.Label},contentNode:cc.Node},start:function(){},onEnable:function(){var e=n.get().getPlayer_lv(),t=n.get().getPlayer_exp(),o=n.get().getChance_second(),a=n.get().getChance_extra(),s=n.get().getChance_giftApple(),c=n.get().getChance_goldApple(),r=n.get().getChance_videoApple(),l=n.get().getChance_doubleXp();this.bar.width=t/i.getData(e)*290,this.level.string="\u7b49\u7ea7 "+e,this.node_second||(this.node_second=cc.instantiate(this.item),this.contentNode.addChild(this.node_second),this.node_second.y=155);var h=this.node_second.getComponent("PowerUpItem");e>=1?(h.setLock(!1),h.setLable(o+"% \u4e8c\u6b21\u673a\u4f1a",o),h.setIcon(1)):(h.setLock(!0),h.setLable("\u989d\u5916\u52a0\u6210-1"),h.setIcon(-1)),h.setLight(!0),this.node_extra||(this.node_extra=cc.instantiate(this.item),this.contentNode.addChild(this.node_extra),this.node_extra.y=this.node_second.y-110),h=this.node_extra.getComponent("PowerUpItem"),e>2?(h.setLock(!1),h.setLable(a+"% \u989d\u5916\u7684\u7ee7\u7eed",a),h.setIcon(2)):(h.setLock(!0),h.setLable("\u989d\u5916\u52a0\u6210-2"),h.setIcon(-1)),h.setLight(!1),this.node_giftApple||(this.node_giftApple=cc.instantiate(this.item),this.contentNode.addChild(this.node_giftApple),this.node_giftApple.y=this.node_extra.y-110),h=this.node_giftApple.getComponent("PowerUpItem"),e>3?(h.setLock(!1),h.setLable(s+"% \u989d\u5916\u7684\u82f9\u679c",s),h.setIcon(3)):(h.setLock(!0),h.setLable("\u989d\u5916\u52a0\u6210-3"),h.setIcon(-1)),h.setLight(!0),this.node_goldApple||(this.node_goldApple=cc.instantiate(this.item),this.contentNode.addChild(this.node_goldApple),this.node_goldApple.y=this.node_giftApple.y-110),h=this.node_goldApple.getComponent("PowerUpItem"),e>4?(h.setLock(!1),h.setLable(c+"% \u91d1\u82f9\u679c",c),h.setIcon(4)):(h.setLock(!0),h.setLable("\u989d\u5916\u52a0\u6210-4"),h.setIcon(-1)),h.setLight(!1),this.node_videoApple||(this.node_videoApple=cc.instantiate(this.item),this.contentNode.addChild(this.node_videoApple),this.node_videoApple.y=this.node_goldApple.y-110),h=this.node_videoApple.getComponent("PowerUpItem"),e>5?(h.setLock(!1),h.setLable(r+"% \u770b\u5e7f\u544a\u83b7\u53d6\u7684\u82f9\u679c",r),h.setIcon(5)):(h.setLock(!0),h.setLable("\u989d\u5916\u52a0\u6210-5"),h.setIcon(-1)),h.setLight(!0),this.node_doubleXp||(this.node_doubleXp=cc.instantiate(this.item),this.contentNode.addChild(this.node_doubleXp),this.node_doubleXp.y=this.node_videoApple.y-110),h=this.node_doubleXp.getComponent("PowerUpItem"),e>6?(h.setLock(!1),h.setLable(l+"% \u53cc\u500d\u7ecf\u9a8c",l),h.setIcon(6)):(h.setLock(!0),h.setLable("\u989d\u5916\u52a0\u6210-6"),h.setIcon(-1)),h.setLight(!1)},onUpgrade:function(){}}),cc._RF.pop()},{PlayerLvData:"PlayerLvData",User:"User"}],PrizeData:[function(e,t){"use strict";cc._RF.push(t,"694f7QqA6JASbxi1sASACPl","PrizeData");var n=[{id:0,img:"prize_1",emoji:"\ud83e\udd64"},{id:1,img:"prize_2",emoji:"\ud83c\udf7a"},{id:2,img:"prize_3",emoji:"\ud83c\udf6b"},{id:3,img:"prize_4",emoji:"\ud83c\udf57"},{id:4,img:"prize_5",emoji:"\ud83c\udf54"},{id:5,img:"prize_6",emoji:"\ud83c\udf6d"}];t.exports={getData:function(e){return n[e]}},cc._RF.pop()},{}],ProtoGenerated:[function(e,t){"use strict";if(cc._RF.push(t,"66e7du2HsRMW7x4YQSpb2hV","ProtoGenerated"),window.protobuf){var n=protobuf.Root.fromJSON(JSON.parse('{"options": {"java_outer_classname": "PlayerNetMessage", "java_package": "game.ck.net.message"}, "nested": {"message": {"nested": {"BattleTimeoutNotice": {"fields": {}, "nested": {"Down": {"fields": {"timeoutOverDatas": {"type": "BattleOverInfo", "id": 1, "rule": "repeated"}}}}}, "FightOver": {"fields": {}, "nested": {"Down": {"fields": {}}, "Up": {"fields": {"winId": {"type": "int64", "id": 2}, "datas": {"type": "int32", "id": 3, "rule": "repeated"}, "fightId": {"type": "int64", "id": 1}, "round": {"type": "int32", "id": 4}}}}}, "BattleLog": {"fields": {}, "nested": {"Down": {"fields": {"datas": {"type": "BattleLogInfo", "id": 1, "rule": "repeated"}}}, "Up": {"fields": {}}}}, "BattleInfo": {"fields": {"promoterPlayerId": {"type": "int64", "id": 6}, "contextId": {"type": "string", "id": 4}, "fightId": {"type": "int64", "id": 1}, "stake": {"type": "int32", "id": 8}, "round": {"type": "int32", "id": 7}, "leftTime": {"type": "int32", "id": 3}, "opponentPlayerId": {"type": "int64", "id": 13}, "lastActTime": {"type": "int32", "id": 15}, "myDatas": {"type": "int32", "id": 10, "rule": "repeated"}, "cdata": {"type": "string", "id": 14}, "opponentDatas": {"type": "int32", "id": 11, "rule": "repeated"}, "anotherChance": {"type": "bool", "id": 9}, "createTime": {"type": "int32", "id": 2}, "opponentFacebookId": {"type": "string", "id": 5}, "turnPlayerId": {"type": "int64", "id": 12}}}, "UpdateBattleNotice": {"fields": {}, "nested": {"Down": {"fields": {"items": {"type": "BattleInfo", "id": 1, "rule": "repeated"}}}}}, "Ping": {"fields": {}, "nested": {"Down": {"fields": {"upTime": {"type": "int32", "id": 1}, "time": {"type": "int32", "id": 2}}}, "Up": {"fields": {"upTime": {"type": "int32", "id": 1}}}}}, "FightWithFriend": {"fields": {}, "nested": {"Down": {"fields": {"sign": {"type": "string", "id": 2}}}, "Up": {"fields": {"contextId": {"type": "string", "id": 2}, "stake": {"type": "int32", "id": 3}, "cdata": {"type": "string", "id": 6}, "facebookId": {"type": "string", "id": 1}, "anotherChance": {"type": "bool", "id": 5}, "datas": {"type": "int32", "id": 4, "rule": "repeated"}}}}}, "NewBattleLogNotice": {"fields": {}, "nested": {"Down": {"fields": {"count": {"type": "int32", "id": 1}}}}}, "LoadPlayer": {"fields": {}, "nested": {"Down": {"fields": {"playerId": {"type": "int64", "id": 1}, "newBattlelog": {"type": "int32", "id": 5}, "timeoutOverDatas": {"type": "BattleOverInfo", "id": 3, "rule": "repeated"}, "fightId": {"type": "int64", "id": 4}, "datas": {"type": "BattleInfo", "id": 2, "rule": "repeated"}}}, "Up": {"fields": {"serverSign": {"type": "string", "id": 1}}}}}, "BattleOverInfo": {"fields": {"contextId": {"type": "string", "id": 2}, "winId": {"type": "int64", "id": 4}, "opponentFacebookId": {"type": "string", "id": 3}, "fightId": {"type": "int64", "id": 1}}}, "Version": {"fields": {}, "nested": {"Down": {"fields": {"version": {"type": "int32", "id": 1}, "time": {"type": "int32", "id": 2}}}, "Up": {"fields": {"version": {"type": "int32", "id": 1}}}}}, "DeleteBattleNotice": {"fields": {}, "nested": {"Down": {"fields": {"ids": {"type": "int64", "id": 1, "rule": "repeated"}}}}}, "BattleLogInfo": {"fields": {"promoterPlayerId": {"type": "int64", "id": 3}, "winId": {"type": "int64", "id": 9}, "stake": {"type": "int32", "id": 5}, "overTime": {"type": "int64", "id": 1}, "myDatas": {"type": "int32", "id": 7, "rule": "repeated"}, "timeout": {"type": "bool", "id": 10}, "opponentDatas": {"type": "int32", "id": 8, "rule": "repeated"}, "round": {"type": "int32", "id": 6}, "opponentFacebookId": {"type": "string", "id": 2}, "opponentPlayerId": {"type": "int64", "id": 4}}}, "FightRound": {"fields": {}, "nested": {"Down": {"fields": {}}, "Up": {"fields": {"datas": {"type": "int32", "id": 3, "rule": "repeated"}, "useAnotherChance": {"type": "bool", "id": 2}, "fightId": {"type": "int64", "id": 1}, "round": {"type": "int32", "id": 4}}}}}, "Login": {"fields": {}, "nested": {"Down": {"fields": {}}, "Up": {"fields": {"account": {"type": "string", "id": 1}, "name": {"type": "string", "id": 6}, "ssl": {"type": "bool", "id": 4}, "signature": {"type": "string", "id": 3}, "facebookId": {"type": "string", "id": 5}, "serverId": {"type": "int32", "id": 2}, "headUrl": {"type": "string", "id": 7}}}}}, "TextNotice": {"fields": {}, "nested": {"Down": {"fields": {"msg": {"type": "string", "id": 1}}}}}}}}}'));protobuf.en=function(e,t){var i=n.lookup("message."+e);return i?i.encode(t).finish():null},protobuf.de=function(e,t){var i=n.lookup("message."+e);return i?i.decode(t):null}}else console.log("protobuf is not ready for use");cc._RF.pop()},{}],PushAPI:[function(e,t){"use strict";cc._RF.push(t,"95d17T/KNxGkI15ip3FP2UQ","PushAPI");var n=e("NetMgr"),i={removeNotice:function(e){n.removePush(e)},removeAllNotice:function(){n.removeAllPush()},SocketCloseNotice:function(e){return n.on("onclose",e)},TextNotice:function(e){return n.on("TextNotice",e)},UpdateBattleNotice:function(e){return n.on("UpdateBattleNotice",e)},DeleteBattleNotice:function(e){return n.on("DeleteBattleNotice",e)},BattleTimeoutNotice:function(e){return n.on("DeleteBattleNotice",e)},NewBattleLogNotice:function(e){return n.on("NewBattleLogNotice",e)}};t.exports=i,cc._RF.pop()},{NetMgr:"NetMgr"}],RankItem:[function(e,t){"use strict";cc._RF.push(t,"4be0ao3MSNKU7XWWLJg6LUI","RankItem");var n=e("KnifeData"),i=e("PageMgr"),o=e("Utils");cc.Class({extends:cc.Component,properties:{num1:cc.Node,num2:cc.Node,num3:cc.Node,playerRank:cc.Label,diban:cc.Node,friendBtn:cc.Node,playerSprite:cc.Sprite,playerName:cc.Label,playerScore:cc.Label,playerLevels:cc.Label,knifeSprite:cc.Sprite,defaultKnife:cc.SpriteFrame,defaultPeople:cc.SpriteFrame},onLoad:function(){},updateItem:function(e,t){this.colors=this.colors||["#ffd366","#7b9bb6","#c5753a"],this.itemId=e,this.data=t,this.reset(),this.friendBtn.active=t.isFriend&&t.playerId!=FBInstant.player.getID(),t.isFriend&&(this.friendBtn.off("click"),this.friendBtn.on("click",function(){console.log(t.playerId),FBInstant&&(i.showLoading(),FBInstant.context.createAsync(t.playerId).then(function(){o.playGame({isVS:!0,score:t.score})}).catch(function(e){e&&"SAME_CONTEXT"==e.code&&o.playGame({isVS:!0,score:t.score})}))})),this.num1.active=1==t.rank,this.num2.active=2==t.rank,this.num3.active=3==t.rank,this.playerRank.node.active=t.rank>3,this.playerRank.string=t.rank,FBInstant&&t.playerId!=FBInstant.player.getID()?(this.diban.opacity=178.5,this.diban.color=cc.color().fromHEX("#000000")):(this.diban.opacity=204,this.diban.color=cc.color().fromHEX("#3be0cb")),t.rank<=3?this.playerScore.node.color=cc.color().fromHEX(this.colors[t.rank-1]):this.playerScore.node.color=cc.color().fromHEX("#ffffff");var a=this;if(t.photo&&cc.loader.load(t.photo,function(e,n){e||a.data!=t||(a.playerSprite.spriteFrame=new cc.SpriteFrame(n),a.playerSprite.node.width=a.playerSprite.node.height=70)}),t.costomData){var s=JSON.parse(t.costomData);t.rank,a=this,s.knifeId&&cc.loader.loadRes("knife/"+n.getData(s.knifeId).img,function(e,t){e?console.log("error",e):a.knifeSprite.spriteFrame=new cc.SpriteFrame(t)})}this.playerName.string=t.nickName,t.isFriend?(this.playerScore.string="",this.playerLevels.string=t.score):(this.playerScore.string=t.score,this.playerLevels.string=t.costomData&&s.stageNum)},reset:function(){this.playerSprite.spriteFrame=this.defaultPeople,this.playerSprite.node.width=this.playerSprite.node.height=70,this.knifeSprite.spriteFrame=this.defaultKnife}}),cc._RF.pop()},{KnifeData:"KnifeData",PageMgr:"PageMgr",Utils:"Utils"}],RankPage:[function(e,t){"use strict";cc._RF.push(t,"c9ccahVoZVI45CNbZq1F/C8","RankPage"),e("User"),e("AdHelper");var n=e("PageMgr");e("Utils"),cc.Class({extends:cc.Component,properties:{subContextNode:cc.Node},onLoad:function(){this.callBack=null,this.subContextNode.active=!1},onEnable:function(){var e=this.subContextNode.children[0].getComponent(cc.SubContextView);this.subContextNode.active=!0,window.platfromMgr.showFriendRank("endless",this.subContextNode.width,this.subContextNode.height),e.updateSubContextViewport(),e.reset(),this.scheduleOnce(function(){e.updateSubContextViewport(),e.reset()})},onClickedClose:function(){this.subContextNode.active=!1,n.hideDialog(n.RANK),null!=this.callBack&&(this.callBack(),this.callBack=null)},onUpdateData:function(e){null!=e&&(this.callBack=e.callBack)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],ResultDialog:[function(e,t){"use strict";cc._RF.push(t,"e44a5Yu64FJRaBxR0NYWQW7","ResultDialog");var n=e("AdHelper"),i=e("PageMgr"),o=e("SoundMgr"),a=e("Utils"),s=e("User"),c=e("SloteList"),r=e("SlotData"),l=(e("TaskMgr"),e("ListView"));cc.Class({extends:cc.Component,properties:{knifeCount:cc.Label,diamonLabel:cc.Label,fenxiang:cc.Node,shareNode:cc.Node,shareResultNode:cc.Node,playerImg:cc.Sprite,playerImg2:cc.Sprite,playerImg3:cc.Sprite,otherPlayerImg:cc.Sprite,playerScore:cc.Label,playerScore2:cc.Label,playerResultScore1:cc.Label,playerResultScore2:cc.Label,playerName:cc.Label,bestNode:cc.Node,normalNode:cc.Node,itemPrefab:cc.Prefab,getTipNode:cc.Node,touchMask:cc.Node,slotGroup:cc.Node,spinSwitcher:cc.Animation,spinVideoIcon:cc.Node,spinNoVideo:cc.Node,spinBtn:cc.Button,spinList1:c,spinList2:c,spinList3:c,flyingApple:cc.Node,flyingGoldApple:cc.Node,giftNode:cc.Node,rankList:l,subContextNode:cc.Node},onLoad:function(){},showSpinAnim:function(){var e=this.giftNode.getChildByName("result_spin");this.giftNode.stopAllActions(),e.stopAllActions(),this.giftNode.runAction(cc.sequence(cc.moveTo(.2,cc.winSize.width/2,this.giftNode.y),cc.callFunc(function(){e.runAction(cc.repeatForever(cc.rotateBy(1,20)))})))},onPayPage:function(){n.logEvent("pay_resultshop_click",{payState:s.get().isPayReady()?"YES":"NO"}),i.showDialogAsync(i.PAYSHOP)},onGiftClick:function(){n.logEvent("result_turntable_click"),this.giftNode.active=!1,i.getPageAsync(i.GAMESPIN).then(function(e){i.showLoading(),e.getComponent(i.GAMESPIN).preLoad(function(){i.showDialog(i.GAMESPIN,!0),i.hideLoading(),i.hidePage(i.RESULT)})}).catch(function(){})},onRestart:function(){a.playGame({isVS:!1})},onShowAd:function(e){var t=this;e.currentTarget.active=!1,n.isVideoLoad()?n.showVideoAd(function(){t.showGetGift()},function(){}):n.isInterstitialLoad(),n.logEvent("result_adclick",{isDouble:this.isDoubleApple,type:"reward"})},showGetGift:function(){var e=s.get().addAdDiamon(this.isDoubleApple);this.diamonLabel.string=s.get().getDiamonCount(),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(e),i.showDialog(i.GIFTPAGE,!0)},onInvite:function(e){var t=this;e.currentTarget.active=!1,i.showLoading(),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(e,o){e?i.hideLoading():a.getImageAsync("InviteScreen",function(e){e.getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)}).then(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"PLAY NOW",template:"invite_result",text:"This \ud83c\udfaf game is awesome! You should try it!\ud83d\ude1d",image:e,data:{from:"invite_result"},strategy:"IMMEDIATE",notification:"PUSH"}).then(function(){t.showGetGift(),n.logEvent("result_invite_finish"),i.hideLoading()}).catch(function(e){console.log("updateAsync err",e),i.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),i.hideLoading()})})}).catch(function(e){console.log("chooseAsync err",e),i.hideLoading(),"SAME_CONTEXT"==e.code&&(i.getPage(i.INVITETINVALID).getChildByName("timer").getComponent(cc.Label).string="LATER",i.showDialog(i.INVITETINVALID,!0))}),n.logEvent("result_inviteclick")},onShare:function(){this.shareNode.active=!0,a.captureScreen(this.shareNode,960,500,function(e){FBInstant&&FBInstant.shareAsync({intent:"SHARE",image:e,text:this.isBest?FBInstant.player.getName()+" set a new personal best in Last Knife":"Can you beat my score in Last Knife ?",data:{myReplayData:"data",from:"result_share"}}).then(function(){console.log("share success")}).catch(function(e){console.log("err",e)})}.bind(this)),this.shareNode.active=!1},onEnable:function(){var e=this;this.giftNode.active=s.get().isGiftAvailable(),this.giftNode.x=cc.winSize.width/2+200,n.isVideoLoad()||n.logEvent("result_noads",{isSupport:n.isSupporteVideo()?1:0,count:n.getVideoLoadedCount()});var t=this.getComponent(cc.Animation);t.once("finished",function(){var t=e.data;FBInstant&&"SOLO"!=FBInstant.context.getType()&&t.isVS&&i.showTip("Sending score...",function(){this.sendMessageToFb()}.bind(e),-cc.winSize.height/2+30),e.showSpinAnim(),s.get().subscribeBot()}),t.play("resultIPageIn"),o.play(o.GAME_OVER),n.logEvent("result_show",{isDouble:this.isDoubleApple});var a=n.isVideoLoad()||n.isInterstitialLoad();this.spinBtn.interactable=a,this.spinVideoIcon.active=a,this.spinList1.node.opacity=this.spinVideoIcon.active?0:255,this.spinNoVideo.active=!this.spinBtn.interactable,this.spinList1.setCurrentIndex(1),this.spinList2.setCurrentIndex(0),this.spinList3.setCurrentIndex(2),this.spinList1.randomKnife(),this.spinList2.randomKnife(),this.isFirstPlay?(this.spinBtn.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.2),cc.scaleTo(.5,1)))),this.isFirstPlay=!1):(this.spinBtn.node.scale=1,this.spinBtn.node.stopAllActions(),this.spinList3.randomKnife(),this.giftNode.active||(setTimeout(function(){e.spinList1.idleScroll()},10),setTimeout(function(){e.spinList2.idleScroll(2)},200),setTimeout(function(){e.spinList3.idleScroll()},400)));var c=(Math.floor(Date.now()/1e3)-1541077200)%86400;c>0&&c<300&&n.logEvent("online_count_hight"),c>32400&&c<32700&&n.logEvent("online_count_low"),this.requstRank()},sendMessageToFb:function(){var e=this,t=this.data,n=960,o=500,c=(FBInstant.getEntryPointData(),function(){i.showTip("Score sent!",null,-cc.winSize.height/2+30,!0),setTimeout(function(){i.hideTip()},1e3)});if(t.playerCount>2)s.get().updateGroupRank(t.knifeCount,c);else if(t.opponentScore&&t.opponentScore>0){n*=this.shareResultNode.scale,o*=this.shareResultNode.scale;var r=FBInstant.player.getName()+" win",l=FBInstant.player.getID();t.opponentScore>t.knifeCount?(r=t.otherPlayerName+" win",l=t.otherPlayerId):t.opponentScore==t.knifeCount&&(r="Draw");var h=r+"! Click to collect "+t.rewardCount+"\ud83c\udf4e\ud83c\udf4e\ud83c\udf4e";this.playerResultScore2.string=t.opponentScore,this.shareResultNode.getChildByName("myhat").active=t.opponentScore<t.knifeCount,this.shareResultNode.getChildByName("oherhat").active=t.opponentScore>t.knifeCount,cc.loader.load(t.otherPlayerPhoto,function(e,i){var s=this;e||(this.otherPlayerImg.spriteFrame=new cc.SpriteFrame(i),setTimeout(function(){s.shareResultNode.active=!0,a.captureScreen(s.shareResultNode,n,o,function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Start New Match",template:"play_turn",text:h,image:e,data:{from:"challenge_result",vsType:"end",winId:l,battleId:t.battleId,rewardCount:t.rewardCount,playerId:t.otherPlayerId,playerName:t.otherPlayerName,playerPhoto:t.otherPlayerPhoto,score:t.knifeCount,otherScore:t.opponentScore,otherPlayerId:FBInstant.player.getID(),otherPlayerName:FBInstant.player.getName(),otherPlayerPhoto:FBInstant.player.getPhoto()},strategy:"IMMEDIATE",notification:"PUSH"}).then(c,c)}.bind(s)),s.shareResultNode.active=!1},0))}.bind(this))}else{var d=this.resultType||"challenge";this.resultType=null,setTimeout(function(){e.shareNode.active=!0,a.captureScreen(e.shareNode,n,o,function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"CHALLENGE",template:"play_turn",text:FBInstant.player.getName()+" has challenged you to a match of Last Knife !",image:e,data:{playerId:FBInstant.player.getID(),otherPlayerName:FBInstant.player.getName(),stageNum:t.stageNum,knifeCount:t.knifeCount,otherPlayerPhoto:FBInstant.player.getPhoto(),from:d,battleId:Date.now(),rewardCount:t.rewardCount,vsType:"start"},strategy:"IMMEDIATE",notification:"PUSH"}).then(c,c)}.bind(e)),e.shareNode.active=!1},0)}},updateData:function(e){this.data=e,window.lastScore=e.knifeCount,this.knifeCount.string=e.knifeCount,this.diamonLabel.string=e.diamonCount,s.get().updateScoreAndStage(e.knifeCount,e.stageNum),this.showFriendInfo()},showFriendInfo:function(){this.subContextNode.active=!0;var e=this.subContextNode.children[0].getComponent(cc.SubContextView);window.platfromMgr.showFriendRank("endless",this.subContextNode.width,this.subContextNode.height,1),e.reset(),e.updateSubContextViewport(),this.scheduleOnce(function(){e.updateSubContextViewport(),e.reset()})},updateRankLocal:function(e){if(e=e||this.data.knifeCount||0,this.listData){this.listData.find(function(e){return FBInstant&&FBInstant.player.getID()==e.playerId});for(var t=0;t<this.listData.length;t++){var n=this.listData.splice(a.randomInt(this.listData.length),1)[0];this.listData.push(n)}for(var i=0;i<this.listData.length;i++)this.listData[i].rank=i+1}},requstRank:function(){var e=this;if(!this.listData){var t=[];s.get().getConnectedPlayersAsync(function(n){var i=function(){var e=!1,i=n[o].getID();t.forEach(function(t){t.playerId==i&&(e=!0)}),e||t.push({playerId:i,photo:n[o].getPhoto(),nickName:n[o].getName(),rank:t.length+1,fbRank:0,score:0,isFriend:!0})};for(var o in n)i();if(window.FBInstant){FBInstant.player.getID();t.forEach(function(e){e.playerId})}e.listData=t,e.listData.forEach(function(e){e.rewardCount=a.randomInt(50)+50}),e.updateRankLocal()})}},onJumpGame:function(){n.logEvent("switch_game_click"),window.FBInstant&&FBInstant.switchGameAsync("435134576951080",{from:"lastknife"}).then(function(){n.logEvent("switch_game_success",{game:"ninjago"})}).catch(function(e){console.log(e)})},showGetTip:function(e,t,n){var i=this;this.touchMask.active=!0,s.get().addDiamon(e);var o=n.convertToWorldSpace(cc.p(0,0)),a=this.node.convertToNodeSpace(o);this.getTipNode.active=!0,this.getTipNode.stopAllActions(),this.getTipNode.scale=0,this.getTipNode.y=0,this.getTipNode.x=a.x-200,this.getTipNode.opacity=255,this.getTipNode.getChildByName("label").getComponent(cc.Label).string="+"+e,this.getTipNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(1),cc.spawn(cc.fadeOut(.5),cc.moveBy(.5,0,50)),cc.callFunc(function(){i.touchMask.active=!1,t()})))},setType:function(e){this.resultType=e},onSpinSloto:function(){var e=this;this.spinBtn.node.scale=1,this.spinBtn.node.stopAllActions();var t="free";n.isVideoLoad()?(t="video",n.showVideoAd(function(){e.onSpinSloto_start()},function(){})):(i.showTip("\u6ca1\u6709\u5e7f\u544a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01",null,-200),setTimeout(function(){i.hideTip()},3e3)),n.logEvent("result_spin_click",{isFirst:this.isFirstPlay?"free":"ad",type:t})},onSpinSloto_start:function(){var e=this;o.play(o.SLOT_START);var t=Math.floor(Math.random()*r.length),a=r[t];n.logEvent("result_spin_random",{randomIndex:t});var c=a.slice();Math.random()>.8&&(c[Math.floor(Math.random()*c.length)]=10);var l=Math.floor(Math.random()*c.length),h=c.splice(l,1)[0];c.splice(Math.floor(Math.random()*c.length),0,h),this.isFirstPlay&&(c=[4,4,3],this.isFirstPlay=!1);for(var d=[],u=0;u<c.length;u++)d.indexOf(c[u])>=0?c[u]:d.push(c[u]);var p=2==d.length,g=1==d.length;this.spinBtn.interactable=!1,this.spinVideoIcon.active=!1,this.spinList1.node.opacity=255,this.spinSwitcher.play("resultslot"),this.spinSwitcher.once("finished",function(){e.spinList1.scorllToIndex(c[0],function(){o.play(o.SLOT_STOP)}),setTimeout(function(){e.spinList2.scorllToIndex(c[1],function(){o.play(o.SLOT_STOP)},1)},200),setTimeout(function(){e.spinList3.scorllToIndex(c[2],function(){o.play(o.SLOT_STOP),e.spinSwitcher.play("resultspinback"),p&&(o.play(o.SLOT_2),i.showTip("REWARD X2",null,-200),setTimeout(function(){i.hideTip()},3e3)),g&&(e.spinList1.showLightEffect(),e.spinList2.showLightEffect(),e.spinList3.showLightEffect(),o.play(o.SLOT_3),i.showTip("REWARD X3",null,-200),setTimeout(function(){i.hideTip()},3e3));setTimeout(function(){for(var t=0,n=-1,o=0;o<3;o++){var a=e["spinList"+(o+1)].getCurrentData();"knife"==a.type?n=a.id:t+=a.count*("apple"==a.type?2:4)}g?s.get().addDiamon(3*t):p?s.get().addDiamon(2*t):s.get().addDiamon(t),e.diamonLabel.string=s.get().getDiamonCount(),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(t,p,g,function(){n>0&&e.showKnifeGet(0,n)}),i.showDialog(i.GIFTPAGE,!0),e.spinBtn.interactable=!0},800)},2)},400)})},showAppleGet:function(e,t,n,i){var o=this,a=t?this.flyingApple:this.flyingGoldApple;a.active=!0,a.x=90*(e-1),a.y=-273,a.runAction(cc.sequence(cc.moveTo(.5,cc.p(268,530)),cc.callFunc(function(){a.active=!1,s.get().addDiamon(n),o.diamonLabel.string=s.get().getDiamonCount(),o.diamonLabel.node.runAction(cc.sequence(cc.scaleTo(.2,2),cc.scaleTo(.2,1),cc.callFunc(i)))})))},showKnifeGet:function(e,t,n){var o=i.getPage(i.SHOWINVITEKNIFE).getComponent("ShowInviteKnifeDialog");o.setKnifeInfo(t,""),o.registerOnClose(function(e,t){e&&i.getPage(i.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(t)),n&&n()}),i.showDialog(i.SHOWINVITEKNIFE)},onClickRank:function(){var e=this;this.subContextNode.active=!1,i.showDialogAsync("RankPage",{callBack:function(){console.log("\u6267\u884c\u56de\u8c03\u3002\u3002\u3002\u3002"),e.showFriendInfo()}})}}),cc._RF.pop()},{AdHelper:"AdHelper",ListView:"ListView",PageMgr:"PageMgr",SlotData:"SlotData",SloteList:"SloteList",SoundMgr:"SoundMgr",TaskMgr:"TaskMgr",User:"User",Utils:"Utils"}],ResultItem:[function(e,t){"use strict";cc._RF.push(t,"f88abvVwEVCGKBPZmC8xnR+","ResultItem");var n=e("PageMgr"),i=e("AdHelper");cc.Class({extends:cc.Component,properties:{playerSprite:cc.Sprite,playerName:cc.Label,btnText:cc.Label,appleNode:cc.Node,goldAppleNode:cc.Node,defaltFrame:cc.SpriteFrame,gameIcon:cc.Node},start:function(){},updateItem:function(e){var t=this;this.data=e,this.playerSprite.spriteFrame=this.defaltFrame,e.isInvite?(this.playerName.string="",this.btnText.string="+",this.goldAppleNode.active=2==this.data.appleState,this.appleNode.active=1==this.data.appleState,this.appleNode.x=-20,this.btnText.node.x=20,0==this.data.appleState&&(this.btnText.string="INVITE",this.btnText.node.x=0)):(this.playerName.string=e.nickName,this.btnText.string="PLAY",e.photo&&cc.loader.load(e.photo,function(n,i){n||t.data!=e||(t.playerSprite.spriteFrame=new cc.SpriteFrame(i))}),this.goldAppleNode.active=2==e.appleState,this.appleNode.active=1==e.appleState,this.appleNode.x=-39,0==e.appleState?this.btnText.node.x=0:this.btnText.node.x=20),this.gameIcon.active=e.isJumpGame},onPlayClick:function(){var e=this;if(this.data.isJumpGame)return i.logEvent("switch_game_click"),void(window.FBInstant&&FBInstant.switchGameAsync("435134576951080",{from:"lastknife"}).then(function(){i.logEvent("switch_game_success",{game:"ninjago"})}).catch(function(e){console.log(e)}));var t=function(){var t=e.node,n=e.node.parent,i=e.data.appleState>0;if(e.data.appleState=0,e.updateItem(e.data),e.node.removeFromParent(),n.addChild(t),t.active=!1,i)for(var o=Math.floor(3*Math.random()),a=0;a<3;a++){var s=n.children[a].getComponent("ResultItem");0==s.data.appleState&&o==a&&(s.data.appleState=Math.random()<.9?1:2,s.updateItem(s.data))}};FBInstant?this.data.playerId?(n.showLoading(),i.logEvent("friend_play_click",{appleState:this.data.appleState}),FBInstant.context.createAsync(this.data.playerId).then(function(){n.hideLoading(),n.getPage(n.GAMEMAIN).getComponent("GameMain").setPlay(!0);var o=n.getPage(n.RESULT).getComponent("ResultDialog");o.setType("friend_play"),e.data.appleState>0?o.showGetTip(10*e.data.appleState,function(){n.showPage(n.GAMEMAIN),t()},e.node):(n.showPage(n.GAMEMAIN),t()),i.logEvent("friend_play_click_success",{appleState:e.data.appleState})}).catch(function(e){"NETWORK_FAILURE"!=e.code&&"SAME_CONTEXT"!=e.code||(t(),n.getPage(n.RESULT).getComponent("ResultDialog").addFriendList()),n.hideLoading()})):(n.showLoading(),i.logEvent("friend_choose_show",{appleState:this.data.appleState}),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){n.getPage(n.GAMEMAIN).getComponent("GameMain").setPlay(!0);var o=n.getPage(n.RESULT).getComponent("ResultDialog");o.setType("friend_choose"),e.data.appleState>0?o.showGetTip(10*e.data.appleState,function(){n.showPage(n.GAMEMAIN),t()},e.node):(n.showPage(n.GAMEMAIN),t()),n.hideLoading(),i.logEvent("friend_choose_success",{appleState:e.data.appleState})},function(e){n.hideLoading(),i.logEvent("friend_choose_fail",{code:e.code})})):(n.getPage(n.GAMEMAIN).getComponent("GameMain").setPlay(!1),this.data.appleState>0?n.getPage(n.RESULT).getComponent("ResultDialog").showGetTip(20*this.data.appleState,function(){n.showPage(n.GAMEMAIN),t()},this.node):(n.showPage(n.GAMEMAIN),t()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr"}],ResultRankItem:[function(e,t){"use strict";cc._RF.push(t,"c86adtGWP9NW5+rH79uByi8","ResultRankItem");var n=e("Utils"),i=e("AdHelper"),o=e("PageMgr");cc.Class({extends:cc.Component,properties:{num1:cc.Node,num2:cc.Node,num3:cc.Node,playerRank:cc.Label,diban:cc.Node,friendBtn:cc.Node,playerSprite:cc.Sprite,playerName:cc.Label,playerScore:cc.Label,defaultPeople:cc.SpriteFrame,btnText:cc.Label,rewardLabel:cc.Label},onLoad:function(){},updateItem:function(e,t){var a=this;this.colors=this.colors||["#ffd366","#7b9bb6","#c5753a"],this.itemId=e,this.data=t,this.reset(),this.friendBtn.active=t.isFriend,this.btnText.string="PLAY",this.rewardLabel.string=t.rewardCount,FBInstant&&FBInstant.player.getID()==t.playerId&&(this.btnText.string="SHARE"),t.isFriend&&(this.friendBtn.off("click"),this.friendBtn.on("click",function(){if(console.log(t.playerId),FBInstant)if(o.showLoading(),FBInstant&&FBInstant.player.getID()==t.playerId)n.getShareImg(function(e){o.hideLoading(),FBInstant.shareAsync({intent:"SHARE",text:FBInstant.player.getName()+":Help!\ud83c\udfaf\ud83c\udfaf\ud83c\udfaf\ud83c\udfaf\ud83c\udfaf\ud83c\udfaf",image:e,data:{from:"result_share"}}).then(function(){i.logEvent("result_share_success"),o.hideLoading()}).catch(function(){o.hideLoading()})});else{i.logEvent("friend_play_click");var e=function(){n.playGame({isVS:!0,score:0,rewardCount:a.data.rewardCount}),i.autoShowAd()};FBInstant.context.createAsync(t.playerId).then(function(){o.hideLoading(),e(),i.logEvent("friend_play_click_success")}).catch(function(t){o.hideLoading(),t&&"SAME_CONTEXT"==t.code&&e()})}else n.playGame({isVS:!0,score:0,rewardCount:a.data.rewardCount})})),this.num1.active=1==t.rank,this.num2.active=2==t.rank,this.num3.active=3==t.rank,this.playerRank.node.active=t.rank>3,this.playerRank.string=t.rank,this.diban.active=t.rank%2==1,t.rank<=3?this.playerScore.node.color=cc.hexToColor(this.colors[t.rank-1]):this.playerScore.node.color=cc.hexToColor("#ffffff");var s=this;t.photo&&cc.loader.load(t.photo,function(e,n){e||s.data!=t||(s.playerSprite.spriteFrame=new cc.SpriteFrame(n),s.playerSprite.node.width=s.playerSprite.node.height=70)}),this.playerName.string=t.nickName,this.playerScore.string=t.score},reset:function(){this.playerSprite.spriteFrame=this.defaultPeople}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",Utils:"Utils"}],RoundDao:[function(e,t){"use strict";cc._RF.push(t,"049f4uT5rdI2a4YhUcjqAav","RoundDao"),cc.Class({extends:cc.Component,properties:{black:cc.Sprite,white:cc.Sprite,flag:cc.Sprite},onLoad:function(){this.mode="black"},start:function(){},setMode:function(e){this.mode=e,this.black.node.active="black"==this.mode,this.white.node.active="white"==this.mode,this.flag.node.active="flag"==this.mode,"flag"==this.mode&&(this.flag.node.active=!0,this.black.node.active=!0)}}),cc._RF.pop()},{}],RoundItem:[function(e,t){"use strict";cc._RF.push(t,"b7b23+Pgt1MHYHIkw8odI3b","RoundItem"),cc.Class({extends:cc.Component,properties:{play_head:cc.Sprite,dao1:cc.Node,dao2:cc.Node,dao3:cc.Node,dao4:cc.Node,dao5:cc.Node,dao6:cc.Node,dao7:cc.Node,dao8:cc.Node,dao9:cc.Node,dao10:cc.Node},onLoad:function(){this.daos=[this.dao1,this.dao2,this.dao3,this.dao4,this.dao5,this.dao6,this.dao7,this.dao8,this.dao9,this.dao10]},start:function(){},setLoseIndex:function(e){for(var t=0;t<this.daos.length;t++){var n=this.daos[t].getComponent("RoundDao");t<=e?n.setMode("black"):n.setMode("none")}},setTurn:function(e,t){e-=1;for(var n=[0,4,7,9],i=[4,7,9,10],o=[4,7,9,10],a=0;a<this.daos.length;a++){var s=this.daos[a].getComponent("RoundDao");a<o[e]?a<i[e]&&a>=n[e]&&t?s.setMode("white"):s.setMode("black"):s.setMode("none")}},setData:function(e,t,n){n>=0?(this.setLoseIndex(e),t&&this.daos[e].getComponent("RoundDao").setMode("flag")):this.setTurn(e,t)},setHead:function(e){this.play_head.spriteFrame=e}}),cc._RF.pop()},{}],SettingDialog:[function(e,t){"use strict";cc._RF.push(t,"f714cyvQbpAg6UK0nXQaIkc","SettingDialog");var n=e("SoundMgr"),i=e("PageMgr"),o=e("User");cc.Class({extends:cc.Component,properties:{sound_cx:{default:null,type:cc.Toggle},lefthand_cx:{default:null,type:cc.Toggle}},start:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){e.count++,20==e.count&&(o.get().clearData(),i.showTip("\u6570\u636e\u6e05\u9664\uff0c\u5173\u95ed\u91cd\u542f"))})},onEnable:function(){this.count=0,this.lefthand_cx.isChecked=o.get().getDir(),this.sound_cx.isChecked=n.isSoundEnable()},onSound:function(e){n.setSoundEnable(e.target.parent.getComponent(cc.Toggle).isChecked)},onLeftHand:function(e){o.get().setDir(e.target.parent.getComponent(cc.Toggle).isChecked)}}),cc._RF.pop()},{PageMgr:"PageMgr",SoundMgr:"SoundMgr",User:"User"}],ShopData:[function(e,t){"use strict";cc._RF.push(t,"320b0rQVZRAvJq2j27rCKOO","ShopData");var n=[{type:"apple",title:"\u82f9\u679c\u83b7\u5f97",color:"#294d6d",data:[33,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,56,57,58,59]},{type:"apple",title:"\u82f9\u679c\u83b7\u5f97",color:"#396884",data:[60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79]},{type:"video",title:"\u5e7f\u544a\u83b7\u5f97",color:"#53468e",data:[80,81,82,83,84,85,86,87,24,25,26,27,28,29,30,31,16,17,18,19]},{type:"video",title:"\u5e7f\u544a\u83b7\u5f97",color:"#53468e",data:[20,21,22,23,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119]},{type:"boss",title:"\u51fb\u8d25boss\u83b7\u5f97",color:"#E4462D",data:[46,35,36,53,52,54,38,49,48,45,50,55,51,34,47,39,40,141,151,149]},{type:"boss",title:"\u51fb\u8d25boss\u83b7\u5f97",color:"#E4462D",data:[41,142,144,148,136,137,146,150,140,143,152,153,145,146,120,121,122,123,124,125]},{type:"boss",title:"\u51fb\u8d25boss\u83b7\u5f97",color:"#E4462D",data:[126,127,128,37,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]}];t.exports={getData:function(e){return n[e-1]},getPageLength:function(){return n.length}},cc._RF.pop()},{}],ShopDialog:[function(e,t){"use strict";cc._RF.push(t,"f760fz/Aw9FLavqRTw3FKsM","ShopDialog");var n=e("User"),i=e("Utils"),o=e("AdHelper"),a=e("KnifeData"),s=e("TargetData"),c=e("ShopData"),r=e("PageMgr");cc.Class({extends:cc.Component,properties:{pageView:cc.PageView,diamonLabel:cc.Label,titleNode:cc.Node,titleLabel:cc.Label,bassInfo:cc.Node,itemPrefab:cc.Prefab,showKnife:cc.Sprite,costLabel:cc.Label,unlockBtn:cc.Node,videoBtn:cc.Node,sweetBtn:cc.Node,sweetLabel:cc.Label,candyCountLabel:cc.Label,videoLeft:cc.Label,videoInfo:cc.Node,videoKnifeLabel:cc.Label,inviteFriendNode:cc.Node,inviteLabel:cc.Label,halloweenTopBar:cc.Node},init:function(){this.curPageIndex=0,this.lastSelectItem=null,this.curKnifeData=0,this.isClickEnabled=!0},onLoad:function(){this.init(),this.showKnife.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(1,1.2),cc.scaleTo(1,1))))},onEnable:function(){this.isShowAd=!1,this.curKnifePageIndex&&this.pageView.setCurrentPageIndex(this.curKnifePageIndex)},updateItem:function(e,t,i){var o=n.get().isKnifeUnlock(t.id),a=o?"knife/":"shadows/",s=this;cc.loader.loadRes(a+t.img,function(n,o){n?console.log("error",n):(e.getChildByName("knife").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),e.getChildByName("knife").scale=.5,i&&(s.showKnife.spriteFrame=new cc.SpriteFrame(o),s.onItemClick(-1,e,t)),e.emit("load_finish"))}),o&&(e.getChildByName("knife").color=cc.Color.WHITE),e.getChildByName("greenbg").active=n.get().isKnifeUnlock(t.id),this.node.getChildByName("GuanLight").opacity=o?255:100},start:function(){var e=this,t=this.pageView.getPages(),i=n.get().getCurKnife(),o=0,l=-1;r.showLoading();for(var h=0;h<c.getPageLength();h++)for(var d=0;d<20;d++){var u=c.getData(h+1),p=u.data[d],g=a.getData(p),f=g&&g.id||"",m=this.getItemByData(g,i==f);i==f&&(l=h),m.on("load_finish",function(e){o++,e.off("load_finish"),16==o&&r.hideLoading()}.bind(null,m)),m.dataIndex=f;var v=n.get().isKnifeUnlock(f);if(f&&!v)if(g.boss_id&&g.boss_id>0){var y=s.getData(g.boss_id);m.getChildByName("knife").color=m.getChildByName("knife").color.fromHEX(["#e4462d","#fce352","#a750f5"][y.bossLv])}else u.color&&(m.getChildByName("knife").color=m.getChildByName("knife").color.fromHEX(u.color));m.getChildByName("defaultknife").color=cc.color().fromHEX(u.color),m.on("click",this.onItemClick.bind(this,d,m,g));var I=Math.floor(d/4),_=d%4;m.x=110*(_-2+.5),m.y=110*(2.5-I-.5),t[h].addChild(m),l<0&&(l=0,this.onItemClick(-1,m,g))}this.curKnifePageIndex=l,setTimeout(function(){e.pageView.setCurrentPageIndex(l)},0)},onItemClick:function(e,t,i){if(console.log("data",i),!i)return r.showTip("\u656c\u8bf7\u671f\u5f85"),void setTimeout(function(){r.hideTip()},1e3);if(this.isClickEnabled){this.curKnifeData=i;var o=n.get().isKnifeUnlock(i.id),a=i.price&&i.price>0,c=i.boss_id&&i.boss_id>0,l=i.ad_num&&i.ad_num>0,h=i.friend_num&&i.friend_num>0;if(this.sweetBtn.active=i.isHalloween&&!c,i.isHalloween&&(a=!1),this.unlockBtn.active=!o&&a,this.videoBtn.active=!o&&l,this.inviteFriendNode.active=!o&&h,this.curKnifeData.friend_num&&(this.inviteLabel.string="INVITE("+n.get().getFriendsCount(this.curKnifeData.id)+"/"+this.curKnifeData.friend_num+")"),l&&(this.videoLeft.string=i.ad_num-n.get().getVideoWatchCount(i.id)),this.costLabel.string=i.price,this.sweetLabel.string=i.price,o&&(n.get().setCurKnife(i.id),r.getPage(r.GAMEMAIN).getComponent("GameMain").setKnifeTempLate(cc.instantiate(t.getChildByName("knife")))),this.node.getChildByName("GuanLight").opacity=o?255:100,t==this.lastSelectItem&&o&&e>=0)r.showPage(r.HOME);else{if(this.lastSelectItem&&(this.lastSelectItem.getChildByName("select").active=!1),t.getChildByName("select").active=!0,this.lastSelectItem=t,this.bassInfo.active=c,c){var d=s.getData(i.boss_id),u=this.bassInfo.getChildByName("bossLabel").getComponent(cc.Label);u.string=d.name,u.node.color=cc.color().fromHEX(["#e4462d","#fce352","#a750f5"][d.bossLv]),this.bassInfo.getChildByName("rare").active=1==d.bossLv,this.bassInfo.getChildByName("legengary").active=2==d.bossLv,o?(u.node.color=cc.color().fromHEX("#ffffff"),this.bassInfo.getChildByName("xiaodao boss").color=cc.color().fromHEX("#219256"),this.bassInfo.getChildByName("label").color=cc.color().fromHEX("#219256")):(this.bassInfo.getChildByName("xiaodao boss").color=cc.color().fromHEX("#ffffff"),this.bassInfo.getChildByName("label").color=cc.color().fromHEX("#ffffff"))}this.showKnife.spriteFrame=t.getChildByName("knife").getComponent(cc.Sprite).spriteFrame,this.curKnifePageIndex=this.pageView.getCurrentPageIndex()}}},getItemByData:function(e,t){var n=cc.instantiate(this.itemPrefab);return e?(this.updateItem(n,e,t),n.getChildByName("select").active=t):n.getChildByName("defaultknife").active=!0,t&&(this.lastSelectItem&&(this.lastSelectItem.getChildByName("select").active=!1),this.lastSelectItem=n),n},onPageTurn:function(){this.curPageIndex=this.pageView.getCurrentPageIndex();var e=c.getData(this.curPageIndex+1),t=e.type;this.videoInfo.active="video"==t,"apple"!=t&&(this.inviteFriendNode.active="apple"==t),"boss"!=t&&(this.bassInfo.active=0==t),this.halloweenTopBar.active="halloween"==t,this.titleLabel.string=e.title,this.titleNode.color=cc.color().fromHEX(e.color)},onInviteFriend:function(){var e=this,t=function(){n.get().addFriendsCount(e.curKnifeData.id),n.get().getFriendsCount(e.curKnifeData.id)>=e.curKnifeData.friend_num&&(n.get().unlockKnife(e.curKnifeData.id,0),e.updateItem(e.lastSelectItem,e.curKnifeData,!0),e.unlockBtn.active=!1,e.inviteFriendNode.active=!1),e.inviteLabel.string="INVITE("+n.get().getFriendsCount(e.curKnifeData.id)+"/"+e.curKnifeData.friend_num+")"};FBInstant?(r.showLoading("",!0),o.logEvent("shop_invite_click"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){cc.loader.load(FBInstant.player.getPhoto(),function(e,n){e?r.hideLoading():i.getImageAsync("InviteScreen",function(e){e.getChildByName("photo").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)}).then(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"shop_invite_knife",text:"This \ud83c\udfaf game is awesome! You should try it!\ud83d\ude1d",image:e,data:{from:"shop_invite"},strategy:"IMMEDIATE",notification:"PUSH"}).then(function(){t(),o.logEvent("shop_invite_finish"),r.hideLoading()}).catch(function(e){console.log("updateAsync err",e),r.hideLoading()})}).catch(function(e){console.log("getImageAsync err",e),r.hideLoading()})})}).catch(function(e){console.log("chooseAsync err",e),r.hideLoading()})):t()},onUnlock:function(e){if(n.get().getDiamonCount()>=this.curKnifeData.price)n.get().unlockKnife(this.curKnifeData.id,this.curKnifeData.price),n.get().setCurKnife(this.curKnifeData.id),this.updateItem(this.lastSelectItem,this.curKnifeData,!0),this.unlockBtn.active=!1;else{var t=cc.instantiate(this.node.getChildByName("tipNode"));t.active=!0,t.x=e.currentTarget.x,t.y=e.currentTarget.y+50,t.width=300,t.runAction(cc.spawn(cc.moveBy(1,0,50),cc.fadeOut(1))),this.node.addChild(t)}},onWatchVideo:function(e){var t=this;e.currentTarget.getComponent(cc.Button).interactable=!1,o.showVideoAd(function(){e.currentTarget.getComponent(cc.Button).interactable=!0;var i=t.curKnifeData.id;if(n.get().addWatchVideoCount(i),n.get().getVideoWatchCount(i)==t.curKnifeData.ad_num)n.get().unlockKnife(t.curKnifeData.id,0,!1,!0),n.get().setCurKnife(t.curKnifeData.id),t.updateItem(t.lastSelectItem,t.curKnifeData,!0),t.videoBtn.active=!1;else{t.videoLeft.string=t.curKnifeData.ad_num-n.get().getVideoWatchCount(i);var o=cc.instantiate(t.node.getChildByName("tipNode"));o.active=!0,o.x=e.currentTarget.x,o.y=e.currentTarget.y+50,o.getComponent(cc.Label).string="-1",o.runAction(cc.spawn(cc.moveBy(1,0,50),cc.fadeOut(1))),t.node.addChild(o)}},function(){e.currentTarget.getComponent(cc.Button).interactable=!0})},onSweetBuy:function(e){if(n.get().getSweetCount()>=this.curKnifeData.price)n.get().unlockHalloweenKnife(this.curKnifeData.id,this.curKnifeData.price),n.get().setCurKnife(this.curKnifeData.id),this.updateItem(this.lastSelectItem,this.curKnifeData,!0),this.sweetBtn.active=!1;else{var t=cc.instantiate(this.node.getChildByName("tipNode"));t.active=!0,t.x=e.currentTarget.x,t.y=e.currentTarget.y+50,t.width=300,t.getComponent(cc.Label).string="NOT ENOUGH CANDY",t.runAction(cc.spawn(cc.moveBy(1,0,50),cc.fadeOut(1))),this.node.addChild(t)}},update:function(){this.diamonLabel.string=n.get().getDiamonCount(),this.candyCountLabel.string=n.get().getSweetCount(),this.videoKnifeLabel.string=n.get().getUnlockVideoCount()+"/32",this.isShowAd||(this.videoBtn.getComponent(cc.Button).interactable=o.isVideoLoad())}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",PageMgr:"PageMgr",ShopData:"ShopData",TargetData:"TargetData",User:"User",Utils:"Utils"}],ShowInviteKnifeDialog:[function(e,t){"use strict";cc._RF.push(t,"fda61zLXPFPHYLHmv/nUyOC","ShowInviteKnifeDialog");var n=e("KnifeData"),i=e("User");cc.Class({extends:cc.Component,properties:{info:cc.Label,knifeSprite:cc.Sprite},start:function(){},setKnifeInfo:function(e,t){this.knifeId=e;var i=this,o=n.getData(this.knifeId);this.info.string=t,cc.loader.loadRes("knife/"+o.img,function(e,t){e?console.log("error",e):i.knifeSprite.spriteFrame=new cc.SpriteFrame(t)})},equip:function(){i.get().setCurKnife(this.knifeId),this.onClosed(!0,this.knifeSprite.node)},registerOnClose:function(e){this.onClosed=e},onClose:function(){this.onClosed(!1)}}),cc._RF.pop()},{KnifeData:"KnifeData",User:"User"}],ShowKnifeDialog:[function(e,t){"use strict";cc._RF.push(t,"e60bbRJRAZAyb2i8Cl5rvtR","ShowKnifeDialog");var n=e("KnifeData"),i=e("User"),o=e("AdHelper"),a=e("PageMgr"),s=e("Utils");cc.Class({extends:cc.Component,properties:{bossName:cc.Label,knifeSprite:cc.Sprite,unlockNode:cc.Node,equipBtn:cc.Node,inviteBtn:cc.Node,adBtn:cc.Node,skipBtn:cc.Node},setKnifeInfo:function(e,t,i){this.knifeId=e.drop,this.bossName.string=e.name||"";var a=this,s=n.getData(this.knifeId);t?a.knifeSprite.spriteFrame=new cc.SpriteFrame(t):cc.loader.loadRes("knife/"+s.img,function(e,t){e?console.log("error",e):a.knifeSprite.spriteFrame=new cc.SpriteFrame(t)}),this.unlockNode.active=i,this.equipBtn.active=i,this.adBtn.active=!i&&o.isVideoLoad(),this.inviteBtn.active=!i&&!this.adBtn.active,this.skipBtn.active=this.adBtn.active,i||o.logEvent("knife_invite_show",{isAd:this.adBtn.active?1:0})},equip:function(){this.equipBtn.stopAllActions(),i.get().setCurKnife(this.knifeId),this.onClosed(!0,this.knifeSprite.node),a.hideDialog(a.SHOWKNIFE)},equip_adinvite:function(){o.logEvent("unlock_invite_finish"),i.get().unlockKnife(this.knifeId,0,!0),this.unlockNode.active=!0,this.equipBtn.active=!0,this.inviteBtn.active=!1,this.equip(),a.hideDialog(a.SHOWKNIFE)},onBuyKnife:function(){i.get().unlockKnife(this.knifeId,50,!0),this.equip(),a.hideDialog(a.SHOWKNIFE)},onInvite_:function(){var e=this;o.logEvent("unlock_invite_click");var t=function(){e.equip_adinvite(),a.hideLoading()};if(window.FBInstant){var n=function(){FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(t).catch(function(e){console.log("chooseAsync err",e),a.hideLoading(),"SAME_CONTEXT"==e.code&&(a.getPage(a.INVITETINVALID).getChildByName("timer").getComponent(cc.Label).string="LATER",a.showDialog(a.INVITETINVALID,!0))})};a.showLoading(),s.getShareImg(function(e){FBInstant.updateAsync({action:"CUSTOM",cta:"Play",template:"play_turn",text:"hey\uff0c"+FBInstant.player.getName()+"  is waiting for you\uff01",image:e,data:{from:"continue_invite"},strategy:"IMMEDIATE",notification:"PUSH"}).then(n).catch(n)})}else t()},onAdClick:function(){var e=this;o.logEvent("unlock_ad_click"),o.showVideoAd(function(){e.equip_adinvite()},function(){})},registerOnClose:function(e){this.onClosed=e},onClose:function(){this.onClosed(!1)}}),cc._RF.pop()},{AdHelper:"AdHelper",KnifeData:"KnifeData",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],SlotData:[function(e,t){"use strict";cc._RF.push(t,"6e742nfzClG56mrhPVvp8mK","SlotData"),t.exports=[[0,2,4],[0,3,6],[1,3,3],[1,2,3],[1,2,2],[4,5,7],[0,2,4],[3,5,8],[0,0,4],[0,1,4],[3,3,5],[2,3,3],[1,2,4],[1,1,1],[1,1,1],[0,1,2],[7,7,7],[0,1,3],[5,6,8],[1,5,8],[1,2,3],[3,6,7],[0,1,1],[1,2,4],[5,5,5],[0,3,4],[0,2,4],[0,2,5],[1,1,3],[0,1,3],[1,4,6],[0,0,3],[0,0,0],[2,3,4],[8,8,8],[1,4,5],[0,0,2],[1,3,5],[2,2,2],[0,1,2],[4,6,8],[1,2,6],[0,1,4],[0,2,6],[2,4,6],[0,1,4],[1,5,7],[1,2,5],[0,1,3],[2,3,4],[2,5,7],[0,2,3],[3,3,6],[1,1,3],[1,3,3],[0,3,5],[1,2,4],[1,6,8],[0,6,7],[0,1,4],[3,4,6],[0,1,2],[1,4,5],[3,6,8],[3,3,3],[0,1,3],[6,6,6],[0,1,2],[0,3,6],[0,5,8],[1,2,4],[0,3,3],[1,2,5],[0,1,4],[0,1,2],[0,0,4],[1,2,3],[1,2,6],[2,2,3],[0,1,3],[4,6,7],[0,2,3],[2,6,7],[3,5,7],[3,3,3],[1,2,3],[3,4,5],[4,6,8],[1,2,4],[2,5,8],[0,0,1],[2,4,5],[2,2,2],[1,2,4],[0,1,2],[0,2,2],[0,1,3],[4,5,8],[0,1,5],[0,4,5],[0,2,3],[3,4,5],[0,2,4],[1,2,4],[5,6,7],[1,5,7],[0,0,2],[2,5,7],[9,9,9],[0,2,3],[4,5,7],[2,3,6],[0,2,6],[0,2,4],[0,2,2],[1,3,4],[0,1,6],[0,1,2],[1,4,6],[3,4,6],[0,2,4],[2,3,5],[0,1,3],[0,6,8],[0,1,2],[2,2,3],[1,5,8],[0,1,3],[1,2,3],[0,1,4],[0,2,5],[0,6,7],[0,1,3],[0,4,6],[3,3,6],[1,2,3],[3,5,7],[0,1,1],[0,2,3],[2,3,5],[0,1,5],[1,2,3],[0,4,5],[2,4,5],[0,2,3],[0,5,8],[0,0,1],[1,6,7],[0,5,7],[1,2,3],[1,1,2],[1,1,4],[0,2,4],[1,1,4],[1,2,2],[0,1,2],[0,4,6],[0,3,4],[0,1,4],[0,3,5],[3,6,7],[0,2,3],[3,3,5],[1,3,6],[0,2,3],[4,6,7],[3,5,8],[0,1,2],[2,6,8],[1,6,7],[0,1,4],[0,1,6],[1,6,8],[0,2,4],[1,3,6],[1,3,5],[0,2,3],[2,6,8],[0,3,3],[1,2,3],[4,5,8],[2,4,6],[1,2,4],[2,5,8],[3,6,8],[0,0,0],[0,0,3],[2,2,4],[1,2,4],[2,3,3],[0,5,7],[0,1,4],[1,3,4],[2,2,4],[0,1,2],[2,3,6],[1,1,2],[0,1,2],[2,6,7],[0,6,8]],cc._RF.pop()},{}],SloteList:[function(e,t){"use strict";cc._RF.push(t,"46cba9yw5JGj58ieXZ7sRBZ","SloteList");var n=[],i=e("KnifeData"),o=e("Utils"),a=e("User");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,lightNode:cc.Node},onLoad:function(){this.items=[],this.itemHeight=this.itemPrefab.data.height,this.moveSpeed=0,this.datas=[{type:"apple",count:5},{type:"goldapple",count:5},{type:"apple",count:10},{type:"goldapple",count:10},{type:"apple",count:25},{type:"goldapple",count:25},{type:"apple",count:50},{type:"goldapple",count:50},{type:"apple",count:100},{type:"goldapple",count:100},{type:"knife",id:21}],this.dir=-1;for(var e=0;e<3;e++){var t=cc.instantiate(this.itemPrefab);this.content.addChild(t),t.y=-e*this.itemHeight*this.dir,this.items.push(t.getComponent("SlotoItem")),this.items[e].updateData(this.datas[e],e)}if(0==n.length)for(var o=i.getAllData(),s=0;s<o.length;s++)o[s].ad_num>0&&!a.get().isKnifeUnlock(s+1)&&n.push(s+1)},onEnable:function(){this.isScrolling=!1,this.isIdleScrolling=!1,this.lightNode.active=!1},setKnife:function(e){this.datas[this.datas.length-1].id=e,cc.loader.loadRes("knife/"+i.getData(e).img,cc.SpriteFrame,function(){})},randomKnife:function(){0!=n.length&&this.setKnife(o.randomSelectOne(n))},setCurrentIndex:function(e){this.curIndex=e,this.content.y=this.itemHeight*e*this.dir;for(var t=0;t<this.items.length;t++){this.items[t].node.y=-(t+e)*this.itemHeight*this.dir;var n=(e+t)%this.datas.length;this.items[t].updateData(this.datas[n],n)}},getCurrentData:function(){return this.datas[this.curIndex]},showLightEffect:function(){this.lightNode.active=!0,this.lightNode.stopAllActions(),this.lightNode.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.2,255),cc.fadeTo(.2,0))))},idleScroll:function(e){this.isIdleScrolling=!0,this.moveSpeed=e||1},scorllToIndex:function(e,t,i){this.curIndex=e,e==this.datas.length-1&&n.splice(n.indexOf(this.datas[e].id),1),this.moveSpeed=20,this.isScrolling=!0,this.isIdleScrolling=!1;var o=1;i&&(o+=i);var a=this.itemHeight*this.datas.length,s=Math.floor(this.content.y/a)*a;this.desY=s+this.dir*(o*this.datas.length*this.itemHeight+e*this.itemHeight),this.finishCb=t||function(){}},update:function(){if(this.isIdleScrolling||this.isScrolling){if(this.content.y+=this.moveSpeed*this.dir,1==this.dir&&this.items[0].node.y+this.content.y>this.itemHeight||-1==this.dir&&this.items[0].node.y+this.content.y<-this.itemHeight){var e=this.items.shift(),t=this.items[this.items.length-1];e.node.y=t.node.y-this.itemHeight*this.dir;var n=(t.index+1)%this.datas.length;e.updateData(this.datas[n],n),this.items.push(e)}this.isScrolling&&Math.abs(this.content.y-this.desY)<30&&(this.isScrolling=!1,this.content.y=this.desY,this.finishCb())}}}),cc._RF.pop()},{KnifeData:"KnifeData",User:"User",Utils:"Utils"}],SlotoItem:[function(e,t){"use strict";cc._RF.push(t,"5d435+0PXhNaLiuPW2ZekGD","SlotoItem");var n=e("KnifeData");cc.Class({extends:cc.Component,properties:{countLabel:cc.Label,appleNode:cc.Node,goldAppleNode:cc.Node,knifeSprite:cc.Sprite},updateData:function(e,t){var i=this;this.data!=e&&(this.index=t,this.data=e,this.appleNode.active="apple"==e.type,this.goldAppleNode.active="goldapple"==e.type,this.knifeSprite.node.active="knife"==e.type,"knife"==e.type?(this.countLabel.node.active=!1,cc.loader.loadRes("knife/"+n.getData(e.id).img,cc.SpriteFrame,function(e,t){e?console.log("error",e):i.knifeSprite.spriteFrame=t})):(this.countLabel.node.active=!0,this.countLabel.string=e.count))}}),cc._RF.pop()},{KnifeData:"KnifeData"}],SoundMgr:[function(e,t){"use strict";cc._RF.push(t,"cb77baMvr5LEriYIauncdpl","SoundMgr");var n=function(){};n.CLICK="ui/ClickButton",n.APPLES_COINS="ui/GiftApples",n.CONITINUE_TIMER="ui/TimerContinue",n.GAME_OVER="ui/GameOver",n.PWR_UP_SECOND_CHANCE="ui/SecondChance",n.CAMERA="camera",n.THROW="ThrowKnife",n.HIT="hit/knifeHit",n.HIT_LAST="hit/wookBroken",n.HIT_LAST_SPECIAL="hit/BossDie",n.BOSS_DEFENTED="hit/BossDefeated",n.BOSS_FIGHT="hit/FightBoss",n.KNIFE_HIT="hit/knifeHitKnife",n.APPLE_HIT="hit/KnifeHitApple",n.LEMON_HIT="bosshit/LemonHit",n.COMPASS_HIT="bosshit/CompassHit",n.GEAR_HIT="bosshit/GearHit",n.DONUT_HIT="bosshit/DonutHit",n.SHIRT_HIT="bosshit/ButtonHit",n.DIAMOND_HIT="bosshit/DiamonHit",n.WHEEL_HIT="bosshit/WheelHit",n.CHIP_HIT="bosshit/ButtonHit",n.CHEESE_HIT="bosshit/CheeseHit",n.SHIELD_HIT="bosshit/ShieldHit",n.AK47="bosshit/AK47",n.SLOT_START="ui/slot_spin_start",n.SLOT_STOP="ui/slot_stop",n.SLOT_2="ui/slot_multiplier_x2",n.SLOT_3="ui/slot_multiplier_x3";var i={};n.register=function(e,t){i[e]=t};var o={},a={},s={},c=1,r=1;n.setSoundEnable=function(t){for(var n in c=t?1:0,a)cc.audioEngine.setVolume(a[n],c);e("User").get().save()},n.setMusicEnable=function(t){for(var n in r=t?1:0,s)cc.audioEngine.setVolume(s[n],r);e("User").get().save()},n.isSoundEnable=function(){return 1==c},n.isMusicEnable=function(){return 1==r},n.playClick=function(){a[n.CLICK]=n.play(n.CLICK)},n.preLoad=function(e,t){o[e]||i[e]||(o[e]=!0,cc.loader.loadRes("sound/"+e,function(n,a){o[e]=!1,t&&t(n,a),n?cc.log(n):i[e]=a}))},n.play=function(e,t,s){if(s=s||1,!o[e]&&0!=c)return i[e]?(a[e]=cc.audioEngine.play(i[e],!1,s*c),a[e]):void n.preLoad(e)},n.stop=function(e){cc.audioEngine.stop(a[e])},t.exports=n,cc._RF.pop()},{User:"User"}],SoundUtil:[function(e,t){"use strict";cc._RF.push(t,"fa9d18MP39ET4DxIKnRmC8s","SoundUtil");var n=e("SoundMgr");cc.Class({extends:cc.Component,properties:{},playClick:function(){n.playClick()}}),cc._RF.pop()},{SoundMgr:"SoundMgr"}],SpinDialog:[function(e,t){"use strict";cc._RF.push(t,"2b74532ZNJPSL+RflikyAT6","SpinDialog");var n=e("PageMgr"),i=e("User"),o=e("AdHelper");cc.Class({extends:cc.Component,properties:{giftTimeLabel:cc.Label,playBtn:cc.Button},start:function(){},onEnable:function(){o.logEvent("turntable_dialog_show");var e=this.node.getChildByName("content");e.scale=.8,e.runAction(cc.scaleTo(.1,cc.winSize.width/640))},onPlay:function(){var e=this;o.logEvent("turntable_play_click"),n.getPageAsync(n.GAMESPIN).then(function(t){n.showLoading(),t.getComponent(n.GAMESPIN).preLoad(function(){e.onClose(),n.showDialog(n.GAMESPIN,!0),n.hideLoading()})}).catch(function(){})},onClose:function(){n.hideDialog(n.SPINDIALOG)},update:function(){i.get().isGiftAvailable()?(this.giftTimeLabel.string="\u5c31\u7eea!",this.playBtn.interactable=!0):(this.giftTimeLabel.string=i.get().getGiftLeftTime(),this.playBtn.interactable=!1)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],SpinLottery:[function(e,t){"use strict";cc._RF.push(t,"738274u84JNpot1JEjYc4m1","SpinLottery"),cc.Class({extends:cc.Component,properties:{spinNode:{default:null,type:cc.Node},wheelNode:{default:null,type:cc.Node},maxSpeed:{default:10,type:cc.Float,max:15,min:2,tooltip:"\u6700\u5927\u901f\u5ea6\u8f6c\u6bcf\u79d2"},duration:{default:2,type:cc.Float,max:5,min:1,tooltip:"\u51cf\u901f\u524d\u65cb\u8f6c\u65f6\u95f4"},acc:{default:10,type:cc.Float,max:10,min:1,tooltip:"\u52a0\u901f\u5ea6"},gearNum:{default:8,type:cc.Integer,tooltip:"\u9f7f\u8f6e\u4e2a\u6570"}},onEnable:function(){this.wheelState=0,this.curSpeed=0,this.spinTime=0,this.defaultAngle=360/this.gearNum/2,this.gearAngle=360/this.gearNum,this.wheelNode.rotation=this.defaultAngle,this.finalAngle=0,this.targetId=0,this.decAngle=1080,this.spinNodeSpeed=0,this.spinNodeRotationMax=-20,this.spinNodeMoveTm=0,this.lastSpinMoveTm=0},run:function(e,t){0===this.wheelState&&((null==e||e>=this.gearNum)&&(e=Math.floor(Math.random()*this.gearNum)),this.curDecAngle=this.decAngle,this.wheelState=1,this.curSpeed=0,this.spinTime=0,this.targetId=parseInt(e),this.finalAngle=(360-this.targetId*this.gearAngle+this.defaultAngle+(40*Math.random()-20))%360,this.cb=t)},update:function(e){(this.spinNode.rotation<0||this.spinNodeSpeed<0)&&(this.spinNodeMoveTm<=0?(this.spinNodeSpeed+=50*e,this.spinNodeMoveTm=0):this.spinNodeMoveTm-=e,this.spinNodeSpeed<-1&&(this.spinNodeSpeed=-1),this.spinNode.rotation+=this.spinNodeSpeed,this.spinNode.rotation>0&&(this.spinNode.rotation=0),this.spinNode.rotation<-40&&(this.spinNode.rotation=-40)),0!==this.wheelState&&(1==this.wheelState?(this.spinTime+=e,this.wheelNode.rotation-=this.curSpeed,this.wheelNode.rotation<0&&(this.wheelNode.rotation+=360),this.curSpeed<=this.maxSpeed?this.curSpeed+=this.acc*e:(this.curSpeed=this.maxSpeed,this.spinTime>=this.duration&&Math.abs(this.wheelNode.rotation-this.finalAngle)<=this.maxSpeed+1&&(this.wheelNode.rotation=this.finalAngle,this.maxSpeed=this.curSpeed,this.wheelState=2))):2==this.wheelState&&(this.curSpeed=this.maxSpeed*this.curDecAngle/this.decAngle,this.curSpeed<.2&&(this.curSpeed=.2),this.wheelNode.rotation-=this.curSpeed,this.wheelNode.rotation<0&&(this.wheelNode.rotation+=360),this.curDecAngle-=this.curSpeed,this.curDecAngle<=.001&&(this.wheelNode.rotation=this.finalAngle,this.curSpeed=0,this.wheelState=0,this.cb&&this.cb())),this.lastSpinMoveTm-=e,Math.floor(this.wheelNode.rotation/this.gearAngle)!=Math.floor((this.wheelNode.rotation+this.curSpeed)%360/this.gearAngle)?this.lastSpinMoveTm<=0?(this.lastSpinMoveTm=.2,this.spinNodeSpeed=-this.curSpeed,this.spinNodeMoveTm=.15,this.spinNodeMoveStatus=!1):this.spinNodeMoveStatus=!0:this.lastSpinMoveTm<=0&&this.spinNodeMoveStatus&&(this.lastSpinMoveTm=.2,this.spinNodeSpeed=-this.curSpeed,this.spinNodeMoveTm=.15,this.spinNodeMoveStatus=!1))}}),cc._RF.pop()},{}],SweetCollectDialog:[function(e,t){"use strict";cc._RF.push(t,"7c029AJDJJLmpNSUq+O0I8d","SweetCollectDialog");var n=e("AdHelper"),i=e("PageMgr"),o=e("User");cc.Class({extends:cc.Component,properties:{giftLabel:cc.Label,bossLabel:cc.Label,videoBtn:cc.Button,guang:cc.Node},onLoad:function(){this.guang.runAction(cc.repeatForever(cc.rotateBy(1,10)))},onEnable:function(){this.isWaitingAd=!1;var e=this.node.getChildByName("content");e.scale=.8,e.runAction(cc.scaleTo(.1,1)),n.logEvent("halloween_sweetbag_show")},onDisable:function(){this.isWaitingAd=!1},onUpdateData:function(e){this.onCloseCb=e.onClose,this.count=e.count,this.giftLabel.string=e.count,this.bossLabel.string=e.name},onCollect:function(){this.showGift(!1),n.logEvent("halloween_collect")},onCollectX2:function(){var e=this;n.logEvent("halloween_collectx2"),n.isVideoLoad()?(n.logEvent("halloween_collect_adshow"),n.showVideoAd(this.showGift.bind(this,!0),function(){})):(i.showLoading("",!0),this.isWaitingAd=!0,this.timeoutHandler=setTimeout(function(){e.timeoutHandler=null,e.isWaitingAd=!1,i.hideLoading(),i.showTip("NO ADS AVAILBLE",null,-200),setTimeout(function(){i.hideTip()},3e3),e.showGift()},6e3))},showGift:function(e){i.hideDialog("SweetCollectDialog");var t=e?2:1;o.get().addSweetCount(this.count*t),i.getPage(i.GIFTPAGE).getComponent("GiftPage").setAppleCount(this.count,e,!1,this.onCloseCb,!0),i.showDialog(i.GIFTPAGE)},onClose:function(){i.hideDialog("SweetCollectDialog"),this.onCloseCb()},update:function(){var e=this;this.videoBtn.interactable=n.isSupporteVideo(),this.isWaitingAd&&n.isVideoLoad()&&(this.isWaitingAd=!1,this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=null),n.showVideoAd(this.showGift.bind(this,!0),function(){}),n.logEvent("halloween_collect_adshow"),setTimeout(function(){i.hideLoading(),e.onClose()},2e3))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],TargetData:[function(e,t){"use strict";cc._RF.push(t,"83a4aeXbDVKBZ5xo1HEyfSo","TargetData");var n=[{index:1,avator:"target_1"},{index:2,avator:"boss_10000",name:"\u6854\u5b50",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:36,exp:10,color:"#f77d0c"},{index:3,avator:"boss_10001",name:"\u7315\u7334\u6843",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:46,exp:10,color:"#80a306"},{index:4,avator:"boss_10002",name:"\u5927\u897f\u74dc",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:35,exp:10,color:"#f83913"},{index:5,avator:"boss_20000",name:"\u5de8\u65e0\u9738",hitTarget:"COMPASS_HIT",bossLv:0,block:[],drop:50,exp:20,color:"#61b9d3"},{index:6,avator:"boss_20001",name:"\u8ff7\u4f60\u97f3\u7bb1",hitTarget:"GEAR_HIT",bossLv:0,block:[],drop:45,exp:20,color:"#d0592c"},{index:7,avator:"boss_20002",name:"\u62ab\u8428",hitTarget:"DONUT_HIT",bossLv:0,block:[],drop:54,exp:20,color:"#f83d7c"},{index:8,avator:"boss_30000",name:"\u5954\u9a70\u8f6e\u80ce",hitTarget:"SHIRT_HIT",bossLv:0,block:[],drop:38,exp:30,color:"#00a1a6"},{index:9,avator:"boss_30001",name:"\u76d8\u5b50",hitTarget:"DIAMOND_HIT",bossLv:0,block:[],drop:53,exp:30},{index:10,avator:"boss_30002",name:"\u624b\u8868",hitTarget:"WHEEL_HIT",bossLv:0,block:[],drop:52,exp:30},{index:11,avator:"boss_40000",name:"\u5564\u9152\u76d6",HitTarget:"CHIP_HIT",bossLv:0,block:[],drop:49,exp:40},{index:12,avator:"boss_40001",name:"\u5531\u7247",HitTarget:"CHEESE_HIT",bossLv:0,block:[],drop:48,exp:40},{index:13,avator:"boss_40002",name:"\u8239\u951a",HitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:55,exp:40},{index:14,avator:"boss_50001",name:"\u8349\u5e3d",HitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:51,exp:50},{index:15,avator:"boss_50000",name:"\u67b6\u5b50\u9f13",HitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:39,exp:50},{index:16,avator:"boss_60000",name:"\u8239\u8235",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:34,exp:100},{index:17,avator:"boss_60001",name:"\u76fe\u724c",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:47,exp:100},{index:18,avator:"boss_70000",name:"\u5f71",hitTarget:"SHIELD_HIT",bossLv:1,block:[],drop:136,exp:120},{index:19,avator:"boss_40000",name:"\u5564\u9152\u76d6",hitTarget:"SHIELD_HIT",bossLv:1,block:[],drop:141,exp:150},{index:20,avator:"boss_30100",name:"\u9ad8\u5c14\u592b",hitTarget:"SHIELD_HIT",bossLv:1,block:[],drop:151,exp:170},{index:21,avator:"boss_30003",name:"\u68d2\u68d2\u7cd6",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:150,exp:120},{index:22,avator:"boss_30004",name:"\u67aa\u9776",hitTarget:"AK47",bossLv:1,block:[],drop:41,exp:100},{index:23,avator:"boss_30005",name:"\u6930\u5b50",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:142,exp:20},{index:24,avator:"boss_30006",name:"\u706b\u9f99\u679c",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:143,exp:20},{index:25,avator:"boss_30007",name:"\u77f3\u69b4",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:148,exp:10},{index:26,avator:"boss_20003",name:"\u7f51\u7403",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:40,exp:20},{index:27,avator:"boss_20004",name:"\u5e73\u5e95\u9505",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:137,exp:20},{index:28,avator:"boss_30100",name:"\u9ad8\u5c14\u592b",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:146,exp:10},{index:29,avator:"boss_30100",name:"THE CAMERA",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:150,exp:10},{index:30,avator:"boss_30100",name:"THE MARS",hitTarget:"SHIELD_HIT",bossLv:1,block:[],drop:140,exp:10},{index:31,avator:"THE SUN",name:"THE SAW",hitTarget:"SHIELD_HIT",bossLv:1,block:[],drop:143,exp:10},{index:32,avator:"boss_s4",name:"\u8db3\u7403",hasPlayerImg:!0,hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:144,exp:120},{index:33,avator:"boss_s3",hasPlayerImg:!0,isBack:!0,name:"\u82b1\u73af",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:145,exp:60},{index:34,avator:"boss_s1",hasPlayerImg:!0,name:"\u795e\u9f9f",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:152,exp:60,color:"#f77d0c"},{index:35,avator:"boss_s2",hasPlayerImg:!0,name:"LOVE",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:153,exp:30,color:"#f77d0c"},{index:36,avator:"boss_80000",name:"\u5e7d\u7075",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:158,exp:10,color:"#fbfbfb"},{index:37,avator:"boss_80001",hasPlayerImg:!0,name:"\u5357\u74dc\u5934",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:159,exp:20,color:"#0d0e10"},{index:38,avator:"boss_80002",hasPlayerImg:!0,name:"\u5deb\u5a46\u5e3d",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:160,exp:30,color:"#561277"},{index:39,avator:"boss_80003",hasPlayerImg:!0,name:"\u4e07\u5723\u8282",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:161,exp:40,color:"#bc2a00"},{index:40,avator:"boss_40003",hasPlayerImg:!0,name:"APPLE WATCH",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:146,exp:20},{index:41,avator:"boss_s10",hasPlayerImg:!0,name:"CD\u5531\u7247",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:120,exp:20},{index:42,avator:"boss_s11",name:"\u786c\u5e01",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:121,exp:10},{index:43,avator:"boss_20005",name:"\u5b9d\u9a6c",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:122,exp:10},{index:44,avator:"boss_20006",name:"\u5954\u9a70",hitTarget:"SHIELD_HIT",bossLv:0,block:[],drop:123,exp:10},{index:45,avator:"boss_s5",hasPlayerImg:!0,name:"\u6469\u5929\u8f6e",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:124,exp:15},{index:46,avator:"boss_s6",hasPlayerImg:!0,name:"\u5411\u65e5\u8475",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:125,exp:15},{index:47,avator:"boss_s7",hasPlayerImg:!0,name:"\u4e07\u82b1\u7b52",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:126,exp:15},{index:48,avator:"boss_s9",hasPlayerImg:!0,isBack:!0,name:"\u6708\u4eae",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:127,exp:15},{index:49,avator:"boss_s12",hasPlayerImg:!0,isBack:!0,name:"\u8bfa\u57fa\u4e9a\u624b\u8868",hitTarget:"SHIELD_HIT",bossLv:2,block:[],drop:128,exp:15},{index:50,avator:"boss_10003",name:"\u897f\u7ea2\u67ff",hitTarget:"LEMON_HIT",bossLv:0,block:[],drop:37,exp:10,color:"#f83913"},{index:51,avator:"boss_s13",hasPlayerImg:!0,name:"\u751c\u751c\u5708",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:37,exp:10,color:"#f83913"},{index:52,avator:"boss_s14",hasPlayerImg:!0,name:"\u7389\u7c73",hitTarget:"LEMON_HIT",bossLv:2,block:[],drop:37,exp:10,color:"#f83913"}];t.exports={getData:function(e){return n[e-1]}},cc._RF.pop()},{}],TaskButton:[function(e,t){"use strict";cc._RF.push(t,"e79eff8J65CPKmmLQLkzdlU","TaskButton");var n=e("TaskMgr"),i=e("AdHelper"),o=e("PageMgr");cc.Class({extends:cc.Component,properties:{completeNode:cc.Node,newNode:cc.Node,inprogressNode:cc.Node,statusLabel:cc.Label},update:function(){this.completeNode.active=n.isTaskComplete(),this.inprogressNode.active=n.isTaskInprogress(),this.newNode.active=!(this.completeNode.active||this.inprogressNode.active),this.statusLabel.string="NEW\nTASK",n.isTaskComplete()&&(this.statusLabel.string="TASK\nDONE"),n.isTaskInprogress()&&(this.statusLabel.string="TASK\nDOING")},onLoad:function(){this.completeNode.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,2),cc.scaleTo(.3,1),cc.delayTime(.3))))},onTaskClick:function(){i.logEvent("result_task_click"),n.openTask(),o.showDialogAsync("TaskDialog")}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",TaskMgr:"TaskMgr"}],TaskData:[function(e,t){"use strict";cc._RF.push(t,"be6d1hL1I1FAJJUlg22gCqr","TaskData");var n=[{type:"finish_level",num:5,rewardCount:25,iconIndex:0,des:"COMPLETE STAGE 5."},{type:"finish_level",num:7,rewardCount:30,iconIndex:0,des:"COMPLETE STAGE 7."},{type:"collect_apple",num:20,rewardCount:50,iconIndex:4,des:"COLLECT 20 APPLES"},{type:"spin_slot",num:1,rewardCount:25,iconIndex:2,des:"PLAY ONE-ARM BANDIT 1 TIME."},{type:"challenge_friends",num:1,rewardCount:100,iconIndex:1,des:"CHALLENGE 1 FRIEND"},{type:"finish_level",num:10,rewardCount:50,iconIndex:0,des:"COMPLETE STAGE 10."},{type:"spin_slot",num:3,rewardCount:100,iconIndex:2,des:"PLAY ONE-ARM BANDIT 3 TIME."},{type:"challenge_friends",num:3,rewardCount:300,iconIndex:1,des:"CHALLENGE 3 FRIEND"},{type:"finish_level",num:15,rewardCount:200,iconIndex:0,des:"COMPLETE STAGE 15."},{type:"beat_boss",num:15,rewardCount:50,iconIndex:3,des:"DEFEAT BOSS : THE DIAMOND.IT APPEARS ON THE 25TH STAGE."},{type:"finish_level_nocontinue",num:10,rewardCount:100,iconIndex:0,des:"COMPLETE STAGE 10 WITHOUT 'CONTINUE'."},{type:"finish_level_nocontinue",num:20,rewardCount:300,iconIndex:0,des:"COMPLETE STAGE 20 WITHOUT 'CONTINUE'."},{type:"finish_level_nocontinue",num:30,rewardCount:500,iconIndex:0,des:"COMPLETE STAGE 30 WITHOUT 'CONTINUE'."}];t.exports={getData:function(e){return n[e]},getLength:function(){return Object.keys(n).length}},cc._RF.pop()},{}],TaskDialog:[function(e,t){"use strict";cc._RF.push(t,"7b740oES/FP5KYPTZ7oP1Ax","TaskDialog");var n=e("TaskMgr"),i=e("User"),o=e("PageMgr"),a=e("AdHelper");cc.Class({extends:cc.Component,properties:{iconsFrame:[cc.SpriteFrame],taskIcon:cc.Sprite,desLabel:cc.Label,barLabel:cc.Label,rewardLabel:cc.Label,taskBar:cc.Sprite,collectBtn:cc.Button},updateUI:function(){var e=n.getCurrentTask();this.desLabel.string=e.des,this.rewardLabel.string=e.rewardCount,this.taskIcon.spriteFrame=this.iconsFrame[e.iconIndex],this.collectBtn.interactable=n.isTaskComplete();var t=e.num,o=i.get().getTaskCount();"beat_boss"!=e.type&&"finish_level"!=e.type&&"finish_level_nocontinue"!=e.type||(t=1,o=n.isTaskComplete()?1:0),this.barLabel.string=o+"/"+t,this.taskBar.fillRange=o/t},onEnable:function(){this.updateUI()},onCollectReward:function(){var e=n.getCurrentTask();a.logEvent("task_collect",{taskIndex:i.get().getTaskIndex()}),o.getPage(o.GIFTPAGE).getComponent("GiftPage").setAppleCount(e.rewardCount),o.showDialog(o.GIFTPAGE,!0),i.get().addDiamon(e.rewardCount),n.openNextTask(),this.updateUI()}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",TaskMgr:"TaskMgr",User:"User"}],TaskMgr:[function(e,t){"use strict";cc._RF.push(t,"ca20ejBppRADqzBZvAv9V7C","TaskMgr");var n=e("TaskData"),i=e("User"),o=e("AdHelper"),a={},s=null;a.setTaskIndex=function(e){s=n.getData(e)},a.getCurrentTask=function(){return s},a.getTotalTaskCount=function(){return n.getLength()},a.isTaskFinish=function(){return"beat_boss"==s.type&&i.get().getTaskCount()>0||i.get().getTaskCount()>=s.num},a.isTaskInprogress=function(){return"inprogress"==i.get().getTaskStatus()},a.isTaskComplete=function(){return"completed"==i.get().getTaskStatus()},a.openTask=function(){"unlocked"==i.get().getTaskStatus()&&i.get().setTaskStatus("inprogress")},a.openNextTask=function(){i.get().openNextTask(),i.get().getTaskIndex()<a.getTotalTaskCount()&&(a.setTaskIndex(i.get().getTaskIndex()),s&&"spin_slot"==s.type&&!o.isSupporteVideo()&&a.openNextTask())},a.isAllTaskCompleted=function(){return i.get().getTaskIndex()>=a.getTotalTaskCount()},a.onFinishStage=function(e,t){a.isTaskInprogress()&&("finish_level"==s.type&&i.get().getTaskCount()<e?(i.get().setTaskCount(e),e>=s.num&&i.get().setTaskStatus("completed"),console.log("onFinishStage",e,t)):"finish_level_nocontinue"==s.type&&0==t&&i.get().getTaskCount()<e&&(i.get().setTaskCount(e),e>=s.num&&i.get().setTaskStatus("completed")))},a.onCollectApple=function(e){a.isTaskInprogress()&&"collect_apple"==s.type&&(console.log("onCollectApple",e),i.get().setTaskCount(i.get().getTaskCount()+e),i.get().getTaskCount()>=s.num&&i.get().setTaskStatus("completed"))},a.onSpinSlot=function(){a.isTaskInprogress()&&"spin_slot"==s.type&&(console.log("onSpinSlot"),i.get().setTaskCount(i.get().getTaskCount()+1),i.get().getTaskCount()>=s.num&&i.get().setTaskStatus("completed"))},a.onChallengeFriend=function(){a.isTaskInprogress()&&"challenge_friends"==s.type&&(console.log("onChallengeFriend"),i.get().setTaskCount(i.get().getTaskCount()+1),i.get().getTaskCount()>=s.num&&i.get().setTaskStatus("completed"))},a.onBeatBoss=function(e){a.isTaskInprogress()&&"beat_boss"==s.type&&e==s.num&&(console.log("onBeatBoss",e),i.get().setTaskCount(1),i.get().setTaskStatus("completed"))},t.exports=a,cc._RF.pop()},{AdHelper:"AdHelper",TaskData:"TaskData",User:"User"}],ThanksSaleDialog:[function(e,t){"use strict";cc._RF.push(t,"480b5onYf5Al4Hahknsf8Gf","ThanksSaleDialog");var n=e("PageMgr"),i=e("User"),o=e("AdHelper"),a=e("Utils");cc.Class({extends:cc.Component,properties:{price1:cc.Label,price2:cc.Label,price3:cc.Label,timerLabel:cc.Label},onEnable:function(){this.price1.string=i.get().getPrice("apple_box","$2.99"),this.price2.string=i.get().getPrice("apple_60000","$28.99"),this.price3.string=i.get().getPrice("apple_180000_half","$49.99")},onUpdateData:function(e){this.data=e},onBuyItem1:function(){o.logEvent("pay_shop_click",{itemId:"apple_box"}),i.get().purchase("apple_box",function(){i.get().addDiamon(7500),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(7500),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_box"})},function(){})},onBuyItem2:function(){o.logEvent("pay_shop_click",{itemId:"apple_60000"}),i.get().purchase("apple_60000",function(){i.get().addDiamon(18e4),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(18e4),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_60000"})},function(){})},onBuyItem3:function(){o.logEvent("pay_shop_click",{itemId:"apple_180000_half"}),i.get().purchase("apple_180000_half",function(){i.get().addDiamon(6e5),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(6e5),n.showDialog(n.GIFTPAGE,!0),o.logEvent("pay_shop_success",{itemId:"apple_180000_half"})},function(){})},onClose:function(){n.hideDialog("ThanksSaleDialog"),this.data&&this.data.closeCb&&this.data.closeCb()},update:function(){i.get().getThanksgivingLeftTime()>0&&(this.timerLabel.string=a.formatTimeHMS(i.get().getThanksgivingLeftTime()))}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User",Utils:"Utils"}],TurntableDialog:[function(e,t){"use strict";cc._RF.push(t,"bdeb67amZVGQ5GN+HxeM/IH","TurntableDialog"),e("PageMgr");var n=e("AdHelper");cc.Class({extends:cc.Component,properties:{dialog_tip:cc.Label,btn_random:cc.Button,turntableNode:cc.Node,turntable:cc.Node,coka1:cc.Sprite,coka2:cc.Sprite,coka3:cc.Sprite,coka4:cc.Sprite,coka5:cc.Sprite,coka6:cc.Sprite,curCoka:cc.Sprite},onEnable:function(){this.dialog_tip.node.opacity=255,this.turntableNode.scale=0,this.turntableNode.rotation=0,this.turntable.rotation=0,this.curCoka.node.active=!1,this.curCoka.node.scale=1,this.curCoka.node.x=0,this.curCoka.node.y=90,this.curCoka.node.stopAllActions(),this.prizeRotation=[0,60,120,180,240,300],this.prizes=[this.coka1,this.coka2,this.coka3,this.coka4,this.coka5,this.coka6],this.prize_id=-1,this.turntableNode.runAction(cc.scaleTo(.2,1));var e=cc.scaleTo(1,1.5),t=cc.scaleTo(1,1);e.easing(cc.easeBackInOut(1)),t.easing(cc.easeBackInOut(1)),this.btn_random.node.runAction(cc.repeatForever(cc.sequence(e,t,cc.delayTime(.5)))),this.setupInput(),n.logEvent("spin_show")},onTouchBegan:function(){this.btn_random.node.stopAllActions(),this.btn_random.node.scale=2},onTouchMove:function(){},onTouchEnd:function(){var e=cc.scaleTo(.5,1);this.btn_random.node.runAction(e),this.onRandomHand(),this.removeInput(),n.logEvent("spin_click")},setupInput:function(){this.removeInput(),this.btn_random.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.btn_random.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.btn_random.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.btn_random.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},removeInput:function(){this.btn_random.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.btn_random.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.btn_random.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.btn_random.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},start:function(){},onRandomHand:function(){var e=this,t=this.GetRandomNum(0,5);this.prize_id=t,this.dialog_tip.node.runAction(cc.fadeOut(1));var n=this.prizes[t];this.getComponent("SpinLottery").run(t,function(){e.curCoka.spriteFrame=n.spriteFrame,e.curCoka.node.active=!0;var t=cc.scaleTo(.3,3);console.log("this.turntable.runActionthis.turntable.runAction"),e.curCoka.node.runAction(cc.sequence(t,cc.delayTime(.5),cc.callFunc(function(){e.hideTurntable(e.curCoka)})))})},getPrizeId:function(){return this.prize_id},setFinishCallback:function(e){this.onFinishCb=e},hideTurntable:function(e){var t=this,n=cc.scaleTo(.2,0);this.turntableNode.runAction(cc.sequence(n,cc.callFunc(function(){console.log("this.prize_idthis.prize_id:",t.prize_id),t.onFinishCb(t.prize_id)}))),e.node.runAction(cc.moveTo(.4,0,2e3))},GetRandomNum:function(e,t){var n=t-e,i=Math.random();return e+Math.round(i*n)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr"}],User:[function(e,t){"use strict";cc._RF.push(t,"1c533BAPW5G/5VBJFn8NQSQ","User");var n=e("SoundMgr"),i=e("PageMgr"),o=e("PlayerLvData"),a=e("PowerUpData"),s=e("Utils"),c=e("AdHelper"),r=e("md5"),l=null,h=function(){this.init()},d={time:Date.now(),curIndex:0,status:"unlocked",count:0},u={curMaxStage:0,curMaxKnife:0,curMaxRankKnife:0,diamon:50,curKnifeId:33,unlockedKnife:{33:!0},bossKnifeCount:0,videoKnifeData:{},videoKnifeCount:0,isShowGuide:!0,curTimeIndex:0,lastGiftTime:Date.now(),dir:!0,bossRecordNew:{},bossRecordDefented:{},player_lv:1,player_exp:0,chance_second:0,chance_extra:0,chance_giftApple:0,chance_goldApple:0,chance_videoApple:0,chance_doubleXp:0,groupContextsNew:[],chance_friends:{rate:0,startDay:0},friends_records:{},invite_continue:{count:10,startDay:0},newcountleft:0,lastSendFriendsTime:0,weeklyScore:{index:0,score:0},friendRankOpen:!1,botfriendsNew:[],lastShowNotice:0,isPKOpen:!1,aabb:!1,aacc:!1,isShortCreated:!1,payInfo:[],knifeFriends:{},adShowCount:0,halloween:{sweetCount:0,count:5,time:Date.now()},dailyTask:d,lastSpinTime:0,lastVideoTime:0,lastShowHoroscope:0,vsCollectedIds:{},weekRankInfo:{week:-1,score:0}},p=["1850445281733046","1733136923430740","1778769835493391","1693191317436282","1684508601665167","2160169987332938","1568793599895780","1672957819426594"],g=["week_1","week_2","week_3","week_4","week_5","week_6","week_7","week_8","week_9","week_10","week_11","week_12","week_13","week_14","week_15","week_16","week_17"],f=0;h.get=function(){return l||(l=new h),l},h.prototype.getVersion=function(){var e=0;if(!window.FBInstant)return e;var t=FBInstant.player.getID();try{e=parseInt(t.substring(t.length-2,t.length))}catch(n){return e}return e};var m=!1,v={};h.prototype.initPay=function(){FBInstant.getSupportedAPIs().indexOf("payments.purchaseAsync")&&(FBInstant.payments.onReady(function(){m=!0}),FBInstant.payments.getCatalogAsync().then(function(e){for(var t=0;t<e.length;t++)v[e[t].productID]=e[t].price}).catch(function(){}),FBInstant.payments.getPurchasesAsync().then(function(e){for(var t in e)FBInstant.payments.consumePurchaseAsync(e[t].purchaseToken).then(function(){}).catch(function(){})}))},h.prototype.isPayReady=function(){return!1},h.prototype.getPrice=function(e,t){return v[e]||t},h.prototype.purchase=function(e,t,n){var o=this;m?(i.showLoading(),FBInstant.payments.purchaseAsync({productID:e,developerPayload:"knifelast"}).then(function(e){FBInstant.payments.consumePurchaseAsync(e.purchaseToken).then(function(){i.hideLoading(),t&&t()}).catch(function(e){i.hideLoading(),n&&n(e.message),c.logEvent("pay_consume_error",{code:e.code,message:e.message})}),u.payInfo.push({paymentID:e.paymentID,signedRequest:e.signedRequest}),o.save()}).catch(function(e){i.hideLoading(),n&&n(e.message),c.logEvent("pay_purchase_error",{code:e.code,message:e.message})})):FBInstant?n&&n("pay not ready"):t()},h.prototype.isAdRemoved=function(){return u.aabb},h.prototype.setRemoveAd=function(){u.aabb=!0,this.save()},h.prototype.isFreeContinue=function(){return u.aacc},h.prototype.setFreeContinue=function(){u.aacc=!0,this.save()},h.prototype.setBothFree=function(){u.aabb=!0,u.aacc=!0,this.save()},h.prototype.isPKOpen=function(){return u.isPKOpen},h.prototype.markPKOpen=function(){u.isPKOpen=!0},h.prototype.isShortCreated=function(){return u.isShortCreated},h.prototype.markShortCreated=function(){u.isShortCreated=!0,this.save()},h.prototype.createShortcut=function(e){window.FBInstant&&!h.get().isShortCreated()?FBInstant.canCreateShortcutAsync().then(function(t){t?(c.logEvent("createShortcut"),FBInstant.createShortcutAsync().then(function(){c.logEvent("createShortcutSuccess"),h.get().markShortCreated(),e&&e()}).catch(function(){e&&e()})):e&&e()}).catch(function(){e&&e()}):e&&e()},h.prototype.subscribeBot=function(e){window.FBInstant?FBInstant.player.canSubscribeBotAsync().then(function(){c.logEvent("subscribeBot"),FBInstant.player.subscribeBotAsync().then(function(){c.logEvent("subscribeBotSuccess"),e&&e()}).catch(function(){e&&e()})}).catch(function(){e&&e()}):e&&e()},h.prototype.addFriendsCount=function(e){u.knifeFriends[e]=u.knifeFriends[e]||0,u.knifeFriends[e]++,this.save()},h.prototype.getFriendsCount=function(e){return u.knifeFriends[e]||0},h.prototype.getBotFriendsFilterd=function(e,t){for(var n={action:"playerInfo",playerId:FBInstant.player.getID(),payload:{}},i=0;i<e.length;i++)n.payload[e[i].getID()]={};return t&&t(n),[]};var y=1538982e3,I=0;h.prototype.getFriendRankName=function(){return I<g.length?g[I]:g[g.length-1]},h.prototype.isFriendOpen=function(){return u.friendRankOpen},h.prototype.markFriendOpen=function(){u.friendRankOpen||(u.friendRankOpen=!0,this.save())},h.prototype.getRankResetLeft=function(){for(var e=Math.floor(Date.now()/1e3);y<e;)I++,y+=604800;return s.formatTime(Math.floor((y-e)/60))},h.prototype.isBlocked=function(e){return p.indexOf(e||FBInstant.player.getID())>=0},h.prototype.addAdShowCount=function(){u.adShowCount++,this.save()},h.prototype.sendFriendEvent=function(){if(FBInstant&&Date.now()-u.lastSendFriendsTime>864e5){u.lastSendFriendsTime=Date.now();var e=u.adShowCount;u.adShowCount=0,this.save(),this.getConnectedPlayersAsync(function(e){f=e.length,FBInstant.logEvent("player_friend_count",e.length,{count:e.length});for(var t=window.part1,n=window.part2,i=window.part3,o=window.part4,a={action:"friends",playerId:FBInstant.player.getID(),payload:[]},s=0;s<e.length;s++)a.payload.push(e[s].getID());var c=JSON.stringify(a),l=r(c+t+n+i+o),h=new XMLHttpRequest;h.open("POST","https://fb-bot.capjoy.com/api/v0/upload_140"),h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.onreadystatechange=function(){h.readyState};var d="data="+c+"&sign="+l;h.send(d)}),FBInstant.logEvent("apple_count",u.diamon,{count:Math.floor(u.diamon/500),playerLv:u.player_lv,max_knife:u.curMaxKnife});var t=0;for(var n in u.unlockedKnife)t++;FBInstant.logEvent("knife_count",t,{count:t}),FBInstant.logEvent("WebRenderType",1,{type:cc._renderType}),FBInstant.logEvent("GpuInfo",1,{maxTextureSize:cc.configuration.getMaxTextureSize(),maxTextureUnits:cc.configuration.getMaxTextureUnits(),nPot:cc.configuration.supportsNPOT()?1:0,vao:cc.configuration.supportsShareableVAO()?1:0,version:cc.configuration.getValue("gl.version")}),FBInstant.logEvent("day_adshow_count",e,{count:e})}else FBInstant&&this.getConnectedPlayersAsync(function(e){f=e.length},function(e){console.log(e)})},h.prototype.isShowNotice=function(){var e=Date.now()-u.lastShowNotice>=864e5;return e&&(u.lastShowNotice=Date.now(),this.save()),e},h.prototype.isShowHoroscope=function(){return Date.now()-u.lastShowHoroscope>=864e5},h.prototype.markShowHoroscope=function(){u.lastShowHoroscope=Date.now(),this.save()},h.prototype.getRankName=function(){return"rank_hight_score_global"},h.prototype.init=function(){this.isLoad=!1;for(var e=Math.floor(Date.now()/1e3);y<e;)I++,y+=604800},h.prototype.setGuideEnd=function(){u.isShowGuide=!1,this.save()},h.prototype.decAndGetCount=function(){return u.newcountleft--,u.newcountleft>=0&&this.save(),u.newcountleft},h.prototype.getDiamonCount=function(){return u.diamon},h.prototype.addDiamon=function(e){u.diamon+=e,this.save()},h.prototype.decDiamon=function(e){u.diamon-=e,this.save()},h.prototype.addOneDiamon=function(e){var t=2;e&&(t*=2),this.addDiamon(t)},h.prototype.addShareDiamon=function(){this.addDiamon(30),this.save()},h.prototype.addAdDiamon=function(e){var t=e?2:1;return this.addDiamon(this.getAdDiamonCount()*t),this.save(),this.getAdDiamonCount()*t},h.prototype.getAdDiamonCount=function(){return Math.floor(60*(1+this.getChance_videoApple()/100))},h.prototype.getFreeGiftCount=function(){return Math.floor((100+Math.random()*this.getPlayer_lv())*(1+this.getChance_giftApple()/100))},h.prototype.getMaxStage=function(){return u.curMaxStage},h.prototype.getMaxScore=function(){return u.curMaxKnife};var _=0;h.prototype.updateScoreAndStage=function(e,t){if(window.FBInstant&&e>_&&(FBInstant.postSessionScore(e),_=e),t>=6&&(u.isPKOpen=!0),h.setWeekRankScore(e),f>=1){var n=u.weeklyScore.score;u.weeklyScore.index!=I&&(n=0),n<e&&t>8&&(u.weeklyScore.index=I,u.weeklyScore.score=e,this.setRankScore(this.getFriendRankName(),e,JSON.stringify({stageNum:t,knifeId:u.curKnifeId})))}return u.curMaxRankKnife<=u.curMaxKnife&&u.curMaxStage>=30&&(u.curMaxRankKnife=u.curMaxKnife,this.setRankScore(this.getRankName(),u.curMaxRankKnife,JSON.stringify({stageNum:u.curMaxStage,knifeId:u.curKnifeId}))),(e>this.getMaxScore()||t>this.getMaxStage())&&(u.curMaxStage=Math.max(u.curMaxStage,t),u.curMaxKnife=Math.max(u.curMaxKnife,e),u.curMaxKnife>30*t&&(u.curMaxKnife=e),this.save(),c.logEvent("max_score",{curMaxStage:u.curMaxStage,curMaxKnife:u.curMaxKnife,player_lv:u.player_lv}),!0)},h.setWeekRankScore=function(e){var t=s.getYearWeekByMillisecond(Date.now());u.weekRankInfo.week!=t&&(u.weekRankInfo.score=0,u.weekRankInfo.week=t),e>u.weekRankInfo.score&&(u.weekRankInfo.score=e,window.platfromMgr.submitScore(e,!1))},h.prototype.getCurKnife=function(){return u.curKnifeId},h.prototype.setCurKnife=function(e){u.curKnifeId=e,this.save()},h.prototype.isKnifeUnlock=function(e){return u.unlockedKnife[e+""]},h.prototype.getUnlockBossCount=function(){return u.bossKnifeCount},h.prototype.addWatchVideoCount=function(e){var t=u.videoKnifeData[e]||0;u.videoKnifeData[e]=t+1,this.save()},h.prototype.getVideoWatchCount=function(e){return u.videoKnifeData[e]||0},h.prototype.getUnlockVideoCount=function(){return u.videoKnifeCount},h.prototype.unlockKnife=function(e,t,n,i){this.decDiamon(t),u.unlockedKnife[e]=!0,n&&u.bossKnifeCount++,i&&u.videoKnifeCount++,this.save()};var A=[10,30,60,120,240,480];h.prototype.isGiftAvailable=function(){return Date.now()-u.lastGiftTime>6e4*A[u.curTimeIndex]},h.prototype.getGiftLeftTime=function(){var e=60*A[u.curTimeIndex]-Math.ceil((Date.now()-u.lastGiftTime)/1e3),t=e%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,((e=Math.floor(e/60))<10?"0"+e:e)+t},h.prototype.collectGift=function(e){u.lastGiftTime=Date.now(),u.curTimeIndex++,u.curTimeIndex>=A.length&&(u.curTimeIndex=A.length-1),this.addDiamon(e)},h.prototype.isSpinAvailable=function(){return Date.now()-u.lastSpinTime>288e5},h.prototype.getSpinLeftTime=function(){var e=28800-Math.ceil((Date.now()-u.lastSpinTime)/1e3),t=e%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,((e=Math.floor(e/60))<10?"0"+e:e)+t},h.prototype.resetSpinTime=function(){u.lastSpinTime=Date.now(),this.save()},h.prototype.isVideoAvailable=function(){return Date.now()-u.lastVideoTime>288e5},h.prototype.getVideoLeftTime=function(){var e=28800-Math.ceil((Date.now()-u.lastVideoTime)/1e3),t=e%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,((e=Math.floor(e/60))<10?"0"+e:e)+t},h.prototype.resetVideoTime=function(){u.lastVideoTime=Date.now(),this.save()},h.prototype.getBossStageIndex=function(e){return u.bossRecordNew[e]?u.bossRecordNew[e]:1},h.prototype.addBossStageIndex=function(e,t){u.bossRecordNew[e]=u.bossRecordNew[e]||1,u.bossRecordNew[e]++,t&&u.bossRecordNew[e]>t+1&&(u.bossRecordNew[e]=t+1),this.save()},h.prototype.isBossDefented=function(e){return u.bossRecordDefented[e]},h.prototype.markBossDefented=function(e){u.bossRecordDefented[e]=!0},h.prototype.getBossDefentedCount=function(){return Object.keys(u.bossRecordDefented).length},h.prototype.getPlayer_lv=function(){return u.player_lv},h.prototype.setPlayer_lv=function(e){u.player_lv=e,this.save()},h.prototype.getPlayer_exp=function(){return u.player_exp},h.prototype.getMaxExp=function(){return o.getData(this.getPlayer_lv())},h.prototype.isMaxLevel=function(){return u.player_lv>=o.getMaxLv()&&u.player_exp==this.getMaxExp()},h.prototype.addExp=function(e){if(u.player_lv>=o.getMaxLv()&&u.player_exp+e>=this.getMaxExp())return u.player_exp=this.getMaxExp(),void this.save();if(u.player_exp+=e,u.player_exp>=this.getMaxExp()){u.player_exp-=this.getMaxExp();var t=a.getData(u.player_lv);switch(u.player_lv+=1,t.type){case 1:this.addChanceSecond(t.data);break;case 2:this.addChanceExtra(t.data);break;case 3:this.addChanceGiftApple(t.data);break;case 4:this.addChancGoldApple(t.data);break;case 5:this.addChanceVideoApple(t.data);case 6:this.addChanceDoubleXp(t.data)}c.logEvent("max_player_level",{curMaxStage:u.curMaxStage,curMaxKnife:u.curMaxKnife,player_lv:u.player_lv})}return this.save(),t&&t.type},h.prototype.getChanceTyType=function(e){switch(e){case 1:return this.getChance_second();case 2:return this.getChance_extra();case 3:return this.getChance_giftApple();case 4:return this.getChance_goldApple();case 5:return this.getChance_videoApple();case 6:return this.getChance_doubleXp()}},h.prototype.setPlayer_exp=function(e){u.player_exp=e,this.save()},h.prototype.getChance_second=function(){return u.chance_second},h.prototype.addChanceSecond=function(e){u.chance_second+=e,this.save()},h.prototype.getChance_extra=function(){return 100},h.prototype.addChanceExtra=function(e){u.chance_extra+=e,this.save()},h.prototype.getChance_giftApple=function(){return u.chance_giftApple},h.prototype.addChanceGiftApple=function(e){u.chance_giftApple+=e,this.save()},h.prototype.getChance_goldApple=function(){return u.chance_goldApple},h.prototype.addChancGoldApple=function(e){u.chance_goldApple+=e,this.save()},h.prototype.getChance_videoApple=function(){return u.chance_videoApple},h.prototype.addChanceVideoApple=function(e){u.chance_videoApple+=e,this.save()},h.prototype.getChance_doubleXp=function(){return u.chance_doubleXp},h.prototype.addChanceDoubleXp=function(e){u.chance_doubleXp+=e,this.save()},h.prototype.getFriendsChance=function(){return u.chance_friends.rate},h.prototype.addFriendsChance=function(e,t){e&&!this.isFriendsInvited(e)&&(u.chance_friends.rate+=10,t&&(u.chance_friends.rate+=10),u.chance_friends.rate>100&&(u.chance_friends.rate=100),u.friends_records[e]=Date.now(),this.save())},h.prototype.isFriendsInvited=function(e){var t=u.friends_records[e]||0;return Date.now()-t<864e5},h.prototype.getInviteContinueCount=function(){return u.invite_continue.count},h.prototype.decInviteContinueCount=function(){u.invite_continue.count--,u.invite_continue.count>=0&&this.save()},h.prototype.getFriendTimeLeft=function(e){var t=864e5-Math.ceil(Date.now()-u.friends_records[e]);return t=Math.floor(t/6e4),s.formatTime(t)},h.prototype.load=function(e){var t=null,n=this;FBInstant?FBInstant.player.getDataAsync(["data"]).then(function(t){if(void 0!==t.data)try{n.setData(JSON.parse(t.data))}catch(i){}n.isLoad=!0,e()}):((t=cc.sys.localStorage.getItem("data"))&&n.setData(JSON.parse(t)),e(),n.isLoad=!0)},h.prototype.setData=function(e){Object.keys(u).forEach(function(t){null==e[t]?e[t]=u[t]:u[t]=e[t]});var t=new Date,i=new Date;i.setMonth(0),i.setDate(1);var o=t-i,a=Math.ceil(o/864e5);a-u.chance_friends.startDay>=1&&(u.chance_friends.startDay=a,u.chance_friends.rate=0),a-u.invite_continue.startDay&&(u.invite_continue.startDay=a,u.count=10),n.setMusicEnable(u.musicEnable),n.setSoundEnable(u.soundEnable),u.curMaxStage>=6&&(u.isPKOpen=!0),u.dailyTask&&Date.now()-u.dailyTask.time>864e5&&(u.dailyTask=d)},h.prototype.clearData=function(){FBInstant&&FBInstant.player.setDataAsync({data:{}}),cc.sys.localStorage.removeItem("data")},h.prototype.save=function(){u.soundEnable=n.isSoundEnable(),u.musicEnable=n.isMusicEnable(),this.isLoad&&(FBInstant?FBInstant.player.setDataAsync({data:JSON.stringify(u)}):cc.sys.localStorage.setItem("data",JSON.stringify(u)))},h.prototype.setRankScore=function(e,t,n,i){window.FBInstant&&(this.isBlocked(FBInstant.player.getID())||FBInstant.getLeaderboardAsync(e).then(function(e){return e.setScoreAsync(t,n||"")}).then(function(){i&&i()}).catch(function(e){i&&i(),console.log("error",e)}))},h.prototype.getMyRank=function(e,t){FBInstant&&FBInstant.getLeaderboardAsync(e).then(function(e){return e.getPlayerEntryAsync()}).then(function(n){var i={photo:n.getPlayer().getPhoto(),nickName:n.getPlayer().getName(),rank:n.getRank(),score:n.getScore(),costomData:n.getExtraData()};t(i,e)})},h.prototype.getSound=function(){return u.sound},h.prototype.setSound=function(e){u.sound=e,this.save()},h.prototype.getDir=function(){return u.dir},h.prototype.setDir=function(e){u.dir=e,this.save()};var b=null,k=[];h.prototype.getConnectedPlayersAsync=function(e,t){window.FBInstant?b?e(b):(k.push(e),k.length>1||FBInstant.player.getConnectedPlayersAsync().then(function(e){b=e,k.forEach(function(t){t(e)}),k=[]}).catch(function(e){console.log("getConnectedPlayersAsync",e),t?t():k.forEach(function(e){e([])}),k=[]})):e([])},h.prototype.getRecommondId=function(){return 0==u.groupContextsNew.length?null:u.groupContextsNew[Math.floor(Math.random()*u.groupContextsNew.length)]},h.prototype.addGroupId=function(e){u.groupContextsNew.indexOf(e)>=0||(u.groupContextsNew.push(e),this.save())},h.prototype.updateGroupRank=function(e,t){if(FBInstant){var n="group_rank."+FBInstant.context.getID(),i=function(){FBInstant.updateAsync({action:"LEADERBOARD",name:n}),t()};FBInstant.getLeaderboardAsync(n).then(function(t){return t.setScoreAsync(e,"")}).then(function(){return[i()]}).catch(i)}},h.prototype.chooseFriend=function(e){c.logEvent("restart_choose_show"),FBInstant.context.chooseAsync({filters:["NEW_CONTEXT_ONLY"]}).then(function(){e(!0),c.logEvent("restart_choose_success")},function(){e(!1)})},h.prototype.playWithFriend=function(e,t){var n=this;c.logEvent("restart_recommond_player"),FBInstant.context.createAsync(e).then(function(){t(!0),c.logEvent("restart_recommond_player_success")}).catch(function(e){console.log(e),"SAME_CONTEXT"==e.code?t(!0):n.chooseFriend(function(e){t(e)})})},h.prototype.playWithGroup=function(e,t){var n=this;c.logEvent("restart recommond_group"),FBInstant.context.switchAsync(e).then(function(){t(!0),c.logEvent("restart_recommond_group_success")}).catch(function(e){console.log(e),n.chooseFriend(function(e){t(e)})})},h.prototype.challengeFriends=function(e){var t=this;i.showLoading();var n=u.groupContextsNew.length,o=function(t){i.hideLoading(),e(t)};this.getConnectedPlayersAsync(function(e){console.log(e);var i=e.length;if(i+n==0)t.chooseFriend(o);else if(Math.floor(Math.random()*(n+i))<n){var a=t.getRecommondId();t.playWithGroup(a,o)}else{var s=e[Math.floor(Math.random()*e.length)];"SOLO"!=FBInstant.context.getType()?FBInstant.context.getPlayersAsync().then(function(n){for(var i=null,a=0;a<n.length;a++)if(n[a].getID()!=FBInstant.player.getID()){i=n[a].getID();break}for(c.logEvent("restart_recommond_player");i&&i==s.getID()&&e.length>1;)s=e[Math.floor(Math.random()*e.length)];t.playWithFriend(s.getID(),o)}).catch(function(){t.playWithFriend(s.getID(),o)}):t.playWithFriend(s.getID(),o)}})},h.prototype.getRankDataList=function(e,t,n,i,o){if(FBInstant){var a=this;FBInstant.getLeaderboardAsync(e).then(function(e){return o?e.getConnectedPlayerEntriesAsync():e.getEntriesAsync(t,n)}).then(function(t){for(var s=[],c=0;c<t.length;c++)!a.isBlocked(t[c].getPlayer().getID())&&(t[c].getScore()<2500||FBInstant.player.getID()==t[c].getPlayer().getID())&&(n++,s.push({playerId:t[c].getPlayer().getID(),photo:t[c].getPlayer().getPhoto(),nickName:t[c].getPlayer().getName(),rank:n,fbRank:t[c].getRank(),score:t[c].getScore(),isFriend:o,costomData:t[c].getExtraData()}));i(s,e)}).catch(function(e){console.log(e),i([])})}else{for(var s=[],c=1;c<20;c++)s.push({playerId:"id"+c,photo:null,nickName:"name"+c,rank:c,fbRank:c,score:20*c,isFriend:o});i(s,e)}},h.prototype.decHalloweenCount=function(){u.halloween.count--,this.save()},h.prototype.getHalloweenCount=function(){return Math.floor((Date.now()-u.halloween.time)/1e3)>=C&&(u.halloween.count=5,u.halloween.time=Date.now(),this.save()),u.halloween.count};var C=14400;h.prototype.getHalloweenTime=function(){var e=Math.floor((Date.now()-u.halloween.time)/1e3);if(e>=C)return u.halloween.count=5,u.halloween.time=Date.now(),this.save(),"";var t=(e=C-e)%60<10?":0"+e%60:":"+e%60;return t=((e=Math.floor(e/60))%60<10?":0"+e%60:":"+e%60)+t,((e=Math.floor(e/60))<10?"0"+e:e)+t},h.prototype.getSweetCount=function(){return u.halloween.sweetCount},h.prototype.addSweetCount=function(e){u.halloween.sweetCount+=e,this.save()},h.prototype.unlockHalloweenKnife=function(e,t){u.unlockedKnife[e]=!0,u.halloween.sweetCount-=t,this.save()},h.prototype.getTaskIndex=function(){return u.dailyTask.curIndex},h.prototype.openNextTask=function(){u.dailyTask.curIndex++,u.dailyTask.count=0,u.dailyTask.status="inprogress",this.save()},h.prototype.getTaskCount=function(){return u.dailyTask.count},h.prototype.setTaskCount=function(e){u.dailyTask.count=e,this.save()},h.prototype.getTaskStatus=function(){return u.dailyTask.status},h.prototype.setTaskStatus=function(e){u.dailyTask.status!=e&&(u.dailyTask.status=e,this.save())},h.prototype.getThanksgivingLeftTime=function(){return Math.floor(1543046400-Date.now()/1e3)},h.prototype.getChristmasLeftTime=function(){return Math.floor(1545897600-Date.now()/1e3)},h.prototype.getNewYearLeftTime=function(){return Date.now()<15460704e5?-1:Math.floor(1546502400-Date.now()/1e3)},h.prototype.isVsCollected=function(e){return u.vsCollectedIds[e]},h.prototype.markVsCollected=function(e){u.vsCollectedIds[e]=!0},t.exports=h,cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",PlayerLvData:"PlayerLvData",PowerUpData:"PowerUpData",SoundMgr:"SoundMgr",Utils:"Utils",md5:"md5"}],Utils:[function(e,t){"use strict";cc._RF.push(t,"c15ebC5LmNCVLPSPeQvMSdK","Utils");var n=e("PageMgr"),i={formatNum:function(e){return"0000".substr(0,4-(""+e).length)+e},randomInt:function(e){return Math.floor(Math.random()*e)},randomSelectOne:function(e){return e[i.randomInt(e.length)]},formatTimeHMS:function(e){var t="";return e>=3600&&(t+=Math.floor(e/3600).toString()+"h"),e>=60&&(t+=Math.floor(e%3600/60).toString()+"m"),t+(Math.floor(e%60).toString()+"s")},formatTime:function(e){var t=e%60<10?"H 0"+e%60+"M":"H "+e%60+"M";return t=((e=Math.floor(e/60))%24<10?"D 0"+e%24:"D "+e%24)+t,((e=Math.floor(e/24))<10?"0"+e:e)+t}},o=window.gl;i.captureScreen=function(e,t,n,i,a,s,c){var r=e._sgNode||e,l=o||cc._renderContext;t=Math.floor(t),n=Math.floor(n);var h=new cc.RenderTexture(t,n,cc.Texture2D.PIXEL_FORMAT_RGBA8888,cc.sys.isBrowser?l.DEPTH_STENCIL:l.DEPTH24_STENCIL8_OES);cc.sys.isBrowser&&h.setAutoDraw(!0);var d=e.y;e.scaleY=-e.scaleY,e.y=n;var u=cc.macro.ENABLE_CULLING;cc.macro.ENABLE_CULLING=!1,h.beginWithClear(0,0,0,255,0,0),r.visit(),h.end(),cc.macro.ENABLE_CULLING=u,e.scaleY=-e.scaleY,e.y=d,cc.sys.isBrowser&&(h.scaleY=-1),a&&a();var p="";cc.sys.isBrowser?setTimeout(function(){try{var e=null,o=null;if(cc._renderType===cc.game.RENDER_TYPE_CANVAS)p=h.sprite.getTexture().getHtmlElementObj().toDataURL("image/png");else{var a=h.sprite.getTexture()._glID,r=n-(s=s||0)-(c=c||0);e=l.getParameter(l.FRAMEBUFFER_BINDING);var d=l.createFramebuffer();o=d,l.bindFramebuffer(l.FRAMEBUFFER,d),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,a,0);var u=new Uint8Array(t*r*4);l.readPixels(0,s,t,r,l.RGBA,l.UNSIGNED_BYTE,u),l.deleteFramebuffer(d),o=null;var g=document.createElement("canvas");g.id="captureCanvas",g.width=t,g.height=r,g.getContext("2d").putImageData(new ImageData(Uint8ClampedArray.from(u),t,r),0,0),p=g.toDataURL("image/jpg",.6)}i&&i(p,h)}catch(f){console.log(f),o&&(l.deleteFramebuffer(o),o=null),e&&(l.bindFramebuffer(l.FRAMEBUFFER,e),e=null),i&&i(p,h)}},0):i&&i(p,h)},i.getShareImg=function(e){var t=document.createElement("canvas");t.id="captureCanvas",cc.loader.loadRes("960X5006",function(n,i){var o=i.getHtmlElementObj();t.width=o.width,t.height=o.height;var a=t.getContext("2d");a.drawImage(o,0,0,o.width,o.height);var s=new Image;s.setAttribute("crossOrigin","Anonymous"),s.src=FBInstant.player.getPhoto(),s.onload=function(){a.drawImage(s,352,62,250,250),a.font="40px Arial",a.textAlign="center",a.font="40px Arial",a.fillStyle="white",a.lineWidth=3,a.strokeStyle="black",a.strokeText(FBInstant.player.getName(),o.width/2,370),a.fillText(FBInstant.player.getName(),o.width/2,370),cc.loader.loadRes("fenxiangtouxiangkuang",function(n,i){n||a.drawImage(i.getHtmlElementObj(),347,57,260,260),e(t.toDataURL("image/png"))})}})};var a={};i.getImageAsync=function(e,t){return new Promise(function(n,o){var s=a[e],c=cc.director.getScene();if(s)return c.addChild(s),"function"==typeof t?t(s):s.emit("pre_capture",t),void i.captureScreen(s,s.width,s.height,n,function(){c.removeChild(s)});cc.loader.loadRes("sharePrefab/"+e,function(s,r){if(s)o("load prefab fail --\x3e"+e);else{var l=cc.instantiate(r);a[e]=l,c.addChild(l),"function"==typeof t?t(l):l.emit("pre_capture",t),i.captureScreen(l,l.width,l.height,n,function(){c.removeChild(l)})}})})},i.playGame=function(e){e=e||{};var t=n.getPage(n.GAMEMAIN);n.showLoading(),t.getComponent("GameMain").preloadAsync(e).then(function(){n.showPage(n.GAMEMAIN),n.hideLoading()})},i.getYearWeek=function(e,t,n){var i=new Date(e,parseInt(t)-1,n),o=new Date(e,0,1),a=Math.round((i.valueOf()-o.valueOf())/864e5);return Math.ceil((a+(o.getDay()+1-1))/7)},i.getYearWeekByMillisecond=function(e){var t=new Date(e),n=i.getYearWeek(t.getFullYear(),t.getMonth()+1,t.getDate()).toString();return Number(n)},t.exports=i,cc._RF.pop()},{PageMgr:"PageMgr"}],VersionControl:[function(e,t){"use strict";cc._RF.push(t,"35bd4cX6mRP96KirZrnQmpH","VersionControl"),cc.Class({extends:cc.Component,properties:{indexStart:0,indexEnd:0},onLoad:function(){var e=User.getVersion();this.node.active=e>=this.indexStart&&e<this.indexEnd}}),cc._RF.pop()},{}],VideoShareDialog:[function(e,t){"use strict";cc._RF.push(t,"2f999bFE1BEpJGRjuH+i51X","VideoShareDialog");var n=e("PageMgr");cc.Class({extends:cc.Component,properties:{screenSprite:cc.Sprite,whiteMaskNode:cc.Node},onLoad:function(){var e=new cc.RenderTexture,t=cc.game._renderContext;this.screenSprite.node.height=this.screenSprite.node.width*cc.visibleRect.height/cc.visibleRect.width,e.initWithSize(cc.visibleRect.width,cc.visibleRect.height,t.STENCIL_INDEX8),this.rt=e,this.screenSprite.spriteFrame=new cc.SpriteFrame(e)},onShare:function(){window.platfromMgr.recorderShare(function(){})},onclose:function(){n.hideDialog("VideoShareDialog"),this.onCloseCb&&this.onCloseCb()},screenShot:function(e){var t=this;e.targetTexture=this.rt,this.whiteMaskNode.active=!0,this.scheduleOnce(function(){t.whiteMaskNode.active=!1},.2),this.scheduleOnce(function(){e.targetTexture=null})}}),cc._RF.pop()},{PageMgr:"PageMgr"}],VsResultDialog:[function(e,t){"use strict";cc._RF.push(t,"cc403gcpyVOU5lPeY9qSsex","VsResultDialog");var n=e("PageMgr"),i=e("AdHelper"),o=e("User");cc.Class({extends:cc.Component,properties:{resultLabel:cc.Label,lNameLabel:cc.Label,rNameLabel:cc.Label,lPhotoSprite:cc.Sprite,rPhotoSprite:cc.Sprite,okNode:cc.Node,titleSprite:cc.Sprite,rewardCountLabel:cc.Label},setVSData:function(e){var t=this;this.data=e,this.lNameLabel.string=e.otherScore,this.rNameLabel.string=e.score,this.rewardCountLabel.string=e.rewardCount,e.winId==(FBInstant&&FBInstant.player.getID())?(this.okNode.active=!1,this.resultLabel.string="YOU WIN!",this.resultLabel.node.color=cc.hexToColor("#FFF36E"),o.get().isVsCollected(e.battleId)&&(this.okNode.active=!0)):(this.okNode.active=!0,this.resultLabel.string="YOU LOSE!",this.resultLabel.node.color=cc.hexToColor("#D6D6D6")),cc.loader.load(e.playerPhoto,function(e,n){e?console.log(e):t.lPhotoSprite.spriteFrame=new cc.SpriteFrame(n)}),cc.loader.load(e.otherPlayerPhoto,function(e,n){e?console.log(e):t.rPhotoSprite.spriteFrame=new cc.SpriteFrame(n)})},onEnable:function(){i.logEvent("vs_collect_show")},onCollect:function(){i.logEvent("vs_collect_click"),o.get().markVsCollected(this.data.battleId),o.get().addDiamon(this.data.rewardCount),n.getPage(n.GIFTPAGE).getComponent("GiftPage").setAppleCount(this.data.rewardCount),n.showDialog(n.GIFTPAGE),n.hideDialog(n.VSRESULT)},onClose:function(){n.hideDialog(n.VSRESULT)}}),cc._RF.pop()},{AdHelper:"AdHelper",PageMgr:"PageMgr",User:"User"}],crc16:[function(e,t){"use strict";cc._RF.push(t,"9cb4c3msqJDNq98yKsTD505","crc16"),new Array(0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920),t.exports=function(e,t,n){t=t||0,n=n||e.length;for(var i=0,o=t;o<n;o++){var a=i>>>8&255;a^=255&e[o],i=i<<8&65535,i^=a^=a>>>4,i^=a=a<<5&65535,i^=a=a<<7&65535}return i},cc._RF.pop()},{}],enginefix:[function(e,t){"use strict";cc._RF.push(t,"28635UZy0xPAJ90E/RZ3jF8","enginefix");var n=Math.cos,i=Math.acos,o=Math.max,a=2*Math.PI,s=Math.sqrt;function c(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)}function r(e,t){var r,l,h,d,u=t-0,p=t-e[0],g=3*u,f=3*p,m=3*(t-e[2]),v=1/(-u+f-m+(t-1)),y=(g-6*p+m)*v,I=y*(1/3),_=(-g+f)*v,A=1/3*(3*_-y*y),b=A*(1/3),k=(2*y*y*y-9*y*_+u*v*27)/27,C=k/2,T=C*C+b*b*b;if(T<0){var S=1/3*-A,w=s(S*S*S),P=-k/(2*w),D=i(P<-1?-1:P>1?1:P),N=2*c(w);return l=N*n(D*(1/3))-I,h=N*n((D+a)*(1/3))-I,d=N*n((D+2*a)*(1/3))-I,0<=l&&l<=1?0<=h&&h<=1?0<=d&&d<=1?o(l,h,d):o(l,h):0<=d&&d<=1?o(l,d):l:0<=h&&h<=1?0<=d&&d<=1?o(h,d):h:d}if(0===T)return h=-(r=C<0?c(-C):-c(C))-I,0<=(l=2*r-I)&&l<=1?0<=h&&h<=1?o(l,h):l:h;var L=s(T);return(r=c(-C+L))-c(C+L)-I}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var a=t[o];if(e.call(i,a,o,t))return a;o++}}}),cc.easeBezierActionEx=function(e,t,n,i){return{easing:function(o){return 0*(c=1-(s=r(a=[e,t,n,i],o)))*c*c+3*a[1]*s*c*c+3*a[3]*s*s*c+1*s*s*s;var a,s,c},reverse:function(){return cc.easeBezierAction(i,n,t,e)}}},cc._RF.pop()},{}],md5:[function(require,module,exports){(function(process,global){"use strict";cc._RF.push(module,"a3f5btzv1VKoa/whV6zRL0d","md5"),function(){function t(e){if(e)d[0]=d[16]=d[1]=d[2]=d[3]=d[4]=d[5]=d[6]=d[7]=d[8]=d[9]=d[10]=d[11]=d[12]=d[13]=d[14]=d[15]=0,this.blocks=d,this.buffer8=l;else if(a){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}var r="input is invalid type",e="object"==typeof window,i=e?window:{};i.JS_MD5_NO_WINDOW&&(e=!1);var s=!e&&"object"==typeof self,h=!i.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;h?i=global:s&&(i=self);var f=!i.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,o="function"==typeof define&&define.amd,a=!i.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,n="0123456789abcdef".split(""),u=[128,32768,8388608,-2147483648],y=[0,8,16,24],c=["hex","array","digest","buffer","arrayBuffer","base64"],p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),d=[],l;if(a){var A=new ArrayBuffer(68);l=new Uint8Array(A),d=new Uint32Array(A)}!i.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!a||!i.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var b=function(e){return function(n){return new t(!0).update(n)[e]()}},v=function(){var e=b("hex");h&&(e=w(e)),e.create=function(){return new t},e.update=function(t){return e.create().update(t)};for(var n=0;n<c.length;++n){var i=c[n];e[i]=b(i)}return e},w=function w(t){var e=eval("require('crypto')"),i=eval("require('buffer').Buffer"),s=function(n){if("string"==typeof n)return e.createHash("md5").update(n,"utf8").digest("hex");if(null==n)throw r;return n.constructor===ArrayBuffer&&(n=new Uint8Array(n)),Array.isArray(n)||ArrayBuffer.isView(n)||n.constructor===i?e.createHash("md5").update(new i(n)).digest("hex"):t(n)};return s};t.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw r;if(null===e)throw r;if(a&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||a&&ArrayBuffer.isView(e)))throw r;t=!0}for(var i,o,s=0,c=e.length,l=this.blocks,h=this.buffer8;s<c;){if(this.hashed&&(this.hashed=!1,l[0]=l[16],l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),t)if(a)for(o=this.start;s<c&&o<64;++s)h[o++]=e[s];else for(o=this.start;s<c&&o<64;++s)l[o>>2]|=e[s]<<y[3&o++];else if(a)for(o=this.start;s<c&&o<64;++s)(i=e.charCodeAt(s))<128?h[o++]=i:i<2048?(h[o++]=192|i>>6,h[o++]=128|63&i):i<55296||i>=57344?(h[o++]=224|i>>12,h[o++]=128|i>>6&63,h[o++]=128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++s)),h[o++]=240|i>>18,h[o++]=128|i>>12&63,h[o++]=128|i>>6&63,h[o++]=128|63&i);else for(o=this.start;s<c&&o<64;++s)(i=e.charCodeAt(s))<128?l[o>>2]|=i<<y[3&o++]:i<2048?(l[o>>2]|=(192|i>>6)<<y[3&o++],l[o>>2]|=(128|63&i)<<y[3&o++]):i<55296||i>=57344?(l[o>>2]|=(224|i>>12)<<y[3&o++],l[o>>2]|=(128|i>>6&63)<<y[3&o++],l[o>>2]|=(128|63&i)<<y[3&o++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++s)),l[o>>2]|=(240|i>>18)<<y[3&o++],l[o>>2]|=(128|i>>12&63)<<y[3&o++],l[o>>2]|=(128|i>>6&63)<<y[3&o++],l[o>>2]|=(128|63&i)<<y[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=u[3&t],t>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},t.prototype.hash=function(){var e,t,n,i,o,a,s=this.blocks;this.first?t=((t=((e=((e=s[0]-680876937)<<7|e>>>25)-271733879<<0)^(n=((n=(-271733879^(i=((i=(-1732584194^2004318071&e)+s[1]-117830708)<<12|i>>>20)+e<<0)&(-271733879^e))+s[2]-1126478375)<<17|n>>>15)+i<<0)&(i^e))+s[3]-1316259209)<<22|t>>>10)+n<<0:(e=this.h0,t=this.h1,n=this.h2,t=((t+=((e=((e+=((i=this.h3)^t&(n^i))+s[0]-680876936)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[1]-389564586)<<12|i>>>20)+e<<0)&(e^t))+s[2]+606105819)<<17|n>>>15)+i<<0)&(i^e))+s[3]-1044525330)<<22|t>>>10)+n<<0),t=((t+=((e=((e+=(i^t&(n^i))+s[4]-176418897)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[5]+1200080426)<<12|i>>>20)+e<<0)&(e^t))+s[6]-1473231341)<<17|n>>>15)+i<<0)&(i^e))+s[7]-45705983)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+s[8]+1770035416)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[9]-1958414417)<<12|i>>>20)+e<<0)&(e^t))+s[10]-42063)<<17|n>>>15)+i<<0)&(i^e))+s[11]-1990404162)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+s[12]+1804603682)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+s[13]-40341101)<<12|i>>>20)+e<<0)&(e^t))+s[14]-1502002290)<<17|n>>>15)+i<<0)&(i^e))+s[15]+1236535329)<<22|t>>>10)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[1]-165796510)<<5|e>>>27)+t<<0)^t))+s[6]-1069501632)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[11]+643717713)<<14|n>>>18)+i<<0)^i))+s[0]-373897302)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[5]-701558691)<<5|e>>>27)+t<<0)^t))+s[10]+38016083)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[15]-660478335)<<14|n>>>18)+i<<0)^i))+s[4]-405537848)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[9]+568446438)<<5|e>>>27)+t<<0)^t))+s[14]-1019803690)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[3]-187363961)<<14|n>>>18)+i<<0)^i))+s[8]+1163531501)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+s[13]-1444681467)<<5|e>>>27)+t<<0)^t))+s[2]-51403784)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+s[7]+1735328473)<<14|n>>>18)+i<<0)^i))+s[12]-1926607734)<<20|t>>>12)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[5]-378558)<<4|e>>>28)+t<<0))+s[8]-2022574463)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[11]+1839030562)<<16|n>>>16)+i<<0))+s[14]-35309556)<<23|t>>>9)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[1]-1530992060)<<4|e>>>28)+t<<0))+s[4]+1272893353)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[7]-155497632)<<16|n>>>16)+i<<0))+s[10]-1094730640)<<23|t>>>9)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[13]+681279174)<<4|e>>>28)+t<<0))+s[0]-358537222)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[3]-722521979)<<16|n>>>16)+i<<0))+s[6]+76029189)<<23|t>>>9)+n<<0,t=((t+=((a=(i=((i+=((o=t^n)^(e=((e+=(o^i)+s[9]-640364487)<<4|e>>>28)+t<<0))+s[12]-421815835)<<11|i>>>21)+e<<0)^e)^(n=((n+=(a^t)+s[15]+530742520)<<16|n>>>16)+i<<0))+s[2]-995338651)<<23|t>>>9)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[0]-198630844)<<6|e>>>26)+t<<0)|~n))+s[7]+1126891415)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[14]-1416354905)<<15|n>>>17)+i<<0)|~e))+s[5]-57434055)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[12]+1700485571)<<6|e>>>26)+t<<0)|~n))+s[3]-1894986606)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[10]-1051523)<<15|n>>>17)+i<<0)|~e))+s[1]-2054922799)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[8]+1873313359)<<6|e>>>26)+t<<0)|~n))+s[15]-30611744)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[6]-1560198380)<<15|n>>>17)+i<<0)|~e))+s[13]+1309151649)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+s[4]-145523070)<<6|e>>>26)+t<<0)|~n))+s[11]-1120210379)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+s[2]+718787259)<<15|n>>>17)+i<<0)|~e))+s[9]-343485551)<<21|t>>>11)+n<<0,this.first?(this.h0=e+1732584193<<0,this.h1=t-271733879<<0,this.h2=n-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+i<<0)},t.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,o=this.h3;return n[e>>4&15]+n[15&e]+n[e>>12&15]+n[e>>8&15]+n[e>>20&15]+n[e>>16&15]+n[e>>28&15]+n[e>>24&15]+n[t>>4&15]+n[15&t]+n[t>>12&15]+n[t>>8&15]+n[t>>20&15]+n[t>>16&15]+n[t>>28&15]+n[t>>24&15]+n[i>>4&15]+n[15&i]+n[i>>12&15]+n[i>>8&15]+n[i>>20&15]+n[i>>16&15]+n[i>>28&15]+n[i>>24&15]+n[o>>4&15]+n[15&o]+n[o>>12&15]+n[o>>8&15]+n[o>>20&15]+n[o>>16&15]+n[o>>28&15]+n[o>>24&15]},t.prototype.toString=t.prototype.hex,t.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return[255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255]},t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},t.prototype.buffer=t.prototype.arrayBuffer,t.prototype.base64=function(){for(var e,t,n,i="",o=this.array(),a=0;a<15;)e=o[a++],t=o[a++],n=o[a++],i+=p[e>>>2]+p[63&(e<<4|t>>>4)]+p[63&(t<<2|n>>>6)]+p[63&n];return e=o[a],i+(p[e>>>2]+p[e<<4&63]+"==")};var _=v();f?module.exports=_:(i.md5=_,o&&define(function(){return _}))}(),cc._RF.pop()}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}],use_reversed_rotateTo:[function(e,t){"use strict";cc._RF.push(t,"ede0dP3l4dFcpo6ems1+d0U","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}]},{},["AdHelper","FBShare","GameConfig","PageRegister","PlatfromTT","ChristmasSaleDialog","GameHalloween","HalloweenDialog","HalloweenEndDialog","HalloweenPayDialog","HalloweenRankItem","HalloweenResultDialog","HoroscopeGame","HoroscopeItem","HoroscopePage","NewYearSaleDialog","SweetCollectDialog","ThanksSaleDialog","AdBreath","AdapterScale","JumpGame","ListItem","ListView","VersionControl","AnimationData","HalloweenLevelData","KnifeData","LevelData","PKLevelData","PlayerLvData","PowerUpData","PrizeData","ShopData","SlotData","TargetData","TaskData","AppleShopDialog","BestShareDialog","BonusAnim","ContinuePage","GameDuel","GameMain","GameSpin","GiftCollectDialog","GiftPage","HomePage","InviteDialog","InviteKnifePage","InviteTipDialog","IosShopPage","KnifeIcon","NoticeDialog","PKItem","PKPage","PKRecordItem","PKScreen","PayShop","PointControl","PointIcon","PowerIcon","PowerInfoDialog","PowerUpItem","PowerUpPage","RankItem","RankPage","ResultDialog","ResultItem","ResultRankItem","RoundDao","RoundItem","SettingDialog","ShopDialog","ShowInviteKnifeDialog","ShowKnifeDialog","SloteList","SlotoItem","SpinDialog","SpinLottery","TurntableDialog","VideoShareDialog","VsResultDialog","enginefix","AnimalUtil","EventUtil","NetHelper","PageMgr","PageUtil","SoundMgr","SoundUtil","TaskMgr","User","Utils","md5","NetAPI","NetConfig","ProtoGenerated","PushAPI","NetMgr","crc16","TaskButton","TaskDialog","use_reversed_rotateTo"]);